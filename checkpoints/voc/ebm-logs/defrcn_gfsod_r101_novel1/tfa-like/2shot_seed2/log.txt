[11/18 07:10:34] detectron2 INFO: Rank of current process: 0. World size: 4
[11/18 07:10:34] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/18 07:10:34] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed2", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/18 07:10:34] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/config.yaml
[11/18 07:10:34] d2.utils.env INFO: Using a generated random seed 36357265
[11/18 07:10:35] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/18 07:10:35] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/18 07:10:35] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/18 07:10:35] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/18 07:10:35] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/18 07:10:35] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/18 07:10:35] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/18 07:10:36] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/18 07:10:36] d2.engine.train_loop INFO: Starting training from iteration 0
[11/18 07:10:48] d2.utils.events INFO:  eta: 0:09:53  iter: 19  total_loss: 0.5152  loss_cls: 0.2915  loss_box_reg: 0.1295  loss_rpn_cls: 0.06855  loss_rpn_loc: 0.02673  time: 0.5003  data_time: 0.1049  lr: 0.01  max_mem: 5092M
[11/18 07:10:58] d2.utils.events INFO:  eta: 0:09:34  iter: 39  total_loss: 0.4215  loss_cls: 0.2305  loss_box_reg: 0.1315  loss_rpn_cls: 0.04438  loss_rpn_loc: 0.02101  time: 0.4965  data_time: 0.0098  lr: 0.01  max_mem: 5122M
[11/18 07:11:08] d2.utils.events INFO:  eta: 0:09:22  iter: 59  total_loss: 0.3303  loss_cls: 0.1573  loss_box_reg: 0.1142  loss_rpn_cls: 0.03387  loss_rpn_loc: 0.02018  time: 0.4955  data_time: 0.0098  lr: 0.01  max_mem: 5122M
[11/18 07:11:18] d2.utils.events INFO:  eta: 0:09:13  iter: 79  total_loss: 0.2802  loss_cls: 0.1321  loss_box_reg: 0.1009  loss_rpn_cls: 0.02735  loss_rpn_loc: 0.0154  time: 0.4962  data_time: 0.0093  lr: 0.01  max_mem: 5122M
[11/18 07:11:28] d2.utils.events INFO:  eta: 0:09:03  iter: 99  total_loss: 0.2433  loss_cls: 0.1067  loss_box_reg: 0.0902  loss_rpn_cls: 0.02585  loss_rpn_loc: 0.01527  time: 0.4968  data_time: 0.0107  lr: 0.01  max_mem: 5122M
[11/18 07:11:38] d2.utils.events INFO:  eta: 0:08:53  iter: 119  total_loss: 0.2173  loss_cls: 0.1007  loss_box_reg: 0.08698  loss_rpn_cls: 0.02019  loss_rpn_loc: 0.01595  time: 0.4975  data_time: 0.0101  lr: 0.01  max_mem: 5122M
[11/18 07:11:48] d2.utils.events INFO:  eta: 0:08:43  iter: 139  total_loss: 0.1975  loss_cls: 0.08465  loss_box_reg: 0.07545  loss_rpn_cls: 0.01886  loss_rpn_loc: 0.01503  time: 0.4977  data_time: 0.0099  lr: 0.01  max_mem: 5122M
[11/18 07:11:58] d2.utils.events INFO:  eta: 0:08:33  iter: 159  total_loss: 0.1882  loss_cls: 0.08063  loss_box_reg: 0.07233  loss_rpn_cls: 0.01745  loss_rpn_loc: 0.01777  time: 0.4974  data_time: 0.0099  lr: 0.01  max_mem: 5122M
[11/18 07:12:08] d2.utils.events INFO:  eta: 0:08:22  iter: 179  total_loss: 0.173  loss_cls: 0.07762  loss_box_reg: 0.06693  loss_rpn_cls: 0.01562  loss_rpn_loc: 0.01256  time: 0.4967  data_time: 0.0100  lr: 0.01  max_mem: 5123M
[11/18 07:12:18] d2.utils.events INFO:  eta: 0:08:12  iter: 199  total_loss: 0.1735  loss_cls: 0.07494  loss_box_reg: 0.06481  loss_rpn_cls: 0.01632  loss_rpn_loc: 0.01276  time: 0.4969  data_time: 0.0093  lr: 0.01  max_mem: 5123M
[11/18 07:12:28] d2.utils.events INFO:  eta: 0:08:03  iter: 219  total_loss: 0.1679  loss_cls: 0.07427  loss_box_reg: 0.06305  loss_rpn_cls: 0.01788  loss_rpn_loc: 0.01739  time: 0.4970  data_time: 0.0094  lr: 0.01  max_mem: 5123M
[11/18 07:12:38] d2.utils.events INFO:  eta: 0:07:54  iter: 239  total_loss: 0.1537  loss_cls: 0.07013  loss_box_reg: 0.05809  loss_rpn_cls: 0.01375  loss_rpn_loc: 0.01596  time: 0.4971  data_time: 0.0096  lr: 0.01  max_mem: 5123M
[11/18 07:12:47] d2.utils.events INFO:  eta: 0:07:42  iter: 259  total_loss: 0.1613  loss_cls: 0.06974  loss_box_reg: 0.05836  loss_rpn_cls: 0.01567  loss_rpn_loc: 0.01676  time: 0.4966  data_time: 0.0099  lr: 0.01  max_mem: 5123M
[11/18 07:12:57] d2.utils.events INFO:  eta: 0:07:34  iter: 279  total_loss: 0.1549  loss_cls: 0.06749  loss_box_reg: 0.05684  loss_rpn_cls: 0.01465  loss_rpn_loc: 0.01435  time: 0.4969  data_time: 0.0110  lr: 0.01  max_mem: 5124M
[11/18 07:13:07] d2.utils.events INFO:  eta: 0:07:24  iter: 299  total_loss: 0.1513  loss_cls: 0.06766  loss_box_reg: 0.05378  loss_rpn_cls: 0.01283  loss_rpn_loc: 0.01514  time: 0.4970  data_time: 0.0111  lr: 0.01  max_mem: 5124M
[11/18 07:13:17] d2.utils.events INFO:  eta: 0:07:14  iter: 319  total_loss: 0.1464  loss_cls: 0.06618  loss_box_reg: 0.05343  loss_rpn_cls: 0.01425  loss_rpn_loc: 0.01162  time: 0.4971  data_time: 0.0105  lr: 0.01  max_mem: 5124M
[11/18 07:13:27] d2.utils.events INFO:  eta: 0:07:04  iter: 339  total_loss: 0.1425  loss_cls: 0.06562  loss_box_reg: 0.05172  loss_rpn_cls: 0.01178  loss_rpn_loc: 0.01214  time: 0.4975  data_time: 0.0104  lr: 0.01  max_mem: 5124M
[11/18 07:13:37] d2.utils.events INFO:  eta: 0:06:54  iter: 359  total_loss: 0.1381  loss_cls: 0.06416  loss_box_reg: 0.04882  loss_rpn_cls: 0.01144  loss_rpn_loc: 0.01146  time: 0.4974  data_time: 0.0101  lr: 0.01  max_mem: 5124M
[11/18 07:13:47] d2.utils.events INFO:  eta: 0:06:45  iter: 379  total_loss: 0.1333  loss_cls: 0.06478  loss_box_reg: 0.04816  loss_rpn_cls: 0.009982  loss_rpn_loc: 0.01201  time: 0.4974  data_time: 0.0103  lr: 0.01  max_mem: 5124M
[11/18 07:13:57] d2.utils.events INFO:  eta: 0:06:35  iter: 399  total_loss: 0.1335  loss_cls: 0.06205  loss_box_reg: 0.04515  loss_rpn_cls: 0.01222  loss_rpn_loc: 0.01083  time: 0.4971  data_time: 0.0095  lr: 0.01  max_mem: 5124M
[11/18 07:14:07] d2.utils.events INFO:  eta: 0:06:25  iter: 419  total_loss: 0.1359  loss_cls: 0.06257  loss_box_reg: 0.04486  loss_rpn_cls: 0.01206  loss_rpn_loc: 0.01309  time: 0.4970  data_time: 0.0098  lr: 0.01  max_mem: 5124M
[11/18 07:14:17] d2.utils.events INFO:  eta: 0:06:15  iter: 439  total_loss: 0.1224  loss_cls: 0.06055  loss_box_reg: 0.04457  loss_rpn_cls: 0.008884  loss_rpn_loc: 0.009825  time: 0.4969  data_time: 0.0106  lr: 0.01  max_mem: 5124M
[11/18 07:14:27] d2.utils.events INFO:  eta: 0:06:05  iter: 459  total_loss: 0.1287  loss_cls: 0.0617  loss_box_reg: 0.04319  loss_rpn_cls: 0.01066  loss_rpn_loc: 0.0104  time: 0.4970  data_time: 0.0092  lr: 0.01  max_mem: 5124M
[11/18 07:14:37] d2.utils.events INFO:  eta: 0:05:55  iter: 479  total_loss: 0.1297  loss_cls: 0.06165  loss_box_reg: 0.0438  loss_rpn_cls: 0.01085  loss_rpn_loc: 0.01006  time: 0.4968  data_time: 0.0089  lr: 0.01  max_mem: 5124M
[11/18 07:14:47] d2.utils.events INFO:  eta: 0:05:45  iter: 499  total_loss: 0.1311  loss_cls: 0.06067  loss_box_reg: 0.0437  loss_rpn_cls: 0.01381  loss_rpn_loc: 0.01188  time: 0.4970  data_time: 0.0094  lr: 0.01  max_mem: 5124M
[11/18 07:14:57] d2.utils.events INFO:  eta: 0:05:35  iter: 519  total_loss: 0.1283  loss_cls: 0.06064  loss_box_reg: 0.04277  loss_rpn_cls: 0.01269  loss_rpn_loc: 0.01045  time: 0.4969  data_time: 0.0093  lr: 0.01  max_mem: 5124M
[11/18 07:15:07] d2.utils.events INFO:  eta: 0:05:25  iter: 539  total_loss: 0.1259  loss_cls: 0.06168  loss_box_reg: 0.04137  loss_rpn_cls: 0.01077  loss_rpn_loc: 0.01078  time: 0.4968  data_time: 0.0099  lr: 0.01  max_mem: 5124M
[11/18 07:15:17] d2.utils.events INFO:  eta: 0:05:16  iter: 559  total_loss: 0.1233  loss_cls: 0.06178  loss_box_reg: 0.04082  loss_rpn_cls: 0.01119  loss_rpn_loc: 0.01223  time: 0.4968  data_time: 0.0106  lr: 0.01  max_mem: 5124M
[11/18 07:15:27] d2.utils.events INFO:  eta: 0:05:06  iter: 579  total_loss: 0.1326  loss_cls: 0.06215  loss_box_reg: 0.04008  loss_rpn_cls: 0.009994  loss_rpn_loc: 0.01509  time: 0.4969  data_time: 0.0098  lr: 0.01  max_mem: 5124M
[11/18 07:15:37] d2.utils.events INFO:  eta: 0:04:56  iter: 599  total_loss: 0.1275  loss_cls: 0.06019  loss_box_reg: 0.04222  loss_rpn_cls: 0.01015  loss_rpn_loc: 0.009449  time: 0.4971  data_time: 0.0096  lr: 0.01  max_mem: 5124M
[11/18 07:15:47] d2.utils.events INFO:  eta: 0:04:46  iter: 619  total_loss: 0.1198  loss_cls: 0.05884  loss_box_reg: 0.0396  loss_rpn_cls: 0.01125  loss_rpn_loc: 0.01019  time: 0.4970  data_time: 0.0103  lr: 0.01  max_mem: 5124M
[11/18 07:15:57] d2.utils.events INFO:  eta: 0:04:36  iter: 639  total_loss: 0.1209  loss_cls: 0.05827  loss_box_reg: 0.03975  loss_rpn_cls: 0.01053  loss_rpn_loc: 0.01082  time: 0.4971  data_time: 0.0091  lr: 0.01  max_mem: 5124M
[11/18 07:16:06] d2.utils.events INFO:  eta: 0:04:26  iter: 659  total_loss: 0.1104  loss_cls: 0.05754  loss_box_reg: 0.03783  loss_rpn_cls: 0.007446  loss_rpn_loc: 0.01088  time: 0.4969  data_time: 0.0094  lr: 0.01  max_mem: 5124M
[11/18 07:16:16] d2.utils.events INFO:  eta: 0:04:16  iter: 679  total_loss: 0.1176  loss_cls: 0.06017  loss_box_reg: 0.03854  loss_rpn_cls: 0.01027  loss_rpn_loc: 0.008647  time: 0.4969  data_time: 0.0091  lr: 0.01  max_mem: 5124M
[11/18 07:16:26] d2.utils.events INFO:  eta: 0:04:06  iter: 699  total_loss: 0.1178  loss_cls: 0.05867  loss_box_reg: 0.03808  loss_rpn_cls: 0.009432  loss_rpn_loc: 0.008492  time: 0.4970  data_time: 0.0098  lr: 0.01  max_mem: 5124M
[11/18 07:16:36] d2.utils.events INFO:  eta: 0:03:56  iter: 719  total_loss: 0.1163  loss_cls: 0.0574  loss_box_reg: 0.03742  loss_rpn_cls: 0.01046  loss_rpn_loc: 0.008368  time: 0.4969  data_time: 0.0101  lr: 0.01  max_mem: 5124M
[11/18 07:16:46] d2.utils.events INFO:  eta: 0:03:46  iter: 739  total_loss: 0.1136  loss_cls: 0.05849  loss_box_reg: 0.03697  loss_rpn_cls: 0.009165  loss_rpn_loc: 0.01139  time: 0.4968  data_time: 0.0099  lr: 0.01  max_mem: 5124M
[11/18 07:16:56] d2.utils.events INFO:  eta: 0:03:37  iter: 759  total_loss: 0.1196  loss_cls: 0.0589  loss_box_reg: 0.03758  loss_rpn_cls: 0.01163  loss_rpn_loc: 0.009784  time: 0.4967  data_time: 0.0099  lr: 0.01  max_mem: 5124M
[11/18 07:17:06] d2.utils.events INFO:  eta: 0:03:27  iter: 779  total_loss: 0.1158  loss_cls: 0.05697  loss_box_reg: 0.03856  loss_rpn_cls: 0.01079  loss_rpn_loc: 0.01077  time: 0.4965  data_time: 0.0107  lr: 0.01  max_mem: 5124M
[11/18 07:17:16] d2.utils.events INFO:  eta: 0:03:17  iter: 799  total_loss: 0.1135  loss_cls: 0.05819  loss_box_reg: 0.03669  loss_rpn_cls: 0.009648  loss_rpn_loc: 0.01045  time: 0.4965  data_time: 0.0094  lr: 0.01  max_mem: 5124M
[11/18 07:17:26] d2.utils.events INFO:  eta: 0:03:07  iter: 819  total_loss: 0.1128  loss_cls: 0.05723  loss_box_reg: 0.03755  loss_rpn_cls: 0.009702  loss_rpn_loc: 0.007784  time: 0.4964  data_time: 0.0086  lr: 0.01  max_mem: 5124M
[11/18 07:17:36] d2.utils.events INFO:  eta: 0:02:57  iter: 839  total_loss: 0.1161  loss_cls: 0.05631  loss_box_reg: 0.0347  loss_rpn_cls: 0.008968  loss_rpn_loc: 0.01247  time: 0.4964  data_time: 0.0093  lr: 0.01  max_mem: 5124M
[11/18 07:17:46] d2.utils.events INFO:  eta: 0:02:47  iter: 859  total_loss: 0.1068  loss_cls: 0.05359  loss_box_reg: 0.03396  loss_rpn_cls: 0.01035  loss_rpn_loc: 0.008773  time: 0.4965  data_time: 0.0097  lr: 0.01  max_mem: 5124M
[11/18 07:17:55] d2.utils.events INFO:  eta: 0:02:37  iter: 879  total_loss: 0.1121  loss_cls: 0.05674  loss_box_reg: 0.03512  loss_rpn_cls: 0.01138  loss_rpn_loc: 0.009575  time: 0.4964  data_time: 0.0097  lr: 0.01  max_mem: 5124M
[11/18 07:18:05] d2.utils.events INFO:  eta: 0:02:27  iter: 899  total_loss: 0.1152  loss_cls: 0.058  loss_box_reg: 0.03577  loss_rpn_cls: 0.01133  loss_rpn_loc: 0.01102  time: 0.4963  data_time: 0.0102  lr: 0.01  max_mem: 5124M
[11/18 07:18:15] d2.utils.events INFO:  eta: 0:02:17  iter: 919  total_loss: 0.1108  loss_cls: 0.05582  loss_box_reg: 0.03578  loss_rpn_cls: 0.01041  loss_rpn_loc: 0.008325  time: 0.4962  data_time: 0.0104  lr: 0.01  max_mem: 5124M
[11/18 07:18:25] d2.utils.events INFO:  eta: 0:02:08  iter: 939  total_loss: 0.1137  loss_cls: 0.05729  loss_box_reg: 0.03583  loss_rpn_cls: 0.009248  loss_rpn_loc: 0.008765  time: 0.4962  data_time: 0.0087  lr: 0.01  max_mem: 5124M
[11/18 07:18:35] d2.utils.events INFO:  eta: 0:01:58  iter: 959  total_loss: 0.1049  loss_cls: 0.05291  loss_box_reg: 0.03203  loss_rpn_cls: 0.00937  loss_rpn_loc: 0.009138  time: 0.4960  data_time: 0.0096  lr: 0.01  max_mem: 5124M
[11/18 07:18:45] d2.utils.events INFO:  eta: 0:01:48  iter: 979  total_loss: 0.1115  loss_cls: 0.05642  loss_box_reg: 0.03394  loss_rpn_cls: 0.01003  loss_rpn_loc: 0.009166  time: 0.4959  data_time: 0.0102  lr: 0.001  max_mem: 5124M
[11/18 07:18:55] d2.utils.events INFO:  eta: 0:01:38  iter: 999  total_loss: 0.1105  loss_cls: 0.05487  loss_box_reg: 0.03504  loss_rpn_cls: 0.009634  loss_rpn_loc: 0.00685  time: 0.4959  data_time: 0.0100  lr: 0.001  max_mem: 5124M
[11/18 07:19:04] d2.utils.events INFO:  eta: 0:01:28  iter: 1019  total_loss: 0.1038  loss_cls: 0.05541  loss_box_reg: 0.03172  loss_rpn_cls: 0.009166  loss_rpn_loc: 0.005359  time: 0.4959  data_time: 0.0101  lr: 0.001  max_mem: 5124M
[11/18 07:19:15] d2.utils.events INFO:  eta: 0:01:18  iter: 1039  total_loss: 0.1048  loss_cls: 0.05628  loss_box_reg: 0.03512  loss_rpn_cls: 0.007807  loss_rpn_loc: 0.005387  time: 0.4960  data_time: 0.0115  lr: 0.001  max_mem: 5124M
[11/18 07:19:24] d2.utils.events INFO:  eta: 0:01:08  iter: 1059  total_loss: 0.1062  loss_cls: 0.05615  loss_box_reg: 0.03529  loss_rpn_cls: 0.009069  loss_rpn_loc: 0.004707  time: 0.4960  data_time: 0.0092  lr: 0.001  max_mem: 5124M
[11/18 07:19:34] d2.utils.events INFO:  eta: 0:00:59  iter: 1079  total_loss: 0.1055  loss_cls: 0.05762  loss_box_reg: 0.03336  loss_rpn_cls: 0.008493  loss_rpn_loc: 0.005131  time: 0.4959  data_time: 0.0093  lr: 0.001  max_mem: 5124M
[11/18 07:19:44] d2.utils.events INFO:  eta: 0:00:49  iter: 1099  total_loss: 0.1018  loss_cls: 0.05435  loss_box_reg: 0.03235  loss_rpn_cls: 0.009257  loss_rpn_loc: 0.005617  time: 0.4959  data_time: 0.0105  lr: 0.001  max_mem: 5124M
[11/18 07:19:54] d2.utils.events INFO:  eta: 0:00:39  iter: 1119  total_loss: 0.1034  loss_cls: 0.05574  loss_box_reg: 0.03195  loss_rpn_cls: 0.009101  loss_rpn_loc: 0.004874  time: 0.4960  data_time: 0.0094  lr: 0.001  max_mem: 5124M
[11/18 07:20:04] d2.utils.events INFO:  eta: 0:00:29  iter: 1139  total_loss: 0.1004  loss_cls: 0.05593  loss_box_reg: 0.03171  loss_rpn_cls: 0.009257  loss_rpn_loc: 0.00495  time: 0.4960  data_time: 0.0095  lr: 0.001  max_mem: 5124M
[11/18 07:20:14] d2.utils.events INFO:  eta: 0:00:19  iter: 1159  total_loss: 0.1059  loss_cls: 0.05709  loss_box_reg: 0.03334  loss_rpn_cls: 0.009048  loss_rpn_loc: 0.004651  time: 0.4960  data_time: 0.0097  lr: 0.001  max_mem: 5124M
[11/18 07:20:24] d2.utils.events INFO:  eta: 0:00:09  iter: 1179  total_loss: 0.104  loss_cls: 0.05425  loss_box_reg: 0.03195  loss_rpn_cls: 0.007521  loss_rpn_loc: 0.004836  time: 0.4961  data_time: 0.0104  lr: 0.001  max_mem: 5124M
[11/18 07:20:34] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final.pth
[11/18 07:20:35] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.1047  loss_cls: 0.05671  loss_box_reg: 0.03248  loss_rpn_cls: 0.00781  loss_rpn_loc: 0.004501  time: 0.4961  data_time: 0.0089  lr: 0.001  max_mem: 5124M
[11/18 07:20:35] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:09:54 (0.4961 s / it)
[11/18 07:20:35] d2.engine.hooks INFO: Total training time: 0:09:55 (0:00:01 on hooks)
[11/18 07:20:35] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/18 07:20:35] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 07:20:35] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/18 07:20:36] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/18 07:20:36] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/18 07:20:36] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/18 07:20:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 07:20:37] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/18 07:20:37] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/18 07:20:37] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/18 07:20:48] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.1166 s / img. ETA=0:02:18
[11/18 07:20:54] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.1154 s / img. ETA=0:02:11
[11/18 07:20:59] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.1156 s / img. ETA=0:02:05
[11/18 07:21:05] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.1156 s / img. ETA=0:01:59
[11/18 07:21:11] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.1152 s / img. ETA=0:01:53
[11/18 07:21:17] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.1148 s / img. ETA=0:01:47
[11/18 07:21:22] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.1143 s / img. ETA=0:01:41
[11/18 07:21:28] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.1140 s / img. ETA=0:01:35
[11/18 07:21:33] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.1140 s / img. ETA=0:01:29
[11/18 07:21:39] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.1137 s / img. ETA=0:01:23
[11/18 07:21:45] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.1134 s / img. ETA=0:01:17
[11/18 07:21:50] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.1136 s / img. ETA=0:01:12
[11/18 07:21:56] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.1134 s / img. ETA=0:01:06
[11/18 07:22:01] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.1133 s / img. ETA=0:01:00
[11/18 07:22:07] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.1134 s / img. ETA=0:00:55
[11/18 07:22:13] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.1135 s / img. ETA=0:00:49
[11/18 07:22:19] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.1135 s / img. ETA=0:00:44
[11/18 07:22:24] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.1134 s / img. ETA=0:00:38
[11/18 07:22:30] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.1133 s / img. ETA=0:00:32
[11/18 07:22:35] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.1133 s / img. ETA=0:00:26
[11/18 07:22:41] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.1132 s / img. ETA=0:00:21
[11/18 07:22:47] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.1133 s / img. ETA=0:00:15
[11/18 07:22:52] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.1132 s / img. ETA=0:00:09
[11/18 07:22:58] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.1131 s / img. ETA=0:00:04
[11/18 07:23:02] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:19 (0.112733 s / img per device, on 4 devices)
[11/18 07:23:02] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:17 (0.111291 s / img per device, on 4 devices)
[11/18 07:23:02] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/18 07:23:08] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 36.149 | 77.971 | 54.451 |   66.696    | 41.767 |
[11/18 07:23:08] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.423 | 55.407 | 32.836 | 31.423 | 55.407  | 32.836  |
[11/18 07:23:08] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/18 07:23:08] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/18 07:23:08] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/18 07:23:08] defrcn.evaluation.testing INFO: copypaste: 31.4225,55.4068,32.8358,31.4225,55.4068,32.8358
[11/18 07:23:19] detectron2 INFO: Rank of current process: 0. World size: 4
[11/18 07:23:19] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2', 'SEED', '36357265'], resume=False, start_iter=-1)
[11/18 07:23:19] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed2", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/18 07:23:19] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/config.yaml
[11/18 07:23:19] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/18 07:23:20] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final-merge.pth ...
[11/18 07:23:20] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/18 07:23:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 07:23:20] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/18 07:23:20] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/18 07:23:20] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/18 07:23:20] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/18 07:23:22] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/18 07:23:22] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 07:23:22] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/18 07:23:22] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/18 07:23:25] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/18 07:23:36] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.1157 s / img. ETA=0:02:17
[11/18 07:23:41] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.1148 s / img. ETA=0:02:10
[11/18 07:23:47] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.1150 s / img. ETA=0:02:05
[11/18 07:23:53] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.1149 s / img. ETA=0:01:59
[11/18 07:23:59] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.1145 s / img. ETA=0:01:53
[11/18 07:24:04] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.1141 s / img. ETA=0:01:46
[11/18 07:24:10] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.1136 s / img. ETA=0:01:40
[11/18 07:24:15] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.1135 s / img. ETA=0:01:35
[11/18 07:24:21] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.1137 s / img. ETA=0:01:29
[11/18 07:24:27] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.1134 s / img. ETA=0:01:23
[11/18 07:24:32] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.1131 s / img. ETA=0:01:17
[11/18 07:24:38] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.1131 s / img. ETA=0:01:12
[11/18 07:24:43] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.1128 s / img. ETA=0:01:06
[11/18 07:24:49] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.1127 s / img. ETA=0:01:00
[11/18 07:24:55] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.1128 s / img. ETA=0:00:55
[11/18 07:25:00] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.1127 s / img. ETA=0:00:49
[11/18 07:25:06] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.1128 s / img. ETA=0:00:43
[11/18 07:25:11] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.1126 s / img. ETA=0:00:38
[11/18 07:25:17] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.1126 s / img. ETA=0:00:32
[11/18 07:25:22] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.1126 s / img. ETA=0:00:26
[11/18 07:25:28] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.1126 s / img. ETA=0:00:21
[11/18 07:25:34] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.1126 s / img. ETA=0:00:15
[11/18 07:25:39] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.1125 s / img. ETA=0:00:09
[11/18 07:25:45] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.1124 s / img. ETA=0:00:04
[11/18 07:25:49] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:18 (0.111922 s / img per device, on 4 devices)
[11/18 07:25:49] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:15 (0.110285 s / img per device, on 4 devices)
[11/18 07:25:50] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/18 07:26:13] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   86.731    |  86.621   | 74.717 |  74.485  | 88.937 | 87.748 | 69.928  |    74.295     | 86.179 | 84.475  |  86.430  |    56.242     | 81.992  | 84.814  |   82.752    | 50.805 | 79.410 | 60.505 |   71.073    | 52.115 |
[11/18 07:26:13] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 49.128 | 76.013 | 53.260 | 54.099 | 80.423  | 59.790  | 34.216 | 62.782  | 33.671  |
[11/18 07:26:13] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/18 07:26:13] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/18 07:26:13] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/18 07:26:13] defrcn.evaluation.testing INFO: copypaste: 49.1282,76.0128,53.2598,54.0990,80.4232,59.7895,34.2157,62.7815,33.6707
[11/22 04:05:31] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 04:05:31] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 04:05:31] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed2", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 04:05:31] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/config.yaml
[11/22 04:05:31] d2.utils.env INFO: Using a generated random seed 31437581
[11/22 04:05:31] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 04:05:31] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 04:05:31] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 04:05:31] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 04:05:31] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 04:05:31] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 04:05:31] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 04:05:32] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 04:05:32] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 04:05:38] d2.utils.events INFO:  eta: 0:03:58  iter: 19  total_loss: 0.5306  loss_cls: 0.3119  loss_box_reg: 0.1446  loss_rpn_cls: 0.05647  loss_rpn_loc: 0.01713  time: 0.2013  data_time: 0.1459  lr: 0.01  max_mem: 4875M
[11/22 04:05:42] d2.utils.events INFO:  eta: 0:03:53  iter: 39  total_loss: 0.3837  loss_cls: 0.2031  loss_box_reg: 0.1313  loss_rpn_cls: 0.03717  loss_rpn_loc: 0.01389  time: 0.1992  data_time: 0.0141  lr: 0.01  max_mem: 4906M
[11/22 04:05:46] d2.utils.events INFO:  eta: 0:03:47  iter: 59  total_loss: 0.3052  loss_cls: 0.1474  loss_box_reg: 0.1164  loss_rpn_cls: 0.02465  loss_rpn_loc: 0.01118  time: 0.1985  data_time: 0.0141  lr: 0.01  max_mem: 4906M
[11/22 04:05:50] d2.utils.events INFO:  eta: 0:03:43  iter: 79  total_loss: 0.2498  loss_cls: 0.1164  loss_box_reg: 0.1022  loss_rpn_cls: 0.01984  loss_rpn_loc: 0.01113  time: 0.1986  data_time: 0.0124  lr: 0.01  max_mem: 5084M
[11/22 04:05:54] d2.utils.events INFO:  eta: 0:03:39  iter: 99  total_loss: 0.2202  loss_cls: 0.1007  loss_box_reg: 0.09001  loss_rpn_cls: 0.01679  loss_rpn_loc: 0.01194  time: 0.1989  data_time: 0.0135  lr: 0.01  max_mem: 5084M
[11/22 04:05:58] d2.utils.events INFO:  eta: 0:03:34  iter: 119  total_loss: 0.193  loss_cls: 0.08618  loss_box_reg: 0.07682  loss_rpn_cls: 0.01407  loss_rpn_loc: 0.01302  time: 0.1985  data_time: 0.0128  lr: 0.01  max_mem: 5084M
[11/22 04:06:02] d2.utils.events INFO:  eta: 0:03:29  iter: 139  total_loss: 0.182  loss_cls: 0.08432  loss_box_reg: 0.06852  loss_rpn_cls: 0.01204  loss_rpn_loc: 0.01148  time: 0.1981  data_time: 0.0142  lr: 0.01  max_mem: 5084M
[11/22 04:06:06] d2.utils.events INFO:  eta: 0:03:25  iter: 159  total_loss: 0.1649  loss_cls: 0.07934  loss_box_reg: 0.06867  loss_rpn_cls: 0.01035  loss_rpn_loc: 0.01116  time: 0.1980  data_time: 0.0135  lr: 0.01  max_mem: 5084M
[11/22 04:06:10] d2.utils.events INFO:  eta: 0:03:21  iter: 179  total_loss: 0.1604  loss_cls: 0.07558  loss_box_reg: 0.06082  loss_rpn_cls: 0.009289  loss_rpn_loc: 0.00976  time: 0.1978  data_time: 0.0127  lr: 0.01  max_mem: 5084M
[11/22 04:06:14] d2.utils.events INFO:  eta: 0:03:17  iter: 199  total_loss: 0.1488  loss_cls: 0.07195  loss_box_reg: 0.05503  loss_rpn_cls: 0.008998  loss_rpn_loc: 0.01052  time: 0.1978  data_time: 0.0139  lr: 0.01  max_mem: 5084M
[11/22 04:06:18] d2.utils.events INFO:  eta: 0:03:14  iter: 219  total_loss: 0.1466  loss_cls: 0.07023  loss_box_reg: 0.05374  loss_rpn_cls: 0.01024  loss_rpn_loc: 0.01108  time: 0.1980  data_time: 0.0137  lr: 0.01  max_mem: 5084M
[11/22 04:06:22] d2.utils.events INFO:  eta: 0:03:10  iter: 239  total_loss: 0.1388  loss_cls: 0.06963  loss_box_reg: 0.05284  loss_rpn_cls: 0.007771  loss_rpn_loc: 0.01051  time: 0.1981  data_time: 0.0136  lr: 0.01  max_mem: 5084M
[11/22 04:06:26] d2.utils.events INFO:  eta: 0:03:06  iter: 259  total_loss: 0.1391  loss_cls: 0.06787  loss_box_reg: 0.05031  loss_rpn_cls: 0.008874  loss_rpn_loc: 0.01081  time: 0.1981  data_time: 0.0146  lr: 0.01  max_mem: 5084M
[11/22 04:06:30] d2.utils.events INFO:  eta: 0:03:02  iter: 279  total_loss: 0.1385  loss_cls: 0.06981  loss_box_reg: 0.04923  loss_rpn_cls: 0.007467  loss_rpn_loc: 0.01075  time: 0.1981  data_time: 0.0141  lr: 0.01  max_mem: 5084M
[11/22 04:06:34] d2.utils.events INFO:  eta: 0:02:58  iter: 299  total_loss: 0.132  loss_cls: 0.06722  loss_box_reg: 0.04656  loss_rpn_cls: 0.006703  loss_rpn_loc: 0.008988  time: 0.1980  data_time: 0.0141  lr: 0.01  max_mem: 5084M
[11/22 04:06:38] d2.utils.events INFO:  eta: 0:02:53  iter: 319  total_loss: 0.1297  loss_cls: 0.06492  loss_box_reg: 0.04613  loss_rpn_cls: 0.006945  loss_rpn_loc: 0.01077  time: 0.1981  data_time: 0.0136  lr: 0.01  max_mem: 5084M
[11/22 04:06:42] d2.utils.events INFO:  eta: 0:02:49  iter: 339  total_loss: 0.1244  loss_cls: 0.06463  loss_box_reg: 0.04556  loss_rpn_cls: 0.006808  loss_rpn_loc: 0.009537  time: 0.1983  data_time: 0.0148  lr: 0.01  max_mem: 5084M
[11/22 04:06:46] d2.utils.events INFO:  eta: 0:02:46  iter: 359  total_loss: 0.1216  loss_cls: 0.06358  loss_box_reg: 0.04182  loss_rpn_cls: 0.006465  loss_rpn_loc: 0.008809  time: 0.1986  data_time: 0.0138  lr: 0.01  max_mem: 5084M
[11/22 04:06:50] d2.utils.events INFO:  eta: 0:02:42  iter: 379  total_loss: 0.1231  loss_cls: 0.06314  loss_box_reg: 0.04517  loss_rpn_cls: 0.005412  loss_rpn_loc: 0.007926  time: 0.1986  data_time: 0.0157  lr: 0.01  max_mem: 5084M
[11/22 04:06:54] d2.utils.events INFO:  eta: 0:02:38  iter: 399  total_loss: 0.1229  loss_cls: 0.06385  loss_box_reg: 0.0429  loss_rpn_cls: 0.006482  loss_rpn_loc: 0.008525  time: 0.1986  data_time: 0.0157  lr: 0.01  max_mem: 5084M
[11/22 04:06:58] d2.utils.events INFO:  eta: 0:02:34  iter: 419  total_loss: 0.1224  loss_cls: 0.06354  loss_box_reg: 0.04371  loss_rpn_cls: 0.006077  loss_rpn_loc: 0.009211  time: 0.1986  data_time: 0.0148  lr: 0.01  max_mem: 5084M
[11/22 04:07:02] d2.utils.events INFO:  eta: 0:02:30  iter: 439  total_loss: 0.1167  loss_cls: 0.06108  loss_box_reg: 0.04261  loss_rpn_cls: 0.005118  loss_rpn_loc: 0.008171  time: 0.1987  data_time: 0.0156  lr: 0.01  max_mem: 5084M
[11/22 04:07:06] d2.utils.events INFO:  eta: 0:02:26  iter: 459  total_loss: 0.1197  loss_cls: 0.06256  loss_box_reg: 0.04275  loss_rpn_cls: 0.005398  loss_rpn_loc: 0.007521  time: 0.1989  data_time: 0.0136  lr: 0.01  max_mem: 5084M
[11/22 04:07:10] d2.utils.events INFO:  eta: 0:02:22  iter: 479  total_loss: 0.1161  loss_cls: 0.06095  loss_box_reg: 0.03903  loss_rpn_cls: 0.005843  loss_rpn_loc: 0.008941  time: 0.1989  data_time: 0.0143  lr: 0.01  max_mem: 5084M
[11/22 04:07:14] d2.utils.events INFO:  eta: 0:02:18  iter: 499  total_loss: 0.1197  loss_cls: 0.06466  loss_box_reg: 0.04018  loss_rpn_cls: 0.006112  loss_rpn_loc: 0.008598  time: 0.1991  data_time: 0.0156  lr: 0.01  max_mem: 5084M
[11/22 04:07:18] d2.utils.events INFO:  eta: 0:02:14  iter: 519  total_loss: 0.11  loss_cls: 0.05904  loss_box_reg: 0.03907  loss_rpn_cls: 0.00548  loss_rpn_loc: 0.006943  time: 0.1991  data_time: 0.0131  lr: 0.01  max_mem: 5084M
[11/22 04:07:22] d2.utils.events INFO:  eta: 0:02:10  iter: 539  total_loss: 0.1155  loss_cls: 0.05981  loss_box_reg: 0.03879  loss_rpn_cls: 0.006412  loss_rpn_loc: 0.007391  time: 0.1991  data_time: 0.0159  lr: 0.01  max_mem: 5084M
[11/22 04:07:26] d2.utils.events INFO:  eta: 0:02:06  iter: 559  total_loss: 0.1095  loss_cls: 0.05934  loss_box_reg: 0.03698  loss_rpn_cls: 0.005456  loss_rpn_loc: 0.007523  time: 0.1992  data_time: 0.0136  lr: 0.01  max_mem: 5084M
[11/22 04:07:30] d2.utils.events INFO:  eta: 0:02:03  iter: 579  total_loss: 0.108  loss_cls: 0.05831  loss_box_reg: 0.0357  loss_rpn_cls: 0.00553  loss_rpn_loc: 0.008838  time: 0.1993  data_time: 0.0150  lr: 0.01  max_mem: 5084M
[11/22 04:07:34] d2.utils.events INFO:  eta: 0:01:59  iter: 599  total_loss: 0.1063  loss_cls: 0.05635  loss_box_reg: 0.03648  loss_rpn_cls: 0.005418  loss_rpn_loc: 0.007531  time: 0.1994  data_time: 0.0148  lr: 0.01  max_mem: 5084M
[11/22 04:07:38] d2.utils.events INFO:  eta: 0:01:55  iter: 619  total_loss: 0.1088  loss_cls: 0.05849  loss_box_reg: 0.03717  loss_rpn_cls: 0.005648  loss_rpn_loc: 0.0067  time: 0.1994  data_time: 0.0154  lr: 0.01  max_mem: 5084M
[11/22 04:07:42] d2.utils.events INFO:  eta: 0:01:51  iter: 639  total_loss: 0.1043  loss_cls: 0.05701  loss_box_reg: 0.03429  loss_rpn_cls: 0.00523  loss_rpn_loc: 0.006679  time: 0.1995  data_time: 0.0137  lr: 0.01  max_mem: 5084M
[11/22 04:07:46] d2.utils.events INFO:  eta: 0:01:47  iter: 659  total_loss: 0.1077  loss_cls: 0.05902  loss_box_reg: 0.03588  loss_rpn_cls: 0.004785  loss_rpn_loc: 0.007025  time: 0.1995  data_time: 0.0149  lr: 0.01  max_mem: 5084M
[11/22 04:07:50] d2.utils.events INFO:  eta: 0:01:43  iter: 679  total_loss: 0.1068  loss_cls: 0.05919  loss_box_reg: 0.03616  loss_rpn_cls: 0.005298  loss_rpn_loc: 0.006891  time: 0.1996  data_time: 0.0151  lr: 0.01  max_mem: 5084M
[11/22 04:07:55] d2.utils.events INFO:  eta: 0:01:39  iter: 699  total_loss: 0.1054  loss_cls: 0.05797  loss_box_reg: 0.03636  loss_rpn_cls: 0.005939  loss_rpn_loc: 0.006336  time: 0.1997  data_time: 0.0150  lr: 0.01  max_mem: 5084M
[11/22 04:07:59] d2.utils.events INFO:  eta: 0:01:35  iter: 719  total_loss: 0.1053  loss_cls: 0.05717  loss_box_reg: 0.03385  loss_rpn_cls: 0.005139  loss_rpn_loc: 0.007258  time: 0.1999  data_time: 0.0148  lr: 0.01  max_mem: 5084M
[11/22 04:08:03] d2.utils.events INFO:  eta: 0:01:31  iter: 739  total_loss: 0.1064  loss_cls: 0.05873  loss_box_reg: 0.03357  loss_rpn_cls: 0.004744  loss_rpn_loc: 0.006364  time: 0.1999  data_time: 0.0143  lr: 0.01  max_mem: 5084M
[11/22 04:08:07] d2.utils.events INFO:  eta: 0:01:27  iter: 759  total_loss: 0.1036  loss_cls: 0.05818  loss_box_reg: 0.03226  loss_rpn_cls: 0.004992  loss_rpn_loc: 0.007011  time: 0.2001  data_time: 0.0143  lr: 0.01  max_mem: 5084M
[11/22 04:08:11] d2.utils.events INFO:  eta: 0:01:23  iter: 779  total_loss: 0.102  loss_cls: 0.05567  loss_box_reg: 0.03349  loss_rpn_cls: 0.004271  loss_rpn_loc: 0.008057  time: 0.2001  data_time: 0.0148  lr: 0.01  max_mem: 5084M
[11/22 04:08:15] d2.utils.events INFO:  eta: 0:01:19  iter: 799  total_loss: 0.1052  loss_cls: 0.05768  loss_box_reg: 0.03288  loss_rpn_cls: 0.00554  loss_rpn_loc: 0.008044  time: 0.2002  data_time: 0.0146  lr: 0.01  max_mem: 5084M
[11/22 04:08:19] d2.utils.events INFO:  eta: 0:01:15  iter: 819  total_loss: 0.1005  loss_cls: 0.05614  loss_box_reg: 0.03387  loss_rpn_cls: 0.005165  loss_rpn_loc: 0.00663  time: 0.2002  data_time: 0.0153  lr: 0.01  max_mem: 5084M
[11/22 04:08:23] d2.utils.events INFO:  eta: 0:01:11  iter: 839  total_loss: 0.1004  loss_cls: 0.05612  loss_box_reg: 0.03261  loss_rpn_cls: 0.004947  loss_rpn_loc: 0.006912  time: 0.2003  data_time: 0.0140  lr: 0.01  max_mem: 5084M
[11/22 04:08:27] d2.utils.events INFO:  eta: 0:01:07  iter: 859  total_loss: 0.09843  loss_cls: 0.05561  loss_box_reg: 0.03138  loss_rpn_cls: 0.004679  loss_rpn_loc: 0.005462  time: 0.2003  data_time: 0.0150  lr: 0.01  max_mem: 5084M
[11/22 04:08:31] d2.utils.events INFO:  eta: 0:01:03  iter: 879  total_loss: 0.09667  loss_cls: 0.05472  loss_box_reg: 0.03173  loss_rpn_cls: 0.004476  loss_rpn_loc: 0.006265  time: 0.2003  data_time: 0.0145  lr: 0.01  max_mem: 5084M
[11/22 04:08:35] d2.utils.events INFO:  eta: 0:00:59  iter: 899  total_loss: 0.09677  loss_cls: 0.05604  loss_box_reg: 0.03122  loss_rpn_cls: 0.003688  loss_rpn_loc: 0.006189  time: 0.2003  data_time: 0.0144  lr: 0.01  max_mem: 5084M
[11/22 04:08:39] d2.utils.events INFO:  eta: 0:00:55  iter: 919  total_loss: 0.09679  loss_cls: 0.05605  loss_box_reg: 0.03327  loss_rpn_cls: 0.003759  loss_rpn_loc: 0.006119  time: 0.2003  data_time: 0.0155  lr: 0.01  max_mem: 5084M
[11/22 04:08:43] d2.utils.events INFO:  eta: 0:00:51  iter: 939  total_loss: 0.09706  loss_cls: 0.0551  loss_box_reg: 0.03155  loss_rpn_cls: 0.004587  loss_rpn_loc: 0.00595  time: 0.2003  data_time: 0.0141  lr: 0.01  max_mem: 5084M
[11/22 04:08:47] d2.utils.events INFO:  eta: 0:00:47  iter: 959  total_loss: 0.09644  loss_cls: 0.05432  loss_box_reg: 0.0296  loss_rpn_cls: 0.005366  loss_rpn_loc: 0.006554  time: 0.2002  data_time: 0.0122  lr: 0.01  max_mem: 5084M
[11/22 04:08:51] d2.utils.events INFO:  eta: 0:00:43  iter: 979  total_loss: 0.09255  loss_cls: 0.05241  loss_box_reg: 0.03021  loss_rpn_cls: 0.004262  loss_rpn_loc: 0.005471  time: 0.2003  data_time: 0.0138  lr: 0.001  max_mem: 5084M
[11/22 04:08:55] d2.utils.events INFO:  eta: 0:00:39  iter: 999  total_loss: 0.09279  loss_cls: 0.0532  loss_box_reg: 0.03019  loss_rpn_cls: 0.004325  loss_rpn_loc: 0.00391  time: 0.2003  data_time: 0.0160  lr: 0.001  max_mem: 5084M
[11/22 04:08:59] d2.utils.events INFO:  eta: 0:00:35  iter: 1019  total_loss: 0.0956  loss_cls: 0.05463  loss_box_reg: 0.03109  loss_rpn_cls: 0.004069  loss_rpn_loc: 0.003457  time: 0.2004  data_time: 0.0143  lr: 0.001  max_mem: 5084M
[11/22 04:09:03] d2.utils.events INFO:  eta: 0:00:31  iter: 1039  total_loss: 0.09289  loss_cls: 0.05482  loss_box_reg: 0.03008  loss_rpn_cls: 0.004133  loss_rpn_loc: 0.00343  time: 0.2004  data_time: 0.0153  lr: 0.001  max_mem: 5084M
[11/22 04:09:07] d2.utils.events INFO:  eta: 0:00:27  iter: 1059  total_loss: 0.09001  loss_cls: 0.05085  loss_box_reg: 0.03102  loss_rpn_cls: 0.004201  loss_rpn_loc: 0.003665  time: 0.2004  data_time: 0.0137  lr: 0.001  max_mem: 5084M
[11/22 04:09:11] d2.utils.events INFO:  eta: 0:00:23  iter: 1079  total_loss: 0.09153  loss_cls: 0.05371  loss_box_reg: 0.02966  loss_rpn_cls: 0.004343  loss_rpn_loc: 0.003209  time: 0.2004  data_time: 0.0140  lr: 0.001  max_mem: 5084M
[11/22 04:09:15] d2.utils.events INFO:  eta: 0:00:19  iter: 1099  total_loss: 0.09326  loss_cls: 0.05381  loss_box_reg: 0.0304  loss_rpn_cls: 0.00408  loss_rpn_loc: 0.0031  time: 0.2004  data_time: 0.0151  lr: 0.001  max_mem: 5084M
[11/22 04:09:19] d2.utils.events INFO:  eta: 0:00:15  iter: 1119  total_loss: 0.09111  loss_cls: 0.0537  loss_box_reg: 0.03022  loss_rpn_cls: 0.003695  loss_rpn_loc: 0.003136  time: 0.2004  data_time: 0.0133  lr: 0.001  max_mem: 5084M
[11/22 04:09:23] d2.utils.events INFO:  eta: 0:00:12  iter: 1139  total_loss: 0.09294  loss_cls: 0.05439  loss_box_reg: 0.03066  loss_rpn_cls: 0.00456  loss_rpn_loc: 0.003179  time: 0.2004  data_time: 0.0155  lr: 0.001  max_mem: 5084M
[11/22 04:09:27] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.09516  loss_cls: 0.05598  loss_box_reg: 0.03017  loss_rpn_cls: 0.004063  loss_rpn_loc: 0.003467  time: 0.2004  data_time: 0.0117  lr: 0.001  max_mem: 5084M
[11/22 04:09:31] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.09033  loss_cls: 0.05335  loss_box_reg: 0.02876  loss_rpn_cls: 0.004119  loss_rpn_loc: 0.003155  time: 0.2004  data_time: 0.0156  lr: 0.001  max_mem: 5084M
[11/22 04:09:36] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final.pth
[11/22 04:09:37] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.09608  loss_cls: 0.0565  loss_box_reg: 0.03184  loss_rpn_cls: 0.004661  loss_rpn_loc: 0.003737  time: 0.2004  data_time: 0.0149  lr: 0.001  max_mem: 5084M
[11/22 04:09:37] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:00 (0.2004 s / it)
[11/22 04:09:37] d2.engine.hooks INFO: Total training time: 0:04:02 (0:00:02 on hooks)
[11/22 04:09:38] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 04:09:38] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:09:38] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 04:09:38] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 04:09:38] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 04:09:38] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 04:09:39] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:09:39] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 04:09:39] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 04:09:39] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 04:09:49] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0612 s / img. ETA=0:01:12
[11/22 04:09:52] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0605 s / img. ETA=0:01:08
[11/22 04:09:55] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0602 s / img. ETA=0:01:05
[11/22 04:09:58] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0597 s / img. ETA=0:01:01
[11/22 04:10:01] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0594 s / img. ETA=0:00:58
[11/22 04:10:04] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0593 s / img. ETA=0:00:55
[11/22 04:10:07] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0591 s / img. ETA=0:00:52
[11/22 04:10:10] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0589 s / img. ETA=0:00:49
[11/22 04:10:12] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0588 s / img. ETA=0:00:46
[11/22 04:10:15] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0586 s / img. ETA=0:00:43
[11/22 04:10:18] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0585 s / img. ETA=0:00:40
[11/22 04:10:21] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0584 s / img. ETA=0:00:37
[11/22 04:10:24] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0583 s / img. ETA=0:00:34
[11/22 04:10:27] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0582 s / img. ETA=0:00:31
[11/22 04:10:30] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0583 s / img. ETA=0:00:28
[11/22 04:10:33] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0583 s / img. ETA=0:00:25
[11/22 04:10:35] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0582 s / img. ETA=0:00:22
[11/22 04:10:38] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0581 s / img. ETA=0:00:19
[11/22 04:10:41] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0581 s / img. ETA=0:00:16
[11/22 04:10:44] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0580 s / img. ETA=0:00:13
[11/22 04:10:47] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0580 s / img. ETA=0:00:10
[11/22 04:10:50] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0580 s / img. ETA=0:00:08
[11/22 04:10:53] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0580 s / img. ETA=0:00:05
[11/22 04:10:55] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0579 s / img. ETA=0:00:02
[11/22 04:10:58] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:11 (0.057583 s / img per device, on 4 devices)
[11/22 04:10:58] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:09 (0.056191 s / img per device, on 4 devices)
[11/22 04:10:59] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 04:11:05] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 39.396 | 75.466 | 56.214 |   64.102    | 42.643 |
[11/22 04:11:05] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 30.498 | 55.564 | 29.933 | 30.498 | 55.564  | 29.933  |
[11/22 04:11:05] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 04:11:05] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 04:11:05] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 04:11:05] defrcn.evaluation.testing INFO: copypaste: 30.4983,55.5642,29.9330,30.4983,55.5642,29.9330
[11/22 04:11:19] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 04:11:19] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2'], resume=False, start_iter=-1)
[11/22 04:11:19] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed2", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 04:11:19] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/config.yaml
[11/22 04:11:19] d2.utils.env INFO: Using a generated random seed 19575708
[11/22 04:11:19] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 04:11:19] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final-merge.pth ...
[11/22 04:11:20] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 04:11:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:11:20] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 04:11:20] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 04:11:20] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 04:11:20] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 04:11:23] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 04:11:23] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:11:23] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 04:11:23] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 04:11:25] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 04:11:35] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0589 s / img. ETA=0:01:09
[11/22 04:11:38] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0585 s / img. ETA=0:01:06
[11/22 04:11:41] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0585 s / img. ETA=0:01:03
[11/22 04:11:44] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0582 s / img. ETA=0:01:00
[11/22 04:11:47] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0579 s / img. ETA=0:00:57
[11/22 04:11:50] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0581 s / img. ETA=0:00:54
[11/22 04:11:53] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0581 s / img. ETA=0:00:51
[11/22 04:11:55] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0579 s / img. ETA=0:00:48
[11/22 04:11:58] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0580 s / img. ETA=0:00:45
[11/22 04:12:01] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0581 s / img. ETA=0:00:42
[11/22 04:12:04] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0581 s / img. ETA=0:00:39
[11/22 04:12:07] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0581 s / img. ETA=0:00:37
[11/22 04:12:10] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0582 s / img. ETA=0:00:34
[11/22 04:12:13] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0583 s / img. ETA=0:00:31
[11/22 04:12:16] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0584 s / img. ETA=0:00:28
[11/22 04:12:19] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0585 s / img. ETA=0:00:25
[11/22 04:12:22] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0584 s / img. ETA=0:00:22
[11/22 04:12:25] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0585 s / img. ETA=0:00:19
[11/22 04:12:28] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0585 s / img. ETA=0:00:16
[11/22 04:12:31] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0584 s / img. ETA=0:00:13
[11/22 04:12:34] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0583 s / img. ETA=0:00:10
[11/22 04:12:36] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0583 s / img. ETA=0:00:08
[11/22 04:12:39] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0582 s / img. ETA=0:00:05
[11/22 04:12:42] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0581 s / img. ETA=0:00:02
[11/22 04:12:45] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:12 (0.058394 s / img per device, on 4 devices)
[11/22 04:12:45] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:09 (0.056082 s / img per device, on 4 devices)
[11/22 04:12:46] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 04:13:11] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   85.527    |  86.856   | 74.406 |  74.755  | 88.760 | 88.407 | 69.351  |    72.612     | 86.436 | 85.846  |  86.721  |    56.405     | 81.263  | 84.919  |   82.769    | 56.611 | 76.406 | 67.177 |   69.277    | 51.918 |
[11/22 04:13:11] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.851 | 76.321 | 53.208 | 53.766 | 80.336  | 60.207  | 34.105 | 64.278  | 32.208  |
[11/22 04:13:11] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 04:13:11] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 04:13:11] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 04:13:11] defrcn.evaluation.testing INFO: copypaste: 48.8512,76.3211,53.2075,53.7665,80.3356,60.2073,34.1054,64.2777,32.2083
[11/22 04:13:23] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 04:13:23] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 04:13:23] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed2", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 04:13:23] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/config.yaml
[11/22 04:13:23] d2.utils.env INFO: Using a generated random seed 23405201
[11/22 04:13:23] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 04:13:23] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 04:13:23] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 04:13:23] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 04:13:23] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 04:13:23] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 04:13:23] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 04:13:23] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 04:13:24] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 04:13:30] d2.utils.events INFO:  eta: 0:03:53  iter: 19  total_loss: 0.5171  loss_cls: 0.2786  loss_box_reg: 0.1382  loss_rpn_cls: 0.06719  loss_rpn_loc: 0.03542  time: 0.2007  data_time: 0.1511  lr: 0.01  max_mem: 5085M
[11/22 04:13:34] d2.utils.events INFO:  eta: 0:03:48  iter: 39  total_loss: 0.4112  loss_cls: 0.2174  loss_box_reg: 0.1275  loss_rpn_cls: 0.04915  loss_rpn_loc: 0.02545  time: 0.1986  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/22 04:13:38] d2.utils.events INFO:  eta: 0:03:46  iter: 59  total_loss: 0.3213  loss_cls: 0.1557  loss_box_reg: 0.1156  loss_rpn_cls: 0.03408  loss_rpn_loc: 0.01819  time: 0.1985  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/22 04:13:42] d2.utils.events INFO:  eta: 0:03:42  iter: 79  total_loss: 0.2708  loss_cls: 0.1167  loss_box_reg: 0.09782  loss_rpn_cls: 0.03022  loss_rpn_loc: 0.02005  time: 0.1992  data_time: 0.0177  lr: 0.01  max_mem: 5085M
[11/22 04:13:46] d2.utils.events INFO:  eta: 0:03:38  iter: 99  total_loss: 0.2359  loss_cls: 0.09983  loss_box_reg: 0.08853  loss_rpn_cls: 0.02756  loss_rpn_loc: 0.02253  time: 0.1993  data_time: 0.0154  lr: 0.01  max_mem: 5085M
[11/22 04:13:50] d2.utils.events INFO:  eta: 0:03:34  iter: 119  total_loss: 0.2118  loss_cls: 0.08576  loss_box_reg: 0.08565  loss_rpn_cls: 0.02448  loss_rpn_loc: 0.01463  time: 0.1993  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/22 04:13:54] d2.utils.events INFO:  eta: 0:03:30  iter: 139  total_loss: 0.2008  loss_cls: 0.07977  loss_box_reg: 0.07807  loss_rpn_cls: 0.02396  loss_rpn_loc: 0.01788  time: 0.1989  data_time: 0.0157  lr: 0.01  max_mem: 5085M
[11/22 04:13:58] d2.utils.events INFO:  eta: 0:03:26  iter: 159  total_loss: 0.1865  loss_cls: 0.07702  loss_box_reg: 0.07195  loss_rpn_cls: 0.02471  loss_rpn_loc: 0.01339  time: 0.1987  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 04:14:02] d2.utils.events INFO:  eta: 0:03:22  iter: 179  total_loss: 0.1806  loss_cls: 0.07615  loss_box_reg: 0.06836  loss_rpn_cls: 0.02011  loss_rpn_loc: 0.01502  time: 0.1985  data_time: 0.0126  lr: 0.01  max_mem: 5085M
[11/22 04:14:06] d2.utils.events INFO:  eta: 0:03:18  iter: 199  total_loss: 0.1837  loss_cls: 0.07394  loss_box_reg: 0.06742  loss_rpn_cls: 0.0211  loss_rpn_loc: 0.0187  time: 0.1984  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/22 04:14:10] d2.utils.events INFO:  eta: 0:03:14  iter: 219  total_loss: 0.1712  loss_cls: 0.07113  loss_box_reg: 0.06265  loss_rpn_cls: 0.01714  loss_rpn_loc: 0.01717  time: 0.1983  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 04:14:14] d2.utils.events INFO:  eta: 0:03:10  iter: 239  total_loss: 0.1679  loss_cls: 0.06858  loss_box_reg: 0.06089  loss_rpn_cls: 0.01754  loss_rpn_loc: 0.0135  time: 0.1984  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 04:14:18] d2.utils.events INFO:  eta: 0:03:06  iter: 259  total_loss: 0.1607  loss_cls: 0.06636  loss_box_reg: 0.05754  loss_rpn_cls: 0.01829  loss_rpn_loc: 0.0174  time: 0.1984  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/22 04:14:22] d2.utils.events INFO:  eta: 0:03:01  iter: 279  total_loss: 0.152  loss_cls: 0.06586  loss_box_reg: 0.05526  loss_rpn_cls: 0.01561  loss_rpn_loc: 0.01084  time: 0.1982  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/22 04:14:26] d2.utils.events INFO:  eta: 0:02:57  iter: 299  total_loss: 0.1499  loss_cls: 0.06671  loss_box_reg: 0.05304  loss_rpn_cls: 0.01571  loss_rpn_loc: 0.0129  time: 0.1982  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 04:14:30] d2.utils.events INFO:  eta: 0:02:53  iter: 319  total_loss: 0.1511  loss_cls: 0.06619  loss_box_reg: 0.05093  loss_rpn_cls: 0.01908  loss_rpn_loc: 0.01612  time: 0.1982  data_time: 0.0160  lr: 0.01  max_mem: 5085M
[11/22 04:14:34] d2.utils.events INFO:  eta: 0:02:49  iter: 339  total_loss: 0.1449  loss_cls: 0.06566  loss_box_reg: 0.04877  loss_rpn_cls: 0.01633  loss_rpn_loc: 0.01283  time: 0.1983  data_time: 0.0128  lr: 0.01  max_mem: 5085M
[11/22 04:14:38] d2.utils.events INFO:  eta: 0:02:46  iter: 359  total_loss: 0.1459  loss_cls: 0.06431  loss_box_reg: 0.04731  loss_rpn_cls: 0.01789  loss_rpn_loc: 0.01432  time: 0.1983  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/22 04:14:42] d2.utils.events INFO:  eta: 0:02:42  iter: 379  total_loss: 0.1403  loss_cls: 0.06387  loss_box_reg: 0.04543  loss_rpn_cls: 0.01548  loss_rpn_loc: 0.01202  time: 0.1983  data_time: 0.0133  lr: 0.01  max_mem: 5085M
[11/22 04:14:46] d2.utils.events INFO:  eta: 0:02:38  iter: 399  total_loss: 0.1392  loss_cls: 0.06413  loss_box_reg: 0.04811  loss_rpn_cls: 0.01365  loss_rpn_loc: 0.01323  time: 0.1984  data_time: 0.0127  lr: 0.01  max_mem: 5085M
[11/22 04:14:50] d2.utils.events INFO:  eta: 0:02:34  iter: 419  total_loss: 0.1395  loss_cls: 0.06229  loss_box_reg: 0.04718  loss_rpn_cls: 0.01632  loss_rpn_loc: 0.01463  time: 0.1984  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/22 04:14:54] d2.utils.events INFO:  eta: 0:02:30  iter: 439  total_loss: 0.1337  loss_cls: 0.06346  loss_box_reg: 0.04732  loss_rpn_cls: 0.01424  loss_rpn_loc: 0.009796  time: 0.1983  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 04:14:58] d2.utils.events INFO:  eta: 0:02:26  iter: 459  total_loss: 0.1342  loss_cls: 0.06292  loss_box_reg: 0.04446  loss_rpn_cls: 0.01212  loss_rpn_loc: 0.0113  time: 0.1984  data_time: 0.0129  lr: 0.01  max_mem: 5085M
[11/22 04:15:02] d2.utils.events INFO:  eta: 0:02:22  iter: 479  total_loss: 0.1337  loss_cls: 0.06254  loss_box_reg: 0.04392  loss_rpn_cls: 0.01453  loss_rpn_loc: 0.01297  time: 0.1984  data_time: 0.0162  lr: 0.01  max_mem: 5085M
[11/22 04:15:06] d2.utils.events INFO:  eta: 0:02:18  iter: 499  total_loss: 0.1368  loss_cls: 0.06325  loss_box_reg: 0.0439  loss_rpn_cls: 0.01166  loss_rpn_loc: 0.01345  time: 0.1985  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/22 04:15:10] d2.utils.events INFO:  eta: 0:02:14  iter: 519  total_loss: 0.131  loss_cls: 0.05969  loss_box_reg: 0.0425  loss_rpn_cls: 0.01458  loss_rpn_loc: 0.01169  time: 0.1987  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/22 04:15:14] d2.utils.events INFO:  eta: 0:02:10  iter: 539  total_loss: 0.1348  loss_cls: 0.05924  loss_box_reg: 0.04283  loss_rpn_cls: 0.01599  loss_rpn_loc: 0.01173  time: 0.1986  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 04:15:18] d2.utils.events INFO:  eta: 0:02:06  iter: 559  total_loss: 0.1298  loss_cls: 0.06241  loss_box_reg: 0.04216  loss_rpn_cls: 0.01263  loss_rpn_loc: 0.01055  time: 0.1987  data_time: 0.0157  lr: 0.01  max_mem: 5085M
[11/22 04:15:22] d2.utils.events INFO:  eta: 0:02:02  iter: 579  total_loss: 0.1315  loss_cls: 0.05978  loss_box_reg: 0.04315  loss_rpn_cls: 0.01519  loss_rpn_loc: 0.01231  time: 0.1988  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/22 04:15:26] d2.utils.events INFO:  eta: 0:01:59  iter: 599  total_loss: 0.1244  loss_cls: 0.05947  loss_box_reg: 0.04288  loss_rpn_cls: 0.01213  loss_rpn_loc: 0.01204  time: 0.1988  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/22 04:15:30] d2.utils.events INFO:  eta: 0:01:55  iter: 619  total_loss: 0.1237  loss_cls: 0.06081  loss_box_reg: 0.04116  loss_rpn_cls: 0.01061  loss_rpn_loc: 0.009563  time: 0.1989  data_time: 0.0142  lr: 0.01  max_mem: 5085M
[11/22 04:15:34] d2.utils.events INFO:  eta: 0:01:51  iter: 639  total_loss: 0.1251  loss_cls: 0.05683  loss_box_reg: 0.04053  loss_rpn_cls: 0.01398  loss_rpn_loc: 0.01092  time: 0.1989  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/22 04:15:38] d2.utils.events INFO:  eta: 0:01:47  iter: 659  total_loss: 0.1269  loss_cls: 0.05922  loss_box_reg: 0.03945  loss_rpn_cls: 0.01362  loss_rpn_loc: 0.009586  time: 0.1990  data_time: 0.0139  lr: 0.01  max_mem: 5085M
[11/22 04:15:42] d2.utils.events INFO:  eta: 0:01:43  iter: 679  total_loss: 0.129  loss_cls: 0.06005  loss_box_reg: 0.04188  loss_rpn_cls: 0.01317  loss_rpn_loc: 0.01447  time: 0.1991  data_time: 0.0130  lr: 0.01  max_mem: 5085M
[11/22 04:15:46] d2.utils.events INFO:  eta: 0:01:39  iter: 699  total_loss: 0.1285  loss_cls: 0.05742  loss_box_reg: 0.04066  loss_rpn_cls: 0.01177  loss_rpn_loc: 0.0163  time: 0.1991  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 04:15:50] d2.utils.events INFO:  eta: 0:01:35  iter: 719  total_loss: 0.1232  loss_cls: 0.05393  loss_box_reg: 0.03946  loss_rpn_cls: 0.01455  loss_rpn_loc: 0.01341  time: 0.1991  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 04:15:54] d2.utils.events INFO:  eta: 0:01:31  iter: 739  total_loss: 0.1242  loss_cls: 0.06036  loss_box_reg: 0.04126  loss_rpn_cls: 0.01029  loss_rpn_loc: 0.01131  time: 0.1992  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/22 04:15:58] d2.utils.events INFO:  eta: 0:01:27  iter: 759  total_loss: 0.114  loss_cls: 0.05571  loss_box_reg: 0.03731  loss_rpn_cls: 0.01309  loss_rpn_loc: 0.008209  time: 0.1992  data_time: 0.0149  lr: 0.01  max_mem: 5085M
[11/22 04:16:02] d2.utils.events INFO:  eta: 0:01:23  iter: 779  total_loss: 0.1246  loss_cls: 0.06016  loss_box_reg: 0.03761  loss_rpn_cls: 0.0118  loss_rpn_loc: 0.01179  time: 0.1994  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/22 04:16:06] d2.utils.events INFO:  eta: 0:01:19  iter: 799  total_loss: 0.1192  loss_cls: 0.05597  loss_box_reg: 0.03871  loss_rpn_cls: 0.0129  loss_rpn_loc: 0.01088  time: 0.1995  data_time: 0.0134  lr: 0.01  max_mem: 5085M
[11/22 04:16:10] d2.utils.events INFO:  eta: 0:01:15  iter: 819  total_loss: 0.1187  loss_cls: 0.0555  loss_box_reg: 0.03629  loss_rpn_cls: 0.01392  loss_rpn_loc: 0.01122  time: 0.1995  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/22 04:16:14] d2.utils.events INFO:  eta: 0:01:11  iter: 839  total_loss: 0.1186  loss_cls: 0.05689  loss_box_reg: 0.03733  loss_rpn_cls: 0.01205  loss_rpn_loc: 0.009969  time: 0.1995  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/22 04:16:18] d2.utils.events INFO:  eta: 0:01:07  iter: 859  total_loss: 0.1175  loss_cls: 0.05811  loss_box_reg: 0.03722  loss_rpn_cls: 0.01141  loss_rpn_loc: 0.01067  time: 0.1995  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/22 04:16:22] d2.utils.events INFO:  eta: 0:01:03  iter: 879  total_loss: 0.1106  loss_cls: 0.05372  loss_box_reg: 0.03675  loss_rpn_cls: 0.01088  loss_rpn_loc: 0.01004  time: 0.1996  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/22 04:16:26] d2.utils.events INFO:  eta: 0:00:59  iter: 899  total_loss: 0.1231  loss_cls: 0.05762  loss_box_reg: 0.03897  loss_rpn_cls: 0.01114  loss_rpn_loc: 0.01017  time: 0.1996  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/22 04:16:30] d2.utils.events INFO:  eta: 0:00:55  iter: 919  total_loss: 0.116  loss_cls: 0.05648  loss_box_reg: 0.0365  loss_rpn_cls: 0.01042  loss_rpn_loc: 0.01008  time: 0.1996  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/22 04:16:34] d2.utils.events INFO:  eta: 0:00:51  iter: 939  total_loss: 0.1142  loss_cls: 0.05447  loss_box_reg: 0.03807  loss_rpn_cls: 0.0111  loss_rpn_loc: 0.00979  time: 0.1996  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/22 04:16:38] d2.utils.events INFO:  eta: 0:00:47  iter: 959  total_loss: 0.1125  loss_cls: 0.05789  loss_box_reg: 0.03457  loss_rpn_cls: 0.0106  loss_rpn_loc: 0.008908  time: 0.1997  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/22 04:16:43] d2.utils.events INFO:  eta: 0:00:43  iter: 979  total_loss: 0.1093  loss_cls: 0.05656  loss_box_reg: 0.03496  loss_rpn_cls: 0.01032  loss_rpn_loc: 0.007127  time: 0.1997  data_time: 0.0144  lr: 0.001  max_mem: 5085M
[11/22 04:16:47] d2.utils.events INFO:  eta: 0:00:39  iter: 999  total_loss: 0.113  loss_cls: 0.05478  loss_box_reg: 0.03519  loss_rpn_cls: 0.01257  loss_rpn_loc: 0.00775  time: 0.1997  data_time: 0.0149  lr: 0.001  max_mem: 5085M
[11/22 04:16:51] d2.utils.events INFO:  eta: 0:00:35  iter: 1019  total_loss: 0.1094  loss_cls: 0.05648  loss_box_reg: 0.03843  loss_rpn_cls: 0.01043  loss_rpn_loc: 0.00471  time: 0.1997  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/22 04:16:55] d2.utils.events INFO:  eta: 0:00:31  iter: 1039  total_loss: 0.1091  loss_cls: 0.05688  loss_box_reg: 0.03527  loss_rpn_cls: 0.01009  loss_rpn_loc: 0.00717  time: 0.1997  data_time: 0.0146  lr: 0.001  max_mem: 5085M
[11/22 04:16:59] d2.utils.events INFO:  eta: 0:00:27  iter: 1059  total_loss: 0.1095  loss_cls: 0.05722  loss_box_reg: 0.03587  loss_rpn_cls: 0.009623  loss_rpn_loc: 0.005102  time: 0.1997  data_time: 0.0149  lr: 0.001  max_mem: 5085M
[11/22 04:17:03] d2.utils.events INFO:  eta: 0:00:23  iter: 1079  total_loss: 0.1103  loss_cls: 0.05642  loss_box_reg: 0.03637  loss_rpn_cls: 0.009776  loss_rpn_loc: 0.005356  time: 0.1998  data_time: 0.0154  lr: 0.001  max_mem: 5085M
[11/22 04:17:07] d2.utils.events INFO:  eta: 0:00:19  iter: 1099  total_loss: 0.1085  loss_cls: 0.05692  loss_box_reg: 0.03422  loss_rpn_cls: 0.01122  loss_rpn_loc: 0.004865  time: 0.1998  data_time: 0.0133  lr: 0.001  max_mem: 5085M
[11/22 04:17:11] d2.utils.events INFO:  eta: 0:00:15  iter: 1119  total_loss: 0.1037  loss_cls: 0.05598  loss_box_reg: 0.03344  loss_rpn_cls: 0.01009  loss_rpn_loc: 0.005825  time: 0.1999  data_time: 0.0161  lr: 0.001  max_mem: 5085M
[11/22 04:17:15] d2.utils.events INFO:  eta: 0:00:11  iter: 1139  total_loss: 0.1105  loss_cls: 0.05518  loss_box_reg: 0.03742  loss_rpn_cls: 0.009641  loss_rpn_loc: 0.004531  time: 0.1999  data_time: 0.0148  lr: 0.001  max_mem: 5085M
[11/22 04:17:19] d2.utils.events INFO:  eta: 0:00:07  iter: 1159  total_loss: 0.1041  loss_cls: 0.05467  loss_box_reg: 0.0346  loss_rpn_cls: 0.009225  loss_rpn_loc: 0.005287  time: 0.1999  data_time: 0.0139  lr: 0.001  max_mem: 5085M
[11/22 04:17:23] d2.utils.events INFO:  eta: 0:00:03  iter: 1179  total_loss: 0.1121  loss_cls: 0.05588  loss_box_reg: 0.03729  loss_rpn_cls: 0.01173  loss_rpn_loc: 0.005599  time: 0.1999  data_time: 0.0153  lr: 0.001  max_mem: 5085M
[11/22 04:17:27] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final.pth
[11/22 04:17:29] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.1061  loss_cls: 0.05336  loss_box_reg: 0.03479  loss_rpn_cls: 0.009389  loss_rpn_loc: 0.004756  time: 0.1999  data_time: 0.0146  lr: 0.001  max_mem: 5085M
[11/22 04:17:29] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:03:59 (0.1999 s / it)
[11/22 04:17:29] d2.engine.hooks INFO: Total training time: 0:04:01 (0:00:02 on hooks)
[11/22 04:17:29] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 04:17:29] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:17:29] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 04:17:29] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 04:17:29] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 04:17:29] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 04:17:30] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:17:30] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 04:17:30] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 04:17:31] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 04:17:41] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0600 s / img. ETA=0:01:11
[11/22 04:17:44] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0590 s / img. ETA=0:01:07
[11/22 04:17:46] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0587 s / img. ETA=0:01:03
[11/22 04:17:49] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0587 s / img. ETA=0:01:00
[11/22 04:17:52] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0584 s / img. ETA=0:00:57
[11/22 04:17:55] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0584 s / img. ETA=0:00:54
[11/22 04:17:58] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0582 s / img. ETA=0:00:51
[11/22 04:18:01] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0579 s / img. ETA=0:00:48
[11/22 04:18:04] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0578 s / img. ETA=0:00:45
[11/22 04:18:06] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0577 s / img. ETA=0:00:42
[11/22 04:18:09] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0575 s / img. ETA=0:00:39
[11/22 04:18:12] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0576 s / img. ETA=0:00:36
[11/22 04:18:15] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0575 s / img. ETA=0:00:33
[11/22 04:18:18] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0573 s / img. ETA=0:00:30
[11/22 04:18:21] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0573 s / img. ETA=0:00:27
[11/22 04:18:24] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0573 s / img. ETA=0:00:25
[11/22 04:18:26] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0573 s / img. ETA=0:00:22
[11/22 04:18:29] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0571 s / img. ETA=0:00:19
[11/22 04:18:32] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0571 s / img. ETA=0:00:16
[11/22 04:18:35] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0570 s / img. ETA=0:00:13
[11/22 04:18:38] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0570 s / img. ETA=0:00:10
[11/22 04:18:41] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0572 s / img. ETA=0:00:07
[11/22 04:18:43] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0572 s / img. ETA=0:00:05
[11/22 04:18:46] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0571 s / img. ETA=0:00:02
[11/22 04:18:49] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:10 (0.056772 s / img per device, on 4 devices)
[11/22 04:18:49] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:08 (0.055354 s / img per device, on 4 devices)
[11/22 04:18:49] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 04:18:55] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 42.193 | 75.615 | 58.176 |   63.957    | 46.394 |
[11/22 04:18:55] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 33.323 | 57.267 | 34.976 | 33.323 | 57.267  | 34.976  |
[11/22 04:18:55] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 04:18:55] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 04:18:55] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 04:18:55] defrcn.evaluation.testing INFO: copypaste: 33.3227,57.2670,34.9755,33.3227,57.2670,34.9755
[11/22 04:19:09] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 04:19:09] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2'], resume=False, start_iter=-1)
[11/22 04:19:09] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed2", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 04:19:09] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/config.yaml
[11/22 04:19:09] d2.utils.env INFO: Using a generated random seed 9855854
[11/22 04:19:09] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 04:19:10] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed2/model_final-merge.pth ...
[11/22 04:19:10] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 04:19:10] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:19:10] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 04:19:10] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 04:19:10] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 04:19:10] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 04:19:13] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 04:19:13] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 04:19:13] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 04:19:13] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 04:19:14] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 04:19:25] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0573 s / img. ETA=0:01:08
[11/22 04:19:28] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0574 s / img. ETA=0:01:05
[11/22 04:19:31] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0577 s / img. ETA=0:01:02
[11/22 04:19:34] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0576 s / img. ETA=0:00:59
[11/22 04:19:36] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0573 s / img. ETA=0:00:56
[11/22 04:19:39] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0574 s / img. ETA=0:00:53
[11/22 04:19:42] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0573 s / img. ETA=0:00:50
[11/22 04:19:45] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0572 s / img. ETA=0:00:47
[11/22 04:19:48] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0572 s / img. ETA=0:00:45
[11/22 04:19:51] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0571 s / img. ETA=0:00:42
[11/22 04:19:53] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0570 s / img. ETA=0:00:39
[11/22 04:19:56] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0571 s / img. ETA=0:00:36
[11/22 04:19:59] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0572 s / img. ETA=0:00:33
[11/22 04:20:02] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0572 s / img. ETA=0:00:30
[11/22 04:20:05] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0572 s / img. ETA=0:00:27
[11/22 04:20:08] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0571 s / img. ETA=0:00:25
[11/22 04:20:11] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0571 s / img. ETA=0:00:22
[11/22 04:20:13] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0571 s / img. ETA=0:00:19
[11/22 04:20:16] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0570 s / img. ETA=0:00:16
[11/22 04:20:19] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0570 s / img. ETA=0:00:13
[11/22 04:20:22] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0569 s / img. ETA=0:00:10
[11/22 04:20:25] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0570 s / img. ETA=0:00:07
[11/22 04:20:28] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0569 s / img. ETA=0:00:05
[11/22 04:20:30] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0570 s / img. ETA=0:00:02
[11/22 04:20:33] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:10 (0.056772 s / img per device, on 4 devices)
[11/22 04:20:33] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:07 (0.054722 s / img per device, on 4 devices)
[11/22 04:20:33] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 04:20:57] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   85.459    |  85.964   | 74.351 |  74.730  | 88.803 | 88.049 | 70.158  |    74.125     | 86.632 | 85.130  |  86.545  |    56.833     | 81.979  | 84.601  |   83.392    | 57.610 | 77.374 | 68.183 |   65.452    | 53.483 |
[11/22 04:20:57] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 49.524 | 76.443 | 53.838 | 53.910 | 80.450  | 59.497  | 36.367 | 64.420  | 36.860  |
[11/22 04:20:57] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 04:20:57] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 04:20:57] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 04:20:57] defrcn.evaluation.testing INFO: copypaste: 49.5241,76.4427,53.8382,53.9097,80.4501,59.4974,36.3670,64.4204,36.8604
