[11/21 18:28:56] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 18:28:56] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/21 18:28:56] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 18:28:56] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/21 18:28:56] d2.utils.env INFO: Using a generated random seed 59968369
[11/21 18:28:56] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 18:28:56] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/21 18:28:56] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/21 18:28:56] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/21 18:28:56] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/21 18:28:56] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/21 18:28:56] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 18:28:57] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/21 18:28:57] d2.engine.train_loop INFO: Starting training from iteration 0
[11/21 18:29:03] d2.utils.events INFO:  eta: 0:03:53  iter: 19  total_loss: 0.6079  loss_cls: 0.3623  loss_box_reg: 0.1553  loss_rpn_cls: 0.04464  loss_rpn_loc: 0.04595  time: 0.1980  data_time: 0.1501  lr: 0.01  max_mem: 5085M
[11/21 18:29:07] d2.utils.events INFO:  eta: 0:03:49  iter: 39  total_loss: 0.4038  loss_cls: 0.1798  loss_box_reg: 0.1453  loss_rpn_cls: 0.02756  loss_rpn_loc: 0.04346  time: 0.1993  data_time: 0.0163  lr: 0.01  max_mem: 5085M
[11/21 18:29:11] d2.utils.events INFO:  eta: 0:03:45  iter: 59  total_loss: 0.2821  loss_cls: 0.1047  loss_box_reg: 0.1194  loss_rpn_cls: 0.02026  loss_rpn_loc: 0.0351  time: 0.1985  data_time: 0.0162  lr: 0.01  max_mem: 5085M
[11/21 18:29:15] d2.utils.events INFO:  eta: 0:03:42  iter: 79  total_loss: 0.2472  loss_cls: 0.0871  loss_box_reg: 0.108  loss_rpn_cls: 0.015  loss_rpn_loc: 0.03357  time: 0.1995  data_time: 0.0177  lr: 0.01  max_mem: 5085M
[11/21 18:29:19] d2.utils.events INFO:  eta: 0:03:37  iter: 99  total_loss: 0.2176  loss_cls: 0.08352  loss_box_reg: 0.08578  loss_rpn_cls: 0.01365  loss_rpn_loc: 0.02959  time: 0.1992  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/21 18:29:23] d2.utils.events INFO:  eta: 0:03:33  iter: 119  total_loss: 0.2016  loss_cls: 0.07641  loss_box_reg: 0.07904  loss_rpn_cls: 0.01424  loss_rpn_loc: 0.02801  time: 0.1989  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 18:29:27] d2.utils.events INFO:  eta: 0:03:30  iter: 139  total_loss: 0.1812  loss_cls: 0.07152  loss_box_reg: 0.07859  loss_rpn_cls: 0.0103  loss_rpn_loc: 0.02456  time: 0.1989  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/21 18:29:31] d2.utils.events INFO:  eta: 0:03:25  iter: 159  total_loss: 0.1742  loss_cls: 0.06876  loss_box_reg: 0.06419  loss_rpn_cls: 0.01026  loss_rpn_loc: 0.02382  time: 0.1984  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/21 18:29:35] d2.utils.events INFO:  eta: 0:03:22  iter: 179  total_loss: 0.1685  loss_cls: 0.06172  loss_box_reg: 0.06474  loss_rpn_cls: 0.008114  loss_rpn_loc: 0.02442  time: 0.1983  data_time: 0.0161  lr: 0.01  max_mem: 5085M
[11/21 18:29:39] d2.utils.events INFO:  eta: 0:03:18  iter: 199  total_loss: 0.1619  loss_cls: 0.06035  loss_box_reg: 0.05949  loss_rpn_cls: 0.009392  loss_rpn_loc: 0.02965  time: 0.1986  data_time: 0.0154  lr: 0.01  max_mem: 5085M
[11/21 18:29:43] d2.utils.events INFO:  eta: 0:03:14  iter: 219  total_loss: 0.1518  loss_cls: 0.06074  loss_box_reg: 0.05772  loss_rpn_cls: 0.007752  loss_rpn_loc: 0.02085  time: 0.1985  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 18:29:47] d2.utils.events INFO:  eta: 0:03:10  iter: 239  total_loss: 0.1488  loss_cls: 0.05774  loss_box_reg: 0.05551  loss_rpn_cls: 0.007389  loss_rpn_loc: 0.01868  time: 0.1985  data_time: 0.0157  lr: 0.01  max_mem: 5085M
[11/21 18:29:51] d2.utils.events INFO:  eta: 0:03:06  iter: 259  total_loss: 0.1439  loss_cls: 0.05649  loss_box_reg: 0.0563  loss_rpn_cls: 0.006794  loss_rpn_loc: 0.02021  time: 0.1986  data_time: 0.0151  lr: 0.01  max_mem: 5085M
[11/21 18:29:55] d2.utils.events INFO:  eta: 0:03:02  iter: 279  total_loss: 0.1416  loss_cls: 0.05714  loss_box_reg: 0.05333  loss_rpn_cls: 0.007207  loss_rpn_loc: 0.0212  time: 0.1984  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/21 18:29:59] d2.utils.events INFO:  eta: 0:02:58  iter: 299  total_loss: 0.1381  loss_cls: 0.05696  loss_box_reg: 0.05334  loss_rpn_cls: 0.006232  loss_rpn_loc: 0.02209  time: 0.1982  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/21 18:30:03] d2.utils.events INFO:  eta: 0:02:54  iter: 319  total_loss: 0.1327  loss_cls: 0.05358  loss_box_reg: 0.04806  loss_rpn_cls: 0.005877  loss_rpn_loc: 0.02189  time: 0.1984  data_time: 0.0160  lr: 0.01  max_mem: 5085M
[11/21 18:30:07] d2.utils.events INFO:  eta: 0:02:50  iter: 339  total_loss: 0.1295  loss_cls: 0.05418  loss_box_reg: 0.05102  loss_rpn_cls: 0.005875  loss_rpn_loc: 0.01859  time: 0.1982  data_time: 0.0169  lr: 0.01  max_mem: 5085M
[11/21 18:30:11] d2.utils.events INFO:  eta: 0:02:45  iter: 359  total_loss: 0.1256  loss_cls: 0.05245  loss_box_reg: 0.04955  loss_rpn_cls: 0.005353  loss_rpn_loc: 0.01655  time: 0.1980  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/21 18:30:15] d2.utils.events INFO:  eta: 0:02:41  iter: 379  total_loss: 0.1268  loss_cls: 0.05225  loss_box_reg: 0.04872  loss_rpn_cls: 0.005791  loss_rpn_loc: 0.01733  time: 0.1978  data_time: 0.0160  lr: 0.01  max_mem: 5085M
[11/21 18:30:19] d2.utils.events INFO:  eta: 0:02:37  iter: 399  total_loss: 0.1324  loss_cls: 0.05093  loss_box_reg: 0.0497  loss_rpn_cls: 0.004551  loss_rpn_loc: 0.01608  time: 0.1977  data_time: 0.0138  lr: 0.01  max_mem: 5085M
[11/21 18:30:23] d2.utils.events INFO:  eta: 0:02:33  iter: 419  total_loss: 0.1253  loss_cls: 0.05197  loss_box_reg: 0.04627  loss_rpn_cls: 0.005376  loss_rpn_loc: 0.01734  time: 0.1977  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 18:30:27] d2.utils.events INFO:  eta: 0:02:29  iter: 439  total_loss: 0.123  loss_cls: 0.0495  loss_box_reg: 0.04681  loss_rpn_cls: 0.005736  loss_rpn_loc: 0.01945  time: 0.1977  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/21 18:30:31] d2.utils.events INFO:  eta: 0:02:26  iter: 459  total_loss: 0.125  loss_cls: 0.04912  loss_box_reg: 0.04452  loss_rpn_cls: 0.006154  loss_rpn_loc: 0.02131  time: 0.1977  data_time: 0.0154  lr: 0.01  max_mem: 5085M
[11/21 18:30:34] d2.utils.events INFO:  eta: 0:02:21  iter: 479  total_loss: 0.1263  loss_cls: 0.0512  loss_box_reg: 0.04554  loss_rpn_cls: 0.004807  loss_rpn_loc: 0.02017  time: 0.1976  data_time: 0.0157  lr: 0.01  max_mem: 5085M
[11/21 18:30:38] d2.utils.events INFO:  eta: 0:02:17  iter: 499  total_loss: 0.1222  loss_cls: 0.04699  loss_box_reg: 0.04485  loss_rpn_cls: 0.004686  loss_rpn_loc: 0.01916  time: 0.1975  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/21 18:30:42] d2.utils.events INFO:  eta: 0:02:13  iter: 519  total_loss: 0.1139  loss_cls: 0.04643  loss_box_reg: 0.04236  loss_rpn_cls: 0.00466  loss_rpn_loc: 0.01591  time: 0.1974  data_time: 0.0161  lr: 0.01  max_mem: 5085M
[11/21 18:30:46] d2.utils.events INFO:  eta: 0:02:10  iter: 539  total_loss: 0.1127  loss_cls: 0.04932  loss_box_reg: 0.04322  loss_rpn_cls: 0.004192  loss_rpn_loc: 0.0169  time: 0.1974  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/21 18:30:50] d2.utils.events INFO:  eta: 0:02:06  iter: 559  total_loss: 0.1116  loss_cls: 0.04754  loss_box_reg: 0.04082  loss_rpn_cls: 0.004398  loss_rpn_loc: 0.01493  time: 0.1975  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/21 18:30:54] d2.utils.events INFO:  eta: 0:02:01  iter: 579  total_loss: 0.1105  loss_cls: 0.04769  loss_box_reg: 0.04092  loss_rpn_cls: 0.004307  loss_rpn_loc: 0.01596  time: 0.1974  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 18:30:58] d2.utils.events INFO:  eta: 0:01:58  iter: 599  total_loss: 0.1091  loss_cls: 0.04535  loss_box_reg: 0.03986  loss_rpn_cls: 0.004385  loss_rpn_loc: 0.01707  time: 0.1973  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 18:31:02] d2.utils.events INFO:  eta: 0:01:54  iter: 619  total_loss: 0.1076  loss_cls: 0.04649  loss_box_reg: 0.04134  loss_rpn_cls: 0.004281  loss_rpn_loc: 0.01338  time: 0.1973  data_time: 0.0157  lr: 0.01  max_mem: 5085M
[11/21 18:31:06] d2.utils.events INFO:  eta: 0:01:50  iter: 639  total_loss: 0.1088  loss_cls: 0.04506  loss_box_reg: 0.03953  loss_rpn_cls: 0.003507  loss_rpn_loc: 0.01548  time: 0.1972  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 18:31:10] d2.utils.events INFO:  eta: 0:01:46  iter: 659  total_loss: 0.1086  loss_cls: 0.04566  loss_box_reg: 0.03968  loss_rpn_cls: 0.00365  loss_rpn_loc: 0.01729  time: 0.1971  data_time: 0.0149  lr: 0.01  max_mem: 5085M
[11/21 18:31:14] d2.utils.events INFO:  eta: 0:01:42  iter: 679  total_loss: 0.1085  loss_cls: 0.04571  loss_box_reg: 0.04136  loss_rpn_cls: 0.003899  loss_rpn_loc: 0.01594  time: 0.1972  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 18:31:18] d2.utils.events INFO:  eta: 0:01:38  iter: 699  total_loss: 0.104  loss_cls: 0.0457  loss_box_reg: 0.04054  loss_rpn_cls: 0.003912  loss_rpn_loc: 0.01546  time: 0.1973  data_time: 0.0149  lr: 0.01  max_mem: 5085M
[11/21 18:31:22] d2.utils.events INFO:  eta: 0:01:34  iter: 719  total_loss: 0.1042  loss_cls: 0.04235  loss_box_reg: 0.03902  loss_rpn_cls: 0.003852  loss_rpn_loc: 0.01771  time: 0.1972  data_time: 0.0162  lr: 0.01  max_mem: 5085M
[11/21 18:31:26] d2.utils.events INFO:  eta: 0:01:30  iter: 739  total_loss: 0.1052  loss_cls: 0.04707  loss_box_reg: 0.03987  loss_rpn_cls: 0.004011  loss_rpn_loc: 0.01767  time: 0.1973  data_time: 0.0164  lr: 0.01  max_mem: 5085M
[11/21 18:31:30] d2.utils.events INFO:  eta: 0:01:26  iter: 759  total_loss: 0.105  loss_cls: 0.0435  loss_box_reg: 0.03871  loss_rpn_cls: 0.003478  loss_rpn_loc: 0.01444  time: 0.1972  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/21 18:31:34] d2.utils.events INFO:  eta: 0:01:22  iter: 779  total_loss: 0.1038  loss_cls: 0.04644  loss_box_reg: 0.0389  loss_rpn_cls: 0.003728  loss_rpn_loc: 0.01508  time: 0.1971  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 18:31:38] d2.utils.events INFO:  eta: 0:01:18  iter: 799  total_loss: 0.1022  loss_cls: 0.04254  loss_box_reg: 0.03649  loss_rpn_cls: 0.003341  loss_rpn_loc: 0.01448  time: 0.1972  data_time: 0.0163  lr: 0.01  max_mem: 5085M
[11/21 18:31:41] d2.utils.events INFO:  eta: 0:01:14  iter: 819  total_loss: 0.1005  loss_cls: 0.04258  loss_box_reg: 0.03741  loss_rpn_cls: 0.00328  loss_rpn_loc: 0.01231  time: 0.1971  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/21 18:31:45] d2.utils.events INFO:  eta: 0:01:10  iter: 839  total_loss: 0.09995  loss_cls: 0.04508  loss_box_reg: 0.03719  loss_rpn_cls: 0.003412  loss_rpn_loc: 0.01363  time: 0.1971  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 18:31:49] d2.utils.events INFO:  eta: 0:01:06  iter: 859  total_loss: 0.1048  loss_cls: 0.04668  loss_box_reg: 0.03698  loss_rpn_cls: 0.003587  loss_rpn_loc: 0.01574  time: 0.1971  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/21 18:31:53] d2.utils.events INFO:  eta: 0:01:02  iter: 879  total_loss: 0.09927  loss_cls: 0.0436  loss_box_reg: 0.03727  loss_rpn_cls: 0.0038  loss_rpn_loc: 0.01205  time: 0.1971  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/21 18:31:57] d2.utils.events INFO:  eta: 0:00:58  iter: 899  total_loss: 0.09987  loss_cls: 0.04361  loss_box_reg: 0.03491  loss_rpn_cls: 0.003803  loss_rpn_loc: 0.01359  time: 0.1971  data_time: 0.0157  lr: 0.01  max_mem: 5085M
[11/21 18:32:01] d2.utils.events INFO:  eta: 0:00:55  iter: 919  total_loss: 0.09667  loss_cls: 0.04288  loss_box_reg: 0.03579  loss_rpn_cls: 0.00311  loss_rpn_loc: 0.01458  time: 0.1971  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/21 18:32:05] d2.utils.events INFO:  eta: 0:00:51  iter: 939  total_loss: 0.0988  loss_cls: 0.04105  loss_box_reg: 0.03419  loss_rpn_cls: 0.003305  loss_rpn_loc: 0.01374  time: 0.1972  data_time: 0.0165  lr: 0.01  max_mem: 5085M
[11/21 18:32:09] d2.utils.events INFO:  eta: 0:00:47  iter: 959  total_loss: 0.09554  loss_cls: 0.04122  loss_box_reg: 0.03409  loss_rpn_cls: 0.003375  loss_rpn_loc: 0.01199  time: 0.1972  data_time: 0.0163  lr: 0.01  max_mem: 5085M
[11/21 18:32:13] d2.utils.events INFO:  eta: 0:00:43  iter: 979  total_loss: 0.09165  loss_cls: 0.04128  loss_box_reg: 0.034  loss_rpn_cls: 0.003515  loss_rpn_loc: 0.01212  time: 0.1972  data_time: 0.0155  lr: 0.001  max_mem: 5085M
[11/21 18:32:17] d2.utils.events INFO:  eta: 0:00:39  iter: 999  total_loss: 0.09059  loss_cls: 0.04464  loss_box_reg: 0.03501  loss_rpn_cls: 0.003472  loss_rpn_loc: 0.009421  time: 0.1972  data_time: 0.0167  lr: 0.001  max_mem: 5085M
[11/21 18:32:21] d2.utils.events INFO:  eta: 0:00:35  iter: 1019  total_loss: 0.08976  loss_cls: 0.04173  loss_box_reg: 0.03514  loss_rpn_cls: 0.004171  loss_rpn_loc: 0.01008  time: 0.1971  data_time: 0.0148  lr: 0.001  max_mem: 5085M
[11/21 18:32:25] d2.utils.events INFO:  eta: 0:00:31  iter: 1039  total_loss: 0.08783  loss_cls: 0.04348  loss_box_reg: 0.0334  loss_rpn_cls: 0.002523  loss_rpn_loc: 0.006109  time: 0.1971  data_time: 0.0150  lr: 0.001  max_mem: 5085M
[11/21 18:32:29] d2.utils.events INFO:  eta: 0:00:27  iter: 1059  total_loss: 0.08907  loss_cls: 0.03972  loss_box_reg: 0.03399  loss_rpn_cls: 0.002849  loss_rpn_loc: 0.007174  time: 0.1971  data_time: 0.0149  lr: 0.001  max_mem: 5085M
[11/21 18:32:33] d2.utils.events INFO:  eta: 0:00:23  iter: 1079  total_loss: 0.09018  loss_cls: 0.04257  loss_box_reg: 0.03406  loss_rpn_cls: 0.003097  loss_rpn_loc: 0.007084  time: 0.1971  data_time: 0.0145  lr: 0.001  max_mem: 5085M
[11/21 18:32:37] d2.utils.events INFO:  eta: 0:00:19  iter: 1099  total_loss: 0.0846  loss_cls: 0.04013  loss_box_reg: 0.03166  loss_rpn_cls: 0.002868  loss_rpn_loc: 0.006477  time: 0.1971  data_time: 0.0163  lr: 0.001  max_mem: 5085M
[11/21 18:32:41] d2.utils.events INFO:  eta: 0:00:15  iter: 1119  total_loss: 0.08589  loss_cls: 0.04264  loss_box_reg: 0.0338  loss_rpn_cls: 0.002889  loss_rpn_loc: 0.006441  time: 0.1971  data_time: 0.0155  lr: 0.001  max_mem: 5085M
[11/21 18:32:45] d2.utils.events INFO:  eta: 0:00:11  iter: 1139  total_loss: 0.08696  loss_cls: 0.04317  loss_box_reg: 0.03455  loss_rpn_cls: 0.002702  loss_rpn_loc: 0.007038  time: 0.1971  data_time: 0.0168  lr: 0.001  max_mem: 5085M
[11/21 18:32:49] d2.utils.events INFO:  eta: 0:00:07  iter: 1159  total_loss: 0.08945  loss_cls: 0.04064  loss_box_reg: 0.03496  loss_rpn_cls: 0.003127  loss_rpn_loc: 0.008138  time: 0.1971  data_time: 0.0163  lr: 0.001  max_mem: 5085M
[11/21 18:32:52] d2.utils.events INFO:  eta: 0:00:03  iter: 1179  total_loss: 0.08796  loss_cls: 0.04257  loss_box_reg: 0.03476  loss_rpn_cls: 0.003136  loss_rpn_loc: 0.006714  time: 0.1970  data_time: 0.0156  lr: 0.001  max_mem: 5085M
[11/21 18:32:56] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/21 18:32:57] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.09008  loss_cls: 0.04467  loss_box_reg: 0.03526  loss_rpn_cls: 0.002829  loss_rpn_loc: 0.00685  time: 0.1970  data_time: 0.0147  lr: 0.001  max_mem: 5085M
[11/21 18:32:57] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:03:56 (0.1970 s / it)
[11/21 18:32:57] d2.engine.hooks INFO: Total training time: 0:03:57 (0:00:01 on hooks)
[11/21 18:32:58] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/21 18:32:58] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:32:58] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 18:32:58] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/21 18:32:58] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 18:32:58] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 18:32:58] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:32:58] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/21 18:32:58] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 18:32:59] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 18:33:10] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0595 s / img. ETA=0:01:10
[11/21 18:33:12] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0587 s / img. ETA=0:01:06
[11/21 18:33:15] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0585 s / img. ETA=0:01:03
[11/21 18:33:18] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0585 s / img. ETA=0:01:00
[11/21 18:33:21] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0582 s / img. ETA=0:00:57
[11/21 18:33:24] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0582 s / img. ETA=0:00:54
[11/21 18:33:27] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0580 s / img. ETA=0:00:51
[11/21 18:33:30] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0578 s / img. ETA=0:00:48
[11/21 18:33:33] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0576 s / img. ETA=0:00:45
[11/21 18:33:35] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0574 s / img. ETA=0:00:42
[11/21 18:33:38] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0573 s / img. ETA=0:00:39
[11/21 18:33:41] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0573 s / img. ETA=0:00:36
[11/21 18:33:44] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0571 s / img. ETA=0:00:33
[11/21 18:33:47] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0571 s / img. ETA=0:00:30
[11/21 18:33:49] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0571 s / img. ETA=0:00:27
[11/21 18:33:52] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0571 s / img. ETA=0:00:24
[11/21 18:33:55] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0571 s / img. ETA=0:00:22
[11/21 18:33:58] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0571 s / img. ETA=0:00:19
[11/21 18:34:01] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0571 s / img. ETA=0:00:16
[11/21 18:34:04] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0570 s / img. ETA=0:00:13
[11/21 18:34:06] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0569 s / img. ETA=0:00:10
[11/21 18:34:09] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0569 s / img. ETA=0:00:07
[11/21 18:34:12] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0569 s / img. ETA=0:00:05
[11/21 18:34:15] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0568 s / img. ETA=0:00:02
[11/21 18:34:17] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:10 (0.056772 s / img per device, on 4 devices)
[11/21 18:34:17] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:07 (0.055139 s / img per device, on 4 devices)
[11/21 18:34:18] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 18:34:24] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.779 | 70.392 | 50.556 |   61.465    | 54.009 |
[11/21 18:34:24] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 32.384 | 58.040 | 31.636 | 32.384 | 58.040  | 31.636  |
[11/21 18:34:24] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/21 18:34:24] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 18:34:24] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/21 18:34:24] defrcn.evaluation.testing INFO: copypaste: 32.3843,58.0401,31.6365,32.3843,58.0401,31.6365
[11/21 18:34:38] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 18:34:38] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'SEED', '59968369'], resume=False, start_iter=-1)
[11/21 18:34:38] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 18:34:38] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/21 18:34:38] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 18:34:38] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/21 18:34:39] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/21 18:34:39] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:34:39] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 18:34:39] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/21 18:34:39] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 18:34:39] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 18:34:41] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/21 18:34:41] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:34:41] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/21 18:34:41] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/21 18:34:43] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 18:34:53] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0594 s / img. ETA=0:01:10
[11/21 18:34:56] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0590 s / img. ETA=0:01:07
[11/21 18:34:59] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0588 s / img. ETA=0:01:04
[11/21 18:35:02] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0591 s / img. ETA=0:01:01
[11/21 18:35:05] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0591 s / img. ETA=0:00:58
[11/21 18:35:08] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0592 s / img. ETA=0:00:55
[11/21 18:35:11] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0592 s / img. ETA=0:00:52
[11/21 18:35:14] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0592 s / img. ETA=0:00:49
[11/21 18:35:17] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0593 s / img. ETA=0:00:46
[11/21 18:35:20] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0594 s / img. ETA=0:00:43
[11/21 18:35:23] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0593 s / img. ETA=0:00:40
[11/21 18:35:26] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0592 s / img. ETA=0:00:37
[11/21 18:35:29] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0593 s / img. ETA=0:00:34
[11/21 18:35:32] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0591 s / img. ETA=0:00:31
[11/21 18:35:35] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0591 s / img. ETA=0:00:28
[11/21 18:35:38] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0591 s / img. ETA=0:00:25
[11/21 18:35:41] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0590 s / img. ETA=0:00:22
[11/21 18:35:43] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0590 s / img. ETA=0:00:19
[11/21 18:35:46] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0590 s / img. ETA=0:00:16
[11/21 18:35:49] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0590 s / img. ETA=0:00:14
[11/21 18:35:52] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0591 s / img. ETA=0:00:11
[11/21 18:35:55] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0592 s / img. ETA=0:00:08
[11/21 18:35:58] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0591 s / img. ETA=0:00:05
[11/21 18:36:01] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0591 s / img. ETA=0:00:02
[11/21 18:36:04] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:13 (0.059205 s / img per device, on 4 devices)
[11/21 18:36:04] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.056902 s / img per device, on 4 devices)
[11/21 18:36:04] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 18:36:26] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.980    |  86.799   | 73.159 |  74.228  | 88.596 | 87.943 | 69.224  |    73.677     | 86.634 | 84.940  |  86.033  |    53.611     | 81.929  | 85.604  |   81.597    | 62.017 | 70.162 | 63.205 |   61.720    | 54.721 |
[11/21 18:36:26] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.054 | 75.539 | 51.585 | 53.159 | 79.930  | 59.184  | 32.737 | 62.365  | 28.789  |
[11/21 18:36:26] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/21 18:36:26] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 18:36:26] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/21 18:36:26] defrcn.evaluation.testing INFO: copypaste: 48.0538,75.5389,51.5854,53.1593,79.9302,59.1841,32.7373,62.3650,28.7891
[11/22 00:23:30] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:23:30] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 00:23:30] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:23:30] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:23:30] d2.utils.env INFO: Using a generated random seed 33359262
[11/22 00:23:31] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:23:31] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 00:23:31] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 00:23:31] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 00:23:31] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 00:23:31] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:23:31] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:23:31] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 00:23:32] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 00:23:40] d2.utils.events INFO:  eta: 0:04:21  iter: 19  total_loss: 0.559  loss_cls: 0.3283  loss_box_reg: 0.1461  loss_rpn_cls: 0.04804  loss_rpn_loc: 0.04692  time: 0.2197  data_time: 0.1988  lr: 0.01  max_mem: 4910M
[11/22 00:23:44] d2.utils.events INFO:  eta: 0:04:15  iter: 39  total_loss: 0.3631  loss_cls: 0.1743  loss_box_reg: 0.1312  loss_rpn_cls: 0.02396  loss_rpn_loc: 0.02925  time: 0.2199  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 00:23:48] d2.utils.events INFO:  eta: 0:04:10  iter: 59  total_loss: 0.2765  loss_cls: 0.1122  loss_box_reg: 0.1117  loss_rpn_cls: 0.01841  loss_rpn_loc: 0.02911  time: 0.2187  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 00:23:53] d2.utils.events INFO:  eta: 0:04:05  iter: 79  total_loss: 0.2424  loss_cls: 0.08782  loss_box_reg: 0.09911  loss_rpn_cls: 0.01532  loss_rpn_loc: 0.03053  time: 0.2185  data_time: 0.0203  lr: 0.01  max_mem: 5088M
[11/22 00:23:57] d2.utils.events INFO:  eta: 0:04:01  iter: 99  total_loss: 0.2191  loss_cls: 0.07996  loss_box_reg: 0.08446  loss_rpn_cls: 0.0126  loss_rpn_loc: 0.03094  time: 0.2188  data_time: 0.0214  lr: 0.01  max_mem: 5088M
[11/22 00:24:02] d2.utils.events INFO:  eta: 0:03:55  iter: 119  total_loss: 0.1943  loss_cls: 0.07069  loss_box_reg: 0.07388  loss_rpn_cls: 0.01042  loss_rpn_loc: 0.02792  time: 0.2182  data_time: 0.0214  lr: 0.01  max_mem: 5088M
[11/22 00:24:06] d2.utils.events INFO:  eta: 0:03:51  iter: 139  total_loss: 0.1682  loss_cls: 0.06717  loss_box_reg: 0.06689  loss_rpn_cls: 0.009271  loss_rpn_loc: 0.02188  time: 0.2184  data_time: 0.0180  lr: 0.01  max_mem: 5088M
[11/22 00:24:10] d2.utils.events INFO:  eta: 0:03:46  iter: 159  total_loss: 0.1693  loss_cls: 0.06695  loss_box_reg: 0.06669  loss_rpn_cls: 0.008678  loss_rpn_loc: 0.0219  time: 0.2184  data_time: 0.0187  lr: 0.01  max_mem: 5088M
[11/22 00:24:15] d2.utils.events INFO:  eta: 0:03:42  iter: 179  total_loss: 0.1562  loss_cls: 0.05895  loss_box_reg: 0.06246  loss_rpn_cls: 0.00808  loss_rpn_loc: 0.02621  time: 0.2183  data_time: 0.0195  lr: 0.01  max_mem: 5088M
[11/22 00:24:19] d2.utils.events INFO:  eta: 0:03:38  iter: 199  total_loss: 0.1554  loss_cls: 0.06237  loss_box_reg: 0.06076  loss_rpn_cls: 0.007915  loss_rpn_loc: 0.02328  time: 0.2186  data_time: 0.0212  lr: 0.01  max_mem: 5088M
[11/22 00:24:24] d2.utils.events INFO:  eta: 0:03:34  iter: 219  total_loss: 0.1488  loss_cls: 0.05694  loss_box_reg: 0.05632  loss_rpn_cls: 0.007649  loss_rpn_loc: 0.019  time: 0.2187  data_time: 0.0215  lr: 0.01  max_mem: 5088M
[11/22 00:24:28] d2.utils.events INFO:  eta: 0:03:30  iter: 239  total_loss: 0.143  loss_cls: 0.05468  loss_box_reg: 0.05485  loss_rpn_cls: 0.006595  loss_rpn_loc: 0.02223  time: 0.2190  data_time: 0.0245  lr: 0.01  max_mem: 5088M
[11/22 00:24:32] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.141  loss_cls: 0.05739  loss_box_reg: 0.05715  loss_rpn_cls: 0.00637  loss_rpn_loc: 0.01903  time: 0.2191  data_time: 0.0225  lr: 0.01  max_mem: 5088M
[11/22 00:24:37] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.1399  loss_cls: 0.05478  loss_box_reg: 0.05235  loss_rpn_cls: 0.006011  loss_rpn_loc: 0.02157  time: 0.2192  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 00:24:41] d2.utils.events INFO:  eta: 0:03:16  iter: 299  total_loss: 0.1345  loss_cls: 0.05346  loss_box_reg: 0.05313  loss_rpn_cls: 0.005115  loss_rpn_loc: 0.02005  time: 0.2191  data_time: 0.0184  lr: 0.01  max_mem: 5088M
[11/22 00:24:46] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1336  loss_cls: 0.05367  loss_box_reg: 0.04945  loss_rpn_cls: 0.005026  loss_rpn_loc: 0.02193  time: 0.2191  data_time: 0.0198  lr: 0.01  max_mem: 5088M
[11/22 00:24:50] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1285  loss_cls: 0.05118  loss_box_reg: 0.05181  loss_rpn_cls: 0.005024  loss_rpn_loc: 0.0184  time: 0.2193  data_time: 0.0201  lr: 0.01  max_mem: 5088M
[11/22 00:24:54] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1291  loss_cls: 0.04875  loss_box_reg: 0.04742  loss_rpn_cls: 0.006537  loss_rpn_loc: 0.0239  time: 0.2192  data_time: 0.0196  lr: 0.01  max_mem: 5088M
[11/22 00:24:59] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.1272  loss_cls: 0.05387  loss_box_reg: 0.04804  loss_rpn_cls: 0.006036  loss_rpn_loc: 0.01884  time: 0.2193  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 00:25:03] d2.utils.events INFO:  eta: 0:02:54  iter: 399  total_loss: 0.1189  loss_cls: 0.04987  loss_box_reg: 0.04767  loss_rpn_cls: 0.005906  loss_rpn_loc: 0.01627  time: 0.2198  data_time: 0.0200  lr: 0.01  max_mem: 5088M
[11/22 00:25:08] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.1132  loss_cls: 0.04607  loss_box_reg: 0.04412  loss_rpn_cls: 0.003978  loss_rpn_loc: 0.01668  time: 0.2197  data_time: 0.0205  lr: 0.01  max_mem: 5088M
[11/22 00:25:12] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1186  loss_cls: 0.04766  loss_box_reg: 0.04209  loss_rpn_cls: 0.004659  loss_rpn_loc: 0.01862  time: 0.2196  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 00:25:17] d2.utils.events INFO:  eta: 0:02:41  iter: 459  total_loss: 0.1218  loss_cls: 0.04744  loss_box_reg: 0.04574  loss_rpn_cls: 0.004189  loss_rpn_loc: 0.01678  time: 0.2197  data_time: 0.0217  lr: 0.01  max_mem: 5088M
[11/22 00:25:21] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.116  loss_cls: 0.04501  loss_box_reg: 0.0417  loss_rpn_cls: 0.00428  loss_rpn_loc: 0.01545  time: 0.2197  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 00:25:26] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1111  loss_cls: 0.04687  loss_box_reg: 0.04233  loss_rpn_cls: 0.003727  loss_rpn_loc: 0.01187  time: 0.2196  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 00:25:30] d2.utils.events INFO:  eta: 0:02:28  iter: 519  total_loss: 0.119  loss_cls: 0.05177  loss_box_reg: 0.04476  loss_rpn_cls: 0.004288  loss_rpn_loc: 0.01653  time: 0.2196  data_time: 0.0191  lr: 0.01  max_mem: 5088M
[11/22 00:25:34] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1109  loss_cls: 0.04568  loss_box_reg: 0.0424  loss_rpn_cls: 0.003586  loss_rpn_loc: 0.01692  time: 0.2193  data_time: 0.0195  lr: 0.01  max_mem: 5088M
[11/22 00:25:39] d2.utils.events INFO:  eta: 0:02:19  iter: 559  total_loss: 0.11  loss_cls: 0.04751  loss_box_reg: 0.04044  loss_rpn_cls: 0.003853  loss_rpn_loc: 0.0129  time: 0.2194  data_time: 0.0187  lr: 0.01  max_mem: 5088M
[11/22 00:25:43] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1075  loss_cls: 0.04357  loss_box_reg: 0.04194  loss_rpn_cls: 0.003738  loss_rpn_loc: 0.01513  time: 0.2193  data_time: 0.0205  lr: 0.01  max_mem: 5088M
[11/22 00:25:47] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1042  loss_cls: 0.0456  loss_box_reg: 0.03972  loss_rpn_cls: 0.003205  loss_rpn_loc: 0.01203  time: 0.2193  data_time: 0.0197  lr: 0.01  max_mem: 5088M
[11/22 00:25:52] d2.utils.events INFO:  eta: 0:02:06  iter: 619  total_loss: 0.1057  loss_cls: 0.04357  loss_box_reg: 0.03789  loss_rpn_cls: 0.004183  loss_rpn_loc: 0.01503  time: 0.2193  data_time: 0.0205  lr: 0.01  max_mem: 5088M
[11/22 00:25:57] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1029  loss_cls: 0.0436  loss_box_reg: 0.03884  loss_rpn_cls: 0.004159  loss_rpn_loc: 0.01403  time: 0.2193  data_time: 0.0227  lr: 0.01  max_mem: 5088M
[11/22 00:26:01] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1037  loss_cls: 0.04255  loss_box_reg: 0.03603  loss_rpn_cls: 0.002993  loss_rpn_loc: 0.01559  time: 0.2192  data_time: 0.0198  lr: 0.01  max_mem: 5088M
[11/22 00:26:06] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.1095  loss_cls: 0.04614  loss_box_reg: 0.03874  loss_rpn_cls: 0.003971  loss_rpn_loc: 0.01581  time: 0.2194  data_time: 0.0189  lr: 0.01  max_mem: 5088M
[11/22 00:26:10] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1041  loss_cls: 0.04312  loss_box_reg: 0.03885  loss_rpn_cls: 0.002943  loss_rpn_loc: 0.01524  time: 0.2194  data_time: 0.0172  lr: 0.01  max_mem: 5088M
[11/22 00:26:14] d2.utils.events INFO:  eta: 0:01:44  iter: 719  total_loss: 0.1033  loss_cls: 0.04202  loss_box_reg: 0.03845  loss_rpn_cls: 0.00377  loss_rpn_loc: 0.01637  time: 0.2194  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 00:26:19] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1002  loss_cls: 0.04438  loss_box_reg: 0.037  loss_rpn_cls: 0.004131  loss_rpn_loc: 0.01449  time: 0.2194  data_time: 0.0193  lr: 0.01  max_mem: 5088M
[11/22 00:26:23] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1006  loss_cls: 0.04255  loss_box_reg: 0.03417  loss_rpn_cls: 0.003499  loss_rpn_loc: 0.01452  time: 0.2195  data_time: 0.0211  lr: 0.01  max_mem: 5088M
[11/22 00:26:28] d2.utils.events INFO:  eta: 0:01:31  iter: 779  total_loss: 0.1062  loss_cls: 0.04545  loss_box_reg: 0.03794  loss_rpn_cls: 0.003609  loss_rpn_loc: 0.01564  time: 0.2196  data_time: 0.0198  lr: 0.01  max_mem: 5088M
[11/22 00:26:32] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.1039  loss_cls: 0.04186  loss_box_reg: 0.03843  loss_rpn_cls: 0.003808  loss_rpn_loc: 0.01615  time: 0.2196  data_time: 0.0182  lr: 0.01  max_mem: 5088M
[11/22 00:26:37] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1015  loss_cls: 0.04323  loss_box_reg: 0.03524  loss_rpn_cls: 0.004034  loss_rpn_loc: 0.01719  time: 0.2196  data_time: 0.0217  lr: 0.01  max_mem: 5088M
[11/22 00:26:41] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09642  loss_cls: 0.04263  loss_box_reg: 0.03606  loss_rpn_cls: 0.003396  loss_rpn_loc: 0.01323  time: 0.2195  data_time: 0.0194  lr: 0.01  max_mem: 5088M
[11/22 00:26:45] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.1012  loss_cls: 0.04264  loss_box_reg: 0.03634  loss_rpn_cls: 0.003845  loss_rpn_loc: 0.01596  time: 0.2196  data_time: 0.0198  lr: 0.01  max_mem: 5088M
[11/22 00:26:50] d2.utils.events INFO:  eta: 0:01:09  iter: 879  total_loss: 0.09103  loss_cls: 0.04095  loss_box_reg: 0.03456  loss_rpn_cls: 0.003683  loss_rpn_loc: 0.01267  time: 0.2196  data_time: 0.0228  lr: 0.01  max_mem: 5088M
[11/22 00:26:54] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09248  loss_cls: 0.04224  loss_box_reg: 0.03616  loss_rpn_cls: 0.003174  loss_rpn_loc: 0.01154  time: 0.2196  data_time: 0.0184  lr: 0.01  max_mem: 5088M
[11/22 00:26:59] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09575  loss_cls: 0.04335  loss_box_reg: 0.03581  loss_rpn_cls: 0.002961  loss_rpn_loc: 0.01187  time: 0.2196  data_time: 0.0203  lr: 0.01  max_mem: 5088M
[11/22 00:27:03] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09036  loss_cls: 0.0399  loss_box_reg: 0.03517  loss_rpn_cls: 0.002704  loss_rpn_loc: 0.01117  time: 0.2196  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 00:27:08] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09258  loss_cls: 0.04341  loss_box_reg: 0.03464  loss_rpn_cls: 0.003232  loss_rpn_loc: 0.01204  time: 0.2196  data_time: 0.0215  lr: 0.01  max_mem: 5088M
[11/22 00:27:12] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09152  loss_cls: 0.04331  loss_box_reg: 0.03313  loss_rpn_cls: 0.003165  loss_rpn_loc: 0.01051  time: 0.2196  data_time: 0.0207  lr: 0.001  max_mem: 5088M
[11/22 00:27:16] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08794  loss_cls: 0.04188  loss_box_reg: 0.03199  loss_rpn_cls: 0.002916  loss_rpn_loc: 0.008405  time: 0.2196  data_time: 0.0179  lr: 0.001  max_mem: 5088M
[11/22 00:27:21] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08614  loss_cls: 0.04275  loss_box_reg: 0.03251  loss_rpn_cls: 0.003153  loss_rpn_loc: 0.008216  time: 0.2197  data_time: 0.0216  lr: 0.001  max_mem: 5088M
[11/22 00:27:25] d2.utils.events INFO:  eta: 0:00:34  iter: 1039  total_loss: 0.08909  loss_cls: 0.04412  loss_box_reg: 0.03251  loss_rpn_cls: 0.003091  loss_rpn_loc: 0.007007  time: 0.2196  data_time: 0.0202  lr: 0.001  max_mem: 5088M
[11/22 00:27:34] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.0809  loss_cls: 0.03801  loss_box_reg: 0.03031  loss_rpn_cls: 0.003047  loss_rpn_loc: 0.007563  time: 0.2197  data_time: 0.0204  lr: 0.001  max_mem: 5088M
[11/22 00:27:38] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.07962  loss_cls: 0.04199  loss_box_reg: 0.02999  loss_rpn_cls: 0.002557  loss_rpn_loc: 0.006227  time: 0.2196  data_time: 0.0193  lr: 0.001  max_mem: 5088M
[11/22 00:27:43] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08753  loss_cls: 0.04242  loss_box_reg: 0.03172  loss_rpn_cls: 0.00272  loss_rpn_loc: 0.008109  time: 0.2196  data_time: 0.0189  lr: 0.001  max_mem: 5088M
[11/22 00:27:47] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08196  loss_cls: 0.0399  loss_box_reg: 0.03201  loss_rpn_cls: 0.002373  loss_rpn_loc: 0.006655  time: 0.2196  data_time: 0.0195  lr: 0.001  max_mem: 5088M
[11/22 00:27:52] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08404  loss_cls: 0.0407  loss_box_reg: 0.03059  loss_rpn_cls: 0.002462  loss_rpn_loc: 0.006041  time: 0.2196  data_time: 0.0196  lr: 0.001  max_mem: 5088M
[11/22 00:27:56] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08663  loss_cls: 0.04431  loss_box_reg: 0.03276  loss_rpn_cls: 0.002601  loss_rpn_loc: 0.006555  time: 0.2196  data_time: 0.0208  lr: 0.001  max_mem: 5088M
[11/22 00:28:00] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08481  loss_cls: 0.04018  loss_box_reg: 0.03364  loss_rpn_cls: 0.002572  loss_rpn_loc: 0.007432  time: 0.2196  data_time: 0.0204  lr: 0.001  max_mem: 5088M
[11/22 00:28:05] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 00:28:07] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08919  loss_cls: 0.04328  loss_box_reg: 0.03456  loss_rpn_cls: 0.00287  loss_rpn_loc: 0.006897  time: 0.2196  data_time: 0.0190  lr: 0.001  max_mem: 5088M
[11/22 00:28:07] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:23 (0.2196 s / it)
[11/22 00:28:07] d2.engine.hooks INFO: Total training time: 0:04:31 (0:00:08 on hooks)
[11/22 00:28:08] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 00:28:08] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:28:08] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:28:08] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 00:28:08] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:28:08] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:28:09] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:28:09] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:28:09] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:28:10] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:28:23] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0644 s / img. ETA=0:01:16
[11/22 00:28:26] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0629 s / img. ETA=0:01:11
[11/22 00:28:29] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0632 s / img. ETA=0:01:08
[11/22 00:28:32] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0631 s / img. ETA=0:01:05
[11/22 00:28:36] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0633 s / img. ETA=0:01:02
[11/22 00:28:39] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0635 s / img. ETA=0:00:59
[11/22 00:28:42] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0633 s / img. ETA=0:00:56
[11/22 00:28:45] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0633 s / img. ETA=0:00:53
[11/22 00:28:48] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0633 s / img. ETA=0:00:49
[11/22 00:28:51] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0632 s / img. ETA=0:00:46
[11/22 00:28:55] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0631 s / img. ETA=0:00:43
[11/22 00:28:58] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0630 s / img. ETA=0:00:40
[11/22 00:29:01] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0628 s / img. ETA=0:00:36
[11/22 00:29:04] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0627 s / img. ETA=0:00:33
[11/22 00:29:07] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0626 s / img. ETA=0:00:30
[11/22 00:29:10] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0624 s / img. ETA=0:00:27
[11/22 00:29:13] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0623 s / img. ETA=0:00:24
[11/22 00:29:16] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0622 s / img. ETA=0:00:21
[11/22 00:29:19] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0621 s / img. ETA=0:00:17
[11/22 00:29:22] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0620 s / img. ETA=0:00:14
[11/22 00:29:25] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0619 s / img. ETA=0:00:11
[11/22 00:29:28] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0619 s / img. ETA=0:00:08
[11/22 00:29:31] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0618 s / img. ETA=0:00:05
[11/22 00:29:34] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0618 s / img. ETA=0:00:02
[11/22 00:29:37] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:16 (0.061638 s / img per device, on 4 devices)
[11/22 00:29:37] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:13 (0.059638 s / img per device, on 4 devices)
[11/22 00:29:37] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:29:44] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.516 | 71.227 | 34.767 |   60.479    | 53.504 |
[11/22 00:29:44] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 28.852 | 54.699 | 25.947 | 28.852 | 54.699  | 25.947  |
[11/22 00:29:44] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 00:29:44] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:29:44] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 00:29:44] defrcn.evaluation.testing INFO: copypaste: 28.8522,54.6985,25.9466,28.8522,54.6985,25.9466
[11/22 00:29:58] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:29:58] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 00:29:58] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:29:58] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:29:58] d2.utils.env INFO: Using a generated random seed 61512538
[11/22 00:29:59] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:29:59] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 00:30:01] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 00:30:01] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:30:01] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:30:01] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 00:30:01] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:30:01] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:30:04] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 00:30:04] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:30:04] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 00:30:04] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 00:30:06] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:30:18] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0609 s / img. ETA=0:01:12
[11/22 00:30:21] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0600 s / img. ETA=0:01:08
[11/22 00:30:24] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0599 s / img. ETA=0:01:05
[11/22 00:30:27] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0597 s / img. ETA=0:01:01
[11/22 00:30:30] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0595 s / img. ETA=0:00:58
[11/22 00:30:33] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0595 s / img. ETA=0:00:55
[11/22 00:30:36] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0593 s / img. ETA=0:00:52
[11/22 00:30:39] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0592 s / img. ETA=0:00:49
[11/22 00:30:42] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0592 s / img. ETA=0:00:46
[11/22 00:30:45] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0592 s / img. ETA=0:00:43
[11/22 00:30:48] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0591 s / img. ETA=0:00:40
[11/22 00:30:51] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0592 s / img. ETA=0:00:37
[11/22 00:30:54] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0591 s / img. ETA=0:00:34
[11/22 00:30:56] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0590 s / img. ETA=0:00:31
[11/22 00:30:59] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0590 s / img. ETA=0:00:28
[11/22 00:31:02] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0589 s / img. ETA=0:00:25
[11/22 00:31:05] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0589 s / img. ETA=0:00:22
[11/22 00:31:08] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0589 s / img. ETA=0:00:19
[11/22 00:31:11] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0588 s / img. ETA=0:00:16
[11/22 00:31:14] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0588 s / img. ETA=0:00:13
[11/22 00:31:17] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0587 s / img. ETA=0:00:11
[11/22 00:31:20] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0588 s / img. ETA=0:00:08
[11/22 00:31:23] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0587 s / img. ETA=0:00:05
[11/22 00:31:26] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0587 s / img. ETA=0:00:02
[11/22 00:31:28] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:12 (0.058394 s / img per device, on 4 devices)
[11/22 00:31:28] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:09 (0.056354 s / img per device, on 4 devices)
[11/22 00:31:35] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:31:59] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.822    |  86.351   | 72.772 |  74.116  | 88.602 | 87.818 | 68.920  |    76.060     | 86.173 | 84.269  |  86.236  |    55.048     | 82.149  | 85.199  |   82.025    | 62.060 | 69.346 | 22.355 |   62.514    | 52.271 |
[11/22 00:31:59] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 46.787 | 73.455 | 50.726 | 53.175 | 80.037  | 59.669  | 27.622 | 53.709  | 23.895  |
[11/22 00:31:59] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 00:31:59] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:31:59] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 00:31:59] defrcn.evaluation.testing INFO: copypaste: 46.7866,73.4553,50.7255,53.1750,80.0374,59.6690,27.6217,53.7091,23.8950
[11/22 00:32:11] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:32:11] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 00:32:11] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:32:11] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:32:11] d2.utils.env INFO: Using a generated random seed 14071606
[11/22 00:32:12] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:32:12] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 00:32:12] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 00:32:12] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 00:32:12] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 00:32:12] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:32:12] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:32:12] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 00:32:12] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 00:32:20] d2.utils.events INFO:  eta: 0:04:14  iter: 19  total_loss: 0.6068  loss_cls: 0.3453  loss_box_reg: 0.1679  loss_rpn_cls: 0.04369  loss_rpn_loc: 0.05326  time: 0.2172  data_time: 0.1969  lr: 0.01  max_mem: 4906M
[11/22 00:32:25] d2.utils.events INFO:  eta: 0:04:13  iter: 39  total_loss: 0.3932  loss_cls: 0.1732  loss_box_reg: 0.1488  loss_rpn_cls: 0.0278  loss_rpn_loc: 0.03725  time: 0.2210  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 00:32:29] d2.utils.events INFO:  eta: 0:04:10  iter: 59  total_loss: 0.2825  loss_cls: 0.107  loss_box_reg: 0.1196  loss_rpn_cls: 0.01868  loss_rpn_loc: 0.03402  time: 0.2217  data_time: 0.0229  lr: 0.01  max_mem: 5087M
[11/22 00:32:34] d2.utils.events INFO:  eta: 0:04:06  iter: 79  total_loss: 0.2348  loss_cls: 0.08344  loss_box_reg: 0.1085  loss_rpn_cls: 0.01431  loss_rpn_loc: 0.0281  time: 0.2219  data_time: 0.0221  lr: 0.01  max_mem: 5087M
[11/22 00:32:38] d2.utils.events INFO:  eta: 0:04:01  iter: 99  total_loss: 0.216  loss_cls: 0.07423  loss_box_reg: 0.09049  loss_rpn_cls: 0.01312  loss_rpn_loc: 0.0313  time: 0.2215  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 00:32:43] d2.utils.events INFO:  eta: 0:03:57  iter: 119  total_loss: 0.1895  loss_cls: 0.0729  loss_box_reg: 0.08092  loss_rpn_cls: 0.0116  loss_rpn_loc: 0.02754  time: 0.2215  data_time: 0.0223  lr: 0.01  max_mem: 5087M
[11/22 00:32:47] d2.utils.events INFO:  eta: 0:03:52  iter: 139  total_loss: 0.1745  loss_cls: 0.06357  loss_box_reg: 0.07263  loss_rpn_cls: 0.01019  loss_rpn_loc: 0.02722  time: 0.2215  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 00:32:51] d2.utils.events INFO:  eta: 0:03:48  iter: 159  total_loss: 0.1673  loss_cls: 0.06467  loss_box_reg: 0.06641  loss_rpn_cls: 0.009784  loss_rpn_loc: 0.02376  time: 0.2216  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 00:32:56] d2.utils.events INFO:  eta: 0:03:44  iter: 179  total_loss: 0.1598  loss_cls: 0.06476  loss_box_reg: 0.06367  loss_rpn_cls: 0.008091  loss_rpn_loc: 0.02128  time: 0.2213  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:33:00] d2.utils.events INFO:  eta: 0:03:39  iter: 199  total_loss: 0.1499  loss_cls: 0.05748  loss_box_reg: 0.05839  loss_rpn_cls: 0.007748  loss_rpn_loc: 0.02444  time: 0.2212  data_time: 0.0205  lr: 0.01  max_mem: 5087M
[11/22 00:33:05] d2.utils.events INFO:  eta: 0:03:35  iter: 219  total_loss: 0.1441  loss_cls: 0.05926  loss_box_reg: 0.05717  loss_rpn_cls: 0.007079  loss_rpn_loc: 0.02394  time: 0.2209  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:33:09] d2.utils.events INFO:  eta: 0:03:30  iter: 239  total_loss: 0.1391  loss_cls: 0.05634  loss_box_reg: 0.05468  loss_rpn_cls: 0.007803  loss_rpn_loc: 0.02389  time: 0.2209  data_time: 0.0207  lr: 0.01  max_mem: 5087M
[11/22 00:33:14] d2.utils.events INFO:  eta: 0:03:26  iter: 259  total_loss: 0.146  loss_cls: 0.05459  loss_box_reg: 0.05547  loss_rpn_cls: 0.006051  loss_rpn_loc: 0.0251  time: 0.2209  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 00:33:18] d2.utils.events INFO:  eta: 0:03:22  iter: 279  total_loss: 0.1354  loss_cls: 0.05282  loss_box_reg: 0.05165  loss_rpn_cls: 0.006159  loss_rpn_loc: 0.01894  time: 0.2208  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 00:33:22] d2.utils.events INFO:  eta: 0:03:17  iter: 299  total_loss: 0.1323  loss_cls: 0.05156  loss_box_reg: 0.05199  loss_rpn_cls: 0.005629  loss_rpn_loc: 0.0209  time: 0.2208  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:33:27] d2.utils.events INFO:  eta: 0:03:13  iter: 319  total_loss: 0.1373  loss_cls: 0.05227  loss_box_reg: 0.05201  loss_rpn_cls: 0.006431  loss_rpn_loc: 0.02392  time: 0.2208  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 00:33:31] d2.utils.events INFO:  eta: 0:03:09  iter: 339  total_loss: 0.1232  loss_cls: 0.04681  loss_box_reg: 0.04411  loss_rpn_cls: 0.005953  loss_rpn_loc: 0.01997  time: 0.2211  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 00:33:36] d2.utils.events INFO:  eta: 0:03:04  iter: 359  total_loss: 0.1256  loss_cls: 0.05007  loss_box_reg: 0.04862  loss_rpn_cls: 0.006176  loss_rpn_loc: 0.0186  time: 0.2211  data_time: 0.0199  lr: 0.01  max_mem: 5087M
[11/22 00:33:40] d2.utils.events INFO:  eta: 0:03:00  iter: 379  total_loss: 0.1235  loss_cls: 0.0506  loss_box_reg: 0.04604  loss_rpn_cls: 0.005635  loss_rpn_loc: 0.01831  time: 0.2212  data_time: 0.0222  lr: 0.01  max_mem: 5087M
[11/22 00:33:45] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.1182  loss_cls: 0.04873  loss_box_reg: 0.04755  loss_rpn_cls: 0.004738  loss_rpn_loc: 0.01548  time: 0.2211  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:33:49] d2.utils.events INFO:  eta: 0:02:51  iter: 419  total_loss: 0.1237  loss_cls: 0.04679  loss_box_reg: 0.04657  loss_rpn_cls: 0.004946  loss_rpn_loc: 0.02019  time: 0.2210  data_time: 0.0176  lr: 0.01  max_mem: 5087M
[11/22 00:33:54] d2.utils.events INFO:  eta: 0:02:47  iter: 439  total_loss: 0.1157  loss_cls: 0.04743  loss_box_reg: 0.04266  loss_rpn_cls: 0.004907  loss_rpn_loc: 0.01548  time: 0.2210  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:33:58] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1213  loss_cls: 0.04842  loss_box_reg: 0.04586  loss_rpn_cls: 0.005903  loss_rpn_loc: 0.01953  time: 0.2211  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 00:34:02] d2.utils.events INFO:  eta: 0:02:38  iter: 479  total_loss: 0.1142  loss_cls: 0.04759  loss_box_reg: 0.04382  loss_rpn_cls: 0.004388  loss_rpn_loc: 0.01757  time: 0.2211  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 00:34:07] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1149  loss_cls: 0.04692  loss_box_reg: 0.0452  loss_rpn_cls: 0.004496  loss_rpn_loc: 0.01793  time: 0.2210  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 00:34:11] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.1144  loss_cls: 0.04611  loss_box_reg: 0.04197  loss_rpn_cls: 0.005137  loss_rpn_loc: 0.02108  time: 0.2210  data_time: 0.0208  lr: 0.01  max_mem: 5087M
[11/22 00:34:16] d2.utils.events INFO:  eta: 0:02:25  iter: 539  total_loss: 0.1088  loss_cls: 0.04616  loss_box_reg: 0.04255  loss_rpn_cls: 0.003839  loss_rpn_loc: 0.01579  time: 0.2209  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 00:34:20] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1117  loss_cls: 0.04492  loss_box_reg: 0.04038  loss_rpn_cls: 0.005857  loss_rpn_loc: 0.01816  time: 0.2209  data_time: 0.0199  lr: 0.01  max_mem: 5087M
[11/22 00:34:25] d2.utils.events INFO:  eta: 0:02:16  iter: 579  total_loss: 0.1113  loss_cls: 0.04587  loss_box_reg: 0.04325  loss_rpn_cls: 0.004529  loss_rpn_loc: 0.01475  time: 0.2209  data_time: 0.0179  lr: 0.01  max_mem: 5087M
[11/22 00:34:29] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1085  loss_cls: 0.04692  loss_box_reg: 0.0401  loss_rpn_cls: 0.004444  loss_rpn_loc: 0.01598  time: 0.2209  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 00:34:33] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1071  loss_cls: 0.04588  loss_box_reg: 0.04361  loss_rpn_cls: 0.003796  loss_rpn_loc: 0.01316  time: 0.2208  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:34:38] d2.utils.events INFO:  eta: 0:02:03  iter: 639  total_loss: 0.1053  loss_cls: 0.04294  loss_box_reg: 0.03985  loss_rpn_cls: 0.004267  loss_rpn_loc: 0.01713  time: 0.2209  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 00:34:42] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1061  loss_cls: 0.04242  loss_box_reg: 0.0385  loss_rpn_cls: 0.003452  loss_rpn_loc: 0.018  time: 0.2209  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 00:34:47] d2.utils.events INFO:  eta: 0:01:54  iter: 679  total_loss: 0.1051  loss_cls: 0.04319  loss_box_reg: 0.03787  loss_rpn_cls: 0.003583  loss_rpn_loc: 0.01689  time: 0.2209  data_time: 0.0171  lr: 0.01  max_mem: 5087M
[11/22 00:34:51] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1096  loss_cls: 0.04423  loss_box_reg: 0.03993  loss_rpn_cls: 0.004059  loss_rpn_loc: 0.01777  time: 0.2209  data_time: 0.0174  lr: 0.01  max_mem: 5087M
[11/22 00:34:56] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1039  loss_cls: 0.04237  loss_box_reg: 0.03731  loss_rpn_cls: 0.004276  loss_rpn_loc: 0.01445  time: 0.2209  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:35:00] d2.utils.events INFO:  eta: 0:01:41  iter: 739  total_loss: 0.09944  loss_cls: 0.04427  loss_box_reg: 0.03709  loss_rpn_cls: 0.003786  loss_rpn_loc: 0.0134  time: 0.2209  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 00:35:05] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1029  loss_cls: 0.04276  loss_box_reg: 0.03909  loss_rpn_cls: 0.004162  loss_rpn_loc: 0.0158  time: 0.2209  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 00:35:09] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.1009  loss_cls: 0.04377  loss_box_reg: 0.0383  loss_rpn_cls: 0.003768  loss_rpn_loc: 0.01478  time: 0.2209  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:35:13] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.09668  loss_cls: 0.0412  loss_box_reg: 0.03547  loss_rpn_cls: 0.003268  loss_rpn_loc: 0.01358  time: 0.2209  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 00:35:18] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.09674  loss_cls: 0.04162  loss_box_reg: 0.03687  loss_rpn_cls: 0.00341  loss_rpn_loc: 0.01465  time: 0.2209  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 00:35:22] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.09946  loss_cls: 0.0421  loss_box_reg: 0.0374  loss_rpn_cls: 0.003097  loss_rpn_loc: 0.01412  time: 0.2209  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 00:35:27] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.09536  loss_cls: 0.04132  loss_box_reg: 0.03587  loss_rpn_cls: 0.003859  loss_rpn_loc: 0.01466  time: 0.2209  data_time: 0.0173  lr: 0.01  max_mem: 5087M
[11/22 00:35:31] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.0994  loss_cls: 0.04064  loss_box_reg: 0.03699  loss_rpn_cls: 0.003113  loss_rpn_loc: 0.0126  time: 0.2209  data_time: 0.0191  lr: 0.01  max_mem: 5087M
[11/22 00:35:36] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09671  loss_cls: 0.04158  loss_box_reg: 0.03603  loss_rpn_cls: 0.003482  loss_rpn_loc: 0.01426  time: 0.2209  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 00:35:40] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09538  loss_cls: 0.044  loss_box_reg: 0.03791  loss_rpn_cls: 0.003165  loss_rpn_loc: 0.01567  time: 0.2208  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:35:44] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.09543  loss_cls: 0.04021  loss_box_reg: 0.03669  loss_rpn_cls: 0.003049  loss_rpn_loc: 0.01475  time: 0.2208  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 00:35:49] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09365  loss_cls: 0.03878  loss_box_reg: 0.03423  loss_rpn_cls: 0.002681  loss_rpn_loc: 0.01545  time: 0.2208  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:35:53] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09291  loss_cls: 0.04048  loss_box_reg: 0.03557  loss_rpn_cls: 0.003605  loss_rpn_loc: 0.01125  time: 0.2208  data_time: 0.0201  lr: 0.001  max_mem: 5087M
[11/22 00:35:58] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.0879  loss_cls: 0.04057  loss_box_reg: 0.03453  loss_rpn_cls: 0.003894  loss_rpn_loc: 0.009708  time: 0.2207  data_time: 0.0180  lr: 0.001  max_mem: 5087M
[11/22 00:36:02] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.09175  loss_cls: 0.04094  loss_box_reg: 0.03525  loss_rpn_cls: 0.00367  loss_rpn_loc: 0.00959  time: 0.2207  data_time: 0.0170  lr: 0.001  max_mem: 5087M
[11/22 00:36:07] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08586  loss_cls: 0.03978  loss_box_reg: 0.03384  loss_rpn_cls: 0.003496  loss_rpn_loc: 0.008193  time: 0.2209  data_time: 0.0318  lr: 0.001  max_mem: 5087M
[11/22 00:36:11] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08638  loss_cls: 0.0391  loss_box_reg: 0.03178  loss_rpn_cls: 0.003483  loss_rpn_loc: 0.007849  time: 0.2209  data_time: 0.0199  lr: 0.001  max_mem: 5087M
[11/22 00:36:15] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08779  loss_cls: 0.04156  loss_box_reg: 0.03405  loss_rpn_cls: 0.003375  loss_rpn_loc: 0.007579  time: 0.2208  data_time: 0.0195  lr: 0.001  max_mem: 5087M
[11/22 00:36:20] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08727  loss_cls: 0.03862  loss_box_reg: 0.03442  loss_rpn_cls: 0.00361  loss_rpn_loc: 0.008021  time: 0.2208  data_time: 0.0168  lr: 0.001  max_mem: 5087M
[11/22 00:36:24] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.0865  loss_cls: 0.04078  loss_box_reg: 0.03265  loss_rpn_cls: 0.003466  loss_rpn_loc: 0.008499  time: 0.2208  data_time: 0.0194  lr: 0.001  max_mem: 5087M
[11/22 00:36:29] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.09207  loss_cls: 0.04336  loss_box_reg: 0.03538  loss_rpn_cls: 0.003198  loss_rpn_loc: 0.007807  time: 0.2208  data_time: 0.0187  lr: 0.001  max_mem: 5087M
[11/22 00:36:33] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08469  loss_cls: 0.0396  loss_box_reg: 0.03413  loss_rpn_cls: 0.003103  loss_rpn_loc: 0.008278  time: 0.2208  data_time: 0.0182  lr: 0.001  max_mem: 5087M
[11/22 00:36:38] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08577  loss_cls: 0.03899  loss_box_reg: 0.03293  loss_rpn_cls: 0.003042  loss_rpn_loc: 0.006194  time: 0.2207  data_time: 0.0169  lr: 0.001  max_mem: 5087M
[11/22 00:36:42] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 00:36:44] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08757  loss_cls: 0.0408  loss_box_reg: 0.03405  loss_rpn_cls: 0.003055  loss_rpn_loc: 0.007177  time: 0.2208  data_time: 0.0191  lr: 0.001  max_mem: 5087M
[11/22 00:36:44] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:24 (0.2208 s / it)
[11/22 00:36:44] d2.engine.hooks INFO: Total training time: 0:04:27 (0:00:02 on hooks)
[11/22 00:36:45] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 00:36:45] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:36:45] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:36:45] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 00:36:45] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:36:45] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:36:46] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:36:46] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:36:46] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:36:47] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:36:59] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0621 s / img. ETA=0:01:13
[11/22 00:37:03] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0615 s / img. ETA=0:01:10
[11/22 00:37:06] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0616 s / img. ETA=0:01:07
[11/22 00:37:09] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0615 s / img. ETA=0:01:03
[11/22 00:37:12] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0614 s / img. ETA=0:01:00
[11/22 00:37:15] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0614 s / img. ETA=0:00:57
[11/22 00:37:18] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0613 s / img. ETA=0:00:54
[11/22 00:37:21] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0612 s / img. ETA=0:00:51
[11/22 00:37:24] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0611 s / img. ETA=0:00:48
[11/22 00:37:27] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0610 s / img. ETA=0:00:45
[11/22 00:37:30] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0609 s / img. ETA=0:00:41
[11/22 00:37:33] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0609 s / img. ETA=0:00:38
[11/22 00:37:36] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0609 s / img. ETA=0:00:35
[11/22 00:37:39] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0609 s / img. ETA=0:00:32
[11/22 00:37:42] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0609 s / img. ETA=0:00:29
[11/22 00:37:45] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0609 s / img. ETA=0:00:26
[11/22 00:37:48] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0609 s / img. ETA=0:00:23
[11/22 00:37:51] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0608 s / img. ETA=0:00:20
[11/22 00:37:54] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0608 s / img. ETA=0:00:17
[11/22 00:37:57] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0608 s / img. ETA=0:00:14
[11/22 00:38:00] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0608 s / img. ETA=0:00:11
[11/22 00:38:03] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0609 s / img. ETA=0:00:08
[11/22 00:38:06] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0610 s / img. ETA=0:00:05
[11/22 00:38:09] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0609 s / img. ETA=0:00:02
[11/22 00:38:12] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 00:38:12] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.058926 s / img per device, on 4 devices)
[11/22 00:38:12] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:38:19] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.042 | 69.673 | 49.190 |   60.121    | 51.376 |
[11/22 00:38:19] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.800 | 56.680 | 29.402 | 31.800 | 56.680  | 29.402  |
[11/22 00:38:19] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 00:38:19] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:38:19] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 00:38:19] defrcn.evaluation.testing INFO: copypaste: 31.8005,56.6804,29.4023,31.8005,56.6804,29.4023
[11/22 00:38:35] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:38:35] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 00:38:35] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:38:35] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:38:35] d2.utils.env INFO: Using a generated random seed 38213650
[11/22 00:38:36] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:38:36] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 00:38:38] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 00:38:38] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:38:38] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:38:38] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 00:38:38] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:38:38] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:38:39] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 00:38:39] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:38:39] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 00:38:39] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 00:38:41] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:38:53] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0643 s / img. ETA=0:01:16
[11/22 00:38:57] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0624 s / img. ETA=0:01:10
[11/22 00:39:00] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0619 s / img. ETA=0:01:07
[11/22 00:39:03] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0617 s / img. ETA=0:01:04
[11/22 00:39:06] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0614 s / img. ETA=0:01:00
[11/22 00:39:09] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0612 s / img. ETA=0:00:57
[11/22 00:39:12] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0609 s / img. ETA=0:00:54
[11/22 00:39:15] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0608 s / img. ETA=0:00:50
[11/22 00:39:18] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0607 s / img. ETA=0:00:47
[11/22 00:39:21] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0606 s / img. ETA=0:00:44
[11/22 00:39:24] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0605 s / img. ETA=0:00:41
[11/22 00:39:27] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0605 s / img. ETA=0:00:38
[11/22 00:39:30] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0604 s / img. ETA=0:00:35
[11/22 00:39:32] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0603 s / img. ETA=0:00:32
[11/22 00:39:35] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0603 s / img. ETA=0:00:29
[11/22 00:39:38] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0602 s / img. ETA=0:00:26
[11/22 00:39:41] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0602 s / img. ETA=0:00:23
[11/22 00:39:44] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0601 s / img. ETA=0:00:20
[11/22 00:39:47] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0601 s / img. ETA=0:00:17
[11/22 00:39:50] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0600 s / img. ETA=0:00:14
[11/22 00:39:53] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0600 s / img. ETA=0:00:11
[11/22 00:39:56] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0600 s / img. ETA=0:00:08
[11/22 00:39:59] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0599 s / img. ETA=0:00:05
[11/22 00:40:02] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0599 s / img. ETA=0:00:02
[11/22 00:40:05] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 00:40:05] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.057462 s / img per device, on 4 devices)
[11/22 00:40:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:40:34] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   85.784    |  87.208   | 73.758 |  73.651  | 88.422 | 88.172 | 69.711  |    74.108     | 86.985 | 85.075  |  86.305  |    55.184     | 81.514  | 85.505  |   81.515    | 61.649 | 70.927 | 59.259 |   60.842    | 52.543 |
[11/22 00:40:34] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.945 | 75.406 | 51.126 | 53.358 | 80.193  | 58.735  | 31.706 | 61.044  | 28.298  |
[11/22 00:40:34] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 00:40:34] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:40:34] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 00:40:34] defrcn.evaluation.testing INFO: copypaste: 47.9448,75.4059,51.1258,53.3578,80.1932,58.7351,31.7057,61.0440,28.2976
[11/22 00:40:46] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:40:46] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 00:40:46] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:40:46] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:40:46] d2.utils.env INFO: Using a generated random seed 49249014
[11/22 00:40:47] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:40:47] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 00:40:47] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 00:40:47] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 00:40:47] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 00:40:47] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:40:47] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:40:47] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 00:40:47] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 00:40:56] d2.utils.events INFO:  eta: 0:04:22  iter: 19  total_loss: 0.5912  loss_cls: 0.3139  loss_box_reg: 0.1685  loss_rpn_cls: 0.04993  loss_rpn_loc: 0.05181  time: 0.2217  data_time: 0.1965  lr: 0.01  max_mem: 5087M
[11/22 00:41:00] d2.utils.events INFO:  eta: 0:04:17  iter: 39  total_loss: 0.3574  loss_cls: 0.1407  loss_box_reg: 0.1456  loss_rpn_cls: 0.02859  loss_rpn_loc: 0.03658  time: 0.2224  data_time: 0.0207  lr: 0.01  max_mem: 5087M
[11/22 00:41:04] d2.utils.events INFO:  eta: 0:04:13  iter: 59  total_loss: 0.2939  loss_cls: 0.09638  loss_box_reg: 0.123  loss_rpn_cls: 0.01919  loss_rpn_loc: 0.037  time: 0.2214  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 00:41:09] d2.utils.events INFO:  eta: 0:04:08  iter: 79  total_loss: 0.2504  loss_cls: 0.08839  loss_box_reg: 0.103  loss_rpn_cls: 0.01632  loss_rpn_loc: 0.03607  time: 0.2216  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:41:13] d2.utils.events INFO:  eta: 0:04:04  iter: 99  total_loss: 0.2214  loss_cls: 0.07998  loss_box_reg: 0.08674  loss_rpn_cls: 0.01426  loss_rpn_loc: 0.03464  time: 0.2220  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 00:41:18] d2.utils.events INFO:  eta: 0:03:59  iter: 119  total_loss: 0.201  loss_cls: 0.07355  loss_box_reg: 0.08255  loss_rpn_cls: 0.01294  loss_rpn_loc: 0.02968  time: 0.2217  data_time: 0.0219  lr: 0.01  max_mem: 5087M
[11/22 00:41:22] d2.utils.events INFO:  eta: 0:03:55  iter: 139  total_loss: 0.1822  loss_cls: 0.06261  loss_box_reg: 0.0723  loss_rpn_cls: 0.01315  loss_rpn_loc: 0.02887  time: 0.2219  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 00:41:27] d2.utils.events INFO:  eta: 0:03:50  iter: 159  total_loss: 0.1666  loss_cls: 0.06211  loss_box_reg: 0.06431  loss_rpn_cls: 0.01012  loss_rpn_loc: 0.02647  time: 0.2223  data_time: 0.0210  lr: 0.01  max_mem: 5087M
[11/22 00:41:31] d2.utils.events INFO:  eta: 0:03:46  iter: 179  total_loss: 0.1689  loss_cls: 0.06667  loss_box_reg: 0.0641  loss_rpn_cls: 0.009415  loss_rpn_loc: 0.02677  time: 0.2222  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 00:41:36] d2.utils.events INFO:  eta: 0:03:41  iter: 199  total_loss: 0.1563  loss_cls: 0.06128  loss_box_reg: 0.0626  loss_rpn_cls: 0.008773  loss_rpn_loc: 0.02694  time: 0.2223  data_time: 0.0241  lr: 0.01  max_mem: 5087M
[11/22 00:41:40] d2.utils.events INFO:  eta: 0:03:37  iter: 219  total_loss: 0.1476  loss_cls: 0.05699  loss_box_reg: 0.05759  loss_rpn_cls: 0.0068  loss_rpn_loc: 0.02119  time: 0.2224  data_time: 0.0219  lr: 0.01  max_mem: 5087M
[11/22 00:41:45] d2.utils.events INFO:  eta: 0:03:32  iter: 239  total_loss: 0.1507  loss_cls: 0.05581  loss_box_reg: 0.05626  loss_rpn_cls: 0.008093  loss_rpn_loc: 0.02708  time: 0.2222  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 00:41:49] d2.utils.events INFO:  eta: 0:03:28  iter: 259  total_loss: 0.1382  loss_cls: 0.05365  loss_box_reg: 0.0524  loss_rpn_cls: 0.006986  loss_rpn_loc: 0.02255  time: 0.2225  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 00:41:54] d2.utils.events INFO:  eta: 0:03:24  iter: 279  total_loss: 0.1398  loss_cls: 0.05107  loss_box_reg: 0.05256  loss_rpn_cls: 0.006758  loss_rpn_loc: 0.02611  time: 0.2224  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 00:41:58] d2.utils.events INFO:  eta: 0:03:19  iter: 299  total_loss: 0.1389  loss_cls: 0.05465  loss_box_reg: 0.05338  loss_rpn_cls: 0.006227  loss_rpn_loc: 0.02437  time: 0.2221  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 00:42:02] d2.utils.events INFO:  eta: 0:03:15  iter: 319  total_loss: 0.1355  loss_cls: 0.05191  loss_box_reg: 0.05075  loss_rpn_cls: 0.006837  loss_rpn_loc: 0.02518  time: 0.2221  data_time: 0.0220  lr: 0.01  max_mem: 5087M
[11/22 00:42:07] d2.utils.events INFO:  eta: 0:03:10  iter: 339  total_loss: 0.1319  loss_cls: 0.05254  loss_box_reg: 0.05079  loss_rpn_cls: 0.006402  loss_rpn_loc: 0.02225  time: 0.2224  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 00:42:11] d2.utils.events INFO:  eta: 0:03:06  iter: 359  total_loss: 0.1305  loss_cls: 0.04854  loss_box_reg: 0.04893  loss_rpn_cls: 0.005539  loss_rpn_loc: 0.02192  time: 0.2223  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:42:16] d2.utils.events INFO:  eta: 0:03:01  iter: 379  total_loss: 0.1249  loss_cls: 0.04653  loss_box_reg: 0.04961  loss_rpn_cls: 0.006004  loss_rpn_loc: 0.0218  time: 0.2223  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 00:42:20] d2.utils.events INFO:  eta: 0:02:57  iter: 399  total_loss: 0.1299  loss_cls: 0.04744  loss_box_reg: 0.04742  loss_rpn_cls: 0.005494  loss_rpn_loc: 0.01943  time: 0.2222  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:42:25] d2.utils.events INFO:  eta: 0:02:52  iter: 419  total_loss: 0.1276  loss_cls: 0.04836  loss_box_reg: 0.04805  loss_rpn_cls: 0.005196  loss_rpn_loc: 0.02112  time: 0.2222  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:42:29] d2.utils.events INFO:  eta: 0:02:48  iter: 439  total_loss: 0.1275  loss_cls: 0.04944  loss_box_reg: 0.04592  loss_rpn_cls: 0.004482  loss_rpn_loc: 0.01885  time: 0.2222  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:42:34] d2.utils.events INFO:  eta: 0:02:44  iter: 459  total_loss: 0.1207  loss_cls: 0.04869  loss_box_reg: 0.04606  loss_rpn_cls: 0.005028  loss_rpn_loc: 0.02244  time: 0.2223  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:42:38] d2.utils.events INFO:  eta: 0:02:39  iter: 479  total_loss: 0.1172  loss_cls: 0.04615  loss_box_reg: 0.04309  loss_rpn_cls: 0.005636  loss_rpn_loc: 0.01861  time: 0.2222  data_time: 0.0212  lr: 0.01  max_mem: 5087M
[11/22 00:42:43] d2.utils.events INFO:  eta: 0:02:35  iter: 499  total_loss: 0.1147  loss_cls: 0.04722  loss_box_reg: 0.04432  loss_rpn_cls: 0.004633  loss_rpn_loc: 0.01738  time: 0.2221  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 00:42:47] d2.utils.events INFO:  eta: 0:02:30  iter: 519  total_loss: 0.1182  loss_cls: 0.04617  loss_box_reg: 0.04427  loss_rpn_cls: 0.004858  loss_rpn_loc: 0.02089  time: 0.2222  data_time: 0.0210  lr: 0.01  max_mem: 5087M
[11/22 00:42:52] d2.utils.events INFO:  eta: 0:02:26  iter: 539  total_loss: 0.1165  loss_cls: 0.04299  loss_box_reg: 0.04208  loss_rpn_cls: 0.004427  loss_rpn_loc: 0.0207  time: 0.2221  data_time: 0.0213  lr: 0.01  max_mem: 5087M
[11/22 00:42:56] d2.utils.events INFO:  eta: 0:02:21  iter: 559  total_loss: 0.1116  loss_cls: 0.04388  loss_box_reg: 0.04228  loss_rpn_cls: 0.00486  loss_rpn_loc: 0.01825  time: 0.2222  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:43:00] d2.utils.events INFO:  eta: 0:02:17  iter: 579  total_loss: 0.1092  loss_cls: 0.04456  loss_box_reg: 0.04212  loss_rpn_cls: 0.00385  loss_rpn_loc: 0.01814  time: 0.2221  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 00:43:05] d2.utils.events INFO:  eta: 0:02:12  iter: 599  total_loss: 0.1132  loss_cls: 0.04548  loss_box_reg: 0.0412  loss_rpn_cls: 0.004597  loss_rpn_loc: 0.01677  time: 0.2220  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 00:43:09] d2.utils.events INFO:  eta: 0:02:08  iter: 619  total_loss: 0.111  loss_cls: 0.04436  loss_box_reg: 0.04459  loss_rpn_cls: 0.004199  loss_rpn_loc: 0.01561  time: 0.2220  data_time: 0.0223  lr: 0.01  max_mem: 5087M
[11/22 00:43:14] d2.utils.events INFO:  eta: 0:02:04  iter: 639  total_loss: 0.1133  loss_cls: 0.04235  loss_box_reg: 0.04079  loss_rpn_cls: 0.005172  loss_rpn_loc: 0.02275  time: 0.2221  data_time: 0.0203  lr: 0.01  max_mem: 5087M
[11/22 00:43:18] d2.utils.events INFO:  eta: 0:01:59  iter: 659  total_loss: 0.1016  loss_cls: 0.04215  loss_box_reg: 0.03937  loss_rpn_cls: 0.004846  loss_rpn_loc: 0.01662  time: 0.2220  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 00:43:23] d2.utils.events INFO:  eta: 0:01:55  iter: 679  total_loss: 0.1054  loss_cls: 0.04318  loss_box_reg: 0.04  loss_rpn_cls: 0.003896  loss_rpn_loc: 0.01681  time: 0.2220  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:43:27] d2.utils.events INFO:  eta: 0:01:50  iter: 699  total_loss: 0.1032  loss_cls: 0.04166  loss_box_reg: 0.04126  loss_rpn_cls: 0.00392  loss_rpn_loc: 0.01403  time: 0.2218  data_time: 0.0203  lr: 0.01  max_mem: 5087M
[11/22 00:43:32] d2.utils.events INFO:  eta: 0:01:46  iter: 719  total_loss: 0.1047  loss_cls: 0.04376  loss_box_reg: 0.03903  loss_rpn_cls: 0.003823  loss_rpn_loc: 0.01419  time: 0.2219  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 00:43:36] d2.utils.events INFO:  eta: 0:01:41  iter: 739  total_loss: 0.1111  loss_cls: 0.04244  loss_box_reg: 0.04144  loss_rpn_cls: 0.004366  loss_rpn_loc: 0.02144  time: 0.2220  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 00:43:41] d2.utils.events INFO:  eta: 0:01:37  iter: 759  total_loss: 0.1074  loss_cls: 0.0427  loss_box_reg: 0.04035  loss_rpn_cls: 0.004709  loss_rpn_loc: 0.01588  time: 0.2220  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 00:43:45] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.1012  loss_cls: 0.03999  loss_box_reg: 0.03812  loss_rpn_cls: 0.003317  loss_rpn_loc: 0.01645  time: 0.2220  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 00:43:49] d2.utils.events INFO:  eta: 0:01:28  iter: 799  total_loss: 0.106  loss_cls: 0.04295  loss_box_reg: 0.03938  loss_rpn_cls: 0.003828  loss_rpn_loc: 0.0172  time: 0.2220  data_time: 0.0227  lr: 0.01  max_mem: 5087M
[11/22 00:43:54] d2.utils.events INFO:  eta: 0:01:24  iter: 819  total_loss: 0.1009  loss_cls: 0.04054  loss_box_reg: 0.03559  loss_rpn_cls: 0.004094  loss_rpn_loc: 0.01789  time: 0.2219  data_time: 0.0204  lr: 0.01  max_mem: 5087M
[11/22 00:43:58] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.09415  loss_cls: 0.03858  loss_box_reg: 0.037  loss_rpn_cls: 0.003981  loss_rpn_loc: 0.01342  time: 0.2219  data_time: 0.0212  lr: 0.01  max_mem: 5087M
[11/22 00:44:03] d2.utils.events INFO:  eta: 0:01:15  iter: 859  total_loss: 0.1025  loss_cls: 0.04399  loss_box_reg: 0.03857  loss_rpn_cls: 0.004315  loss_rpn_loc: 0.0156  time: 0.2219  data_time: 0.0225  lr: 0.01  max_mem: 5087M
[11/22 00:44:07] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.1027  loss_cls: 0.04167  loss_box_reg: 0.03871  loss_rpn_cls: 0.004513  loss_rpn_loc: 0.0164  time: 0.2220  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 00:44:12] d2.utils.events INFO:  eta: 0:01:06  iter: 899  total_loss: 0.09952  loss_cls: 0.03998  loss_box_reg: 0.03808  loss_rpn_cls: 0.003159  loss_rpn_loc: 0.01391  time: 0.2219  data_time: 0.0217  lr: 0.01  max_mem: 5087M
[11/22 00:44:16] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09514  loss_cls: 0.04272  loss_box_reg: 0.03543  loss_rpn_cls: 0.003579  loss_rpn_loc: 0.01276  time: 0.2219  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:44:21] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.09958  loss_cls: 0.04136  loss_box_reg: 0.03767  loss_rpn_cls: 0.00339  loss_rpn_loc: 0.01286  time: 0.2219  data_time: 0.0212  lr: 0.01  max_mem: 5087M
[11/22 00:44:25] d2.utils.events INFO:  eta: 0:00:53  iter: 959  total_loss: 0.09857  loss_cls: 0.04214  loss_box_reg: 0.03679  loss_rpn_cls: 0.004759  loss_rpn_loc: 0.01721  time: 0.2219  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 00:44:29] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09465  loss_cls: 0.04089  loss_box_reg: 0.03614  loss_rpn_cls: 0.002392  loss_rpn_loc: 0.01318  time: 0.2219  data_time: 0.0178  lr: 0.001  max_mem: 5087M
[11/22 00:44:34] d2.utils.events INFO:  eta: 0:00:44  iter: 999  total_loss: 0.09127  loss_cls: 0.04245  loss_box_reg: 0.03502  loss_rpn_cls: 0.002995  loss_rpn_loc: 0.008693  time: 0.2218  data_time: 0.0198  lr: 0.001  max_mem: 5087M
[11/22 00:44:38] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08607  loss_cls: 0.03813  loss_box_reg: 0.03363  loss_rpn_cls: 0.002903  loss_rpn_loc: 0.008868  time: 0.2218  data_time: 0.0193  lr: 0.001  max_mem: 5087M
[11/22 00:44:43] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08595  loss_cls: 0.03975  loss_box_reg: 0.03285  loss_rpn_cls: 0.00315  loss_rpn_loc: 0.009405  time: 0.2218  data_time: 0.0209  lr: 0.001  max_mem: 5087M
[11/22 00:44:47] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08851  loss_cls: 0.04178  loss_box_reg: 0.03334  loss_rpn_cls: 0.003438  loss_rpn_loc: 0.007016  time: 0.2218  data_time: 0.0189  lr: 0.001  max_mem: 5087M
[11/22 00:44:52] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08803  loss_cls: 0.04105  loss_box_reg: 0.03408  loss_rpn_cls: 0.003524  loss_rpn_loc: 0.008041  time: 0.2217  data_time: 0.0199  lr: 0.001  max_mem: 5087M
[11/22 00:44:56] d2.utils.events INFO:  eta: 0:00:22  iter: 1099  total_loss: 0.08869  loss_cls: 0.04034  loss_box_reg: 0.03386  loss_rpn_cls: 0.002654  loss_rpn_loc: 0.006897  time: 0.2217  data_time: 0.0201  lr: 0.001  max_mem: 5087M
[11/22 00:45:00] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.0871  loss_cls: 0.03946  loss_box_reg: 0.03341  loss_rpn_cls: 0.003176  loss_rpn_loc: 0.008326  time: 0.2217  data_time: 0.0191  lr: 0.001  max_mem: 5087M
[11/22 00:45:05] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08618  loss_cls: 0.04084  loss_box_reg: 0.03352  loss_rpn_cls: 0.002667  loss_rpn_loc: 0.00842  time: 0.2216  data_time: 0.0198  lr: 0.001  max_mem: 5087M
[11/22 00:45:09] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.09166  loss_cls: 0.04201  loss_box_reg: 0.03649  loss_rpn_cls: 0.003113  loss_rpn_loc: 0.007931  time: 0.2216  data_time: 0.0208  lr: 0.001  max_mem: 5087M
[11/22 00:45:14] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.09003  loss_cls: 0.04132  loss_box_reg: 0.03579  loss_rpn_cls: 0.002405  loss_rpn_loc: 0.007345  time: 0.2215  data_time: 0.0189  lr: 0.001  max_mem: 5087M
[11/22 00:45:18] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 00:45:20] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.09173  loss_cls: 0.04165  loss_box_reg: 0.03624  loss_rpn_cls: 0.003278  loss_rpn_loc: 0.008158  time: 0.2215  data_time: 0.0193  lr: 0.001  max_mem: 5087M
[11/22 00:45:20] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:25 (0.2215 s / it)
[11/22 00:45:20] d2.engine.hooks INFO: Total training time: 0:04:28 (0:00:02 on hooks)
[11/22 00:45:21] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 00:45:21] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:45:21] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:45:21] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 00:45:21] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:45:21] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:45:22] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:45:22] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:45:22] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:45:22] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:45:35] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0628 s / img. ETA=0:01:14
[11/22 00:45:39] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0616 s / img. ETA=0:01:10
[11/22 00:45:42] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0616 s / img. ETA=0:01:07
[11/22 00:45:45] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0624 s / img. ETA=0:01:04
[11/22 00:45:48] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0620 s / img. ETA=0:01:01
[11/22 00:45:51] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0624 s / img. ETA=0:00:58
[11/22 00:45:54] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0619 s / img. ETA=0:00:54
[11/22 00:45:57] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0617 s / img. ETA=0:00:51
[11/22 00:46:00] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0615 s / img. ETA=0:00:48
[11/22 00:46:03] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0613 s / img. ETA=0:00:45
[11/22 00:46:06] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0611 s / img. ETA=0:00:42
[11/22 00:46:09] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0611 s / img. ETA=0:00:38
[11/22 00:46:12] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0609 s / img. ETA=0:00:35
[11/22 00:46:15] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0608 s / img. ETA=0:00:32
[11/22 00:46:18] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0608 s / img. ETA=0:00:29
[11/22 00:46:21] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0607 s / img. ETA=0:00:26
[11/22 00:46:24] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0606 s / img. ETA=0:00:23
[11/22 00:46:27] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0605 s / img. ETA=0:00:20
[11/22 00:46:30] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0604 s / img. ETA=0:00:17
[11/22 00:46:33] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0604 s / img. ETA=0:00:14
[11/22 00:46:36] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0603 s / img. ETA=0:00:11
[11/22 00:46:39] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0604 s / img. ETA=0:00:08
[11/22 00:46:42] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0603 s / img. ETA=0:00:05
[11/22 00:46:45] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0604 s / img. ETA=0:00:02
[11/22 00:46:47] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 00:46:47] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.058474 s / img per device, on 4 devices)
[11/22 00:46:48] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:46:55] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 51.867 | 70.987 | 41.133 |   59.598    | 52.966 |
[11/22 00:46:55] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.004 | 55.310 | 29.925 | 31.004 | 55.310  | 29.925  |
[11/22 00:46:55] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 00:46:55] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:46:55] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 00:46:55] defrcn.evaluation.testing INFO: copypaste: 31.0039,55.3102,29.9253,31.0039,55.3102,29.9253
[11/22 00:47:10] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:47:10] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 00:47:10] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:47:10] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:47:10] d2.utils.env INFO: Using a generated random seed 12893433
[11/22 00:47:10] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:47:11] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 00:47:12] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 00:47:12] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:47:12] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:47:12] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 00:47:12] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:47:12] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:47:13] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 00:47:13] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:47:13] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 00:47:13] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 00:47:15] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:47:28] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0634 s / img. ETA=0:01:15
[11/22 00:47:31] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0620 s / img. ETA=0:01:10
[11/22 00:47:34] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0629 s / img. ETA=0:01:08
[11/22 00:47:38] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0629 s / img. ETA=0:01:05
[11/22 00:47:41] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0628 s / img. ETA=0:01:02
[11/22 00:47:44] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0628 s / img. ETA=0:00:58
[11/22 00:47:47] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0627 s / img. ETA=0:00:55
[11/22 00:47:50] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0627 s / img. ETA=0:00:52
[11/22 00:47:53] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0627 s / img. ETA=0:00:49
[11/22 00:47:56] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0626 s / img. ETA=0:00:46
[11/22 00:47:59] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0624 s / img. ETA=0:00:42
[11/22 00:48:02] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0624 s / img. ETA=0:00:39
[11/22 00:48:06] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0623 s / img. ETA=0:00:36
[11/22 00:48:09] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0624 s / img. ETA=0:00:33
[11/22 00:48:12] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0624 s / img. ETA=0:00:30
[11/22 00:48:15] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0625 s / img. ETA=0:00:27
[11/22 00:48:18] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0625 s / img. ETA=0:00:24
[11/22 00:48:21] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0625 s / img. ETA=0:00:21
[11/22 00:48:24] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0625 s / img. ETA=0:00:17
[11/22 00:48:27] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0624 s / img. ETA=0:00:14
[11/22 00:48:31] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0625 s / img. ETA=0:00:11
[11/22 00:48:34] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0625 s / img. ETA=0:00:08
[11/22 00:48:37] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0625 s / img. ETA=0:00:05
[11/22 00:48:40] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0625 s / img. ETA=0:00:02
[11/22 00:48:43] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:17 (0.062449 s / img per device, on 4 devices)
[11/22 00:48:43] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:13 (0.059813 s / img per device, on 4 devices)
[11/22 00:48:43] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:49:08] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.354    |  87.010   | 72.695 |  73.883  | 88.477 | 88.195 | 69.364  |    74.680     | 86.890 | 84.618  |  86.117  |    55.596     | 80.887  | 85.078  |   81.645    | 56.086 | 72.430 | 44.011 |   59.562    | 52.407 |
[11/22 00:49:08] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.458 | 74.199 | 51.145 | 53.180 | 79.966  | 59.120  | 30.293 | 56.899  | 27.223  |
[11/22 00:49:08] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 00:49:08] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:49:08] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 00:49:08] defrcn.evaluation.testing INFO: copypaste: 47.4582,74.1993,51.1454,53.1799,79.9660,59.1196,30.2932,56.8990,27.2230
[11/22 00:49:20] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:49:20] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 00:49:20] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:49:20] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:49:20] d2.utils.env INFO: Using a generated random seed 22633947
[11/22 00:49:20] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:49:20] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 00:49:20] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 00:49:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 00:49:20] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 00:49:20] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:49:20] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:49:21] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 00:49:21] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 00:49:29] d2.utils.events INFO:  eta: 0:04:24  iter: 19  total_loss: 0.5956  loss_cls: 0.327  loss_box_reg: 0.1616  loss_rpn_cls: 0.04795  loss_rpn_loc: 0.0441  time: 0.2215  data_time: 0.2033  lr: 0.01  max_mem: 5088M
[11/22 00:49:33] d2.utils.events INFO:  eta: 0:04:19  iter: 39  total_loss: 0.3835  loss_cls: 0.1519  loss_box_reg: 0.1461  loss_rpn_cls: 0.02849  loss_rpn_loc: 0.04285  time: 0.2206  data_time: 0.0188  lr: 0.01  max_mem: 5088M
[11/22 00:49:38] d2.utils.events INFO:  eta: 0:04:11  iter: 59  total_loss: 0.2928  loss_cls: 0.1013  loss_box_reg: 0.1191  loss_rpn_cls: 0.02166  loss_rpn_loc: 0.04641  time: 0.2200  data_time: 0.0190  lr: 0.01  max_mem: 5088M
[11/22 00:49:42] d2.utils.events INFO:  eta: 0:04:05  iter: 79  total_loss: 0.2503  loss_cls: 0.08627  loss_box_reg: 0.0988  loss_rpn_cls: 0.01615  loss_rpn_loc: 0.03143  time: 0.2194  data_time: 0.0190  lr: 0.01  max_mem: 5088M
[11/22 00:49:47] d2.utils.events INFO:  eta: 0:04:01  iter: 99  total_loss: 0.2189  loss_cls: 0.08181  loss_box_reg: 0.09514  loss_rpn_cls: 0.01489  loss_rpn_loc: 0.03132  time: 0.2194  data_time: 0.0183  lr: 0.01  max_mem: 5088M
[11/22 00:49:51] d2.utils.events INFO:  eta: 0:03:56  iter: 119  total_loss: 0.2001  loss_cls: 0.07466  loss_box_reg: 0.07887  loss_rpn_cls: 0.01235  loss_rpn_loc: 0.02605  time: 0.2195  data_time: 0.0188  lr: 0.01  max_mem: 5088M
[11/22 00:49:55] d2.utils.events INFO:  eta: 0:03:52  iter: 139  total_loss: 0.1794  loss_cls: 0.06897  loss_box_reg: 0.07818  loss_rpn_cls: 0.01105  loss_rpn_loc: 0.02534  time: 0.2192  data_time: 0.0201  lr: 0.01  max_mem: 5088M
[11/22 00:50:00] d2.utils.events INFO:  eta: 0:03:47  iter: 159  total_loss: 0.1674  loss_cls: 0.06407  loss_box_reg: 0.06988  loss_rpn_cls: 0.01074  loss_rpn_loc: 0.02396  time: 0.2191  data_time: 0.0217  lr: 0.01  max_mem: 5088M
[11/22 00:50:04] d2.utils.events INFO:  eta: 0:03:43  iter: 179  total_loss: 0.1655  loss_cls: 0.06351  loss_box_reg: 0.06326  loss_rpn_cls: 0.009888  loss_rpn_loc: 0.02617  time: 0.2190  data_time: 0.0181  lr: 0.01  max_mem: 5088M
[11/22 00:50:08] d2.utils.events INFO:  eta: 0:03:38  iter: 199  total_loss: 0.1475  loss_cls: 0.05919  loss_box_reg: 0.05727  loss_rpn_cls: 0.007952  loss_rpn_loc: 0.02306  time: 0.2190  data_time: 0.0212  lr: 0.01  max_mem: 5088M
[11/22 00:50:13] d2.utils.events INFO:  eta: 0:03:34  iter: 219  total_loss: 0.1516  loss_cls: 0.057  loss_box_reg: 0.05667  loss_rpn_cls: 0.009039  loss_rpn_loc: 0.0247  time: 0.2189  data_time: 0.0219  lr: 0.01  max_mem: 5088M
[11/22 00:50:17] d2.utils.events INFO:  eta: 0:03:29  iter: 239  total_loss: 0.1399  loss_cls: 0.05697  loss_box_reg: 0.05425  loss_rpn_cls: 0.007005  loss_rpn_loc: 0.02087  time: 0.2192  data_time: 0.0250  lr: 0.01  max_mem: 5088M
[11/22 00:50:22] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.1396  loss_cls: 0.05507  loss_box_reg: 0.05421  loss_rpn_cls: 0.007058  loss_rpn_loc: 0.02583  time: 0.2195  data_time: 0.0207  lr: 0.01  max_mem: 5088M
[11/22 00:50:26] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.1365  loss_cls: 0.05366  loss_box_reg: 0.05102  loss_rpn_cls: 0.005367  loss_rpn_loc: 0.02197  time: 0.2194  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 00:50:31] d2.utils.events INFO:  eta: 0:03:16  iter: 299  total_loss: 0.1384  loss_cls: 0.05104  loss_box_reg: 0.05098  loss_rpn_cls: 0.006116  loss_rpn_loc: 0.02362  time: 0.2195  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 00:50:35] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1353  loss_cls: 0.05176  loss_box_reg: 0.05136  loss_rpn_cls: 0.005937  loss_rpn_loc: 0.02689  time: 0.2195  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 00:50:39] d2.utils.events INFO:  eta: 0:03:07  iter: 339  total_loss: 0.1274  loss_cls: 0.04934  loss_box_reg: 0.04702  loss_rpn_cls: 0.005728  loss_rpn_loc: 0.02183  time: 0.2194  data_time: 0.0194  lr: 0.01  max_mem: 5088M
[11/22 00:50:44] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1319  loss_cls: 0.05004  loss_box_reg: 0.04909  loss_rpn_cls: 0.005176  loss_rpn_loc: 0.01882  time: 0.2198  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 00:50:48] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.1259  loss_cls: 0.05089  loss_box_reg: 0.05007  loss_rpn_cls: 0.005484  loss_rpn_loc: 0.01682  time: 0.2197  data_time: 0.0206  lr: 0.01  max_mem: 5088M
[11/22 00:50:53] d2.utils.events INFO:  eta: 0:02:54  iter: 399  total_loss: 0.1284  loss_cls: 0.04836  loss_box_reg: 0.04493  loss_rpn_cls: 0.00518  loss_rpn_loc: 0.02118  time: 0.2198  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 00:50:57] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.1283  loss_cls: 0.04476  loss_box_reg: 0.04681  loss_rpn_cls: 0.006008  loss_rpn_loc: 0.02514  time: 0.2202  data_time: 0.0194  lr: 0.01  max_mem: 5088M
[11/22 00:51:02] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1168  loss_cls: 0.04674  loss_box_reg: 0.04513  loss_rpn_cls: 0.004235  loss_rpn_loc: 0.01662  time: 0.2200  data_time: 0.0189  lr: 0.01  max_mem: 5088M
[11/22 00:51:06] d2.utils.events INFO:  eta: 0:02:41  iter: 459  total_loss: 0.1132  loss_cls: 0.04457  loss_box_reg: 0.04426  loss_rpn_cls: 0.004849  loss_rpn_loc: 0.01764  time: 0.2200  data_time: 0.0196  lr: 0.01  max_mem: 5088M
[11/22 00:51:10] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.1177  loss_cls: 0.04671  loss_box_reg: 0.04453  loss_rpn_cls: 0.004644  loss_rpn_loc: 0.01717  time: 0.2199  data_time: 0.0186  lr: 0.01  max_mem: 5088M
[11/22 00:51:15] d2.utils.events INFO:  eta: 0:02:32  iter: 499  total_loss: 0.1155  loss_cls: 0.04535  loss_box_reg: 0.04484  loss_rpn_cls: 0.005823  loss_rpn_loc: 0.01849  time: 0.2199  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 00:51:19] d2.utils.events INFO:  eta: 0:02:28  iter: 519  total_loss: 0.1118  loss_cls: 0.04456  loss_box_reg: 0.04293  loss_rpn_cls: 0.004706  loss_rpn_loc: 0.01745  time: 0.2200  data_time: 0.0207  lr: 0.01  max_mem: 5088M
[11/22 00:51:24] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1112  loss_cls: 0.04568  loss_box_reg: 0.0436  loss_rpn_cls: 0.004606  loss_rpn_loc: 0.01633  time: 0.2199  data_time: 0.0190  lr: 0.01  max_mem: 5088M
[11/22 00:51:28] d2.utils.events INFO:  eta: 0:02:19  iter: 559  total_loss: 0.1152  loss_cls: 0.04497  loss_box_reg: 0.04169  loss_rpn_cls: 0.004287  loss_rpn_loc: 0.01849  time: 0.2200  data_time: 0.0196  lr: 0.01  max_mem: 5088M
[11/22 00:51:33] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1071  loss_cls: 0.04625  loss_box_reg: 0.04174  loss_rpn_cls: 0.003501  loss_rpn_loc: 0.01475  time: 0.2200  data_time: 0.0200  lr: 0.01  max_mem: 5088M
[11/22 00:51:37] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1074  loss_cls: 0.04569  loss_box_reg: 0.04124  loss_rpn_cls: 0.00414  loss_rpn_loc: 0.01562  time: 0.2199  data_time: 0.0215  lr: 0.01  max_mem: 5088M
[11/22 00:51:41] d2.utils.events INFO:  eta: 0:02:06  iter: 619  total_loss: 0.1062  loss_cls: 0.04521  loss_box_reg: 0.043  loss_rpn_cls: 0.003834  loss_rpn_loc: 0.01328  time: 0.2199  data_time: 0.0221  lr: 0.01  max_mem: 5088M
[11/22 00:51:46] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1054  loss_cls: 0.0421  loss_box_reg: 0.04032  loss_rpn_cls: 0.004143  loss_rpn_loc: 0.01708  time: 0.2199  data_time: 0.0187  lr: 0.01  max_mem: 5088M
[11/22 00:51:50] d2.utils.events INFO:  eta: 0:01:57  iter: 659  total_loss: 0.107  loss_cls: 0.0412  loss_box_reg: 0.04093  loss_rpn_cls: 0.004168  loss_rpn_loc: 0.01524  time: 0.2198  data_time: 0.0193  lr: 0.01  max_mem: 5088M
[11/22 00:51:55] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.11  loss_cls: 0.04231  loss_box_reg: 0.04057  loss_rpn_cls: 0.004536  loss_rpn_loc: 0.0181  time: 0.2198  data_time: 0.0179  lr: 0.01  max_mem: 5088M
[11/22 00:51:59] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1029  loss_cls: 0.0428  loss_box_reg: 0.04105  loss_rpn_cls: 0.00301  loss_rpn_loc: 0.01375  time: 0.2202  data_time: 0.0201  lr: 0.01  max_mem: 5088M
[11/22 00:52:04] d2.utils.events INFO:  eta: 0:01:44  iter: 719  total_loss: 0.1006  loss_cls: 0.04267  loss_box_reg: 0.03863  loss_rpn_cls: 0.003561  loss_rpn_loc: 0.01514  time: 0.2202  data_time: 0.0219  lr: 0.01  max_mem: 5088M
[11/22 00:52:08] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1019  loss_cls: 0.0405  loss_box_reg: 0.0389  loss_rpn_cls: 0.003679  loss_rpn_loc: 0.01519  time: 0.2203  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 00:52:12] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1042  loss_cls: 0.04366  loss_box_reg: 0.04027  loss_rpn_cls: 0.004258  loss_rpn_loc: 0.01436  time: 0.2202  data_time: 0.0215  lr: 0.01  max_mem: 5088M
[11/22 00:52:17] d2.utils.events INFO:  eta: 0:01:31  iter: 779  total_loss: 0.105  loss_cls: 0.04128  loss_box_reg: 0.03765  loss_rpn_cls: 0.003728  loss_rpn_loc: 0.01699  time: 0.2201  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 00:52:21] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.1007  loss_cls: 0.04123  loss_box_reg: 0.03719  loss_rpn_cls: 0.003645  loss_rpn_loc: 0.01246  time: 0.2201  data_time: 0.0179  lr: 0.01  max_mem: 5088M
[11/22 00:52:26] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.09941  loss_cls: 0.04049  loss_box_reg: 0.03709  loss_rpn_cls: 0.003777  loss_rpn_loc: 0.01735  time: 0.2201  data_time: 0.0188  lr: 0.01  max_mem: 5088M
[11/22 00:52:30] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09428  loss_cls: 0.04008  loss_box_reg: 0.03734  loss_rpn_cls: 0.003477  loss_rpn_loc: 0.01379  time: 0.2201  data_time: 0.0201  lr: 0.01  max_mem: 5088M
[11/22 00:52:35] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.1035  loss_cls: 0.04237  loss_box_reg: 0.03671  loss_rpn_cls: 0.00335  loss_rpn_loc: 0.01538  time: 0.2201  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 00:52:39] d2.utils.events INFO:  eta: 0:01:09  iter: 879  total_loss: 0.1026  loss_cls: 0.04114  loss_box_reg: 0.03595  loss_rpn_cls: 0.003386  loss_rpn_loc: 0.01974  time: 0.2201  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 00:52:43] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09703  loss_cls: 0.0391  loss_box_reg: 0.03685  loss_rpn_cls: 0.003704  loss_rpn_loc: 0.0166  time: 0.2202  data_time: 0.0202  lr: 0.01  max_mem: 5088M
[11/22 00:52:48] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09371  loss_cls: 0.04087  loss_box_reg: 0.03467  loss_rpn_cls: 0.00356  loss_rpn_loc: 0.01346  time: 0.2202  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 00:52:53] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09463  loss_cls: 0.03573  loss_box_reg: 0.03432  loss_rpn_cls: 0.003342  loss_rpn_loc: 0.01471  time: 0.2201  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 00:52:57] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09532  loss_cls: 0.04349  loss_box_reg: 0.03524  loss_rpn_cls: 0.003326  loss_rpn_loc: 0.01474  time: 0.2201  data_time: 0.0188  lr: 0.01  max_mem: 5088M
[11/22 00:53:01] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09462  loss_cls: 0.03938  loss_box_reg: 0.03567  loss_rpn_cls: 0.003103  loss_rpn_loc: 0.009876  time: 0.2200  data_time: 0.0191  lr: 0.001  max_mem: 5088M
[11/22 00:53:06] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.09017  loss_cls: 0.03906  loss_box_reg: 0.03217  loss_rpn_cls: 0.003622  loss_rpn_loc: 0.009252  time: 0.2201  data_time: 0.0217  lr: 0.001  max_mem: 5088M
[11/22 00:53:10] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08697  loss_cls: 0.03889  loss_box_reg: 0.03473  loss_rpn_cls: 0.003012  loss_rpn_loc: 0.007969  time: 0.2200  data_time: 0.0179  lr: 0.001  max_mem: 5088M
[11/22 00:53:15] d2.utils.events INFO:  eta: 0:00:34  iter: 1039  total_loss: 0.08866  loss_cls: 0.04046  loss_box_reg: 0.03619  loss_rpn_cls: 0.00289  loss_rpn_loc: 0.008033  time: 0.2200  data_time: 0.0198  lr: 0.001  max_mem: 5088M
[11/22 00:53:19] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08824  loss_cls: 0.03963  loss_box_reg: 0.03347  loss_rpn_cls: 0.003043  loss_rpn_loc: 0.009727  time: 0.2200  data_time: 0.0188  lr: 0.001  max_mem: 5088M
[11/22 00:53:23] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08513  loss_cls: 0.04203  loss_box_reg: 0.03511  loss_rpn_cls: 0.003106  loss_rpn_loc: 0.006676  time: 0.2200  data_time: 0.0208  lr: 0.001  max_mem: 5088M
[11/22 00:53:28] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08562  loss_cls: 0.04049  loss_box_reg: 0.03329  loss_rpn_cls: 0.003349  loss_rpn_loc: 0.008899  time: 0.2200  data_time: 0.0213  lr: 0.001  max_mem: 5088M
[11/22 00:53:32] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08814  loss_cls: 0.03934  loss_box_reg: 0.03395  loss_rpn_cls: 0.003286  loss_rpn_loc: 0.009033  time: 0.2200  data_time: 0.0180  lr: 0.001  max_mem: 5088M
[11/22 00:53:37] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08701  loss_cls: 0.04099  loss_box_reg: 0.03589  loss_rpn_cls: 0.002702  loss_rpn_loc: 0.009121  time: 0.2200  data_time: 0.0196  lr: 0.001  max_mem: 5088M
[11/22 00:53:41] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08745  loss_cls: 0.04103  loss_box_reg: 0.03489  loss_rpn_cls: 0.003114  loss_rpn_loc: 0.006949  time: 0.2200  data_time: 0.0233  lr: 0.001  max_mem: 5088M
[11/22 00:53:45] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08961  loss_cls: 0.04144  loss_box_reg: 0.03775  loss_rpn_cls: 0.002962  loss_rpn_loc: 0.007424  time: 0.2200  data_time: 0.0182  lr: 0.001  max_mem: 5088M
[11/22 00:53:50] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 00:53:52] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08744  loss_cls: 0.04021  loss_box_reg: 0.03454  loss_rpn_cls: 0.002914  loss_rpn_loc: 0.007093  time: 0.2199  data_time: 0.0213  lr: 0.001  max_mem: 5088M
[11/22 00:53:52] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:23 (0.2200 s / it)
[11/22 00:53:52] d2.engine.hooks INFO: Total training time: 0:04:26 (0:00:03 on hooks)
[11/22 00:53:54] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 00:53:54] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:53:54] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:53:54] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 00:53:54] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:53:54] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:53:55] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:53:55] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:53:55] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:53:55] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:54:08] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0642 s / img. ETA=0:01:16
[11/22 00:54:11] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0626 s / img. ETA=0:01:11
[11/22 00:54:14] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0624 s / img. ETA=0:01:07
[11/22 00:54:18] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0627 s / img. ETA=0:01:05
[11/22 00:54:21] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0625 s / img. ETA=0:01:01
[11/22 00:54:24] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0624 s / img. ETA=0:00:58
[11/22 00:54:27] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0621 s / img. ETA=0:00:55
[11/22 00:54:30] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0620 s / img. ETA=0:00:51
[11/22 00:54:33] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0618 s / img. ETA=0:00:48
[11/22 00:54:36] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0618 s / img. ETA=0:00:45
[11/22 00:54:39] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0617 s / img. ETA=0:00:42
[11/22 00:54:42] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0618 s / img. ETA=0:00:39
[11/22 00:54:45] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0617 s / img. ETA=0:00:36
[11/22 00:54:48] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0616 s / img. ETA=0:00:33
[11/22 00:54:51] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0617 s / img. ETA=0:00:30
[11/22 00:54:54] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0617 s / img. ETA=0:00:27
[11/22 00:54:58] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0617 s / img. ETA=0:00:23
[11/22 00:55:01] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0616 s / img. ETA=0:00:20
[11/22 00:55:04] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0615 s / img. ETA=0:00:17
[11/22 00:55:07] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0614 s / img. ETA=0:00:14
[11/22 00:55:10] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0614 s / img. ETA=0:00:11
[11/22 00:55:13] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0614 s / img. ETA=0:00:08
[11/22 00:55:16] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0613 s / img. ETA=0:00:05
[11/22 00:55:19] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0613 s / img. ETA=0:00:02
[11/22 00:55:21] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 00:55:21] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:13 (0.059397 s / img per device, on 4 devices)
[11/22 00:55:23] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:55:29] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 52.643 | 72.263 | 50.995 |   59.068    | 53.737 |
[11/22 00:55:29] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 32.192 | 57.741 | 30.730 | 32.192 | 57.741  | 30.730  |
[11/22 00:55:29] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 00:55:29] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:55:29] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 00:55:29] defrcn.evaluation.testing INFO: copypaste: 32.1922,57.7412,30.7302,32.1922,57.7412,30.7302
[11/22 00:55:46] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:55:46] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 00:55:46] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:55:46] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:55:46] d2.utils.env INFO: Using a generated random seed 48796347
[11/22 00:55:46] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:55:46] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 00:55:48] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 00:55:48] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:55:48] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 00:55:48] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 00:55:48] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 00:55:48] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 00:55:50] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 00:55:50] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 00:55:50] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 00:55:50] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 00:55:52] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 00:56:05] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0617 s / img. ETA=0:01:13
[11/22 00:56:08] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0642 s / img. ETA=0:01:13
[11/22 00:56:11] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0627 s / img. ETA=0:01:08
[11/22 00:56:14] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0620 s / img. ETA=0:01:04
[11/22 00:56:17] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0614 s / img. ETA=0:01:00
[11/22 00:56:20] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0611 s / img. ETA=0:00:57
[11/22 00:56:23] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0607 s / img. ETA=0:00:53
[11/22 00:56:26] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0605 s / img. ETA=0:00:50
[11/22 00:56:29] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0603 s / img. ETA=0:00:47
[11/22 00:56:32] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0601 s / img. ETA=0:00:44
[11/22 00:56:35] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0600 s / img. ETA=0:00:41
[11/22 00:56:38] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0600 s / img. ETA=0:00:38
[11/22 00:56:41] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0598 s / img. ETA=0:00:35
[11/22 00:56:44] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0598 s / img. ETA=0:00:32
[11/22 00:56:47] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0597 s / img. ETA=0:00:29
[11/22 00:56:50] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0596 s / img. ETA=0:00:26
[11/22 00:56:52] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0596 s / img. ETA=0:00:23
[11/22 00:56:55] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0595 s / img. ETA=0:00:20
[11/22 00:56:58] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0595 s / img. ETA=0:00:17
[11/22 00:57:01] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0594 s / img. ETA=0:00:14
[11/22 00:57:04] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0594 s / img. ETA=0:00:11
[11/22 00:57:07] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0594 s / img. ETA=0:00:08
[11/22 00:57:10] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0594 s / img. ETA=0:00:05
[11/22 00:57:13] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0593 s / img. ETA=0:00:02
[11/22 00:57:16] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:13 (0.059205 s / img per device, on 4 devices)
[11/22 00:57:16] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.057095 s / img per device, on 4 devices)
[11/22 00:57:19] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 00:57:44] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   86.038    |  86.956   | 72.414 |  73.822  | 88.614 | 88.106 | 68.842  |    74.928     | 86.943 | 84.867  |  86.218  |    54.856     | 82.041  | 84.368  |   81.578    | 56.376 | 70.367 | 49.249 |   61.282    | 53.363 |
[11/22 00:57:44] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.691 | 74.561 | 50.760 | 53.343 | 80.039  | 58.743  | 30.733 | 58.127  | 26.812  |
[11/22 00:57:44] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 00:57:44] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 00:57:44] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 00:57:44] defrcn.evaluation.testing INFO: copypaste: 47.6907,74.5614,50.7604,53.3434,80.0394,58.7432,30.7325,58.1274,26.8118
[11/22 00:57:56] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 00:57:56] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 00:57:56] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 00:57:56] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 00:57:56] d2.utils.env INFO: Using a generated random seed 58878362
[11/22 00:57:56] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 00:57:57] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 00:57:57] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 00:57:57] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 00:57:57] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 00:57:57] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 00:57:57] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 00:57:57] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 00:57:57] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 00:58:05] d2.utils.events INFO:  eta: 0:04:22  iter: 19  total_loss: 0.5968  loss_cls: 0.3492  loss_box_reg: 0.1637  loss_rpn_cls: 0.04674  loss_rpn_loc: 0.05344  time: 0.2220  data_time: 0.1988  lr: 0.01  max_mem: 5087M
[11/22 00:58:09] d2.utils.events INFO:  eta: 0:04:16  iter: 39  total_loss: 0.3753  loss_cls: 0.1715  loss_box_reg: 0.149  loss_rpn_cls: 0.02835  loss_rpn_loc: 0.03447  time: 0.2207  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 00:58:14] d2.utils.events INFO:  eta: 0:04:10  iter: 59  total_loss: 0.296  loss_cls: 0.1097  loss_box_reg: 0.1233  loss_rpn_cls: 0.019  loss_rpn_loc: 0.03726  time: 0.2200  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 00:58:18] d2.utils.events INFO:  eta: 0:04:06  iter: 79  total_loss: 0.2538  loss_cls: 0.09138  loss_box_reg: 0.108  loss_rpn_cls: 0.01626  loss_rpn_loc: 0.03767  time: 0.2198  data_time: 0.0210  lr: 0.01  max_mem: 5087M
[11/22 00:58:23] d2.utils.events INFO:  eta: 0:04:00  iter: 99  total_loss: 0.217  loss_cls: 0.07942  loss_box_reg: 0.09028  loss_rpn_cls: 0.01503  loss_rpn_loc: 0.0298  time: 0.2194  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 00:58:27] d2.utils.events INFO:  eta: 0:03:56  iter: 119  total_loss: 0.1981  loss_cls: 0.07172  loss_box_reg: 0.07976  loss_rpn_cls: 0.01167  loss_rpn_loc: 0.02881  time: 0.2195  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 00:58:31] d2.utils.events INFO:  eta: 0:03:52  iter: 139  total_loss: 0.1868  loss_cls: 0.07521  loss_box_reg: 0.0752  loss_rpn_cls: 0.009676  loss_rpn_loc: 0.02479  time: 0.2198  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 00:58:36] d2.utils.events INFO:  eta: 0:03:48  iter: 159  total_loss: 0.1794  loss_cls: 0.06714  loss_box_reg: 0.06747  loss_rpn_cls: 0.01125  loss_rpn_loc: 0.03134  time: 0.2202  data_time: 0.0188  lr: 0.01  max_mem: 5087M
[11/22 00:58:40] d2.utils.events INFO:  eta: 0:03:44  iter: 179  total_loss: 0.1667  loss_cls: 0.06471  loss_box_reg: 0.06237  loss_rpn_cls: 0.007217  loss_rpn_loc: 0.02062  time: 0.2200  data_time: 0.0204  lr: 0.01  max_mem: 5087M
[11/22 00:58:45] d2.utils.events INFO:  eta: 0:03:39  iter: 199  total_loss: 0.158  loss_cls: 0.06321  loss_box_reg: 0.06156  loss_rpn_cls: 0.007817  loss_rpn_loc: 0.02348  time: 0.2200  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 00:58:49] d2.utils.events INFO:  eta: 0:03:35  iter: 219  total_loss: 0.1514  loss_cls: 0.05928  loss_box_reg: 0.0606  loss_rpn_cls: 0.007459  loss_rpn_loc: 0.02439  time: 0.2197  data_time: 0.0206  lr: 0.01  max_mem: 5087M
[11/22 00:58:53] d2.utils.events INFO:  eta: 0:03:30  iter: 239  total_loss: 0.1455  loss_cls: 0.05505  loss_box_reg: 0.057  loss_rpn_cls: 0.006978  loss_rpn_loc: 0.02271  time: 0.2196  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 00:58:58] d2.utils.events INFO:  eta: 0:03:26  iter: 259  total_loss: 0.1436  loss_cls: 0.05709  loss_box_reg: 0.05661  loss_rpn_cls: 0.007189  loss_rpn_loc: 0.02092  time: 0.2198  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 00:59:02] d2.utils.events INFO:  eta: 0:03:22  iter: 279  total_loss: 0.1387  loss_cls: 0.05708  loss_box_reg: 0.05677  loss_rpn_cls: 0.007078  loss_rpn_loc: 0.02219  time: 0.2195  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:59:07] d2.utils.events INFO:  eta: 0:03:17  iter: 299  total_loss: 0.146  loss_cls: 0.05748  loss_box_reg: 0.05704  loss_rpn_cls: 0.006975  loss_rpn_loc: 0.02427  time: 0.2197  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 00:59:11] d2.utils.events INFO:  eta: 0:03:13  iter: 319  total_loss: 0.1346  loss_cls: 0.05369  loss_box_reg: 0.05469  loss_rpn_cls: 0.006038  loss_rpn_loc: 0.01932  time: 0.2198  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 00:59:16] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1349  loss_cls: 0.05452  loss_box_reg: 0.05303  loss_rpn_cls: 0.005431  loss_rpn_loc: 0.01859  time: 0.2198  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 00:59:20] d2.utils.events INFO:  eta: 0:03:04  iter: 359  total_loss: 0.1306  loss_cls: 0.05082  loss_box_reg: 0.04791  loss_rpn_cls: 0.006428  loss_rpn_loc: 0.0244  time: 0.2198  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 00:59:24] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.1293  loss_cls: 0.05347  loss_box_reg: 0.04973  loss_rpn_cls: 0.00652  loss_rpn_loc: 0.02173  time: 0.2196  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 00:59:29] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.127  loss_cls: 0.05198  loss_box_reg: 0.05015  loss_rpn_cls: 0.00619  loss_rpn_loc: 0.01901  time: 0.2197  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 00:59:33] d2.utils.events INFO:  eta: 0:02:51  iter: 419  total_loss: 0.1341  loss_cls: 0.05227  loss_box_reg: 0.05042  loss_rpn_cls: 0.006558  loss_rpn_loc: 0.02568  time: 0.2197  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 00:59:38] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1273  loss_cls: 0.05036  loss_box_reg: 0.04801  loss_rpn_cls: 0.006321  loss_rpn_loc: 0.01994  time: 0.2198  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 00:59:42] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1199  loss_cls: 0.047  loss_box_reg: 0.04596  loss_rpn_cls: 0.005255  loss_rpn_loc: 0.0192  time: 0.2197  data_time: 0.0173  lr: 0.01  max_mem: 5087M
[11/22 00:59:46] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.1133  loss_cls: 0.04748  loss_box_reg: 0.04361  loss_rpn_cls: 0.005071  loss_rpn_loc: 0.01573  time: 0.2197  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 00:59:51] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.123  loss_cls: 0.04677  loss_box_reg: 0.04595  loss_rpn_cls: 0.005325  loss_rpn_loc: 0.02115  time: 0.2196  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 00:59:55] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.119  loss_cls: 0.04743  loss_box_reg: 0.04648  loss_rpn_cls: 0.005062  loss_rpn_loc: 0.01714  time: 0.2196  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:00:00] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1159  loss_cls: 0.04521  loss_box_reg: 0.04416  loss_rpn_cls: 0.005272  loss_rpn_loc: 0.01878  time: 0.2196  data_time: 0.0162  lr: 0.01  max_mem: 5087M
[11/22 01:00:04] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1137  loss_cls: 0.04765  loss_box_reg: 0.04486  loss_rpn_cls: 0.004022  loss_rpn_loc: 0.01516  time: 0.2195  data_time: 0.0175  lr: 0.01  max_mem: 5087M
[11/22 01:00:08] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1178  loss_cls: 0.04616  loss_box_reg: 0.04267  loss_rpn_cls: 0.004692  loss_rpn_loc: 0.01791  time: 0.2195  data_time: 0.0169  lr: 0.01  max_mem: 5087M
[11/22 01:00:13] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1113  loss_cls: 0.046  loss_box_reg: 0.04147  loss_rpn_cls: 0.004918  loss_rpn_loc: 0.01735  time: 0.2194  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 01:00:17] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1119  loss_cls: 0.04574  loss_box_reg: 0.04126  loss_rpn_cls: 0.003993  loss_rpn_loc: 0.01555  time: 0.2195  data_time: 0.0169  lr: 0.01  max_mem: 5087M
[11/22 01:00:22] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1108  loss_cls: 0.04651  loss_box_reg: 0.04368  loss_rpn_cls: 0.003621  loss_rpn_loc: 0.01504  time: 0.2195  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:00:26] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1139  loss_cls: 0.04719  loss_box_reg: 0.043  loss_rpn_cls: 0.004029  loss_rpn_loc: 0.0167  time: 0.2195  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:00:31] d2.utils.events INFO:  eta: 0:01:54  iter: 679  total_loss: 0.108  loss_cls: 0.04616  loss_box_reg: 0.04388  loss_rpn_cls: 0.004004  loss_rpn_loc: 0.01437  time: 0.2196  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 01:00:35] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1033  loss_cls: 0.04557  loss_box_reg: 0.0376  loss_rpn_cls: 0.004084  loss_rpn_loc: 0.01644  time: 0.2196  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 01:00:39] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.106  loss_cls: 0.04321  loss_box_reg: 0.0418  loss_rpn_cls: 0.004598  loss_rpn_loc: 0.01402  time: 0.2195  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 01:00:44] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.107  loss_cls: 0.04528  loss_box_reg: 0.03931  loss_rpn_cls: 0.004455  loss_rpn_loc: 0.01646  time: 0.2195  data_time: 0.0174  lr: 0.01  max_mem: 5087M
[11/22 01:00:48] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1066  loss_cls: 0.04881  loss_box_reg: 0.03762  loss_rpn_cls: 0.003346  loss_rpn_loc: 0.01197  time: 0.2196  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:00:53] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.1051  loss_cls: 0.04464  loss_box_reg: 0.03968  loss_rpn_cls: 0.003425  loss_rpn_loc: 0.01491  time: 0.2196  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 01:00:57] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.0982  loss_cls: 0.04243  loss_box_reg: 0.03595  loss_rpn_cls: 0.003451  loss_rpn_loc: 0.01267  time: 0.2196  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 01:01:01] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.09976  loss_cls: 0.04347  loss_box_reg: 0.0355  loss_rpn_cls: 0.00339  loss_rpn_loc: 0.01565  time: 0.2195  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 01:01:06] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.1019  loss_cls: 0.04405  loss_box_reg: 0.03631  loss_rpn_cls: 0.003461  loss_rpn_loc: 0.01309  time: 0.2195  data_time: 0.0199  lr: 0.01  max_mem: 5087M
[11/22 01:01:10] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.0994  loss_cls: 0.04271  loss_box_reg: 0.03516  loss_rpn_cls: 0.003181  loss_rpn_loc: 0.01265  time: 0.2195  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:01:15] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.1041  loss_cls: 0.04309  loss_box_reg: 0.03769  loss_rpn_cls: 0.003817  loss_rpn_loc: 0.01778  time: 0.2195  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:01:19] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.1031  loss_cls: 0.04336  loss_box_reg: 0.03734  loss_rpn_cls: 0.004039  loss_rpn_loc: 0.01712  time: 0.2197  data_time: 0.0188  lr: 0.01  max_mem: 5087M
[11/22 01:01:24] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.101  loss_cls: 0.04398  loss_box_reg: 0.03671  loss_rpn_cls: 0.003883  loss_rpn_loc: 0.01744  time: 0.2197  data_time: 0.0204  lr: 0.01  max_mem: 5087M
[11/22 01:01:28] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.1004  loss_cls: 0.04001  loss_box_reg: 0.03413  loss_rpn_cls: 0.004346  loss_rpn_loc: 0.01851  time: 0.2198  data_time: 0.0188  lr: 0.01  max_mem: 5087M
[11/22 01:01:32] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09774  loss_cls: 0.04221  loss_box_reg: 0.03598  loss_rpn_cls: 0.004874  loss_rpn_loc: 0.01612  time: 0.2197  data_time: 0.0179  lr: 0.01  max_mem: 5087M
[11/22 01:01:37] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09273  loss_cls: 0.04259  loss_box_reg: 0.03439  loss_rpn_cls: 0.003265  loss_rpn_loc: 0.01022  time: 0.2197  data_time: 0.0195  lr: 0.001  max_mem: 5087M
[11/22 01:01:41] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08618  loss_cls: 0.04282  loss_box_reg: 0.03055  loss_rpn_cls: 0.003284  loss_rpn_loc: 0.01019  time: 0.2197  data_time: 0.0184  lr: 0.001  max_mem: 5087M
[11/22 01:01:46] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.09057  loss_cls: 0.03861  loss_box_reg: 0.03265  loss_rpn_cls: 0.003785  loss_rpn_loc: 0.008066  time: 0.2197  data_time: 0.0175  lr: 0.001  max_mem: 5087M
[11/22 01:01:50] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.09017  loss_cls: 0.04356  loss_box_reg: 0.03597  loss_rpn_cls: 0.003312  loss_rpn_loc: 0.007188  time: 0.2197  data_time: 0.0178  lr: 0.001  max_mem: 5087M
[11/22 01:01:54] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08667  loss_cls: 0.04075  loss_box_reg: 0.03334  loss_rpn_cls: 0.00381  loss_rpn_loc: 0.006732  time: 0.2197  data_time: 0.0168  lr: 0.001  max_mem: 5087M
[11/22 01:01:59] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.09074  loss_cls: 0.04435  loss_box_reg: 0.03489  loss_rpn_cls: 0.003841  loss_rpn_loc: 0.007676  time: 0.2197  data_time: 0.0183  lr: 0.001  max_mem: 5087M
[11/22 01:02:03] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08772  loss_cls: 0.03925  loss_box_reg: 0.03365  loss_rpn_cls: 0.004011  loss_rpn_loc: 0.007813  time: 0.2197  data_time: 0.0175  lr: 0.001  max_mem: 5087M
[11/22 01:02:08] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.0907  loss_cls: 0.0438  loss_box_reg: 0.03522  loss_rpn_cls: 0.00362  loss_rpn_loc: 0.007035  time: 0.2197  data_time: 0.0188  lr: 0.001  max_mem: 5087M
[11/22 01:02:12] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.09074  loss_cls: 0.04305  loss_box_reg: 0.03399  loss_rpn_cls: 0.003157  loss_rpn_loc: 0.008411  time: 0.2197  data_time: 0.0181  lr: 0.001  max_mem: 5087M
[11/22 01:02:16] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08776  loss_cls: 0.04132  loss_box_reg: 0.0326  loss_rpn_cls: 0.003381  loss_rpn_loc: 0.007324  time: 0.2196  data_time: 0.0178  lr: 0.001  max_mem: 5087M
[11/22 01:02:21] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.09064  loss_cls: 0.04122  loss_box_reg: 0.03417  loss_rpn_cls: 0.0036  loss_rpn_loc: 0.007587  time: 0.2196  data_time: 0.0175  lr: 0.001  max_mem: 5087M
[11/22 01:02:25] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:02:27] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08968  loss_cls: 0.04194  loss_box_reg: 0.03322  loss_rpn_cls: 0.003363  loss_rpn_loc: 0.007573  time: 0.2196  data_time: 0.0169  lr: 0.001  max_mem: 5087M
[11/22 01:02:27] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:23 (0.2196 s / it)
[11/22 01:02:27] d2.engine.hooks INFO: Total training time: 0:04:26 (0:00:03 on hooks)
[11/22 01:02:28] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:02:28] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:02:28] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:02:28] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:02:28] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:02:28] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:02:29] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:02:29] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:02:29] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:02:30] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:02:43] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0611 s / img. ETA=0:01:12
[11/22 01:02:45] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0600 s / img. ETA=0:01:08
[11/22 01:02:49] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0602 s / img. ETA=0:01:05
[11/22 01:02:51] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0600 s / img. ETA=0:01:02
[11/22 01:02:54] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0599 s / img. ETA=0:00:59
[11/22 01:02:57] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0598 s / img. ETA=0:00:56
[11/22 01:03:00] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0599 s / img. ETA=0:00:53
[11/22 01:03:03] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0598 s / img. ETA=0:00:50
[11/22 01:03:06] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0598 s / img. ETA=0:00:47
[11/22 01:03:09] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0598 s / img. ETA=0:00:44
[11/22 01:03:12] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0597 s / img. ETA=0:00:41
[11/22 01:03:15] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0597 s / img. ETA=0:00:38
[11/22 01:03:18] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0596 s / img. ETA=0:00:35
[11/22 01:03:21] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0596 s / img. ETA=0:00:32
[11/22 01:03:24] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0596 s / img. ETA=0:00:29
[11/22 01:03:27] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0596 s / img. ETA=0:00:26
[11/22 01:03:30] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0597 s / img. ETA=0:00:23
[11/22 01:03:33] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0598 s / img. ETA=0:00:20
[11/22 01:03:36] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0597 s / img. ETA=0:00:17
[11/22 01:03:39] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0598 s / img. ETA=0:00:14
[11/22 01:03:42] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0599 s / img. ETA=0:00:11
[11/22 01:03:46] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0600 s / img. ETA=0:00:08
[11/22 01:03:49] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0601 s / img. ETA=0:00:05
[11/22 01:03:52] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0600 s / img. ETA=0:00:02
[11/22 01:03:54] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 01:03:54] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:11 (0.058304 s / img per device, on 4 devices)
[11/22 01:03:54] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:04:01] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.601 | 70.439 | 44.482 |   57.663    | 51.813 |
[11/22 01:04:01] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.718 | 55.599 | 30.829 | 31.718 | 55.599  | 30.829  |
[11/22 01:04:01] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:04:01] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:04:01] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:04:01] defrcn.evaluation.testing INFO: copypaste: 31.7177,55.5994,30.8295,31.7177,55.5994,30.8295
[11/22 01:04:17] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:04:17] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:04:17] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:04:17] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:04:17] d2.utils.env INFO: Using a generated random seed 20107325
[11/22 01:04:17] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:04:18] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:04:20] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:04:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:04:20] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:04:20] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:04:20] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:04:20] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:04:21] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:04:21] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:04:21] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:04:21] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:04:23] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:04:36] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0620 s / img. ETA=0:01:13
[11/22 01:04:39] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0614 s / img. ETA=0:01:09
[11/22 01:04:42] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0614 s / img. ETA=0:01:06
[11/22 01:04:45] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0612 s / img. ETA=0:01:03
[11/22 01:04:48] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0610 s / img. ETA=0:01:00
[11/22 01:04:51] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0610 s / img. ETA=0:00:57
[11/22 01:04:54] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0608 s / img. ETA=0:00:53
[11/22 01:04:57] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0607 s / img. ETA=0:00:50
[11/22 01:05:00] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0607 s / img. ETA=0:00:47
[11/22 01:05:03] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0606 s / img. ETA=0:00:44
[11/22 01:05:06] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0606 s / img. ETA=0:00:41
[11/22 01:05:09] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0608 s / img. ETA=0:00:38
[11/22 01:05:12] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0607 s / img. ETA=0:00:35
[11/22 01:05:15] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0607 s / img. ETA=0:00:32
[11/22 01:05:18] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0607 s / img. ETA=0:00:29
[11/22 01:05:21] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0607 s / img. ETA=0:00:26
[11/22 01:05:24] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0606 s / img. ETA=0:00:23
[11/22 01:05:27] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0606 s / img. ETA=0:00:20
[11/22 01:05:30] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0605 s / img. ETA=0:00:17
[11/22 01:05:33] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0605 s / img. ETA=0:00:14
[11/22 01:05:36] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0605 s / img. ETA=0:00:11
[11/22 01:05:39] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0605 s / img. ETA=0:00:08
[11/22 01:05:42] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0605 s / img. ETA=0:00:05
[11/22 01:05:45] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0604 s / img. ETA=0:00:02
[11/22 01:05:48] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 01:05:48] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:11 (0.057882 s / img per device, on 4 devices)
[11/22 01:05:48] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:06:12] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.558    |  86.835   | 73.604 |  74.303  | 88.659 | 87.618 | 69.010  |    74.464     | 86.441 | 84.862  |  86.192  |    55.013     | 81.900  | 85.095  |   81.664    | 59.960 | 70.502 | 60.325 |   58.431    | 52.620 |
[11/22 01:06:12] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.987 | 75.103 | 51.493 | 53.217 | 80.014  | 59.224  | 32.295 | 60.368  | 28.300  |
[11/22 01:06:12] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:06:12] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:06:12] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:06:12] defrcn.evaluation.testing INFO: copypaste: 47.9867,75.1028,51.4930,53.2172,80.0145,59.2241,32.2952,60.3676,28.2998
[11/22 01:06:25] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:06:25] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:06:25] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:06:25] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:06:25] d2.utils.env INFO: Using a generated random seed 28115616
[11/22 01:06:25] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:06:26] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:06:26] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:06:26] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:06:26] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:06:26] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:06:26] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:06:26] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:06:26] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:06:35] d2.utils.events INFO:  eta: 0:04:21  iter: 19  total_loss: 0.5792  loss_cls: 0.3289  loss_box_reg: 0.1681  loss_rpn_cls: 0.05438  loss_rpn_loc: 0.05899  time: 0.2287  data_time: 0.2136  lr: 0.01  max_mem: 4909M
[11/22 01:06:39] d2.utils.events INFO:  eta: 0:04:12  iter: 39  total_loss: 0.3692  loss_cls: 0.1531  loss_box_reg: 0.1453  loss_rpn_cls: 0.02689  loss_rpn_loc: 0.03935  time: 0.2244  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 01:06:44] d2.utils.events INFO:  eta: 0:04:11  iter: 59  total_loss: 0.2815  loss_cls: 0.1018  loss_box_reg: 0.1274  loss_rpn_cls: 0.02116  loss_rpn_loc: 0.03594  time: 0.2228  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 01:06:48] d2.utils.events INFO:  eta: 0:04:05  iter: 79  total_loss: 0.2314  loss_cls: 0.08  loss_box_reg: 0.1013  loss_rpn_cls: 0.01575  loss_rpn_loc: 0.03441  time: 0.2219  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 01:06:52] d2.utils.events INFO:  eta: 0:04:01  iter: 99  total_loss: 0.2199  loss_cls: 0.0719  loss_box_reg: 0.088  loss_rpn_cls: 0.01485  loss_rpn_loc: 0.03957  time: 0.2221  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:06:57] d2.utils.events INFO:  eta: 0:03:58  iter: 119  total_loss: 0.1928  loss_cls: 0.0725  loss_box_reg: 0.07635  loss_rpn_cls: 0.01325  loss_rpn_loc: 0.03765  time: 0.2219  data_time: 0.0214  lr: 0.01  max_mem: 5087M
[11/22 01:07:01] d2.utils.events INFO:  eta: 0:03:53  iter: 139  total_loss: 0.18  loss_cls: 0.07021  loss_box_reg: 0.068  loss_rpn_cls: 0.01212  loss_rpn_loc: 0.03089  time: 0.2221  data_time: 0.0213  lr: 0.01  max_mem: 5087M
[11/22 01:07:06] d2.utils.events INFO:  eta: 0:03:48  iter: 159  total_loss: 0.1638  loss_cls: 0.0645  loss_box_reg: 0.06347  loss_rpn_cls: 0.009817  loss_rpn_loc: 0.02356  time: 0.2215  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 01:07:10] d2.utils.events INFO:  eta: 0:03:43  iter: 179  total_loss: 0.1645  loss_cls: 0.06037  loss_box_reg: 0.06177  loss_rpn_cls: 0.009886  loss_rpn_loc: 0.0252  time: 0.2212  data_time: 0.0205  lr: 0.01  max_mem: 5087M
[11/22 01:07:15] d2.utils.events INFO:  eta: 0:03:39  iter: 199  total_loss: 0.1508  loss_cls: 0.05785  loss_box_reg: 0.0564  loss_rpn_cls: 0.009301  loss_rpn_loc: 0.02853  time: 0.2211  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 01:07:19] d2.utils.events INFO:  eta: 0:03:35  iter: 219  total_loss: 0.1387  loss_cls: 0.05431  loss_box_reg: 0.05189  loss_rpn_cls: 0.007194  loss_rpn_loc: 0.02392  time: 0.2212  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 01:07:24] d2.utils.events INFO:  eta: 0:03:30  iter: 239  total_loss: 0.1401  loss_cls: 0.05731  loss_box_reg: 0.05499  loss_rpn_cls: 0.006998  loss_rpn_loc: 0.02176  time: 0.2212  data_time: 0.0215  lr: 0.01  max_mem: 5087M
[11/22 01:07:28] d2.utils.events INFO:  eta: 0:03:26  iter: 259  total_loss: 0.1386  loss_cls: 0.05396  loss_box_reg: 0.05004  loss_rpn_cls: 0.007567  loss_rpn_loc: 0.02438  time: 0.2212  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:07:32] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.1332  loss_cls: 0.05073  loss_box_reg: 0.05023  loss_rpn_cls: 0.006882  loss_rpn_loc: 0.02686  time: 0.2209  data_time: 0.0203  lr: 0.01  max_mem: 5087M
[11/22 01:07:37] d2.utils.events INFO:  eta: 0:03:17  iter: 299  total_loss: 0.1246  loss_cls: 0.05002  loss_box_reg: 0.04688  loss_rpn_cls: 0.006332  loss_rpn_loc: 0.02021  time: 0.2210  data_time: 0.0213  lr: 0.01  max_mem: 5087M
[11/22 01:07:41] d2.utils.events INFO:  eta: 0:03:13  iter: 319  total_loss: 0.1262  loss_cls: 0.04964  loss_box_reg: 0.04673  loss_rpn_cls: 0.006438  loss_rpn_loc: 0.02006  time: 0.2208  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 01:07:46] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1244  loss_cls: 0.04915  loss_box_reg: 0.04492  loss_rpn_cls: 0.0066  loss_rpn_loc: 0.01709  time: 0.2209  data_time: 0.0221  lr: 0.01  max_mem: 5087M
[11/22 01:07:50] d2.utils.events INFO:  eta: 0:03:04  iter: 359  total_loss: 0.1182  loss_cls: 0.04685  loss_box_reg: 0.04514  loss_rpn_cls: 0.005797  loss_rpn_loc: 0.01902  time: 0.2209  data_time: 0.0213  lr: 0.01  max_mem: 5087M
[11/22 01:07:55] d2.utils.events INFO:  eta: 0:03:00  iter: 379  total_loss: 0.126  loss_cls: 0.05126  loss_box_reg: 0.04773  loss_rpn_cls: 0.00538  loss_rpn_loc: 0.02273  time: 0.2209  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 01:07:59] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.12  loss_cls: 0.04689  loss_box_reg: 0.04349  loss_rpn_cls: 0.005498  loss_rpn_loc: 0.02056  time: 0.2208  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 01:08:03] d2.utils.events INFO:  eta: 0:02:51  iter: 419  total_loss: 0.1156  loss_cls: 0.04791  loss_box_reg: 0.04362  loss_rpn_cls: 0.004935  loss_rpn_loc: 0.01912  time: 0.2208  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 01:08:08] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1185  loss_cls: 0.04445  loss_box_reg: 0.04331  loss_rpn_cls: 0.006273  loss_rpn_loc: 0.01749  time: 0.2207  data_time: 0.0213  lr: 0.01  max_mem: 5087M
[11/22 01:08:12] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1217  loss_cls: 0.04818  loss_box_reg: 0.04551  loss_rpn_cls: 0.004668  loss_rpn_loc: 0.02041  time: 0.2207  data_time: 0.0188  lr: 0.01  max_mem: 5087M
[11/22 01:08:17] d2.utils.events INFO:  eta: 0:02:38  iter: 479  total_loss: 0.1153  loss_cls: 0.04523  loss_box_reg: 0.04266  loss_rpn_cls: 0.005356  loss_rpn_loc: 0.01916  time: 0.2206  data_time: 0.0201  lr: 0.01  max_mem: 5087M
[11/22 01:08:21] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1125  loss_cls: 0.04153  loss_box_reg: 0.04129  loss_rpn_cls: 0.005559  loss_rpn_loc: 0.02065  time: 0.2205  data_time: 0.0207  lr: 0.01  max_mem: 5087M
[11/22 01:08:25] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.1134  loss_cls: 0.0493  loss_box_reg: 0.04459  loss_rpn_cls: 0.004329  loss_rpn_loc: 0.01778  time: 0.2205  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 01:08:30] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1115  loss_cls: 0.04201  loss_box_reg: 0.0387  loss_rpn_cls: 0.00499  loss_rpn_loc: 0.01621  time: 0.2206  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 01:08:34] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1117  loss_cls: 0.04449  loss_box_reg: 0.03993  loss_rpn_cls: 0.005593  loss_rpn_loc: 0.02032  time: 0.2206  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:08:39] d2.utils.events INFO:  eta: 0:02:16  iter: 579  total_loss: 0.1109  loss_cls: 0.04325  loss_box_reg: 0.04145  loss_rpn_cls: 0.005295  loss_rpn_loc: 0.01892  time: 0.2206  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 01:08:43] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.102  loss_cls: 0.04055  loss_box_reg: 0.03836  loss_rpn_cls: 0.004917  loss_rpn_loc: 0.01495  time: 0.2205  data_time: 0.0218  lr: 0.01  max_mem: 5087M
[11/22 01:08:48] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1089  loss_cls: 0.04413  loss_box_reg: 0.0404  loss_rpn_cls: 0.004236  loss_rpn_loc: 0.01526  time: 0.2206  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 01:08:52] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1004  loss_cls: 0.04181  loss_box_reg: 0.03913  loss_rpn_cls: 0.004061  loss_rpn_loc: 0.01379  time: 0.2205  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 01:08:56] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1057  loss_cls: 0.04515  loss_box_reg: 0.04024  loss_rpn_cls: 0.003924  loss_rpn_loc: 0.01297  time: 0.2205  data_time: 0.0207  lr: 0.01  max_mem: 5087M
[11/22 01:09:01] d2.utils.events INFO:  eta: 0:01:54  iter: 679  total_loss: 0.09755  loss_cls: 0.04109  loss_box_reg: 0.0391  loss_rpn_cls: 0.004458  loss_rpn_loc: 0.01477  time: 0.2206  data_time: 0.0221  lr: 0.01  max_mem: 5087M
[11/22 01:09:05] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.09726  loss_cls: 0.03806  loss_box_reg: 0.03916  loss_rpn_cls: 0.004694  loss_rpn_loc: 0.01535  time: 0.2207  data_time: 0.0235  lr: 0.01  max_mem: 5087M
[11/22 01:09:10] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1023  loss_cls: 0.04202  loss_box_reg: 0.0385  loss_rpn_cls: 0.00416  loss_rpn_loc: 0.01656  time: 0.2207  data_time: 0.0204  lr: 0.01  max_mem: 5087M
[11/22 01:09:14] d2.utils.events INFO:  eta: 0:01:41  iter: 739  total_loss: 0.09985  loss_cls: 0.04137  loss_box_reg: 0.03635  loss_rpn_cls: 0.003745  loss_rpn_loc: 0.01567  time: 0.2208  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:09:19] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.09816  loss_cls: 0.04009  loss_box_reg: 0.03268  loss_rpn_cls: 0.004329  loss_rpn_loc: 0.01807  time: 0.2208  data_time: 0.0207  lr: 0.01  max_mem: 5087M
[11/22 01:09:23] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.09779  loss_cls: 0.03674  loss_box_reg: 0.03634  loss_rpn_cls: 0.004441  loss_rpn_loc: 0.01756  time: 0.2208  data_time: 0.0190  lr: 0.01  max_mem: 5087M
[11/22 01:09:28] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.09498  loss_cls: 0.0402  loss_box_reg: 0.03662  loss_rpn_cls: 0.003688  loss_rpn_loc: 0.01348  time: 0.2208  data_time: 0.0211  lr: 0.01  max_mem: 5087M
[11/22 01:09:32] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1002  loss_cls: 0.03923  loss_box_reg: 0.03642  loss_rpn_cls: 0.003174  loss_rpn_loc: 0.01792  time: 0.2207  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 01:09:36] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.09996  loss_cls: 0.03956  loss_box_reg: 0.0348  loss_rpn_cls: 0.00405  loss_rpn_loc: 0.0204  time: 0.2207  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 01:09:41] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.09324  loss_cls: 0.03799  loss_box_reg: 0.03236  loss_rpn_cls: 0.004023  loss_rpn_loc: 0.01961  time: 0.2207  data_time: 0.0176  lr: 0.01  max_mem: 5087M
[11/22 01:09:45] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.09708  loss_cls: 0.03857  loss_box_reg: 0.03546  loss_rpn_cls: 0.003846  loss_rpn_loc: 0.02049  time: 0.2207  data_time: 0.0208  lr: 0.01  max_mem: 5087M
[11/22 01:09:50] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09119  loss_cls: 0.03612  loss_box_reg: 0.03438  loss_rpn_cls: 0.003882  loss_rpn_loc: 0.0164  time: 0.2207  data_time: 0.0216  lr: 0.01  max_mem: 5087M
[11/22 01:09:54] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.08878  loss_cls: 0.03878  loss_box_reg: 0.03535  loss_rpn_cls: 0.003987  loss_rpn_loc: 0.01517  time: 0.2207  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:09:59] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.09131  loss_cls: 0.03765  loss_box_reg: 0.03425  loss_rpn_cls: 0.003942  loss_rpn_loc: 0.01424  time: 0.2207  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 01:10:03] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09301  loss_cls: 0.03697  loss_box_reg: 0.03456  loss_rpn_cls: 0.003922  loss_rpn_loc: 0.01505  time: 0.2207  data_time: 0.0191  lr: 0.01  max_mem: 5087M
[11/22 01:10:07] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09014  loss_cls: 0.03502  loss_box_reg: 0.03493  loss_rpn_cls: 0.004163  loss_rpn_loc: 0.01352  time: 0.2206  data_time: 0.0198  lr: 0.001  max_mem: 5087M
[11/22 01:10:12] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08519  loss_cls: 0.04059  loss_box_reg: 0.03428  loss_rpn_cls: 0.003412  loss_rpn_loc: 0.008556  time: 0.2206  data_time: 0.0198  lr: 0.001  max_mem: 5087M
[11/22 01:10:16] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08144  loss_cls: 0.03788  loss_box_reg: 0.0337  loss_rpn_cls: 0.002914  loss_rpn_loc: 0.007497  time: 0.2206  data_time: 0.0216  lr: 0.001  max_mem: 5087M
[11/22 01:10:21] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08171  loss_cls: 0.03936  loss_box_reg: 0.03212  loss_rpn_cls: 0.00364  loss_rpn_loc: 0.008268  time: 0.2206  data_time: 0.0179  lr: 0.001  max_mem: 5087M
[11/22 01:10:25] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.07754  loss_cls: 0.03616  loss_box_reg: 0.03075  loss_rpn_cls: 0.003135  loss_rpn_loc: 0.008426  time: 0.2206  data_time: 0.0196  lr: 0.001  max_mem: 5087M
[11/22 01:10:30] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08553  loss_cls: 0.03749  loss_box_reg: 0.03182  loss_rpn_cls: 0.002997  loss_rpn_loc: 0.007491  time: 0.2206  data_time: 0.0183  lr: 0.001  max_mem: 5087M
[11/22 01:10:34] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08193  loss_cls: 0.03747  loss_box_reg: 0.03382  loss_rpn_cls: 0.002745  loss_rpn_loc: 0.007525  time: 0.2206  data_time: 0.0194  lr: 0.001  max_mem: 5087M
[11/22 01:10:38] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08521  loss_cls: 0.0389  loss_box_reg: 0.03246  loss_rpn_cls: 0.00351  loss_rpn_loc: 0.009737  time: 0.2207  data_time: 0.0187  lr: 0.001  max_mem: 5087M
[11/22 01:10:43] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08067  loss_cls: 0.03775  loss_box_reg: 0.03125  loss_rpn_cls: 0.003658  loss_rpn_loc: 0.009816  time: 0.2207  data_time: 0.0190  lr: 0.001  max_mem: 5087M
[11/22 01:10:47] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08679  loss_cls: 0.03806  loss_box_reg: 0.0339  loss_rpn_cls: 0.003366  loss_rpn_loc: 0.007747  time: 0.2206  data_time: 0.0223  lr: 0.001  max_mem: 5087M
[11/22 01:10:52] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08632  loss_cls: 0.03882  loss_box_reg: 0.03331  loss_rpn_cls: 0.003284  loss_rpn_loc: 0.007431  time: 0.2206  data_time: 0.0206  lr: 0.001  max_mem: 5087M
[11/22 01:10:56] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:10:58] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08809  loss_cls: 0.03788  loss_box_reg: 0.03412  loss_rpn_cls: 0.0034  loss_rpn_loc: 0.00798  time: 0.2206  data_time: 0.0181  lr: 0.001  max_mem: 5087M
[11/22 01:10:58] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:24 (0.2206 s / it)
[11/22 01:10:58] d2.engine.hooks INFO: Total training time: 0:04:27 (0:00:02 on hooks)
[11/22 01:10:59] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:10:59] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:10:59] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:10:59] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:10:59] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:10:59] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:11:00] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:11:00] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:11:00] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:11:01] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:11:14] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0631 s / img. ETA=0:01:14
[11/22 01:11:17] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0621 s / img. ETA=0:01:10
[11/22 01:11:20] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0622 s / img. ETA=0:01:07
[11/22 01:11:23] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0620 s / img. ETA=0:01:04
[11/22 01:11:26] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0619 s / img. ETA=0:01:01
[11/22 01:11:29] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0618 s / img. ETA=0:00:57
[11/22 01:11:32] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0616 s / img. ETA=0:00:54
[11/22 01:11:35] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0615 s / img. ETA=0:00:51
[11/22 01:11:38] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0613 s / img. ETA=0:00:48
[11/22 01:11:41] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0612 s / img. ETA=0:00:45
[11/22 01:11:44] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0614 s / img. ETA=0:00:42
[11/22 01:11:47] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0614 s / img. ETA=0:00:39
[11/22 01:11:50] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0613 s / img. ETA=0:00:36
[11/22 01:11:53] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0612 s / img. ETA=0:00:32
[11/22 01:11:56] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0612 s / img. ETA=0:00:29
[11/22 01:11:59] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0612 s / img. ETA=0:00:26
[11/22 01:12:02] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0612 s / img. ETA=0:00:23
[11/22 01:12:05] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0611 s / img. ETA=0:00:20
[11/22 01:12:08] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0610 s / img. ETA=0:00:17
[11/22 01:12:11] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0610 s / img. ETA=0:00:14
[11/22 01:12:14] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0609 s / img. ETA=0:00:11
[11/22 01:12:17] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0609 s / img. ETA=0:00:08
[11/22 01:12:20] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0609 s / img. ETA=0:00:05
[11/22 01:12:24] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0609 s / img. ETA=0:00:02
[11/22 01:12:26] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 01:12:26] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.059005 s / img per device, on 4 devices)
[11/22 01:12:28] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:12:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.058 | 67.937 | 46.965 |   60.625    | 52.396 |
[11/22 01:12:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 30.974 | 56.196 | 30.216 | 30.974 | 56.196  | 30.216  |
[11/22 01:12:36] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:12:36] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:12:36] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:12:36] defrcn.evaluation.testing INFO: copypaste: 30.9743,56.1961,30.2161,30.9743,56.1961,30.2161
[11/22 01:12:52] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:12:52] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:12:52] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:12:52] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:12:52] d2.utils.env INFO: Using a generated random seed 55326722
[11/22 01:12:53] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:12:53] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:12:55] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:12:55] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:12:55] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:12:55] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:12:55] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:12:55] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:12:58] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:12:58] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:12:58] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:12:58] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:12:59] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:13:12] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0645 s / img. ETA=0:01:16
[11/22 01:13:15] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0624 s / img. ETA=0:01:11
[11/22 01:13:18] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0621 s / img. ETA=0:01:07
[11/22 01:13:21] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0619 s / img. ETA=0:01:04
[11/22 01:13:24] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0616 s / img. ETA=0:01:00
[11/22 01:13:28] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0615 s / img. ETA=0:00:57
[11/22 01:13:30] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0611 s / img. ETA=0:00:54
[11/22 01:13:33] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0609 s / img. ETA=0:00:51
[11/22 01:13:36] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0607 s / img. ETA=0:00:47
[11/22 01:13:39] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0605 s / img. ETA=0:00:44
[11/22 01:13:42] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0603 s / img. ETA=0:00:41
[11/22 01:13:45] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0602 s / img. ETA=0:00:38
[11/22 01:13:48] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0600 s / img. ETA=0:00:35
[11/22 01:13:51] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0599 s / img. ETA=0:00:32
[11/22 01:13:54] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0598 s / img. ETA=0:00:29
[11/22 01:13:57] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0598 s / img. ETA=0:00:26
[11/22 01:14:00] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0597 s / img. ETA=0:00:23
[11/22 01:14:03] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0597 s / img. ETA=0:00:20
[11/22 01:14:06] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0596 s / img. ETA=0:00:17
[11/22 01:14:09] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0595 s / img. ETA=0:00:14
[11/22 01:14:12] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0595 s / img. ETA=0:00:11
[11/22 01:14:15] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0595 s / img. ETA=0:00:08
[11/22 01:14:17] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0594 s / img. ETA=0:00:05
[11/22 01:14:20] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0594 s / img. ETA=0:00:02
[11/22 01:14:23] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:13 (0.059205 s / img per device, on 4 devices)
[11/22 01:14:23] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.056956 s / img per device, on 4 devices)
[11/22 01:14:25] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:14:50] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.656    |  86.784   | 72.943 |  73.746  | 88.503 | 87.944 | 69.811  |    74.522     | 86.884 | 84.666  |  85.989  |    55.183     | 80.599  | 84.996  |   81.564    | 59.502 | 72.164 | 59.817 |   61.081    | 52.111 |
[11/22 01:14:50] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.017 | 75.173 | 51.457 | 53.425 | 79.919  | 59.021  | 31.793 | 60.935  | 28.764  |
[11/22 01:14:50] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:14:50] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:14:50] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:14:50] defrcn.evaluation.testing INFO: copypaste: 48.0167,75.1733,51.4570,53.4245,79.9194,59.0212,31.7934,60.9350,28.7642
[11/22 01:15:02] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:15:02] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:15:02] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:15:02] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:15:02] d2.utils.env INFO: Using a generated random seed 5650533
[11/22 01:15:03] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:15:03] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:15:03] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:15:03] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:15:03] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:15:03] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:15:03] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:15:04] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:15:04] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:15:12] d2.utils.events INFO:  eta: 0:04:16  iter: 19  total_loss: 0.5842  loss_cls: 0.3222  loss_box_reg: 0.1746  loss_rpn_cls: 0.04149  loss_rpn_loc: 0.05397  time: 0.2207  data_time: 0.1972  lr: 0.01  max_mem: 5087M
[11/22 01:15:16] d2.utils.events INFO:  eta: 0:04:15  iter: 39  total_loss: 0.3702  loss_cls: 0.1302  loss_box_reg: 0.1589  loss_rpn_cls: 0.02706  loss_rpn_loc: 0.03494  time: 0.2203  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:15:20] d2.utils.events INFO:  eta: 0:04:09  iter: 59  total_loss: 0.2884  loss_cls: 0.09902  loss_box_reg: 0.1304  loss_rpn_cls: 0.02211  loss_rpn_loc: 0.03892  time: 0.2192  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 01:15:25] d2.utils.events INFO:  eta: 0:04:05  iter: 79  total_loss: 0.2502  loss_cls: 0.08555  loss_box_reg: 0.1072  loss_rpn_cls: 0.01571  loss_rpn_loc: 0.03266  time: 0.2200  data_time: 0.0229  lr: 0.01  max_mem: 5087M
[11/22 01:15:29] d2.utils.events INFO:  eta: 0:04:00  iter: 99  total_loss: 0.2236  loss_cls: 0.07779  loss_box_reg: 0.09334  loss_rpn_cls: 0.01386  loss_rpn_loc: 0.03358  time: 0.2197  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 01:15:34] d2.utils.events INFO:  eta: 0:03:56  iter: 119  total_loss: 0.1983  loss_cls: 0.07321  loss_box_reg: 0.08142  loss_rpn_cls: 0.01155  loss_rpn_loc: 0.03048  time: 0.2195  data_time: 0.0181  lr: 0.01  max_mem: 5087M
[11/22 01:15:38] d2.utils.events INFO:  eta: 0:03:51  iter: 139  total_loss: 0.1846  loss_cls: 0.06647  loss_box_reg: 0.07186  loss_rpn_cls: 0.0113  loss_rpn_loc: 0.03828  time: 0.2194  data_time: 0.0218  lr: 0.01  max_mem: 5087M
[11/22 01:15:43] d2.utils.events INFO:  eta: 0:03:47  iter: 159  total_loss: 0.1785  loss_cls: 0.06678  loss_box_reg: 0.06923  loss_rpn_cls: 0.009851  loss_rpn_loc: 0.02923  time: 0.2194  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:15:47] d2.utils.events INFO:  eta: 0:03:42  iter: 179  total_loss: 0.1708  loss_cls: 0.06242  loss_box_reg: 0.06574  loss_rpn_cls: 0.009998  loss_rpn_loc: 0.02487  time: 0.2193  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 01:15:51] d2.utils.events INFO:  eta: 0:03:38  iter: 199  total_loss: 0.1583  loss_cls: 0.06427  loss_box_reg: 0.06293  loss_rpn_cls: 0.008533  loss_rpn_loc: 0.02207  time: 0.2193  data_time: 0.0219  lr: 0.01  max_mem: 5087M
[11/22 01:15:56] d2.utils.events INFO:  eta: 0:03:34  iter: 219  total_loss: 0.1576  loss_cls: 0.06193  loss_box_reg: 0.06531  loss_rpn_cls: 0.00799  loss_rpn_loc: 0.02615  time: 0.2194  data_time: 0.0217  lr: 0.01  max_mem: 5087M
[11/22 01:16:00] d2.utils.events INFO:  eta: 0:03:29  iter: 239  total_loss: 0.1523  loss_cls: 0.05785  loss_box_reg: 0.06499  loss_rpn_cls: 0.008967  loss_rpn_loc: 0.02559  time: 0.2194  data_time: 0.0208  lr: 0.01  max_mem: 5087M
[11/22 01:16:05] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.1564  loss_cls: 0.06049  loss_box_reg: 0.06137  loss_rpn_cls: 0.007555  loss_rpn_loc: 0.02267  time: 0.2194  data_time: 0.0214  lr: 0.01  max_mem: 5087M
[11/22 01:16:09] d2.utils.events INFO:  eta: 0:03:20  iter: 279  total_loss: 0.1464  loss_cls: 0.05362  loss_box_reg: 0.05597  loss_rpn_cls: 0.007863  loss_rpn_loc: 0.02708  time: 0.2191  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 01:16:13] d2.utils.events INFO:  eta: 0:03:16  iter: 299  total_loss: 0.1409  loss_cls: 0.05308  loss_box_reg: 0.05223  loss_rpn_cls: 0.006989  loss_rpn_loc: 0.02397  time: 0.2192  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 01:16:18] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1375  loss_cls: 0.05377  loss_box_reg: 0.05419  loss_rpn_cls: 0.006726  loss_rpn_loc: 0.0208  time: 0.2191  data_time: 0.0190  lr: 0.01  max_mem: 5087M
[11/22 01:16:22] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1387  loss_cls: 0.05275  loss_box_reg: 0.05337  loss_rpn_cls: 0.006514  loss_rpn_loc: 0.02022  time: 0.2194  data_time: 0.0190  lr: 0.01  max_mem: 5087M
[11/22 01:16:27] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1268  loss_cls: 0.05009  loss_box_reg: 0.04984  loss_rpn_cls: 0.00592  loss_rpn_loc: 0.02302  time: 0.2193  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:16:31] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.129  loss_cls: 0.04986  loss_box_reg: 0.0522  loss_rpn_cls: 0.006079  loss_rpn_loc: 0.01857  time: 0.2193  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:16:35] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.1307  loss_cls: 0.04884  loss_box_reg: 0.05092  loss_rpn_cls: 0.006076  loss_rpn_loc: 0.01992  time: 0.2195  data_time: 0.0191  lr: 0.01  max_mem: 5087M
[11/22 01:16:40] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.1304  loss_cls: 0.05258  loss_box_reg: 0.05309  loss_rpn_cls: 0.006021  loss_rpn_loc: 0.01946  time: 0.2196  data_time: 0.0202  lr: 0.01  max_mem: 5087M
[11/22 01:16:44] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.126  loss_cls: 0.04756  loss_box_reg: 0.04934  loss_rpn_cls: 0.005209  loss_rpn_loc: 0.01996  time: 0.2196  data_time: 0.0172  lr: 0.01  max_mem: 5087M
[11/22 01:16:49] d2.utils.events INFO:  eta: 0:02:41  iter: 459  total_loss: 0.1242  loss_cls: 0.0497  loss_box_reg: 0.04514  loss_rpn_cls: 0.005375  loss_rpn_loc: 0.01532  time: 0.2195  data_time: 0.0206  lr: 0.01  max_mem: 5087M
[11/22 01:16:53] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.1218  loss_cls: 0.04972  loss_box_reg: 0.04786  loss_rpn_cls: 0.005071  loss_rpn_loc: 0.01764  time: 0.2196  data_time: 0.0185  lr: 0.01  max_mem: 5087M
[11/22 01:16:58] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1262  loss_cls: 0.04945  loss_box_reg: 0.04769  loss_rpn_cls: 0.004606  loss_rpn_loc: 0.01844  time: 0.2199  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 01:17:02] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.1236  loss_cls: 0.05022  loss_box_reg: 0.04416  loss_rpn_cls: 0.005228  loss_rpn_loc: 0.02001  time: 0.2199  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 01:17:07] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1253  loss_cls: 0.0474  loss_box_reg: 0.04584  loss_rpn_cls: 0.005991  loss_rpn_loc: 0.02412  time: 0.2199  data_time: 0.0205  lr: 0.01  max_mem: 5087M
[11/22 01:17:11] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1185  loss_cls: 0.04504  loss_box_reg: 0.04732  loss_rpn_cls: 0.005457  loss_rpn_loc: 0.02075  time: 0.2199  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 01:17:15] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1166  loss_cls: 0.0452  loss_box_reg: 0.0451  loss_rpn_cls: 0.0061  loss_rpn_loc: 0.01783  time: 0.2199  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:17:20] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1088  loss_cls: 0.04675  loss_box_reg: 0.0434  loss_rpn_cls: 0.004961  loss_rpn_loc: 0.01737  time: 0.2199  data_time: 0.0188  lr: 0.01  max_mem: 5087M
[11/22 01:17:24] d2.utils.events INFO:  eta: 0:02:06  iter: 619  total_loss: 0.1107  loss_cls: 0.04868  loss_box_reg: 0.04535  loss_rpn_cls: 0.0035  loss_rpn_loc: 0.01606  time: 0.2199  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:17:29] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.115  loss_cls: 0.04348  loss_box_reg: 0.04208  loss_rpn_cls: 0.00645  loss_rpn_loc: 0.01721  time: 0.2198  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 01:17:33] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1079  loss_cls: 0.04472  loss_box_reg: 0.04089  loss_rpn_cls: 0.004622  loss_rpn_loc: 0.01597  time: 0.2198  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 01:17:38] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.1139  loss_cls: 0.04667  loss_box_reg: 0.04453  loss_rpn_cls: 0.004684  loss_rpn_loc: 0.01617  time: 0.2198  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 01:17:42] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1041  loss_cls: 0.04499  loss_box_reg: 0.04216  loss_rpn_cls: 0.004938  loss_rpn_loc: 0.01501  time: 0.2200  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 01:17:47] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1086  loss_cls: 0.04285  loss_box_reg: 0.04234  loss_rpn_cls: 0.003708  loss_rpn_loc: 0.01495  time: 0.2200  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 01:17:51] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1069  loss_cls: 0.04623  loss_box_reg: 0.04112  loss_rpn_cls: 0.004438  loss_rpn_loc: 0.01352  time: 0.2200  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 01:17:56] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1078  loss_cls: 0.04191  loss_box_reg: 0.04055  loss_rpn_cls: 0.005054  loss_rpn_loc: 0.01688  time: 0.2200  data_time: 0.0208  lr: 0.01  max_mem: 5087M
[11/22 01:18:00] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.1065  loss_cls: 0.04447  loss_box_reg: 0.04031  loss_rpn_cls: 0.003879  loss_rpn_loc: 0.0174  time: 0.2200  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 01:18:04] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.1089  loss_cls: 0.04415  loss_box_reg: 0.04086  loss_rpn_cls: 0.004709  loss_rpn_loc: 0.01566  time: 0.2200  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:18:09] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1052  loss_cls: 0.04278  loss_box_reg: 0.04191  loss_rpn_cls: 0.00461  loss_rpn_loc: 0.01478  time: 0.2200  data_time: 0.0175  lr: 0.01  max_mem: 5087M
[11/22 01:18:13] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.1028  loss_cls: 0.04438  loss_box_reg: 0.04118  loss_rpn_cls: 0.004106  loss_rpn_loc: 0.01381  time: 0.2200  data_time: 0.0179  lr: 0.01  max_mem: 5087M
[11/22 01:18:18] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.104  loss_cls: 0.04552  loss_box_reg: 0.04082  loss_rpn_cls: 0.003816  loss_rpn_loc: 0.01483  time: 0.2199  data_time: 0.0181  lr: 0.01  max_mem: 5087M
[11/22 01:18:22] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.1057  loss_cls: 0.04239  loss_box_reg: 0.04095  loss_rpn_cls: 0.003814  loss_rpn_loc: 0.01528  time: 0.2199  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 01:18:27] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.1014  loss_cls: 0.04329  loss_box_reg: 0.0408  loss_rpn_cls: 0.004322  loss_rpn_loc: 0.01302  time: 0.2200  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 01:18:31] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.1057  loss_cls: 0.04322  loss_box_reg: 0.03876  loss_rpn_cls: 0.003001  loss_rpn_loc: 0.01463  time: 0.2199  data_time: 0.0200  lr: 0.01  max_mem: 5087M
[11/22 01:18:35] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.1001  loss_cls: 0.04159  loss_box_reg: 0.03804  loss_rpn_cls: 0.003881  loss_rpn_loc: 0.01265  time: 0.2199  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:18:40] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09934  loss_cls: 0.04217  loss_box_reg: 0.03902  loss_rpn_cls: 0.003481  loss_rpn_loc: 0.01246  time: 0.2198  data_time: 0.0185  lr: 0.01  max_mem: 5087M
[11/22 01:18:44] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09712  loss_cls: 0.04197  loss_box_reg: 0.03604  loss_rpn_cls: 0.003589  loss_rpn_loc: 0.01023  time: 0.2198  data_time: 0.0181  lr: 0.001  max_mem: 5087M
[11/22 01:18:49] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.09255  loss_cls: 0.04155  loss_box_reg: 0.03609  loss_rpn_cls: 0.003921  loss_rpn_loc: 0.009762  time: 0.2199  data_time: 0.0197  lr: 0.001  max_mem: 5087M
[11/22 01:18:53] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.09509  loss_cls: 0.04067  loss_box_reg: 0.03529  loss_rpn_cls: 0.004048  loss_rpn_loc: 0.009699  time: 0.2198  data_time: 0.0196  lr: 0.001  max_mem: 5087M
[11/22 01:18:57] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.09137  loss_cls: 0.03826  loss_box_reg: 0.03596  loss_rpn_cls: 0.00374  loss_rpn_loc: 0.008854  time: 0.2198  data_time: 0.0193  lr: 0.001  max_mem: 5087M
[11/22 01:19:02] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.09339  loss_cls: 0.04198  loss_box_reg: 0.03885  loss_rpn_cls: 0.003847  loss_rpn_loc: 0.008297  time: 0.2198  data_time: 0.0224  lr: 0.001  max_mem: 5087M
[11/22 01:19:06] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.09171  loss_cls: 0.04191  loss_box_reg: 0.03523  loss_rpn_cls: 0.003251  loss_rpn_loc: 0.007148  time: 0.2198  data_time: 0.0201  lr: 0.001  max_mem: 5087M
[11/22 01:19:11] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08964  loss_cls: 0.04343  loss_box_reg: 0.03709  loss_rpn_cls: 0.003255  loss_rpn_loc: 0.006875  time: 0.2198  data_time: 0.0176  lr: 0.001  max_mem: 5087M
[11/22 01:19:15] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.09525  loss_cls: 0.04457  loss_box_reg: 0.0388  loss_rpn_cls: 0.004385  loss_rpn_loc: 0.01031  time: 0.2198  data_time: 0.0171  lr: 0.001  max_mem: 5087M
[11/22 01:19:19] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.09458  loss_cls: 0.04404  loss_box_reg: 0.03813  loss_rpn_cls: 0.003863  loss_rpn_loc: 0.007643  time: 0.2198  data_time: 0.0188  lr: 0.001  max_mem: 5087M
[11/22 01:19:24] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.09376  loss_cls: 0.04039  loss_box_reg: 0.03613  loss_rpn_cls: 0.003512  loss_rpn_loc: 0.008688  time: 0.2198  data_time: 0.0178  lr: 0.001  max_mem: 5087M
[11/22 01:19:28] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.09347  loss_cls: 0.0413  loss_box_reg: 0.03709  loss_rpn_cls: 0.003967  loss_rpn_loc: 0.009338  time: 0.2197  data_time: 0.0171  lr: 0.001  max_mem: 5087M
[11/22 01:19:33] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:19:35] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.09234  loss_cls: 0.04121  loss_box_reg: 0.03733  loss_rpn_cls: 0.003607  loss_rpn_loc: 0.008789  time: 0.2197  data_time: 0.0177  lr: 0.001  max_mem: 5087M
[11/22 01:19:35] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:23 (0.2197 s / it)
[11/22 01:19:35] d2.engine.hooks INFO: Total training time: 0:04:27 (0:00:03 on hooks)
[11/22 01:19:37] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:19:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:19:37] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:19:37] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:19:37] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:19:37] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:19:38] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:19:38] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:19:38] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:19:38] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:19:51] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0617 s / img. ETA=0:01:13
[11/22 01:19:54] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0610 s / img. ETA=0:01:09
[11/22 01:19:57] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0610 s / img. ETA=0:01:06
[11/22 01:20:00] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0609 s / img. ETA=0:01:03
[11/22 01:20:03] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0614 s / img. ETA=0:01:00
[11/22 01:20:07] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0619 s / img. ETA=0:00:58
[11/22 01:20:10] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0619 s / img. ETA=0:00:54
[11/22 01:20:13] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0618 s / img. ETA=0:00:51
[11/22 01:20:16] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0617 s / img. ETA=0:00:48
[11/22 01:20:19] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0615 s / img. ETA=0:00:45
[11/22 01:20:22] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0613 s / img. ETA=0:00:42
[11/22 01:20:25] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0612 s / img. ETA=0:00:39
[11/22 01:20:28] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0610 s / img. ETA=0:00:35
[11/22 01:20:31] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0608 s / img. ETA=0:00:32
[11/22 01:20:34] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0607 s / img. ETA=0:00:29
[11/22 01:20:37] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0605 s / img. ETA=0:00:26
[11/22 01:20:39] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0604 s / img. ETA=0:00:23
[11/22 01:20:42] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0603 s / img. ETA=0:00:20
[11/22 01:20:45] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0602 s / img. ETA=0:00:17
[11/22 01:20:48] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0601 s / img. ETA=0:00:14
[11/22 01:20:51] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0601 s / img. ETA=0:00:11
[11/22 01:20:54] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0600 s / img. ETA=0:00:08
[11/22 01:20:57] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0599 s / img. ETA=0:00:05
[11/22 01:21:00] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0599 s / img. ETA=0:00:02
[11/22 01:21:03] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 01:21:03] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:11 (0.057984 s / img per device, on 4 devices)
[11/22 01:21:03] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:21:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 52.295 | 69.645 | 49.141 |   59.556    | 51.142 |
[11/22 01:21:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.189 | 56.356 | 30.441 | 31.189 | 56.356  | 30.441  |
[11/22 01:21:10] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:21:10] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:21:10] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:21:10] defrcn.evaluation.testing INFO: copypaste: 31.1889,56.3559,30.4409,31.1889,56.3559,30.4409
[11/22 01:21:28] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:21:28] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:21:28] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:21:28] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:21:28] d2.utils.env INFO: Using a generated random seed 30762052
[11/22 01:21:28] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:21:28] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:21:30] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:21:30] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:21:30] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:21:30] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:21:30] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:21:30] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:21:31] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:21:31] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:21:31] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:21:31] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:21:33] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:21:46] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0636 s / img. ETA=0:01:15
[11/22 01:21:49] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0617 s / img. ETA=0:01:10
[11/22 01:21:52] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0612 s / img. ETA=0:01:06
[11/22 01:21:55] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0609 s / img. ETA=0:01:03
[11/22 01:21:58] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0606 s / img. ETA=0:00:59
[11/22 01:22:01] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0605 s / img. ETA=0:00:56
[11/22 01:22:04] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0603 s / img. ETA=0:00:53
[11/22 01:22:07] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0601 s / img. ETA=0:00:50
[11/22 01:22:10] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0600 s / img. ETA=0:00:47
[11/22 01:22:13] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0599 s / img. ETA=0:00:44
[11/22 01:22:16] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0598 s / img. ETA=0:00:41
[11/22 01:22:19] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0599 s / img. ETA=0:00:38
[11/22 01:22:22] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0598 s / img. ETA=0:00:35
[11/22 01:22:25] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0597 s / img. ETA=0:00:32
[11/22 01:22:28] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0597 s / img. ETA=0:00:29
[11/22 01:22:31] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0597 s / img. ETA=0:00:26
[11/22 01:22:34] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0597 s / img. ETA=0:00:23
[11/22 01:22:37] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0597 s / img. ETA=0:00:20
[11/22 01:22:40] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0597 s / img. ETA=0:00:17
[11/22 01:22:43] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0597 s / img. ETA=0:00:14
[11/22 01:22:46] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0597 s / img. ETA=0:00:11
[11/22 01:22:49] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0597 s / img. ETA=0:00:08
[11/22 01:22:52] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0597 s / img. ETA=0:00:05
[11/22 01:22:55] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0597 s / img. ETA=0:00:02
[11/22 01:22:57] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 01:22:57] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.057308 s / img per device, on 4 devices)
[11/22 01:23:03] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:23:28] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   86.052    |  86.784   | 73.506 |  73.931  | 88.600 | 88.511 | 69.570  |    74.808     | 87.073 | 84.654  |  86.261  |    56.590     | 80.867  | 85.247  |   82.584    | 56.374 | 70.162 | 53.599 |   61.928    | 50.361 |
[11/22 01:23:28] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.691 | 74.873 | 50.947 | 53.529 | 80.336  | 59.136  | 30.177 | 58.485  | 26.379  |
[11/22 01:23:28] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:23:28] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:23:28] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:23:28] defrcn.evaluation.testing INFO: copypaste: 47.6914,74.8732,50.9465,53.5294,80.3360,59.1357,30.1775,58.4850,26.3791
[11/22 01:23:41] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:23:41] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:23:41] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:23:41] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:23:41] d2.utils.env INFO: Using a generated random seed 43926203
[11/22 01:23:41] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:23:41] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:23:41] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:23:41] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:23:41] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:23:42] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:23:42] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:23:42] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:23:42] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:23:50] d2.utils.events INFO:  eta: 0:04:18  iter: 19  total_loss: 0.5877  loss_cls: 0.3299  loss_box_reg: 0.1615  loss_rpn_cls: 0.04683  loss_rpn_loc: 0.04954  time: 0.2204  data_time: 0.1991  lr: 0.01  max_mem: 5088M
[11/22 01:23:54] d2.utils.events INFO:  eta: 0:04:13  iter: 39  total_loss: 0.3741  loss_cls: 0.1519  loss_box_reg: 0.1492  loss_rpn_cls: 0.02749  loss_rpn_loc: 0.04538  time: 0.2199  data_time: 0.0189  lr: 0.01  max_mem: 5088M
[11/22 01:23:59] d2.utils.events INFO:  eta: 0:04:07  iter: 59  total_loss: 0.2855  loss_cls: 0.1084  loss_box_reg: 0.1213  loss_rpn_cls: 0.01991  loss_rpn_loc: 0.03179  time: 0.2182  data_time: 0.0203  lr: 0.01  max_mem: 5088M
[11/22 01:24:03] d2.utils.events INFO:  eta: 0:04:03  iter: 79  total_loss: 0.2383  loss_cls: 0.07944  loss_box_reg: 0.1021  loss_rpn_cls: 0.01747  loss_rpn_loc: 0.03408  time: 0.2183  data_time: 0.0212  lr: 0.01  max_mem: 5088M
[11/22 01:24:07] d2.utils.events INFO:  eta: 0:03:59  iter: 99  total_loss: 0.2154  loss_cls: 0.08348  loss_box_reg: 0.08926  loss_rpn_cls: 0.01192  loss_rpn_loc: 0.03105  time: 0.2184  data_time: 0.0231  lr: 0.01  max_mem: 5088M
[11/22 01:24:12] d2.utils.events INFO:  eta: 0:03:55  iter: 119  total_loss: 0.1911  loss_cls: 0.06851  loss_box_reg: 0.07896  loss_rpn_cls: 0.01314  loss_rpn_loc: 0.02998  time: 0.2180  data_time: 0.0234  lr: 0.01  max_mem: 5088M
[11/22 01:24:16] d2.utils.events INFO:  eta: 0:03:51  iter: 139  total_loss: 0.1793  loss_cls: 0.06681  loss_box_reg: 0.07106  loss_rpn_cls: 0.009295  loss_rpn_loc: 0.02578  time: 0.2187  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 01:24:21] d2.utils.events INFO:  eta: 0:03:47  iter: 159  total_loss: 0.1692  loss_cls: 0.06187  loss_box_reg: 0.0655  loss_rpn_cls: 0.01025  loss_rpn_loc: 0.02805  time: 0.2189  data_time: 0.0228  lr: 0.01  max_mem: 5088M
[11/22 01:24:25] d2.utils.events INFO:  eta: 0:03:43  iter: 179  total_loss: 0.1613  loss_cls: 0.06186  loss_box_reg: 0.06177  loss_rpn_cls: 0.00972  loss_rpn_loc: 0.02523  time: 0.2191  data_time: 0.0212  lr: 0.01  max_mem: 5088M
[11/22 01:24:29] d2.utils.events INFO:  eta: 0:03:38  iter: 199  total_loss: 0.1511  loss_cls: 0.05669  loss_box_reg: 0.05906  loss_rpn_cls: 0.008902  loss_rpn_loc: 0.02891  time: 0.2192  data_time: 0.0220  lr: 0.01  max_mem: 5088M
[11/22 01:24:34] d2.utils.events INFO:  eta: 0:03:34  iter: 219  total_loss: 0.1425  loss_cls: 0.05355  loss_box_reg: 0.05467  loss_rpn_cls: 0.008334  loss_rpn_loc: 0.02367  time: 0.2192  data_time: 0.0232  lr: 0.01  max_mem: 5088M
[11/22 01:24:38] d2.utils.events INFO:  eta: 0:03:30  iter: 239  total_loss: 0.1356  loss_cls: 0.05064  loss_box_reg: 0.05253  loss_rpn_cls: 0.007756  loss_rpn_loc: 0.02106  time: 0.2194  data_time: 0.0226  lr: 0.01  max_mem: 5088M
[11/22 01:24:43] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.1415  loss_cls: 0.05191  loss_box_reg: 0.05507  loss_rpn_cls: 0.006829  loss_rpn_loc: 0.02069  time: 0.2194  data_time: 0.0194  lr: 0.01  max_mem: 5088M
[11/22 01:24:47] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.14  loss_cls: 0.05175  loss_box_reg: 0.0536  loss_rpn_cls: 0.007829  loss_rpn_loc: 0.02157  time: 0.2194  data_time: 0.0186  lr: 0.01  max_mem: 5088M
[11/22 01:24:52] d2.utils.events INFO:  eta: 0:03:17  iter: 299  total_loss: 0.13  loss_cls: 0.04982  loss_box_reg: 0.04904  loss_rpn_cls: 0.005752  loss_rpn_loc: 0.01964  time: 0.2194  data_time: 0.0202  lr: 0.01  max_mem: 5088M
[11/22 01:24:56] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1291  loss_cls: 0.05141  loss_box_reg: 0.04819  loss_rpn_cls: 0.005454  loss_rpn_loc: 0.02593  time: 0.2197  data_time: 0.0184  lr: 0.01  max_mem: 5088M
[11/22 01:25:00] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1289  loss_cls: 0.04789  loss_box_reg: 0.05015  loss_rpn_cls: 0.006223  loss_rpn_loc: 0.02031  time: 0.2195  data_time: 0.0197  lr: 0.01  max_mem: 5088M
[11/22 01:25:05] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1203  loss_cls: 0.04683  loss_box_reg: 0.04738  loss_rpn_cls: 0.005989  loss_rpn_loc: 0.0235  time: 0.2194  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 01:25:09] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.125  loss_cls: 0.0467  loss_box_reg: 0.04546  loss_rpn_cls: 0.007695  loss_rpn_loc: 0.0219  time: 0.2194  data_time: 0.0212  lr: 0.01  max_mem: 5088M
[11/22 01:25:14] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.1222  loss_cls: 0.04705  loss_box_reg: 0.04787  loss_rpn_cls: 0.005684  loss_rpn_loc: 0.01723  time: 0.2195  data_time: 0.0207  lr: 0.01  max_mem: 5088M
[11/22 01:25:18] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.1243  loss_cls: 0.04686  loss_box_reg: 0.0482  loss_rpn_cls: 0.005822  loss_rpn_loc: 0.01846  time: 0.2195  data_time: 0.0191  lr: 0.01  max_mem: 5088M
[11/22 01:25:22] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1215  loss_cls: 0.04662  loss_box_reg: 0.04765  loss_rpn_cls: 0.004894  loss_rpn_loc: 0.01791  time: 0.2196  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 01:25:27] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1182  loss_cls: 0.04756  loss_box_reg: 0.04356  loss_rpn_cls: 0.005668  loss_rpn_loc: 0.01826  time: 0.2197  data_time: 0.0186  lr: 0.01  max_mem: 5088M
[11/22 01:25:31] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.1181  loss_cls: 0.04548  loss_box_reg: 0.04563  loss_rpn_cls: 0.005215  loss_rpn_loc: 0.01837  time: 0.2196  data_time: 0.0186  lr: 0.01  max_mem: 5088M
[11/22 01:25:36] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1102  loss_cls: 0.04381  loss_box_reg: 0.04272  loss_rpn_cls: 0.005232  loss_rpn_loc: 0.01962  time: 0.2197  data_time: 0.0197  lr: 0.01  max_mem: 5088M
[11/22 01:25:40] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.1106  loss_cls: 0.04579  loss_box_reg: 0.04238  loss_rpn_cls: 0.006095  loss_rpn_loc: 0.01922  time: 0.2197  data_time: 0.0198  lr: 0.01  max_mem: 5088M
[11/22 01:25:45] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1122  loss_cls: 0.04344  loss_box_reg: 0.04342  loss_rpn_cls: 0.005858  loss_rpn_loc: 0.01871  time: 0.2196  data_time: 0.0227  lr: 0.01  max_mem: 5088M
[11/22 01:25:49] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1108  loss_cls: 0.04384  loss_box_reg: 0.04285  loss_rpn_cls: 0.003846  loss_rpn_loc: 0.01468  time: 0.2195  data_time: 0.0207  lr: 0.01  max_mem: 5088M
[11/22 01:25:53] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1047  loss_cls: 0.04341  loss_box_reg: 0.04147  loss_rpn_cls: 0.004274  loss_rpn_loc: 0.01521  time: 0.2196  data_time: 0.0200  lr: 0.01  max_mem: 5088M
[11/22 01:25:58] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1065  loss_cls: 0.04263  loss_box_reg: 0.04111  loss_rpn_cls: 0.003404  loss_rpn_loc: 0.01592  time: 0.2195  data_time: 0.0200  lr: 0.01  max_mem: 5088M
[11/22 01:26:02] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1015  loss_cls: 0.04118  loss_box_reg: 0.03921  loss_rpn_cls: 0.004462  loss_rpn_loc: 0.01431  time: 0.2195  data_time: 0.0218  lr: 0.01  max_mem: 5088M
[11/22 01:26:07] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1001  loss_cls: 0.04233  loss_box_reg: 0.04008  loss_rpn_cls: 0.004003  loss_rpn_loc: 0.01403  time: 0.2195  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 01:26:15] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1092  loss_cls: 0.04244  loss_box_reg: 0.03891  loss_rpn_cls: 0.003951  loss_rpn_loc: 0.01884  time: 0.2258  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 01:26:20] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.11  loss_cls: 0.04301  loss_box_reg: 0.04179  loss_rpn_cls: 0.004419  loss_rpn_loc: 0.01739  time: 0.2256  data_time: 0.0225  lr: 0.01  max_mem: 5088M
[11/22 01:26:24] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1033  loss_cls: 0.04251  loss_box_reg: 0.0403  loss_rpn_cls: 0.004181  loss_rpn_loc: 0.01378  time: 0.2254  data_time: 0.0189  lr: 0.01  max_mem: 5088M
[11/22 01:26:28] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1029  loss_cls: 0.04109  loss_box_reg: 0.04005  loss_rpn_cls: 0.003824  loss_rpn_loc: 0.01793  time: 0.2253  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 01:26:33] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1006  loss_cls: 0.04003  loss_box_reg: 0.03913  loss_rpn_cls: 0.004047  loss_rpn_loc: 0.01628  time: 0.2251  data_time: 0.0217  lr: 0.01  max_mem: 5088M
[11/22 01:26:37] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1008  loss_cls: 0.03788  loss_box_reg: 0.03741  loss_rpn_cls: 0.003995  loss_rpn_loc: 0.01717  time: 0.2250  data_time: 0.0210  lr: 0.01  max_mem: 5088M
[11/22 01:26:42] d2.utils.events INFO:  eta: 0:01:31  iter: 779  total_loss: 0.1047  loss_cls: 0.03951  loss_box_reg: 0.03888  loss_rpn_cls: 0.003621  loss_rpn_loc: 0.01657  time: 0.2248  data_time: 0.0193  lr: 0.01  max_mem: 5088M
[11/22 01:26:46] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.1054  loss_cls: 0.04017  loss_box_reg: 0.03923  loss_rpn_cls: 0.004717  loss_rpn_loc: 0.01807  time: 0.2249  data_time: 0.0197  lr: 0.01  max_mem: 5088M
[11/22 01:26:50] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.107  loss_cls: 0.04044  loss_box_reg: 0.04062  loss_rpn_cls: 0.004781  loss_rpn_loc: 0.01618  time: 0.2247  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 01:26:55] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09867  loss_cls: 0.04021  loss_box_reg: 0.03525  loss_rpn_cls: 0.003866  loss_rpn_loc: 0.01542  time: 0.2245  data_time: 0.0187  lr: 0.01  max_mem: 5088M
[11/22 01:26:59] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.09958  loss_cls: 0.0411  loss_box_reg: 0.03958  loss_rpn_cls: 0.004073  loss_rpn_loc: 0.01523  time: 0.2245  data_time: 0.0213  lr: 0.01  max_mem: 5088M
[11/22 01:27:04] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.0942  loss_cls: 0.03873  loss_box_reg: 0.03417  loss_rpn_cls: 0.003546  loss_rpn_loc: 0.01696  time: 0.2243  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 01:27:08] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09711  loss_cls: 0.03753  loss_box_reg: 0.03345  loss_rpn_cls: 0.003652  loss_rpn_loc: 0.01969  time: 0.2243  data_time: 0.0202  lr: 0.01  max_mem: 5088M
[11/22 01:27:13] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09614  loss_cls: 0.03917  loss_box_reg: 0.03638  loss_rpn_cls: 0.004737  loss_rpn_loc: 0.01625  time: 0.2241  data_time: 0.0190  lr: 0.01  max_mem: 5088M
[11/22 01:27:17] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09513  loss_cls: 0.0401  loss_box_reg: 0.03557  loss_rpn_cls: 0.004361  loss_rpn_loc: 0.01462  time: 0.2240  data_time: 0.0207  lr: 0.01  max_mem: 5088M
[11/22 01:27:21] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09115  loss_cls: 0.03704  loss_box_reg: 0.0331  loss_rpn_cls: 0.003936  loss_rpn_loc: 0.01482  time: 0.2240  data_time: 0.0184  lr: 0.01  max_mem: 5088M
[11/22 01:27:26] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09105  loss_cls: 0.03655  loss_box_reg: 0.035  loss_rpn_cls: 0.003931  loss_rpn_loc: 0.0114  time: 0.2239  data_time: 0.0209  lr: 0.001  max_mem: 5088M
[11/22 01:27:30] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08728  loss_cls: 0.03871  loss_box_reg: 0.03445  loss_rpn_cls: 0.002729  loss_rpn_loc: 0.007485  time: 0.2238  data_time: 0.0182  lr: 0.001  max_mem: 5088M
[11/22 01:27:35] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08419  loss_cls: 0.03825  loss_box_reg: 0.03203  loss_rpn_cls: 0.003282  loss_rpn_loc: 0.007775  time: 0.2238  data_time: 0.0189  lr: 0.001  max_mem: 5088M
[11/22 01:27:39] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08696  loss_cls: 0.04013  loss_box_reg: 0.03367  loss_rpn_cls: 0.003404  loss_rpn_loc: 0.00807  time: 0.2237  data_time: 0.0205  lr: 0.001  max_mem: 5088M
[11/22 01:27:44] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08555  loss_cls: 0.03799  loss_box_reg: 0.03445  loss_rpn_cls: 0.003911  loss_rpn_loc: 0.009332  time: 0.2237  data_time: 0.0210  lr: 0.001  max_mem: 5088M
[11/22 01:27:48] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08524  loss_cls: 0.03958  loss_box_reg: 0.0331  loss_rpn_cls: 0.003395  loss_rpn_loc: 0.007987  time: 0.2236  data_time: 0.0216  lr: 0.001  max_mem: 5088M
[11/22 01:27:52] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08831  loss_cls: 0.04039  loss_box_reg: 0.03395  loss_rpn_cls: 0.003133  loss_rpn_loc: 0.008653  time: 0.2235  data_time: 0.0189  lr: 0.001  max_mem: 5088M
[11/22 01:27:57] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08647  loss_cls: 0.03962  loss_box_reg: 0.0355  loss_rpn_cls: 0.003034  loss_rpn_loc: 0.007965  time: 0.2234  data_time: 0.0187  lr: 0.001  max_mem: 5088M
[11/22 01:28:01] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08503  loss_cls: 0.03797  loss_box_reg: 0.03285  loss_rpn_cls: 0.003339  loss_rpn_loc: 0.009215  time: 0.2233  data_time: 0.0196  lr: 0.001  max_mem: 5088M
[11/22 01:28:06] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08321  loss_cls: 0.03734  loss_box_reg: 0.03455  loss_rpn_cls: 0.003164  loss_rpn_loc: 0.007168  time: 0.2233  data_time: 0.0194  lr: 0.001  max_mem: 5088M
[11/22 01:28:10] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08534  loss_cls: 0.03889  loss_box_reg: 0.03255  loss_rpn_cls: 0.002657  loss_rpn_loc: 0.007442  time: 0.2232  data_time: 0.0191  lr: 0.001  max_mem: 5088M
[11/22 01:28:14] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:28:16] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08287  loss_cls: 0.03864  loss_box_reg: 0.03211  loss_rpn_cls: 0.002756  loss_rpn_loc: 0.006998  time: 0.2232  data_time: 0.0194  lr: 0.001  max_mem: 5088M
[11/22 01:28:16] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:27 (0.2232 s / it)
[11/22 01:28:16] d2.engine.hooks INFO: Total training time: 0:04:29 (0:00:02 on hooks)
[11/22 01:28:17] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:28:17] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:28:17] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:28:17] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:28:17] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:28:17] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:28:18] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:28:18] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:28:18] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:28:19] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:28:32] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0654 s / img. ETA=0:01:17
[11/22 01:28:35] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0627 s / img. ETA=0:01:11
[11/22 01:28:38] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0622 s / img. ETA=0:01:07
[11/22 01:28:41] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0623 s / img. ETA=0:01:04
[11/22 01:28:44] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0622 s / img. ETA=0:01:01
[11/22 01:28:47] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0623 s / img. ETA=0:00:58
[11/22 01:28:50] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0622 s / img. ETA=0:00:55
[11/22 01:28:53] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0621 s / img. ETA=0:00:52
[11/22 01:28:56] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0620 s / img. ETA=0:00:48
[11/22 01:29:00] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0619 s / img. ETA=0:00:45
[11/22 01:29:03] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0618 s / img. ETA=0:00:42
[11/22 01:29:06] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0619 s / img. ETA=0:00:39
[11/22 01:29:09] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0617 s / img. ETA=0:00:36
[11/22 01:29:12] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0617 s / img. ETA=0:00:33
[11/22 01:29:15] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0617 s / img. ETA=0:00:30
[11/22 01:29:18] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0616 s / img. ETA=0:00:26
[11/22 01:29:21] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0616 s / img. ETA=0:00:23
[11/22 01:29:24] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0615 s / img. ETA=0:00:20
[11/22 01:29:27] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0614 s / img. ETA=0:00:17
[11/22 01:29:30] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0613 s / img. ETA=0:00:14
[11/22 01:29:33] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0613 s / img. ETA=0:00:11
[11/22 01:29:36] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0614 s / img. ETA=0:00:08
[11/22 01:29:39] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0614 s / img. ETA=0:00:05
[11/22 01:29:42] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0615 s / img. ETA=0:00:02
[11/22 01:29:45] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:16 (0.061638 s / img per device, on 4 devices)
[11/22 01:29:45] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:13 (0.059523 s / img per device, on 4 devices)
[11/22 01:29:45] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:29:52] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 52.590 | 69.690 | 50.630 |   57.990    | 52.346 |
[11/22 01:29:52] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.705 | 56.649 | 30.774 | 31.705 | 56.649  | 30.774  |
[11/22 01:29:52] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:29:52] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:29:52] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:29:52] defrcn.evaluation.testing INFO: copypaste: 31.7054,56.6490,30.7737,31.7054,56.6490,30.7737
[11/22 01:30:08] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:30:08] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:30:08] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:30:08] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:30:08] d2.utils.env INFO: Using a generated random seed 11633946
[11/22 01:30:09] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:30:09] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:30:11] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:30:11] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:30:11] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:30:11] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:30:11] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:30:11] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:30:13] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:30:13] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:30:13] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:30:13] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:30:15] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:30:28] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0662 s / img. ETA=0:01:18
[11/22 01:30:31] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0625 s / img. ETA=0:01:11
[11/22 01:30:34] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0628 s / img. ETA=0:01:08
[11/22 01:30:37] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0631 s / img. ETA=0:01:05
[11/22 01:30:41] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0632 s / img. ETA=0:01:02
[11/22 01:30:44] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0635 s / img. ETA=0:00:59
[11/22 01:30:47] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0634 s / img. ETA=0:00:56
[11/22 01:30:50] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0635 s / img. ETA=0:00:53
[11/22 01:30:54] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0637 s / img. ETA=0:00:50
[11/22 01:30:57] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0636 s / img. ETA=0:00:46
[11/22 01:31:00] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0635 s / img. ETA=0:00:43
[11/22 01:31:03] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0636 s / img. ETA=0:00:40
[11/22 01:31:06] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0635 s / img. ETA=0:00:37
[11/22 01:31:09] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0635 s / img. ETA=0:00:34
[11/22 01:31:12] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0635 s / img. ETA=0:00:30
[11/22 01:31:16] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0635 s / img. ETA=0:00:27
[11/22 01:31:19] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0637 s / img. ETA=0:00:24
[11/22 01:31:22] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0638 s / img. ETA=0:00:21
[11/22 01:31:25] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0638 s / img. ETA=0:00:18
[11/22 01:31:29] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0637 s / img. ETA=0:00:15
[11/22 01:31:32] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0636 s / img. ETA=0:00:11
[11/22 01:31:35] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0637 s / img. ETA=0:00:08
[11/22 01:31:38] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0637 s / img. ETA=0:00:05
[11/22 01:31:41] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0637 s / img. ETA=0:00:02
[11/22 01:31:44] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:19 (0.064071 s / img per device, on 4 devices)
[11/22 01:31:44] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:14 (0.060804 s / img per device, on 4 devices)
[11/22 01:31:44] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:32:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.913    |  86.549   | 73.004 |  74.132  | 88.538 | 88.232 | 70.069  |    75.143     | 86.748 | 84.727  |  85.734  |    55.476     | 81.409  | 84.812  |   82.274    | 60.426 | 69.765 | 58.008 |   59.480    | 51.458 |
[11/22 01:32:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.674 | 75.045 | 50.616 | 53.070 | 80.117  | 58.290  | 31.487 | 59.827  | 27.595  |
[11/22 01:32:10] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:32:10] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:32:10] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:32:10] defrcn.evaluation.testing INFO: copypaste: 47.6744,75.0447,50.6159,53.0701,80.1173,58.2896,31.4873,59.8272,27.5949
[11/22 01:32:21] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:32:21] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:32:21] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:32:21] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:32:21] d2.utils.env INFO: Using a generated random seed 24513073
[11/22 01:32:22] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:32:22] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:32:22] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:32:22] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:32:22] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:32:22] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:32:22] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:32:22] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:32:23] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:32:31] d2.utils.events INFO:  eta: 0:04:18  iter: 19  total_loss: 0.6048  loss_cls: 0.3603  loss_box_reg: 0.1668  loss_rpn_cls: 0.04418  loss_rpn_loc: 0.04618  time: 0.2208  data_time: 0.2277  lr: 0.01  max_mem: 5086M
[11/22 01:32:35] d2.utils.events INFO:  eta: 0:04:13  iter: 39  total_loss: 0.3661  loss_cls: 0.1456  loss_box_reg: 0.1439  loss_rpn_cls: 0.02795  loss_rpn_loc: 0.04296  time: 0.2199  data_time: 0.0194  lr: 0.01  max_mem: 5086M
[11/22 01:32:40] d2.utils.events INFO:  eta: 0:04:10  iter: 59  total_loss: 0.288  loss_cls: 0.1051  loss_box_reg: 0.1299  loss_rpn_cls: 0.01777  loss_rpn_loc: 0.02842  time: 0.2195  data_time: 0.0211  lr: 0.01  max_mem: 5086M
[11/22 01:32:44] d2.utils.events INFO:  eta: 0:04:05  iter: 79  total_loss: 0.2483  loss_cls: 0.08796  loss_box_reg: 0.1078  loss_rpn_cls: 0.01563  loss_rpn_loc: 0.03111  time: 0.2199  data_time: 0.0223  lr: 0.01  max_mem: 5086M
[11/22 01:32:49] d2.utils.events INFO:  eta: 0:04:01  iter: 99  total_loss: 0.2184  loss_cls: 0.07797  loss_box_reg: 0.09237  loss_rpn_cls: 0.01283  loss_rpn_loc: 0.033  time: 0.2200  data_time: 0.0208  lr: 0.01  max_mem: 5086M
[11/22 01:32:53] d2.utils.events INFO:  eta: 0:03:56  iter: 119  total_loss: 0.1976  loss_cls: 0.07155  loss_box_reg: 0.08288  loss_rpn_cls: 0.01157  loss_rpn_loc: 0.03201  time: 0.2200  data_time: 0.0212  lr: 0.01  max_mem: 5086M
[11/22 01:32:58] d2.utils.events INFO:  eta: 0:03:52  iter: 139  total_loss: 0.1828  loss_cls: 0.06733  loss_box_reg: 0.0742  loss_rpn_cls: 0.01115  loss_rpn_loc: 0.02344  time: 0.2200  data_time: 0.0202  lr: 0.01  max_mem: 5086M
[11/22 01:33:02] d2.utils.events INFO:  eta: 0:03:48  iter: 159  total_loss: 0.1759  loss_cls: 0.06749  loss_box_reg: 0.06732  loss_rpn_cls: 0.009772  loss_rpn_loc: 0.02853  time: 0.2201  data_time: 0.0232  lr: 0.01  max_mem: 5086M
[11/22 01:33:07] d2.utils.events INFO:  eta: 0:03:43  iter: 179  total_loss: 0.1662  loss_cls: 0.06038  loss_box_reg: 0.06196  loss_rpn_cls: 0.009696  loss_rpn_loc: 0.02437  time: 0.2198  data_time: 0.0196  lr: 0.01  max_mem: 5086M
[11/22 01:33:11] d2.utils.events INFO:  eta: 0:03:39  iter: 199  total_loss: 0.1533  loss_cls: 0.05756  loss_box_reg: 0.05715  loss_rpn_cls: 0.009324  loss_rpn_loc: 0.03066  time: 0.2199  data_time: 0.0222  lr: 0.01  max_mem: 5086M
[11/22 01:33:15] d2.utils.events INFO:  eta: 0:03:34  iter: 219  total_loss: 0.1533  loss_cls: 0.05631  loss_box_reg: 0.0571  loss_rpn_cls: 0.008259  loss_rpn_loc: 0.02974  time: 0.2197  data_time: 0.0206  lr: 0.01  max_mem: 5086M
[11/22 01:33:20] d2.utils.events INFO:  eta: 0:03:30  iter: 239  total_loss: 0.1523  loss_cls: 0.0581  loss_box_reg: 0.05817  loss_rpn_cls: 0.007183  loss_rpn_loc: 0.0251  time: 0.2198  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:33:24] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.1381  loss_cls: 0.0535  loss_box_reg: 0.05293  loss_rpn_cls: 0.006692  loss_rpn_loc: 0.01999  time: 0.2197  data_time: 0.0212  lr: 0.01  max_mem: 5086M
[11/22 01:33:29] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.1372  loss_cls: 0.05156  loss_box_reg: 0.05132  loss_rpn_cls: 0.006132  loss_rpn_loc: 0.01942  time: 0.2196  data_time: 0.0231  lr: 0.01  max_mem: 5086M
[11/22 01:33:33] d2.utils.events INFO:  eta: 0:03:17  iter: 299  total_loss: 0.1331  loss_cls: 0.05265  loss_box_reg: 0.05298  loss_rpn_cls: 0.00499  loss_rpn_loc: 0.01899  time: 0.2196  data_time: 0.0216  lr: 0.01  max_mem: 5086M
[11/22 01:33:37] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1297  loss_cls: 0.0497  loss_box_reg: 0.04921  loss_rpn_cls: 0.005702  loss_rpn_loc: 0.02158  time: 0.2196  data_time: 0.0203  lr: 0.01  max_mem: 5086M
[11/22 01:33:42] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1359  loss_cls: 0.05261  loss_box_reg: 0.05084  loss_rpn_cls: 0.006318  loss_rpn_loc: 0.02606  time: 0.2197  data_time: 0.0198  lr: 0.01  max_mem: 5086M
[11/22 01:33:46] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1263  loss_cls: 0.05036  loss_box_reg: 0.05073  loss_rpn_cls: 0.005297  loss_rpn_loc: 0.02207  time: 0.2197  data_time: 0.0194  lr: 0.01  max_mem: 5086M
[11/22 01:33:51] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.1288  loss_cls: 0.05019  loss_box_reg: 0.04626  loss_rpn_cls: 0.006505  loss_rpn_loc: 0.02012  time: 0.2197  data_time: 0.0214  lr: 0.01  max_mem: 5086M
[11/22 01:33:55] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.124  loss_cls: 0.04948  loss_box_reg: 0.04624  loss_rpn_cls: 0.005315  loss_rpn_loc: 0.02029  time: 0.2197  data_time: 0.0191  lr: 0.01  max_mem: 5086M
[11/22 01:34:00] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.119  loss_cls: 0.04828  loss_box_reg: 0.04737  loss_rpn_cls: 0.005395  loss_rpn_loc: 0.01678  time: 0.2196  data_time: 0.0194  lr: 0.01  max_mem: 5086M
[11/22 01:34:04] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1213  loss_cls: 0.04807  loss_box_reg: 0.0462  loss_rpn_cls: 0.005154  loss_rpn_loc: 0.02002  time: 0.2196  data_time: 0.0221  lr: 0.01  max_mem: 5086M
[11/22 01:34:08] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1129  loss_cls: 0.04367  loss_box_reg: 0.04126  loss_rpn_cls: 0.004462  loss_rpn_loc: 0.01894  time: 0.2196  data_time: 0.0202  lr: 0.01  max_mem: 5086M
[11/22 01:34:13] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.1115  loss_cls: 0.04654  loss_box_reg: 0.04376  loss_rpn_cls: 0.004741  loss_rpn_loc: 0.01733  time: 0.2195  data_time: 0.0219  lr: 0.01  max_mem: 5086M
[11/22 01:34:17] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1137  loss_cls: 0.04541  loss_box_reg: 0.04427  loss_rpn_cls: 0.004784  loss_rpn_loc: 0.01831  time: 0.2195  data_time: 0.0208  lr: 0.01  max_mem: 5086M
[11/22 01:34:21] d2.utils.events INFO:  eta: 0:02:28  iter: 519  total_loss: 0.1127  loss_cls: 0.04473  loss_box_reg: 0.04167  loss_rpn_cls: 0.004441  loss_rpn_loc: 0.01816  time: 0.2194  data_time: 0.0211  lr: 0.01  max_mem: 5086M
[11/22 01:34:26] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1159  loss_cls: 0.0451  loss_box_reg: 0.04487  loss_rpn_cls: 0.006048  loss_rpn_loc: 0.02097  time: 0.2194  data_time: 0.0200  lr: 0.01  max_mem: 5086M
[11/22 01:34:30] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1124  loss_cls: 0.04725  loss_box_reg: 0.04414  loss_rpn_cls: 0.004448  loss_rpn_loc: 0.01564  time: 0.2195  data_time: 0.0212  lr: 0.01  max_mem: 5086M
[11/22 01:34:35] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1085  loss_cls: 0.04546  loss_box_reg: 0.03886  loss_rpn_cls: 0.00426  loss_rpn_loc: 0.01583  time: 0.2194  data_time: 0.0179  lr: 0.01  max_mem: 5086M
[11/22 01:34:39] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.109  loss_cls: 0.0427  loss_box_reg: 0.04213  loss_rpn_cls: 0.003819  loss_rpn_loc: 0.01435  time: 0.2194  data_time: 0.0206  lr: 0.01  max_mem: 5086M
[11/22 01:34:44] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1122  loss_cls: 0.04331  loss_box_reg: 0.04331  loss_rpn_cls: 0.004669  loss_rpn_loc: 0.0185  time: 0.2195  data_time: 0.0211  lr: 0.01  max_mem: 5086M
[11/22 01:34:48] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1034  loss_cls: 0.04372  loss_box_reg: 0.04119  loss_rpn_cls: 0.003966  loss_rpn_loc: 0.01883  time: 0.2197  data_time: 0.0219  lr: 0.01  max_mem: 5086M
[11/22 01:34:52] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1092  loss_cls: 0.04351  loss_box_reg: 0.04048  loss_rpn_cls: 0.004374  loss_rpn_loc: 0.01475  time: 0.2196  data_time: 0.0219  lr: 0.01  max_mem: 5086M
[11/22 01:34:57] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.1034  loss_cls: 0.04453  loss_box_reg: 0.03971  loss_rpn_cls: 0.003522  loss_rpn_loc: 0.01353  time: 0.2196  data_time: 0.0210  lr: 0.01  max_mem: 5086M
[11/22 01:35:01] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1078  loss_cls: 0.04174  loss_box_reg: 0.03959  loss_rpn_cls: 0.004198  loss_rpn_loc: 0.01692  time: 0.2196  data_time: 0.0214  lr: 0.01  max_mem: 5086M
[11/22 01:35:06] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.104  loss_cls: 0.04146  loss_box_reg: 0.03876  loss_rpn_cls: 0.003096  loss_rpn_loc: 0.01809  time: 0.2198  data_time: 0.0194  lr: 0.01  max_mem: 5086M
[11/22 01:35:10] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1026  loss_cls: 0.04195  loss_box_reg: 0.03662  loss_rpn_cls: 0.003731  loss_rpn_loc: 0.01756  time: 0.2199  data_time: 0.0218  lr: 0.01  max_mem: 5086M
[11/22 01:35:15] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1047  loss_cls: 0.04235  loss_box_reg: 0.03836  loss_rpn_cls: 0.004005  loss_rpn_loc: 0.01597  time: 0.2198  data_time: 0.0199  lr: 0.01  max_mem: 5086M
[11/22 01:35:19] d2.utils.events INFO:  eta: 0:01:31  iter: 779  total_loss: 0.09951  loss_cls: 0.0421  loss_box_reg: 0.0383  loss_rpn_cls: 0.003581  loss_rpn_loc: 0.01582  time: 0.2198  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:35:23] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.09917  loss_cls: 0.04148  loss_box_reg: 0.0367  loss_rpn_cls: 0.003578  loss_rpn_loc: 0.01442  time: 0.2198  data_time: 0.0197  lr: 0.01  max_mem: 5086M
[11/22 01:35:28] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.09616  loss_cls: 0.04264  loss_box_reg: 0.03796  loss_rpn_cls: 0.003357  loss_rpn_loc: 0.01396  time: 0.2198  data_time: 0.0187  lr: 0.01  max_mem: 5086M
[11/22 01:35:32] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09605  loss_cls: 0.04258  loss_box_reg: 0.03652  loss_rpn_cls: 0.003242  loss_rpn_loc: 0.01326  time: 0.2197  data_time: 0.0203  lr: 0.01  max_mem: 5086M
[11/22 01:35:37] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.09429  loss_cls: 0.04042  loss_box_reg: 0.03599  loss_rpn_cls: 0.003216  loss_rpn_loc: 0.01389  time: 0.2197  data_time: 0.0200  lr: 0.01  max_mem: 5086M
[11/22 01:35:41] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.09513  loss_cls: 0.03885  loss_box_reg: 0.03528  loss_rpn_cls: 0.003158  loss_rpn_loc: 0.01367  time: 0.2197  data_time: 0.0193  lr: 0.01  max_mem: 5086M
[11/22 01:35:45] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09298  loss_cls: 0.04293  loss_box_reg: 0.03397  loss_rpn_cls: 0.003442  loss_rpn_loc: 0.01183  time: 0.2196  data_time: 0.0206  lr: 0.01  max_mem: 5086M
[11/22 01:35:50] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09331  loss_cls: 0.039  loss_box_reg: 0.03469  loss_rpn_cls: 0.003149  loss_rpn_loc: 0.01257  time: 0.2196  data_time: 0.0206  lr: 0.01  max_mem: 5086M
[11/22 01:35:54] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09505  loss_cls: 0.04016  loss_box_reg: 0.03581  loss_rpn_cls: 0.002687  loss_rpn_loc: 0.01171  time: 0.2196  data_time: 0.0206  lr: 0.01  max_mem: 5086M
[11/22 01:35:59] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.08866  loss_cls: 0.04042  loss_box_reg: 0.03418  loss_rpn_cls: 0.002555  loss_rpn_loc: 0.01304  time: 0.2196  data_time: 0.0208  lr: 0.01  max_mem: 5086M
[11/22 01:36:03] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.0866  loss_cls: 0.03903  loss_box_reg: 0.03372  loss_rpn_cls: 0.002804  loss_rpn_loc: 0.01171  time: 0.2196  data_time: 0.0198  lr: 0.001  max_mem: 5086M
[11/22 01:36:08] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08275  loss_cls: 0.03945  loss_box_reg: 0.03071  loss_rpn_cls: 0.003064  loss_rpn_loc: 0.008473  time: 0.2198  data_time: 0.0191  lr: 0.001  max_mem: 5086M
[11/22 01:36:12] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08294  loss_cls: 0.04068  loss_box_reg: 0.03191  loss_rpn_cls: 0.003233  loss_rpn_loc: 0.009088  time: 0.2198  data_time: 0.0200  lr: 0.001  max_mem: 5086M
[11/22 01:36:16] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08457  loss_cls: 0.04349  loss_box_reg: 0.03424  loss_rpn_cls: 0.002059  loss_rpn_loc: 0.00555  time: 0.2197  data_time: 0.0202  lr: 0.001  max_mem: 5086M
[11/22 01:36:21] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08426  loss_cls: 0.03772  loss_box_reg: 0.03259  loss_rpn_cls: 0.003534  loss_rpn_loc: 0.01015  time: 0.2198  data_time: 0.0192  lr: 0.001  max_mem: 5086M
[11/22 01:36:25] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08425  loss_cls: 0.04215  loss_box_reg: 0.03322  loss_rpn_cls: 0.002568  loss_rpn_loc: 0.006735  time: 0.2198  data_time: 0.0206  lr: 0.001  max_mem: 5086M
[11/22 01:36:30] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08406  loss_cls: 0.04068  loss_box_reg: 0.03285  loss_rpn_cls: 0.002381  loss_rpn_loc: 0.00703  time: 0.2198  data_time: 0.0211  lr: 0.001  max_mem: 5086M
[11/22 01:36:34] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08703  loss_cls: 0.03887  loss_box_reg: 0.03261  loss_rpn_cls: 0.002526  loss_rpn_loc: 0.008475  time: 0.2197  data_time: 0.0231  lr: 0.001  max_mem: 5086M
[11/22 01:36:38] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08679  loss_cls: 0.04053  loss_box_reg: 0.03256  loss_rpn_cls: 0.002653  loss_rpn_loc: 0.006989  time: 0.2197  data_time: 0.0238  lr: 0.001  max_mem: 5086M
[11/22 01:36:43] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08451  loss_cls: 0.03815  loss_box_reg: 0.03384  loss_rpn_cls: 0.00272  loss_rpn_loc: 0.008529  time: 0.2197  data_time: 0.0223  lr: 0.001  max_mem: 5086M
[11/22 01:36:47] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08596  loss_cls: 0.03913  loss_box_reg: 0.03484  loss_rpn_cls: 0.002391  loss_rpn_loc: 0.007398  time: 0.2197  data_time: 0.0206  lr: 0.001  max_mem: 5086M
[11/22 01:36:52] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:36:54] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08607  loss_cls: 0.03997  loss_box_reg: 0.03372  loss_rpn_cls: 0.003067  loss_rpn_loc: 0.007212  time: 0.2197  data_time: 0.0223  lr: 0.001  max_mem: 5086M
[11/22 01:36:54] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:23 (0.2198 s / it)
[11/22 01:36:54] d2.engine.hooks INFO: Total training time: 0:04:26 (0:00:03 on hooks)
[11/22 01:36:56] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:36:56] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:36:56] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:36:56] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:36:56] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:36:56] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:36:57] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:36:57] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:36:57] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:36:57] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:37:10] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0610 s / img. ETA=0:01:12
[11/22 01:37:12] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0600 s / img. ETA=0:01:08
[11/22 01:37:15] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0599 s / img. ETA=0:01:05
[11/22 01:37:18] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0598 s / img. ETA=0:01:02
[11/22 01:37:21] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0596 s / img. ETA=0:00:58
[11/22 01:37:24] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0595 s / img. ETA=0:00:55
[11/22 01:37:27] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0593 s / img. ETA=0:00:52
[11/22 01:37:30] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0592 s / img. ETA=0:00:49
[11/22 01:37:33] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0591 s / img. ETA=0:00:46
[11/22 01:37:36] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0594 s / img. ETA=0:00:43
[11/22 01:37:39] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0596 s / img. ETA=0:00:40
[11/22 01:37:42] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0595 s / img. ETA=0:00:37
[11/22 01:37:45] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0594 s / img. ETA=0:00:34
[11/22 01:37:48] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0593 s / img. ETA=0:00:31
[11/22 01:37:51] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0593 s / img. ETA=0:00:28
[11/22 01:37:54] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0592 s / img. ETA=0:00:25
[11/22 01:37:57] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0591 s / img. ETA=0:00:22
[11/22 01:38:00] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0591 s / img. ETA=0:00:19
[11/22 01:38:03] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0590 s / img. ETA=0:00:16
[11/22 01:38:05] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0589 s / img. ETA=0:00:14
[11/22 01:38:08] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0589 s / img. ETA=0:00:11
[11/22 01:38:11] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0589 s / img. ETA=0:00:08
[11/22 01:38:14] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0589 s / img. ETA=0:00:05
[11/22 01:38:17] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0588 s / img. ETA=0:00:02
[11/22 01:38:20] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:12 (0.058394 s / img per device, on 4 devices)
[11/22 01:38:20] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.056989 s / img per device, on 4 devices)
[11/22 01:38:24] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:38:31] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 52.888 | 69.674 | 41.930 |   59.522    | 52.282 |
[11/22 01:38:31] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.229 | 55.259 | 29.543 | 31.229 | 55.259  | 29.543  |
[11/22 01:38:31] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:38:31] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:38:31] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:38:31] defrcn.evaluation.testing INFO: copypaste: 31.2293,55.2594,29.5434,31.2293,55.2594,29.5434
[11/22 01:38:46] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:38:46] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:38:46] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:38:46] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:38:46] d2.utils.env INFO: Using a generated random seed 48855450
[11/22 01:38:46] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:38:46] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:38:48] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:38:48] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:38:48] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:38:48] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:38:48] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:38:48] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:38:51] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:38:51] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:38:51] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:38:51] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:38:53] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:39:06] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0631 s / img. ETA=0:01:15
[11/22 01:39:09] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0636 s / img. ETA=0:01:12
[11/22 01:39:12] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0635 s / img. ETA=0:01:09
[11/22 01:39:15] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0633 s / img. ETA=0:01:05
[11/22 01:39:19] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0629 s / img. ETA=0:01:02
[11/22 01:39:22] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0629 s / img. ETA=0:00:58
[11/22 01:39:25] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0626 s / img. ETA=0:00:55
[11/22 01:39:28] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0624 s / img. ETA=0:00:52
[11/22 01:39:31] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0623 s / img. ETA=0:00:49
[11/22 01:39:34] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0622 s / img. ETA=0:00:45
[11/22 01:39:37] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0623 s / img. ETA=0:00:42
[11/22 01:39:40] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0624 s / img. ETA=0:00:39
[11/22 01:39:43] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0624 s / img. ETA=0:00:36
[11/22 01:39:46] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0623 s / img. ETA=0:00:33
[11/22 01:39:49] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0622 s / img. ETA=0:00:30
[11/22 01:39:52] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0621 s / img. ETA=0:00:27
[11/22 01:39:55] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0620 s / img. ETA=0:00:24
[11/22 01:39:58] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0618 s / img. ETA=0:00:20
[11/22 01:40:01] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0617 s / img. ETA=0:00:17
[11/22 01:40:04] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0615 s / img. ETA=0:00:14
[11/22 01:40:07] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0615 s / img. ETA=0:00:11
[11/22 01:40:10] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0615 s / img. ETA=0:00:08
[11/22 01:40:13] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0614 s / img. ETA=0:00:05
[11/22 01:40:16] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0614 s / img. ETA=0:00:02
[11/22 01:40:19] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:16 (0.061638 s / img per device, on 4 devices)
[11/22 01:40:19] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.058728 s / img per device, on 4 devices)
[11/22 01:40:20] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:40:46] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   86.565    |  87.022   | 73.765 |  73.743  | 88.456 | 88.542 | 69.471  |    74.826     | 86.790 | 85.213  |  86.143  |    55.187     | 80.782  | 84.930  |   81.830    | 60.059 | 70.428 | 51.642 |   62.600    | 52.179 |
[11/22 01:40:46] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.899 | 75.009 | 51.513 | 53.190 | 80.218  | 59.157  | 32.025 | 59.382  | 28.581  |
[11/22 01:40:46] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:40:46] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:40:46] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:40:46] defrcn.evaluation.testing INFO: copypaste: 47.8991,75.0087,51.5126,53.1902,80.2177,59.1566,32.0255,59.3815,28.5806
[11/22 01:40:58] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:40:58] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:40:58] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:40:58] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:40:58] d2.utils.env INFO: Using a generated random seed 61510404
[11/22 01:40:59] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:40:59] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:40:59] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:40:59] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:40:59] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:40:59] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:40:59] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:40:59] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:41:00] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:41:08] d2.utils.events INFO:  eta: 0:04:20  iter: 19  total_loss: 0.6061  loss_cls: 0.3469  loss_box_reg: 0.1634  loss_rpn_cls: 0.04531  loss_rpn_loc: 0.04629  time: 0.2191  data_time: 0.1995  lr: 0.01  max_mem: 5087M
[11/22 01:41:12] d2.utils.events INFO:  eta: 0:04:14  iter: 39  total_loss: 0.4062  loss_cls: 0.187  loss_box_reg: 0.1572  loss_rpn_cls: 0.02468  loss_rpn_loc: 0.03382  time: 0.2190  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 01:41:16] d2.utils.events INFO:  eta: 0:04:09  iter: 59  total_loss: 0.2926  loss_cls: 0.111  loss_box_reg: 0.1319  loss_rpn_cls: 0.01728  loss_rpn_loc: 0.03215  time: 0.2183  data_time: 0.0205  lr: 0.01  max_mem: 5087M
[11/22 01:41:21] d2.utils.events INFO:  eta: 0:04:05  iter: 79  total_loss: 0.253  loss_cls: 0.09214  loss_box_reg: 0.1076  loss_rpn_cls: 0.01616  loss_rpn_loc: 0.02741  time: 0.2189  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 01:41:25] d2.utils.events INFO:  eta: 0:04:01  iter: 99  total_loss: 0.2222  loss_cls: 0.08249  loss_box_reg: 0.09314  loss_rpn_cls: 0.01179  loss_rpn_loc: 0.03103  time: 0.2192  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:41:30] d2.utils.events INFO:  eta: 0:03:57  iter: 119  total_loss: 0.1998  loss_cls: 0.07585  loss_box_reg: 0.08191  loss_rpn_cls: 0.01193  loss_rpn_loc: 0.02532  time: 0.2192  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 01:41:34] d2.utils.events INFO:  eta: 0:03:52  iter: 139  total_loss: 0.1834  loss_cls: 0.07384  loss_box_reg: 0.07587  loss_rpn_cls: 0.009189  loss_rpn_loc: 0.02342  time: 0.2195  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:41:39] d2.utils.events INFO:  eta: 0:03:48  iter: 159  total_loss: 0.1758  loss_cls: 0.0673  loss_box_reg: 0.07208  loss_rpn_cls: 0.009958  loss_rpn_loc: 0.02437  time: 0.2200  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 01:41:43] d2.utils.events INFO:  eta: 0:03:44  iter: 179  total_loss: 0.1725  loss_cls: 0.06738  loss_box_reg: 0.06845  loss_rpn_cls: 0.009387  loss_rpn_loc: 0.02997  time: 0.2200  data_time: 0.0199  lr: 0.01  max_mem: 5087M
[11/22 01:41:47] d2.utils.events INFO:  eta: 0:03:40  iter: 199  total_loss: 0.1658  loss_cls: 0.06383  loss_box_reg: 0.06917  loss_rpn_cls: 0.008268  loss_rpn_loc: 0.02211  time: 0.2203  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:41:52] d2.utils.events INFO:  eta: 0:03:35  iter: 219  total_loss: 0.1568  loss_cls: 0.05916  loss_box_reg: 0.06213  loss_rpn_cls: 0.008811  loss_rpn_loc: 0.02328  time: 0.2204  data_time: 0.0209  lr: 0.01  max_mem: 5087M
[11/22 01:41:56] d2.utils.events INFO:  eta: 0:03:31  iter: 239  total_loss: 0.1525  loss_cls: 0.05873  loss_box_reg: 0.06169  loss_rpn_cls: 0.007899  loss_rpn_loc: 0.01827  time: 0.2201  data_time: 0.0170  lr: 0.01  max_mem: 5087M
[11/22 01:42:01] d2.utils.events INFO:  eta: 0:03:26  iter: 259  total_loss: 0.1552  loss_cls: 0.05865  loss_box_reg: 0.058  loss_rpn_cls: 0.007613  loss_rpn_loc: 0.02483  time: 0.2203  data_time: 0.0199  lr: 0.01  max_mem: 5087M
[11/22 01:42:05] d2.utils.events INFO:  eta: 0:03:22  iter: 279  total_loss: 0.1534  loss_cls: 0.05474  loss_box_reg: 0.05602  loss_rpn_cls: 0.007225  loss_rpn_loc: 0.02611  time: 0.2201  data_time: 0.0181  lr: 0.01  max_mem: 5087M
[11/22 01:42:10] d2.utils.events INFO:  eta: 0:03:17  iter: 299  total_loss: 0.1417  loss_cls: 0.05533  loss_box_reg: 0.05455  loss_rpn_cls: 0.008727  loss_rpn_loc: 0.02304  time: 0.2201  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 01:42:14] d2.utils.events INFO:  eta: 0:03:13  iter: 319  total_loss: 0.1347  loss_cls: 0.05718  loss_box_reg: 0.05482  loss_rpn_cls: 0.006135  loss_rpn_loc: 0.01936  time: 0.2201  data_time: 0.0183  lr: 0.01  max_mem: 5087M
[11/22 01:42:18] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1406  loss_cls: 0.05222  loss_box_reg: 0.0515  loss_rpn_cls: 0.006189  loss_rpn_loc: 0.0195  time: 0.2203  data_time: 0.0195  lr: 0.01  max_mem: 5087M
[11/22 01:42:23] d2.utils.events INFO:  eta: 0:03:04  iter: 359  total_loss: 0.1346  loss_cls: 0.053  loss_box_reg: 0.05353  loss_rpn_cls: 0.005975  loss_rpn_loc: 0.01893  time: 0.2203  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:42:27] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.1259  loss_cls: 0.05244  loss_box_reg: 0.0522  loss_rpn_cls: 0.005152  loss_rpn_loc: 0.01466  time: 0.2202  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 01:42:32] d2.utils.events INFO:  eta: 0:02:55  iter: 399  total_loss: 0.1291  loss_cls: 0.05245  loss_box_reg: 0.05086  loss_rpn_cls: 0.006059  loss_rpn_loc: 0.02146  time: 0.2201  data_time: 0.0175  lr: 0.01  max_mem: 5087M
[11/22 01:42:36] d2.utils.events INFO:  eta: 0:02:51  iter: 419  total_loss: 0.1288  loss_cls: 0.05481  loss_box_reg: 0.048  loss_rpn_cls: 0.004522  loss_rpn_loc: 0.01751  time: 0.2201  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 01:42:40] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1273  loss_cls: 0.04918  loss_box_reg: 0.04965  loss_rpn_cls: 0.005751  loss_rpn_loc: 0.01777  time: 0.2199  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 01:42:45] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1282  loss_cls: 0.05004  loss_box_reg: 0.05054  loss_rpn_cls: 0.005386  loss_rpn_loc: 0.01838  time: 0.2199  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 01:42:49] d2.utils.events INFO:  eta: 0:02:38  iter: 479  total_loss: 0.1236  loss_cls: 0.0497  loss_box_reg: 0.047  loss_rpn_cls: 0.005279  loss_rpn_loc: 0.01856  time: 0.2203  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 01:42:54] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1199  loss_cls: 0.05051  loss_box_reg: 0.04801  loss_rpn_cls: 0.004185  loss_rpn_loc: 0.01852  time: 0.2203  data_time: 0.0162  lr: 0.01  max_mem: 5087M
[11/22 01:42:58] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.1219  loss_cls: 0.05104  loss_box_reg: 0.04814  loss_rpn_cls: 0.004472  loss_rpn_loc: 0.01541  time: 0.2203  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:43:03] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1202  loss_cls: 0.04885  loss_box_reg: 0.04552  loss_rpn_cls: 0.003886  loss_rpn_loc: 0.01578  time: 0.2202  data_time: 0.0175  lr: 0.01  max_mem: 5087M
[11/22 01:43:07] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1155  loss_cls: 0.05068  loss_box_reg: 0.0456  loss_rpn_cls: 0.004807  loss_rpn_loc: 0.01608  time: 0.2202  data_time: 0.0192  lr: 0.01  max_mem: 5087M
[11/22 01:43:11] d2.utils.events INFO:  eta: 0:02:16  iter: 579  total_loss: 0.1195  loss_cls: 0.04982  loss_box_reg: 0.04548  loss_rpn_cls: 0.003644  loss_rpn_loc: 0.01409  time: 0.2202  data_time: 0.0184  lr: 0.01  max_mem: 5087M
[11/22 01:43:16] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1179  loss_cls: 0.04818  loss_box_reg: 0.04457  loss_rpn_cls: 0.005642  loss_rpn_loc: 0.01831  time: 0.2201  data_time: 0.0156  lr: 0.01  max_mem: 5087M
[11/22 01:43:20] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1172  loss_cls: 0.04776  loss_box_reg: 0.04276  loss_rpn_cls: 0.004593  loss_rpn_loc: 0.01744  time: 0.2201  data_time: 0.0173  lr: 0.01  max_mem: 5087M
[11/22 01:43:25] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1117  loss_cls: 0.04647  loss_box_reg: 0.04135  loss_rpn_cls: 0.005302  loss_rpn_loc: 0.02072  time: 0.2200  data_time: 0.0193  lr: 0.01  max_mem: 5087M
[11/22 01:43:29] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1133  loss_cls: 0.04742  loss_box_reg: 0.04264  loss_rpn_cls: 0.004083  loss_rpn_loc: 0.01843  time: 0.2201  data_time: 0.0169  lr: 0.01  max_mem: 5087M
[11/22 01:43:34] d2.utils.events INFO:  eta: 0:01:54  iter: 679  total_loss: 0.1157  loss_cls: 0.0467  loss_box_reg: 0.04458  loss_rpn_cls: 0.004543  loss_rpn_loc: 0.01448  time: 0.2201  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 01:43:38] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1103  loss_cls: 0.04606  loss_box_reg: 0.04209  loss_rpn_cls: 0.003999  loss_rpn_loc: 0.01505  time: 0.2200  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 01:43:42] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1045  loss_cls: 0.04671  loss_box_reg: 0.0401  loss_rpn_cls: 0.003895  loss_rpn_loc: 0.01352  time: 0.2201  data_time: 0.0160  lr: 0.01  max_mem: 5087M
[11/22 01:43:47] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1111  loss_cls: 0.0491  loss_box_reg: 0.04135  loss_rpn_cls: 0.004129  loss_rpn_loc: 0.01464  time: 0.2204  data_time: 0.0176  lr: 0.01  max_mem: 5087M
[11/22 01:43:51] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1068  loss_cls: 0.04633  loss_box_reg: 0.04007  loss_rpn_cls: 0.003442  loss_rpn_loc: 0.01356  time: 0.2202  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 01:43:56] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.1063  loss_cls: 0.04505  loss_box_reg: 0.04092  loss_rpn_cls: 0.004532  loss_rpn_loc: 0.01551  time: 0.2202  data_time: 0.0169  lr: 0.01  max_mem: 5087M
[11/22 01:44:00] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.1078  loss_cls: 0.04778  loss_box_reg: 0.04247  loss_rpn_cls: 0.003571  loss_rpn_loc: 0.01286  time: 0.2202  data_time: 0.0181  lr: 0.01  max_mem: 5087M
[11/22 01:44:04] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1028  loss_cls: 0.04599  loss_box_reg: 0.03965  loss_rpn_cls: 0.004092  loss_rpn_loc: 0.01239  time: 0.2201  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 01:44:09] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.1054  loss_cls: 0.04633  loss_box_reg: 0.03879  loss_rpn_cls: 0.003758  loss_rpn_loc: 0.01156  time: 0.2200  data_time: 0.0163  lr: 0.01  max_mem: 5087M
[11/22 01:44:13] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.09877  loss_cls: 0.04486  loss_box_reg: 0.03892  loss_rpn_cls: 0.003152  loss_rpn_loc: 0.01097  time: 0.2200  data_time: 0.0170  lr: 0.01  max_mem: 5087M
[11/22 01:44:18] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.1046  loss_cls: 0.04465  loss_box_reg: 0.03709  loss_rpn_cls: 0.00383  loss_rpn_loc: 0.01308  time: 0.2199  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 01:44:22] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.1013  loss_cls: 0.04433  loss_box_reg: 0.03904  loss_rpn_cls: 0.003744  loss_rpn_loc: 0.01417  time: 0.2199  data_time: 0.0179  lr: 0.01  max_mem: 5087M
[11/22 01:44:26] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.1003  loss_cls: 0.04535  loss_box_reg: 0.03717  loss_rpn_cls: 0.003322  loss_rpn_loc: 0.01183  time: 0.2198  data_time: 0.0167  lr: 0.01  max_mem: 5087M
[11/22 01:44:31] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09891  loss_cls: 0.04538  loss_box_reg: 0.03956  loss_rpn_cls: 0.002927  loss_rpn_loc: 0.01137  time: 0.2198  data_time: 0.0190  lr: 0.01  max_mem: 5087M
[11/22 01:44:35] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.1013  loss_cls: 0.04595  loss_box_reg: 0.03766  loss_rpn_cls: 0.00348  loss_rpn_loc: 0.01476  time: 0.2197  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 01:44:39] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09303  loss_cls: 0.04355  loss_box_reg: 0.03478  loss_rpn_cls: 0.00294  loss_rpn_loc: 0.01029  time: 0.2196  data_time: 0.0200  lr: 0.001  max_mem: 5087M
[11/22 01:44:44] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.09011  loss_cls: 0.04173  loss_box_reg: 0.03399  loss_rpn_cls: 0.003087  loss_rpn_loc: 0.00837  time: 0.2196  data_time: 0.0160  lr: 0.001  max_mem: 5087M
[11/22 01:44:48] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.09253  loss_cls: 0.04401  loss_box_reg: 0.03771  loss_rpn_cls: 0.003128  loss_rpn_loc: 0.007613  time: 0.2195  data_time: 0.0173  lr: 0.001  max_mem: 5087M
[11/22 01:44:53] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.09441  loss_cls: 0.04301  loss_box_reg: 0.03597  loss_rpn_cls: 0.003585  loss_rpn_loc: 0.008391  time: 0.2196  data_time: 0.0170  lr: 0.001  max_mem: 5087M
[11/22 01:44:57] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.09209  loss_cls: 0.04112  loss_box_reg: 0.03697  loss_rpn_cls: 0.002865  loss_rpn_loc: 0.006549  time: 0.2195  data_time: 0.0164  lr: 0.001  max_mem: 5087M
[11/22 01:45:01] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08996  loss_cls: 0.04353  loss_box_reg: 0.03647  loss_rpn_cls: 0.003814  loss_rpn_loc: 0.006696  time: 0.2195  data_time: 0.0180  lr: 0.001  max_mem: 5087M
[11/22 01:45:06] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.09217  loss_cls: 0.04392  loss_box_reg: 0.03617  loss_rpn_cls: 0.00312  loss_rpn_loc: 0.006591  time: 0.2195  data_time: 0.0189  lr: 0.001  max_mem: 5087M
[11/22 01:45:10] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08955  loss_cls: 0.04674  loss_box_reg: 0.03578  loss_rpn_cls: 0.002464  loss_rpn_loc: 0.00652  time: 0.2195  data_time: 0.0183  lr: 0.001  max_mem: 5087M
[11/22 01:45:14] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08829  loss_cls: 0.0431  loss_box_reg: 0.03583  loss_rpn_cls: 0.00258  loss_rpn_loc: 0.006913  time: 0.2194  data_time: 0.0179  lr: 0.001  max_mem: 5087M
[11/22 01:45:19] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08801  loss_cls: 0.04467  loss_box_reg: 0.03583  loss_rpn_cls: 0.002527  loss_rpn_loc: 0.00726  time: 0.2195  data_time: 0.0196  lr: 0.001  max_mem: 5087M
[11/22 01:45:23] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08907  loss_cls: 0.04339  loss_box_reg: 0.03446  loss_rpn_cls: 0.002784  loss_rpn_loc: 0.007287  time: 0.2194  data_time: 0.0189  lr: 0.001  max_mem: 5087M
[11/22 01:45:28] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:45:29] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.09336  loss_cls: 0.04487  loss_box_reg: 0.03741  loss_rpn_cls: 0.003145  loss_rpn_loc: 0.007716  time: 0.2194  data_time: 0.0191  lr: 0.001  max_mem: 5087M
[11/22 01:45:29] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:22 (0.2194 s / it)
[11/22 01:45:29] d2.engine.hooks INFO: Total training time: 0:04:25 (0:00:02 on hooks)
[11/22 01:45:31] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:45:31] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:45:31] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:45:31] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:45:31] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:45:31] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:45:32] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:45:32] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:45:32] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:45:32] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:45:45] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0649 s / img. ETA=0:01:17
[11/22 01:45:48] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0633 s / img. ETA=0:01:12
[11/22 01:45:52] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0632 s / img. ETA=0:01:08
[11/22 01:45:55] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0634 s / img. ETA=0:01:05
[11/22 01:45:58] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0631 s / img. ETA=0:01:02
[11/22 01:46:01] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0633 s / img. ETA=0:00:59
[11/22 01:46:04] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0634 s / img. ETA=0:00:56
[11/22 01:46:07] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0634 s / img. ETA=0:00:53
[11/22 01:46:11] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0636 s / img. ETA=0:00:50
[11/22 01:46:14] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0636 s / img. ETA=0:00:46
[11/22 01:46:17] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0636 s / img. ETA=0:00:43
[11/22 01:46:20] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0636 s / img. ETA=0:00:40
[11/22 01:46:23] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0635 s / img. ETA=0:00:37
[11/22 01:46:26] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0634 s / img. ETA=0:00:34
[11/22 01:46:30] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0634 s / img. ETA=0:00:30
[11/22 01:46:33] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0633 s / img. ETA=0:00:27
[11/22 01:46:36] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0631 s / img. ETA=0:00:24
[11/22 01:46:39] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0631 s / img. ETA=0:00:21
[11/22 01:46:42] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0631 s / img. ETA=0:00:18
[11/22 01:46:45] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0631 s / img. ETA=0:00:15
[11/22 01:46:48] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0631 s / img. ETA=0:00:11
[11/22 01:46:51] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0631 s / img. ETA=0:00:08
[11/22 01:46:55] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0631 s / img. ETA=0:00:05
[11/22 01:46:58] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0631 s / img. ETA=0:00:02
[11/22 01:47:01] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:18 (0.063260 s / img per device, on 4 devices)
[11/22 01:47:01] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:15 (0.060945 s / img per device, on 4 devices)
[11/22 01:47:01] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:47:08] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 52.365 | 16.671 | 42.077 |   56.440    | 54.236 |
[11/22 01:47:08] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 23.416 | 44.358 | 21.130 | 23.416 | 44.358  | 21.130  |
[11/22 01:47:08] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:47:08] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:47:08] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:47:08] defrcn.evaluation.testing INFO: copypaste: 23.4158,44.3578,21.1299,23.4158,44.3578,21.1299
[11/22 01:47:23] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:47:23] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:47:23] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:47:23] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:47:23] d2.utils.env INFO: Using a generated random seed 25840478
[11/22 01:47:23] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:47:23] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:47:25] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:47:25] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:47:25] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:47:25] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:47:25] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:47:25] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:47:28] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:47:28] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:47:28] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:47:28] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:47:29] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:47:42] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0620 s / img. ETA=0:01:13
[11/22 01:47:45] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0609 s / img. ETA=0:01:09
[11/22 01:47:48] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0608 s / img. ETA=0:01:06
[11/22 01:47:51] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0608 s / img. ETA=0:01:03
[11/22 01:47:54] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0606 s / img. ETA=0:00:59
[11/22 01:47:57] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0605 s / img. ETA=0:00:56
[11/22 01:48:00] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0603 s / img. ETA=0:00:53
[11/22 01:48:04] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0610 s / img. ETA=0:00:51
[11/22 01:48:07] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0609 s / img. ETA=0:00:47
[11/22 01:48:10] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0607 s / img. ETA=0:00:44
[11/22 01:48:12] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0606 s / img. ETA=0:00:41
[11/22 01:48:15] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0605 s / img. ETA=0:00:38
[11/22 01:48:18] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0604 s / img. ETA=0:00:35
[11/22 01:48:21] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0602 s / img. ETA=0:00:32
[11/22 01:48:24] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0602 s / img. ETA=0:00:29
[11/22 01:48:27] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0601 s / img. ETA=0:00:26
[11/22 01:48:30] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0601 s / img. ETA=0:00:23
[11/22 01:48:33] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0600 s / img. ETA=0:00:20
[11/22 01:48:36] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0600 s / img. ETA=0:00:17
[11/22 01:48:39] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0599 s / img. ETA=0:00:14
[11/22 01:48:42] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0599 s / img. ETA=0:00:11
[11/22 01:48:45] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0599 s / img. ETA=0:00:08
[11/22 01:48:48] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0598 s / img. ETA=0:00:05
[11/22 01:48:51] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0598 s / img. ETA=0:00:02
[11/22 01:48:54] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 01:48:54] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.057337 s / img per device, on 4 devices)
[11/22 01:49:00] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:49:25] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   86.141    |  86.529   | 72.078 |  74.041  | 88.432 | 87.918 | 69.960  |    73.227     | 86.448 | 84.322  |  86.268  |    55.398     | 81.193  | 85.135  |   82.303    | 56.716 | 39.197 | 47.198 |   58.733    | 53.411 |
[11/22 01:49:25] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 46.106 | 72.733 | 48.624 | 53.207 | 79.960  | 58.505  | 24.804 | 51.051  | 18.979  |
[11/22 01:49:25] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:49:25] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:49:25] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:49:25] defrcn.evaluation.testing INFO: copypaste: 46.1059,72.7325,48.6238,53.2066,79.9596,58.5055,24.8039,51.0511,18.9788
[11/22 01:49:37] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:49:37] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:49:37] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:49:37] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:49:37] d2.utils.env INFO: Using a generated random seed 39799898
[11/22 01:49:37] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:49:37] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:49:37] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:49:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:49:37] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:49:37] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:49:37] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:49:38] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:49:38] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:49:46] d2.utils.events INFO:  eta: 0:04:24  iter: 19  total_loss: 0.5898  loss_cls: 0.314  loss_box_reg: 0.1734  loss_rpn_cls: 0.04431  loss_rpn_loc: 0.04233  time: 0.2225  data_time: 0.1943  lr: 0.01  max_mem: 4906M
[11/22 01:49:50] d2.utils.events INFO:  eta: 0:04:19  iter: 39  total_loss: 0.368  loss_cls: 0.1548  loss_box_reg: 0.146  loss_rpn_cls: 0.02678  loss_rpn_loc: 0.03566  time: 0.2217  data_time: 0.0203  lr: 0.01  max_mem: 5086M
[11/22 01:49:55] d2.utils.events INFO:  eta: 0:04:14  iter: 59  total_loss: 0.2909  loss_cls: 0.1025  loss_box_reg: 0.128  loss_rpn_cls: 0.01996  loss_rpn_loc: 0.03202  time: 0.2219  data_time: 0.0235  lr: 0.01  max_mem: 5086M
[11/22 01:49:59] d2.utils.events INFO:  eta: 0:04:09  iter: 79  total_loss: 0.2508  loss_cls: 0.08663  loss_box_reg: 0.1059  loss_rpn_cls: 0.01633  loss_rpn_loc: 0.03353  time: 0.2217  data_time: 0.0219  lr: 0.01  max_mem: 5086M
[11/22 01:50:04] d2.utils.events INFO:  eta: 0:04:03  iter: 99  total_loss: 0.2158  loss_cls: 0.07831  loss_box_reg: 0.0885  loss_rpn_cls: 0.01394  loss_rpn_loc: 0.0262  time: 0.2213  data_time: 0.0221  lr: 0.01  max_mem: 5086M
[11/22 01:50:08] d2.utils.events INFO:  eta: 0:03:59  iter: 119  total_loss: 0.1973  loss_cls: 0.06764  loss_box_reg: 0.07926  loss_rpn_cls: 0.01411  loss_rpn_loc: 0.03193  time: 0.2212  data_time: 0.0189  lr: 0.01  max_mem: 5086M
[11/22 01:50:12] d2.utils.events INFO:  eta: 0:03:54  iter: 139  total_loss: 0.188  loss_cls: 0.072  loss_box_reg: 0.07415  loss_rpn_cls: 0.01127  loss_rpn_loc: 0.03145  time: 0.2210  data_time: 0.0213  lr: 0.01  max_mem: 5086M
[11/22 01:50:17] d2.utils.events INFO:  eta: 0:03:50  iter: 159  total_loss: 0.1741  loss_cls: 0.06642  loss_box_reg: 0.06594  loss_rpn_cls: 0.01042  loss_rpn_loc: 0.02802  time: 0.2207  data_time: 0.0197  lr: 0.01  max_mem: 5086M
[11/22 01:50:21] d2.utils.events INFO:  eta: 0:03:45  iter: 179  total_loss: 0.1641  loss_cls: 0.06728  loss_box_reg: 0.06342  loss_rpn_cls: 0.009346  loss_rpn_loc: 0.02621  time: 0.2205  data_time: 0.0223  lr: 0.01  max_mem: 5086M
[11/22 01:50:26] d2.utils.events INFO:  eta: 0:03:41  iter: 199  total_loss: 0.1479  loss_cls: 0.05934  loss_box_reg: 0.06018  loss_rpn_cls: 0.008575  loss_rpn_loc: 0.0203  time: 0.2203  data_time: 0.0216  lr: 0.01  max_mem: 5086M
[11/22 01:50:30] d2.utils.events INFO:  eta: 0:03:37  iter: 219  total_loss: 0.1552  loss_cls: 0.06487  loss_box_reg: 0.05904  loss_rpn_cls: 0.007542  loss_rpn_loc: 0.02317  time: 0.2206  data_time: 0.0198  lr: 0.01  max_mem: 5086M
[11/22 01:50:34] d2.utils.events INFO:  eta: 0:03:32  iter: 239  total_loss: 0.1533  loss_cls: 0.05802  loss_box_reg: 0.05761  loss_rpn_cls: 0.008171  loss_rpn_loc: 0.0261  time: 0.2204  data_time: 0.0218  lr: 0.01  max_mem: 5086M
[11/22 01:50:39] d2.utils.events INFO:  eta: 0:03:27  iter: 259  total_loss: 0.1463  loss_cls: 0.05336  loss_box_reg: 0.0543  loss_rpn_cls: 0.009875  loss_rpn_loc: 0.02814  time: 0.2205  data_time: 0.0224  lr: 0.01  max_mem: 5086M
[11/22 01:50:43] d2.utils.events INFO:  eta: 0:03:23  iter: 279  total_loss: 0.1386  loss_cls: 0.05692  loss_box_reg: 0.05295  loss_rpn_cls: 0.006219  loss_rpn_loc: 0.0209  time: 0.2204  data_time: 0.0205  lr: 0.01  max_mem: 5086M
[11/22 01:50:48] d2.utils.events INFO:  eta: 0:03:19  iter: 299  total_loss: 0.1388  loss_cls: 0.05817  loss_box_reg: 0.05039  loss_rpn_cls: 0.008026  loss_rpn_loc: 0.02304  time: 0.2206  data_time: 0.0210  lr: 0.01  max_mem: 5086M
[11/22 01:50:52] d2.utils.events INFO:  eta: 0:03:14  iter: 319  total_loss: 0.1364  loss_cls: 0.0524  loss_box_reg: 0.04765  loss_rpn_cls: 0.008685  loss_rpn_loc: 0.02875  time: 0.2207  data_time: 0.0200  lr: 0.01  max_mem: 5086M
[11/22 01:50:57] d2.utils.events INFO:  eta: 0:03:10  iter: 339  total_loss: 0.1307  loss_cls: 0.05008  loss_box_reg: 0.04938  loss_rpn_cls: 0.006745  loss_rpn_loc: 0.02161  time: 0.2207  data_time: 0.0205  lr: 0.01  max_mem: 5086M
[11/22 01:51:01] d2.utils.events INFO:  eta: 0:03:05  iter: 359  total_loss: 0.1338  loss_cls: 0.05165  loss_box_reg: 0.04606  loss_rpn_cls: 0.005493  loss_rpn_loc: 0.02006  time: 0.2208  data_time: 0.0222  lr: 0.01  max_mem: 5086M
[11/22 01:51:06] d2.utils.events INFO:  eta: 0:03:00  iter: 379  total_loss: 0.1239  loss_cls: 0.0513  loss_box_reg: 0.04596  loss_rpn_cls: 0.006858  loss_rpn_loc: 0.02178  time: 0.2207  data_time: 0.0214  lr: 0.01  max_mem: 5086M
[11/22 01:51:10] d2.utils.events INFO:  eta: 0:02:56  iter: 399  total_loss: 0.1215  loss_cls: 0.04859  loss_box_reg: 0.04653  loss_rpn_cls: 0.005778  loss_rpn_loc: 0.01951  time: 0.2207  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:51:14] d2.utils.events INFO:  eta: 0:02:51  iter: 419  total_loss: 0.1209  loss_cls: 0.04884  loss_box_reg: 0.0442  loss_rpn_cls: 0.006386  loss_rpn_loc: 0.02318  time: 0.2207  data_time: 0.0227  lr: 0.01  max_mem: 5086M
[11/22 01:51:19] d2.utils.events INFO:  eta: 0:02:47  iter: 439  total_loss: 0.1167  loss_cls: 0.0488  loss_box_reg: 0.04374  loss_rpn_cls: 0.004999  loss_rpn_loc: 0.01691  time: 0.2207  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:51:23] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1155  loss_cls: 0.04707  loss_box_reg: 0.04454  loss_rpn_cls: 0.005849  loss_rpn_loc: 0.02002  time: 0.2207  data_time: 0.0189  lr: 0.01  max_mem: 5086M
[11/22 01:51:28] d2.utils.events INFO:  eta: 0:02:38  iter: 479  total_loss: 0.1185  loss_cls: 0.04808  loss_box_reg: 0.04406  loss_rpn_cls: 0.005177  loss_rpn_loc: 0.01941  time: 0.2208  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:51:32] d2.utils.events INFO:  eta: 0:02:34  iter: 499  total_loss: 0.1182  loss_cls: 0.04706  loss_box_reg: 0.04402  loss_rpn_cls: 0.004868  loss_rpn_loc: 0.01733  time: 0.2208  data_time: 0.0224  lr: 0.01  max_mem: 5086M
[11/22 01:51:37] d2.utils.events INFO:  eta: 0:02:30  iter: 519  total_loss: 0.1157  loss_cls: 0.04662  loss_box_reg: 0.04354  loss_rpn_cls: 0.004827  loss_rpn_loc: 0.0196  time: 0.2209  data_time: 0.0201  lr: 0.01  max_mem: 5086M
[11/22 01:51:41] d2.utils.events INFO:  eta: 0:02:25  iter: 539  total_loss: 0.1113  loss_cls: 0.04525  loss_box_reg: 0.04158  loss_rpn_cls: 0.005512  loss_rpn_loc: 0.0202  time: 0.2209  data_time: 0.0193  lr: 0.01  max_mem: 5086M
[11/22 01:51:46] d2.utils.events INFO:  eta: 0:02:21  iter: 559  total_loss: 0.1149  loss_cls: 0.04615  loss_box_reg: 0.04337  loss_rpn_cls: 0.005303  loss_rpn_loc: 0.01656  time: 0.2208  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:51:50] d2.utils.events INFO:  eta: 0:02:16  iter: 579  total_loss: 0.1164  loss_cls: 0.04731  loss_box_reg: 0.04351  loss_rpn_cls: 0.004401  loss_rpn_loc: 0.01743  time: 0.2209  data_time: 0.0204  lr: 0.01  max_mem: 5086M
[11/22 01:51:54] d2.utils.events INFO:  eta: 0:02:12  iter: 599  total_loss: 0.121  loss_cls: 0.04794  loss_box_reg: 0.04061  loss_rpn_cls: 0.005079  loss_rpn_loc: 0.02083  time: 0.2208  data_time: 0.0192  lr: 0.01  max_mem: 5086M
[11/22 01:51:59] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1143  loss_cls: 0.04494  loss_box_reg: 0.0417  loss_rpn_cls: 0.00507  loss_rpn_loc: 0.02039  time: 0.2208  data_time: 0.0211  lr: 0.01  max_mem: 5086M
[11/22 01:52:03] d2.utils.events INFO:  eta: 0:02:03  iter: 639  total_loss: 0.1155  loss_cls: 0.044  loss_box_reg: 0.04014  loss_rpn_cls: 0.005821  loss_rpn_loc: 0.02463  time: 0.2208  data_time: 0.0204  lr: 0.01  max_mem: 5086M
[11/22 01:52:08] d2.utils.events INFO:  eta: 0:01:59  iter: 659  total_loss: 0.1038  loss_cls: 0.04199  loss_box_reg: 0.03968  loss_rpn_cls: 0.005166  loss_rpn_loc: 0.01842  time: 0.2207  data_time: 0.0197  lr: 0.01  max_mem: 5086M
[11/22 01:52:12] d2.utils.events INFO:  eta: 0:01:54  iter: 679  total_loss: 0.1009  loss_cls: 0.04206  loss_box_reg: 0.03687  loss_rpn_cls: 0.004385  loss_rpn_loc: 0.01641  time: 0.2209  data_time: 0.0205  lr: 0.01  max_mem: 5086M
[11/22 01:52:17] d2.utils.events INFO:  eta: 0:01:50  iter: 699  total_loss: 0.1036  loss_cls: 0.0427  loss_box_reg: 0.03806  loss_rpn_cls: 0.004015  loss_rpn_loc: 0.01519  time: 0.2209  data_time: 0.0189  lr: 0.01  max_mem: 5086M
[11/22 01:52:21] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1041  loss_cls: 0.04487  loss_box_reg: 0.03994  loss_rpn_cls: 0.00458  loss_rpn_loc: 0.01499  time: 0.2208  data_time: 0.0193  lr: 0.01  max_mem: 5086M
[11/22 01:52:25] d2.utils.events INFO:  eta: 0:01:41  iter: 739  total_loss: 0.0989  loss_cls: 0.04328  loss_box_reg: 0.03657  loss_rpn_cls: 0.003425  loss_rpn_loc: 0.01482  time: 0.2208  data_time: 0.0181  lr: 0.01  max_mem: 5086M
[11/22 01:52:30] d2.utils.events INFO:  eta: 0:01:37  iter: 759  total_loss: 0.1083  loss_cls: 0.04493  loss_box_reg: 0.03997  loss_rpn_cls: 0.004433  loss_rpn_loc: 0.0154  time: 0.2209  data_time: 0.0201  lr: 0.01  max_mem: 5086M
[11/22 01:52:34] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.1016  loss_cls: 0.04333  loss_box_reg: 0.03834  loss_rpn_cls: 0.003776  loss_rpn_loc: 0.01458  time: 0.2209  data_time: 0.0199  lr: 0.01  max_mem: 5086M
[11/22 01:52:39] d2.utils.events INFO:  eta: 0:01:28  iter: 799  total_loss: 0.1019  loss_cls: 0.03992  loss_box_reg: 0.03765  loss_rpn_cls: 0.004201  loss_rpn_loc: 0.01608  time: 0.2209  data_time: 0.0197  lr: 0.01  max_mem: 5086M
[11/22 01:52:43] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1008  loss_cls: 0.04453  loss_box_reg: 0.038  loss_rpn_cls: 0.003922  loss_rpn_loc: 0.01454  time: 0.2209  data_time: 0.0234  lr: 0.01  max_mem: 5086M
[11/22 01:52:48] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.1049  loss_cls: 0.03985  loss_box_reg: 0.03586  loss_rpn_cls: 0.004217  loss_rpn_loc: 0.01862  time: 0.2209  data_time: 0.0197  lr: 0.01  max_mem: 5086M
[11/22 01:52:52] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.1083  loss_cls: 0.04181  loss_box_reg: 0.03763  loss_rpn_cls: 0.004221  loss_rpn_loc: 0.01529  time: 0.2209  data_time: 0.0185  lr: 0.01  max_mem: 5086M
[11/22 01:52:57] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.09849  loss_cls: 0.04132  loss_box_reg: 0.03299  loss_rpn_cls: 0.00395  loss_rpn_loc: 0.01473  time: 0.2209  data_time: 0.0180  lr: 0.01  max_mem: 5086M
[11/22 01:53:01] d2.utils.events INFO:  eta: 0:01:06  iter: 899  total_loss: 0.09339  loss_cls: 0.03948  loss_box_reg: 0.03286  loss_rpn_cls: 0.004405  loss_rpn_loc: 0.01396  time: 0.2209  data_time: 0.0180  lr: 0.01  max_mem: 5086M
[11/22 01:53:06] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09722  loss_cls: 0.0424  loss_box_reg: 0.03374  loss_rpn_cls: 0.004349  loss_rpn_loc: 0.01667  time: 0.2209  data_time: 0.0207  lr: 0.01  max_mem: 5086M
[11/22 01:53:10] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.09599  loss_cls: 0.03911  loss_box_reg: 0.03651  loss_rpn_cls: 0.003462  loss_rpn_loc: 0.01396  time: 0.2209  data_time: 0.0189  lr: 0.01  max_mem: 5086M
[11/22 01:53:15] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.1002  loss_cls: 0.04342  loss_box_reg: 0.03672  loss_rpn_cls: 0.004073  loss_rpn_loc: 0.01536  time: 0.2211  data_time: 0.0230  lr: 0.01  max_mem: 5086M
[11/22 01:53:19] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.08982  loss_cls: 0.0395  loss_box_reg: 0.03255  loss_rpn_cls: 0.003848  loss_rpn_loc: 0.01079  time: 0.2211  data_time: 0.0186  lr: 0.001  max_mem: 5086M
[11/22 01:53:23] d2.utils.events INFO:  eta: 0:00:44  iter: 999  total_loss: 0.09146  loss_cls: 0.04184  loss_box_reg: 0.0357  loss_rpn_cls: 0.003558  loss_rpn_loc: 0.01068  time: 0.2211  data_time: 0.0198  lr: 0.001  max_mem: 5086M
[11/22 01:53:28] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.09012  loss_cls: 0.04105  loss_box_reg: 0.03414  loss_rpn_cls: 0.003144  loss_rpn_loc: 0.00879  time: 0.2210  data_time: 0.0209  lr: 0.001  max_mem: 5086M
[11/22 01:53:32] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08516  loss_cls: 0.04181  loss_box_reg: 0.03383  loss_rpn_cls: 0.003429  loss_rpn_loc: 0.008088  time: 0.2210  data_time: 0.0213  lr: 0.001  max_mem: 5086M
[11/22 01:53:37] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.09203  loss_cls: 0.04394  loss_box_reg: 0.03556  loss_rpn_cls: 0.003377  loss_rpn_loc: 0.009617  time: 0.2210  data_time: 0.0205  lr: 0.001  max_mem: 5086M
[11/22 01:53:41] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.0903  loss_cls: 0.04278  loss_box_reg: 0.03444  loss_rpn_cls: 0.003327  loss_rpn_loc: 0.007678  time: 0.2209  data_time: 0.0204  lr: 0.001  max_mem: 5086M
[11/22 01:53:46] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08652  loss_cls: 0.04132  loss_box_reg: 0.03243  loss_rpn_cls: 0.003435  loss_rpn_loc: 0.008144  time: 0.2209  data_time: 0.0195  lr: 0.001  max_mem: 5086M
[11/22 01:53:50] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.09033  loss_cls: 0.0409  loss_box_reg: 0.03501  loss_rpn_cls: 0.003079  loss_rpn_loc: 0.008414  time: 0.2210  data_time: 0.0179  lr: 0.001  max_mem: 5086M
[11/22 01:53:54] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08701  loss_cls: 0.04216  loss_box_reg: 0.03406  loss_rpn_cls: 0.002337  loss_rpn_loc: 0.006077  time: 0.2209  data_time: 0.0184  lr: 0.001  max_mem: 5086M
[11/22 01:53:59] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08629  loss_cls: 0.03934  loss_box_reg: 0.03397  loss_rpn_cls: 0.003244  loss_rpn_loc: 0.008883  time: 0.2209  data_time: 0.0175  lr: 0.001  max_mem: 5086M
[11/22 01:54:03] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08576  loss_cls: 0.04014  loss_box_reg: 0.0328  loss_rpn_cls: 0.003061  loss_rpn_loc: 0.006447  time: 0.2209  data_time: 0.0185  lr: 0.001  max_mem: 5086M
[11/22 01:54:08] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 01:54:09] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08752  loss_cls: 0.0417  loss_box_reg: 0.03176  loss_rpn_cls: 0.002814  loss_rpn_loc: 0.007757  time: 0.2209  data_time: 0.0195  lr: 0.001  max_mem: 5086M
[11/22 01:54:09] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:24 (0.2209 s / it)
[11/22 01:54:09] d2.engine.hooks INFO: Total training time: 0:04:27 (0:00:02 on hooks)
[11/22 01:54:11] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 01:54:11] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:54:11] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:54:11] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 01:54:11] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:54:11] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:54:12] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:54:12] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:54:12] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:54:12] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:54:25] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0636 s / img. ETA=0:01:15
[11/22 01:54:28] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0627 s / img. ETA=0:01:11
[11/22 01:54:32] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0625 s / img. ETA=0:01:08
[11/22 01:54:35] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0623 s / img. ETA=0:01:04
[11/22 01:54:38] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0622 s / img. ETA=0:01:01
[11/22 01:54:41] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0621 s / img. ETA=0:00:58
[11/22 01:54:44] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0618 s / img. ETA=0:00:54
[11/22 01:54:47] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0617 s / img. ETA=0:00:51
[11/22 01:54:50] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0616 s / img. ETA=0:00:48
[11/22 01:54:53] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0615 s / img. ETA=0:00:45
[11/22 01:54:56] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0613 s / img. ETA=0:00:42
[11/22 01:54:59] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0613 s / img. ETA=0:00:39
[11/22 01:55:02] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0612 s / img. ETA=0:00:35
[11/22 01:55:05] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0612 s / img. ETA=0:00:32
[11/22 01:55:08] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0612 s / img. ETA=0:00:29
[11/22 01:55:11] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0612 s / img. ETA=0:00:26
[11/22 01:55:14] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0612 s / img. ETA=0:00:23
[11/22 01:55:17] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0611 s / img. ETA=0:00:20
[11/22 01:55:20] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0611 s / img. ETA=0:00:17
[11/22 01:55:23] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0611 s / img. ETA=0:00:14
[11/22 01:55:26] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0610 s / img. ETA=0:00:11
[11/22 01:55:29] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0610 s / img. ETA=0:00:08
[11/22 01:55:32] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0610 s / img. ETA=0:00:05
[11/22 01:55:35] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0610 s / img. ETA=0:00:02
[11/22 01:55:38] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 01:55:38] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.059141 s / img per device, on 4 devices)
[11/22 01:55:38] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:55:45] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 52.664 | 69.134 | 45.527 |   59.646    | 52.797 |
[11/22 01:55:45] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.742 | 55.954 | 31.904 | 31.742 | 55.954  | 31.904  |
[11/22 01:55:45] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 01:55:45] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:55:45] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 01:55:45] defrcn.evaluation.testing INFO: copypaste: 31.7421,55.9537,31.9041,31.7421,55.9537,31.9041
[11/22 01:56:01] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:56:01] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 01:56:01] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:56:01] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:56:01] d2.utils.env INFO: Using a generated random seed 4091412
[11/22 01:56:01] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:56:02] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 01:56:03] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 01:56:03] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:56:03] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 01:56:03] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 01:56:03] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 01:56:03] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 01:56:04] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 01:56:04] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 01:56:04] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 01:56:04] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 01:56:06] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 01:56:19] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0628 s / img. ETA=0:01:14
[11/22 01:56:22] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0610 s / img. ETA=0:01:09
[11/22 01:56:25] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0607 s / img. ETA=0:01:06
[11/22 01:56:28] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0604 s / img. ETA=0:01:02
[11/22 01:56:31] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0601 s / img. ETA=0:00:59
[11/22 01:56:34] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0600 s / img. ETA=0:00:56
[11/22 01:56:36] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0598 s / img. ETA=0:00:53
[11/22 01:56:39] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0596 s / img. ETA=0:00:49
[11/22 01:56:42] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0595 s / img. ETA=0:00:46
[11/22 01:56:45] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0594 s / img. ETA=0:00:43
[11/22 01:56:48] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0593 s / img. ETA=0:00:40
[11/22 01:56:51] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0594 s / img. ETA=0:00:37
[11/22 01:56:54] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0592 s / img. ETA=0:00:34
[11/22 01:56:57] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0592 s / img. ETA=0:00:31
[11/22 01:57:00] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0591 s / img. ETA=0:00:28
[11/22 01:57:03] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0591 s / img. ETA=0:00:25
[11/22 01:57:06] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0591 s / img. ETA=0:00:22
[11/22 01:57:09] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0590 s / img. ETA=0:00:19
[11/22 01:57:12] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0590 s / img. ETA=0:00:16
[11/22 01:57:14] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0589 s / img. ETA=0:00:14
[11/22 01:57:17] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0589 s / img. ETA=0:00:11
[11/22 01:57:20] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0589 s / img. ETA=0:00:08
[11/22 01:57:23] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0589 s / img. ETA=0:00:05
[11/22 01:57:26] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0588 s / img. ETA=0:00:02
[11/22 01:57:29] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:12 (0.058394 s / img per device, on 4 devices)
[11/22 01:57:29] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:09 (0.056560 s / img per device, on 4 devices)
[11/22 01:57:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 01:58:02] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   85.270    |  87.153   | 73.308 |  73.778  | 88.468 | 88.369 | 69.428  |    76.138     | 86.770 | 84.503  |  86.335  |    55.011     | 81.458  | 85.121  |   82.195    | 59.217 | 69.938 | 58.511 |   60.270    | 51.694 |
[11/22 01:58:02] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.736 | 75.147 | 50.913 | 53.001 | 80.220  | 58.172  | 31.938 | 59.926  | 29.136  |
[11/22 01:58:02] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 01:58:02] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 01:58:02] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 01:58:02] defrcn.evaluation.testing INFO: copypaste: 47.7355,75.1468,50.9129,53.0013,80.2203,58.1717,31.9381,59.9260,29.1365
[11/22 01:58:17] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 01:58:17] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 01:58:17] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 01:58:17] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 01:58:17] d2.utils.env INFO: Using a generated random seed 20098113
[11/22 01:58:17] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 01:58:18] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 01:58:18] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 01:58:18] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 01:58:18] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 01:58:18] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 01:58:18] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 01:58:18] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 01:58:18] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 01:58:26] d2.utils.events INFO:  eta: 0:04:17  iter: 19  total_loss: 0.5824  loss_cls: 0.343  loss_box_reg: 0.1545  loss_rpn_cls: 0.04606  loss_rpn_loc: 0.04399  time: 0.2251  data_time: 0.1976  lr: 0.01  max_mem: 4820M
[11/22 01:58:30] d2.utils.events INFO:  eta: 0:04:12  iter: 39  total_loss: 0.3701  loss_cls: 0.1744  loss_box_reg: 0.1394  loss_rpn_cls: 0.02543  loss_rpn_loc: 0.03228  time: 0.2208  data_time: 0.0179  lr: 0.01  max_mem: 5089M
[11/22 01:58:35] d2.utils.events INFO:  eta: 0:04:07  iter: 59  total_loss: 0.2796  loss_cls: 0.1132  loss_box_reg: 0.1194  loss_rpn_cls: 0.01765  loss_rpn_loc: 0.0279  time: 0.2197  data_time: 0.0219  lr: 0.01  max_mem: 5089M
[11/22 01:58:39] d2.utils.events INFO:  eta: 0:04:02  iter: 79  total_loss: 0.2438  loss_cls: 0.09281  loss_box_reg: 0.1025  loss_rpn_cls: 0.01549  loss_rpn_loc: 0.02697  time: 0.2196  data_time: 0.0195  lr: 0.01  max_mem: 5089M
[11/22 01:58:44] d2.utils.events INFO:  eta: 0:03:58  iter: 99  total_loss: 0.2156  loss_cls: 0.08464  loss_box_reg: 0.08814  loss_rpn_cls: 0.01227  loss_rpn_loc: 0.03086  time: 0.2195  data_time: 0.0200  lr: 0.01  max_mem: 5089M
[11/22 01:58:48] d2.utils.events INFO:  eta: 0:03:54  iter: 119  total_loss: 0.2004  loss_cls: 0.07088  loss_box_reg: 0.0805  loss_rpn_cls: 0.01298  loss_rpn_loc: 0.02897  time: 0.2194  data_time: 0.0213  lr: 0.01  max_mem: 5089M
[11/22 01:58:52] d2.utils.events INFO:  eta: 0:03:50  iter: 139  total_loss: 0.1816  loss_cls: 0.07227  loss_box_reg: 0.07467  loss_rpn_cls: 0.01057  loss_rpn_loc: 0.02294  time: 0.2193  data_time: 0.0195  lr: 0.01  max_mem: 5089M
[11/22 01:58:57] d2.utils.events INFO:  eta: 0:03:45  iter: 159  total_loss: 0.1717  loss_cls: 0.06541  loss_box_reg: 0.06901  loss_rpn_cls: 0.007857  loss_rpn_loc: 0.02398  time: 0.2191  data_time: 0.0207  lr: 0.01  max_mem: 5089M
[11/22 01:59:01] d2.utils.events INFO:  eta: 0:03:41  iter: 179  total_loss: 0.1614  loss_cls: 0.06236  loss_box_reg: 0.06517  loss_rpn_cls: 0.007713  loss_rpn_loc: 0.02292  time: 0.2189  data_time: 0.0207  lr: 0.01  max_mem: 5089M
[11/22 01:59:06] d2.utils.events INFO:  eta: 0:03:37  iter: 199  total_loss: 0.1532  loss_cls: 0.06332  loss_box_reg: 0.05864  loss_rpn_cls: 0.007303  loss_rpn_loc: 0.02146  time: 0.2197  data_time: 0.0254  lr: 0.01  max_mem: 5089M
[11/22 01:59:10] d2.utils.events INFO:  eta: 0:03:33  iter: 219  total_loss: 0.1483  loss_cls: 0.05864  loss_box_reg: 0.05854  loss_rpn_cls: 0.007082  loss_rpn_loc: 0.01983  time: 0.2195  data_time: 0.0220  lr: 0.01  max_mem: 5089M
[11/22 01:59:14] d2.utils.events INFO:  eta: 0:03:29  iter: 239  total_loss: 0.1431  loss_cls: 0.05852  loss_box_reg: 0.05769  loss_rpn_cls: 0.005895  loss_rpn_loc: 0.02102  time: 0.2196  data_time: 0.0188  lr: 0.01  max_mem: 5089M
[11/22 01:59:19] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.141  loss_cls: 0.05464  loss_box_reg: 0.05475  loss_rpn_cls: 0.006342  loss_rpn_loc: 0.02136  time: 0.2196  data_time: 0.0197  lr: 0.01  max_mem: 5089M
[11/22 01:59:23] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.1456  loss_cls: 0.05774  loss_box_reg: 0.05671  loss_rpn_cls: 0.006833  loss_rpn_loc: 0.02155  time: 0.2196  data_time: 0.0205  lr: 0.01  max_mem: 5089M
[11/22 01:59:28] d2.utils.events INFO:  eta: 0:03:16  iter: 299  total_loss: 0.1348  loss_cls: 0.05345  loss_box_reg: 0.0496  loss_rpn_cls: 0.005603  loss_rpn_loc: 0.01757  time: 0.2196  data_time: 0.0209  lr: 0.01  max_mem: 5089M
[11/22 01:59:32] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1352  loss_cls: 0.05243  loss_box_reg: 0.05001  loss_rpn_cls: 0.006375  loss_rpn_loc: 0.0267  time: 0.2198  data_time: 0.0226  lr: 0.01  max_mem: 5089M
[11/22 01:59:37] d2.utils.events INFO:  eta: 0:03:07  iter: 339  total_loss: 0.1262  loss_cls: 0.05139  loss_box_reg: 0.04883  loss_rpn_cls: 0.005566  loss_rpn_loc: 0.01793  time: 0.2197  data_time: 0.0199  lr: 0.01  max_mem: 5089M
[11/22 01:59:41] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1279  loss_cls: 0.05356  loss_box_reg: 0.04762  loss_rpn_cls: 0.004982  loss_rpn_loc: 0.0206  time: 0.2197  data_time: 0.0189  lr: 0.01  max_mem: 5089M
[11/22 01:59:46] d2.utils.events INFO:  eta: 0:02:58  iter: 379  total_loss: 0.123  loss_cls: 0.05455  loss_box_reg: 0.04831  loss_rpn_cls: 0.004647  loss_rpn_loc: 0.01476  time: 0.2194  data_time: 0.0200  lr: 0.01  max_mem: 5089M
[11/22 01:59:50] d2.utils.events INFO:  eta: 0:02:54  iter: 399  total_loss: 0.123  loss_cls: 0.05409  loss_box_reg: 0.04741  loss_rpn_cls: 0.00472  loss_rpn_loc: 0.01722  time: 0.2193  data_time: 0.0206  lr: 0.01  max_mem: 5089M
[11/22 01:59:54] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.1214  loss_cls: 0.05072  loss_box_reg: 0.04678  loss_rpn_cls: 0.00433  loss_rpn_loc: 0.01794  time: 0.2192  data_time: 0.0212  lr: 0.01  max_mem: 5089M
[11/22 01:59:59] d2.utils.events INFO:  eta: 0:02:45  iter: 439  total_loss: 0.1193  loss_cls: 0.0525  loss_box_reg: 0.0447  loss_rpn_cls: 0.00464  loss_rpn_loc: 0.01962  time: 0.2192  data_time: 0.0216  lr: 0.01  max_mem: 5089M
[11/22 02:00:03] d2.utils.events INFO:  eta: 0:02:41  iter: 459  total_loss: 0.1186  loss_cls: 0.05133  loss_box_reg: 0.04471  loss_rpn_cls: 0.003955  loss_rpn_loc: 0.01665  time: 0.2191  data_time: 0.0200  lr: 0.01  max_mem: 5089M
[11/22 02:00:07] d2.utils.events INFO:  eta: 0:02:36  iter: 479  total_loss: 0.1149  loss_cls: 0.05096  loss_box_reg: 0.04342  loss_rpn_cls: 0.003664  loss_rpn_loc: 0.01388  time: 0.2191  data_time: 0.0196  lr: 0.01  max_mem: 5089M
[11/22 02:00:12] d2.utils.events INFO:  eta: 0:02:32  iter: 499  total_loss: 0.1181  loss_cls: 0.04851  loss_box_reg: 0.04378  loss_rpn_cls: 0.004076  loss_rpn_loc: 0.01857  time: 0.2190  data_time: 0.0194  lr: 0.01  max_mem: 5089M
[11/22 02:00:16] d2.utils.events INFO:  eta: 0:02:28  iter: 519  total_loss: 0.1153  loss_cls: 0.04807  loss_box_reg: 0.04202  loss_rpn_cls: 0.004116  loss_rpn_loc: 0.01595  time: 0.2191  data_time: 0.0194  lr: 0.01  max_mem: 5089M
[11/22 02:00:21] d2.utils.events INFO:  eta: 0:02:23  iter: 539  total_loss: 0.1124  loss_cls: 0.04988  loss_box_reg: 0.04374  loss_rpn_cls: 0.003899  loss_rpn_loc: 0.01457  time: 0.2191  data_time: 0.0190  lr: 0.01  max_mem: 5089M
[11/22 02:00:25] d2.utils.events INFO:  eta: 0:02:19  iter: 559  total_loss: 0.1145  loss_cls: 0.04754  loss_box_reg: 0.04088  loss_rpn_cls: 0.004198  loss_rpn_loc: 0.01683  time: 0.2190  data_time: 0.0219  lr: 0.01  max_mem: 5089M
[11/22 02:00:29] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1095  loss_cls: 0.0476  loss_box_reg: 0.04043  loss_rpn_cls: 0.003863  loss_rpn_loc: 0.01626  time: 0.2192  data_time: 0.0223  lr: 0.01  max_mem: 5089M
[11/22 02:00:34] d2.utils.events INFO:  eta: 0:02:10  iter: 599  total_loss: 0.1065  loss_cls: 0.04705  loss_box_reg: 0.04024  loss_rpn_cls: 0.003854  loss_rpn_loc: 0.01552  time: 0.2192  data_time: 0.0193  lr: 0.01  max_mem: 5089M
[11/22 02:00:38] d2.utils.events INFO:  eta: 0:02:06  iter: 619  total_loss: 0.1105  loss_cls: 0.04728  loss_box_reg: 0.03978  loss_rpn_cls: 0.00438  loss_rpn_loc: 0.01646  time: 0.2192  data_time: 0.0182  lr: 0.01  max_mem: 5089M
[11/22 02:00:43] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1046  loss_cls: 0.04523  loss_box_reg: 0.03936  loss_rpn_cls: 0.003805  loss_rpn_loc: 0.01438  time: 0.2192  data_time: 0.0188  lr: 0.01  max_mem: 5089M
[11/22 02:00:47] d2.utils.events INFO:  eta: 0:01:57  iter: 659  total_loss: 0.1048  loss_cls: 0.04595  loss_box_reg: 0.03848  loss_rpn_cls: 0.003584  loss_rpn_loc: 0.01718  time: 0.2192  data_time: 0.0200  lr: 0.01  max_mem: 5089M
[11/22 02:00:51] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.1064  loss_cls: 0.04664  loss_box_reg: 0.03808  loss_rpn_cls: 0.003972  loss_rpn_loc: 0.01574  time: 0.2191  data_time: 0.0199  lr: 0.01  max_mem: 5089M
[11/22 02:00:56] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.09985  loss_cls: 0.04497  loss_box_reg: 0.03877  loss_rpn_cls: 0.00312  loss_rpn_loc: 0.01488  time: 0.2191  data_time: 0.0200  lr: 0.01  max_mem: 5089M
[11/22 02:01:00] d2.utils.events INFO:  eta: 0:01:44  iter: 719  total_loss: 0.101  loss_cls: 0.0444  loss_box_reg: 0.03715  loss_rpn_cls: 0.003642  loss_rpn_loc: 0.01367  time: 0.2193  data_time: 0.0200  lr: 0.01  max_mem: 5089M
[11/22 02:01:05] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1034  loss_cls: 0.04465  loss_box_reg: 0.03744  loss_rpn_cls: 0.003375  loss_rpn_loc: 0.0169  time: 0.2193  data_time: 0.0191  lr: 0.01  max_mem: 5089M
[11/22 02:01:09] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.1026  loss_cls: 0.04705  loss_box_reg: 0.03667  loss_rpn_cls: 0.003792  loss_rpn_loc: 0.0146  time: 0.2193  data_time: 0.0192  lr: 0.01  max_mem: 5089M
[11/22 02:01:14] d2.utils.events INFO:  eta: 0:01:31  iter: 779  total_loss: 0.1007  loss_cls: 0.04644  loss_box_reg: 0.03778  loss_rpn_cls: 0.003612  loss_rpn_loc: 0.01265  time: 0.2193  data_time: 0.0206  lr: 0.01  max_mem: 5089M
[11/22 02:01:18] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.09923  loss_cls: 0.04558  loss_box_reg: 0.03658  loss_rpn_cls: 0.00339  loss_rpn_loc: 0.0128  time: 0.2193  data_time: 0.0206  lr: 0.01  max_mem: 5089M
[11/22 02:01:22] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1007  loss_cls: 0.044  loss_box_reg: 0.03664  loss_rpn_cls: 0.003397  loss_rpn_loc: 0.01249  time: 0.2193  data_time: 0.0194  lr: 0.01  max_mem: 5089M
[11/22 02:01:27] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09872  loss_cls: 0.04332  loss_box_reg: 0.03321  loss_rpn_cls: 0.003576  loss_rpn_loc: 0.0149  time: 0.2193  data_time: 0.0203  lr: 0.01  max_mem: 5089M
[11/22 02:01:31] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.1026  loss_cls: 0.04543  loss_box_reg: 0.03454  loss_rpn_cls: 0.003662  loss_rpn_loc: 0.01358  time: 0.2194  data_time: 0.0197  lr: 0.01  max_mem: 5089M
[11/22 02:01:36] d2.utils.events INFO:  eta: 0:01:09  iter: 879  total_loss: 0.09781  loss_cls: 0.04367  loss_box_reg: 0.03414  loss_rpn_cls: 0.002796  loss_rpn_loc: 0.01488  time: 0.2193  data_time: 0.0189  lr: 0.01  max_mem: 5089M
[11/22 02:01:40] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09797  loss_cls: 0.04189  loss_box_reg: 0.03355  loss_rpn_cls: 0.003091  loss_rpn_loc: 0.01532  time: 0.2193  data_time: 0.0179  lr: 0.01  max_mem: 5089M
[11/22 02:01:44] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.0985  loss_cls: 0.04362  loss_box_reg: 0.03471  loss_rpn_cls: 0.003519  loss_rpn_loc: 0.0143  time: 0.2193  data_time: 0.0186  lr: 0.01  max_mem: 5089M
[11/22 02:01:49] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09756  loss_cls: 0.04257  loss_box_reg: 0.03426  loss_rpn_cls: 0.003212  loss_rpn_loc: 0.01648  time: 0.2193  data_time: 0.0205  lr: 0.01  max_mem: 5089M
[11/22 02:01:53] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09301  loss_cls: 0.04263  loss_box_reg: 0.03314  loss_rpn_cls: 0.003308  loss_rpn_loc: 0.01213  time: 0.2192  data_time: 0.0186  lr: 0.01  max_mem: 5089M
[11/22 02:01:58] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.0906  loss_cls: 0.043  loss_box_reg: 0.03327  loss_rpn_cls: 0.003334  loss_rpn_loc: 0.0107  time: 0.2192  data_time: 0.0195  lr: 0.001  max_mem: 5089M
[11/22 02:02:02] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.09086  loss_cls: 0.04427  loss_box_reg: 0.03358  loss_rpn_cls: 0.002824  loss_rpn_loc: 0.009829  time: 0.2192  data_time: 0.0208  lr: 0.001  max_mem: 5089M
[11/22 02:02:06] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08635  loss_cls: 0.04556  loss_box_reg: 0.03225  loss_rpn_cls: 0.002708  loss_rpn_loc: 0.005894  time: 0.2191  data_time: 0.0186  lr: 0.001  max_mem: 5089M
[11/22 02:02:11] d2.utils.events INFO:  eta: 0:00:34  iter: 1039  total_loss: 0.08575  loss_cls: 0.04236  loss_box_reg: 0.03147  loss_rpn_cls: 0.003068  loss_rpn_loc: 0.008096  time: 0.2191  data_time: 0.0196  lr: 0.001  max_mem: 5089M
[11/22 02:02:15] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08615  loss_cls: 0.04464  loss_box_reg: 0.03198  loss_rpn_cls: 0.002726  loss_rpn_loc: 0.006122  time: 0.2191  data_time: 0.0190  lr: 0.001  max_mem: 5089M
[11/22 02:02:19] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08912  loss_cls: 0.04588  loss_box_reg: 0.03339  loss_rpn_cls: 0.002643  loss_rpn_loc: 0.006732  time: 0.2191  data_time: 0.0191  lr: 0.001  max_mem: 5089M
[11/22 02:02:24] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08671  loss_cls: 0.04214  loss_box_reg: 0.03184  loss_rpn_cls: 0.002929  loss_rpn_loc: 0.006729  time: 0.2191  data_time: 0.0192  lr: 0.001  max_mem: 5089M
[11/22 02:02:28] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08782  loss_cls: 0.04608  loss_box_reg: 0.03258  loss_rpn_cls: 0.003185  loss_rpn_loc: 0.007141  time: 0.2190  data_time: 0.0202  lr: 0.001  max_mem: 5089M
[11/22 02:02:32] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08506  loss_cls: 0.04261  loss_box_reg: 0.03249  loss_rpn_cls: 0.003268  loss_rpn_loc: 0.006936  time: 0.2190  data_time: 0.0181  lr: 0.001  max_mem: 5089M
[11/22 02:02:37] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08673  loss_cls: 0.04206  loss_box_reg: 0.03285  loss_rpn_cls: 0.002894  loss_rpn_loc: 0.006723  time: 0.2190  data_time: 0.0213  lr: 0.001  max_mem: 5089M
[11/22 02:02:41] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08452  loss_cls: 0.0421  loss_box_reg: 0.03171  loss_rpn_cls: 0.00314  loss_rpn_loc: 0.007248  time: 0.2190  data_time: 0.0193  lr: 0.001  max_mem: 5089M
[11/22 02:02:46] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 02:02:48] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.0867  loss_cls: 0.04326  loss_box_reg: 0.03212  loss_rpn_cls: 0.00252  loss_rpn_loc: 0.005717  time: 0.2189  data_time: 0.0200  lr: 0.001  max_mem: 5089M
[11/22 02:02:48] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:22 (0.2190 s / it)
[11/22 02:02:48] d2.engine.hooks INFO: Total training time: 0:04:25 (0:00:03 on hooks)
[11/22 02:02:49] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 02:02:49] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:02:49] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 02:02:49] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 02:02:49] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 02:02:49] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 02:02:50] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:02:50] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 02:02:50] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 02:02:50] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 02:03:03] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0608 s / img. ETA=0:01:12
[11/22 02:03:06] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0597 s / img. ETA=0:01:07
[11/22 02:03:09] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0597 s / img. ETA=0:01:04
[11/22 02:03:12] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0596 s / img. ETA=0:01:01
[11/22 02:03:15] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0594 s / img. ETA=0:00:58
[11/22 02:03:18] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0594 s / img. ETA=0:00:55
[11/22 02:03:21] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0592 s / img. ETA=0:00:52
[11/22 02:03:24] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0591 s / img. ETA=0:00:49
[11/22 02:03:27] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0591 s / img. ETA=0:00:46
[11/22 02:03:30] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0589 s / img. ETA=0:00:43
[11/22 02:03:33] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0589 s / img. ETA=0:00:40
[11/22 02:03:36] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0589 s / img. ETA=0:00:37
[11/22 02:03:39] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0591 s / img. ETA=0:00:34
[11/22 02:03:41] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0590 s / img. ETA=0:00:31
[11/22 02:03:44] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0590 s / img. ETA=0:00:28
[11/22 02:03:47] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0590 s / img. ETA=0:00:25
[11/22 02:03:50] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0589 s / img. ETA=0:00:22
[11/22 02:03:53] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0589 s / img. ETA=0:00:19
[11/22 02:03:56] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0588 s / img. ETA=0:00:16
[11/22 02:03:59] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0588 s / img. ETA=0:00:13
[11/22 02:04:02] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0588 s / img. ETA=0:00:11
[11/22 02:04:05] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0588 s / img. ETA=0:00:08
[11/22 02:04:08] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0588 s / img. ETA=0:00:05
[11/22 02:04:11] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0587 s / img. ETA=0:00:02
[11/22 02:04:13] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:12 (0.058394 s / img per device, on 4 devices)
[11/22 02:04:13] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.056922 s / img per device, on 4 devices)
[11/22 02:04:14] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 02:04:20] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 54.492 | 71.797 | 34.592 |   58.964    | 52.494 |
[11/22 02:04:20] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 29.948 | 54.468 | 30.216 | 29.948 | 54.468  | 30.216  |
[11/22 02:04:20] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 02:04:20] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 02:04:20] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 02:04:20] defrcn.evaluation.testing INFO: copypaste: 29.9481,54.4675,30.2165,29.9481,54.4675,30.2165
[11/22 02:04:36] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 02:04:36] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 02:04:36] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 02:04:36] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 02:04:36] d2.utils.env INFO: Using a generated random seed 39313522
[11/22 02:04:37] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 02:04:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 02:04:39] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 02:04:39] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:04:39] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 02:04:39] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 02:04:39] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 02:04:39] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 02:04:40] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 02:04:40] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:04:40] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 02:04:40] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 02:04:42] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 02:04:55] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0617 s / img. ETA=0:01:13
[11/22 02:04:58] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0607 s / img. ETA=0:01:09
[11/22 02:05:00] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0603 s / img. ETA=0:01:05
[11/22 02:05:03] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0601 s / img. ETA=0:01:02
[11/22 02:05:06] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0598 s / img. ETA=0:00:59
[11/22 02:05:09] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0598 s / img. ETA=0:00:56
[11/22 02:05:12] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0596 s / img. ETA=0:00:52
[11/22 02:05:15] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0595 s / img. ETA=0:00:49
[11/22 02:05:18] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0595 s / img. ETA=0:00:46
[11/22 02:05:21] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0594 s / img. ETA=0:00:43
[11/22 02:05:24] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0593 s / img. ETA=0:00:40
[11/22 02:05:27] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0593 s / img. ETA=0:00:37
[11/22 02:05:30] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0592 s / img. ETA=0:00:34
[11/22 02:05:33] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0592 s / img. ETA=0:00:31
[11/22 02:05:36] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0591 s / img. ETA=0:00:28
[11/22 02:05:39] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0591 s / img. ETA=0:00:25
[11/22 02:05:42] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0591 s / img. ETA=0:00:22
[11/22 02:05:45] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0590 s / img. ETA=0:00:19
[11/22 02:05:47] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0589 s / img. ETA=0:00:16
[11/22 02:05:50] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0589 s / img. ETA=0:00:14
[11/22 02:05:53] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0589 s / img. ETA=0:00:11
[11/22 02:05:56] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0589 s / img. ETA=0:00:08
[11/22 02:05:59] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0588 s / img. ETA=0:00:05
[11/22 02:06:02] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0588 s / img. ETA=0:00:02
[11/22 02:06:05] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:12 (0.058394 s / img per device, on 4 devices)
[11/22 02:06:05] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:09 (0.056411 s / img per device, on 4 devices)
[11/22 02:06:11] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 02:06:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.642    |  86.599   | 72.361 |  74.380  | 88.526 | 88.086 | 69.427  |    75.546     | 86.911 | 84.122  |  86.271  |    55.765     | 81.280  | 85.756  |   82.154    | 61.399 | 70.798 | 57.788 |   59.767    | 52.714 |
[11/22 02:06:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.774 | 75.215 | 51.452 | 53.069 | 80.122  | 58.759  | 31.889 | 60.493  | 29.534  |
[11/22 02:06:36] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 02:06:36] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 02:06:36] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 02:06:36] defrcn.evaluation.testing INFO: copypaste: 47.7740,75.2146,51.4524,53.0689,80.1218,58.7587,31.8891,60.4932,29.5336
[11/22 02:06:51] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 02:06:51] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 02:06:51] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 02:06:51] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 02:06:51] d2.utils.env INFO: Using a generated random seed 54012813
[11/22 02:06:51] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 02:06:51] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 02:06:51] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 02:06:51] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 02:06:51] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 02:06:52] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 02:06:52] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 02:06:52] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 02:06:52] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 02:07:00] d2.utils.events INFO:  eta: 0:04:16  iter: 19  total_loss: 0.5714  loss_cls: 0.3099  loss_box_reg: 0.1704  loss_rpn_cls: 0.04878  loss_rpn_loc: 0.05332  time: 0.2188  data_time: 0.1989  lr: 0.01  max_mem: 5088M
[11/22 02:07:05] d2.utils.events INFO:  eta: 0:04:14  iter: 39  total_loss: 0.3573  loss_cls: 0.143  loss_box_reg: 0.1417  loss_rpn_cls: 0.0249  loss_rpn_loc: 0.04305  time: 0.2206  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 02:07:09] d2.utils.events INFO:  eta: 0:04:10  iter: 59  total_loss: 0.2902  loss_cls: 0.106  loss_box_reg: 0.1237  loss_rpn_cls: 0.01912  loss_rpn_loc: 0.0316  time: 0.2207  data_time: 0.0211  lr: 0.01  max_mem: 5088M
[11/22 02:07:14] d2.utils.events INFO:  eta: 0:04:06  iter: 79  total_loss: 0.255  loss_cls: 0.08976  loss_box_reg: 0.1035  loss_rpn_cls: 0.01525  loss_rpn_loc: 0.03153  time: 0.2209  data_time: 0.0214  lr: 0.01  max_mem: 5088M
[11/22 02:07:18] d2.utils.events INFO:  eta: 0:04:02  iter: 99  total_loss: 0.2203  loss_cls: 0.07862  loss_box_reg: 0.09129  loss_rpn_cls: 0.0158  loss_rpn_loc: 0.03506  time: 0.2208  data_time: 0.0188  lr: 0.01  max_mem: 5088M
[11/22 02:07:22] d2.utils.events INFO:  eta: 0:03:57  iter: 119  total_loss: 0.1885  loss_cls: 0.06717  loss_box_reg: 0.07875  loss_rpn_cls: 0.01152  loss_rpn_loc: 0.02549  time: 0.2200  data_time: 0.0205  lr: 0.01  max_mem: 5088M
[11/22 02:07:27] d2.utils.events INFO:  eta: 0:03:51  iter: 139  total_loss: 0.1846  loss_cls: 0.06691  loss_box_reg: 0.06754  loss_rpn_cls: 0.01259  loss_rpn_loc: 0.02742  time: 0.2197  data_time: 0.0195  lr: 0.01  max_mem: 5088M
[11/22 02:07:31] d2.utils.events INFO:  eta: 0:03:46  iter: 159  total_loss: 0.168  loss_cls: 0.0589  loss_box_reg: 0.06641  loss_rpn_cls: 0.009844  loss_rpn_loc: 0.02399  time: 0.2195  data_time: 0.0212  lr: 0.01  max_mem: 5088M
[11/22 02:07:35] d2.utils.events INFO:  eta: 0:03:43  iter: 179  total_loss: 0.157  loss_cls: 0.05836  loss_box_reg: 0.06105  loss_rpn_cls: 0.009046  loss_rpn_loc: 0.02558  time: 0.2194  data_time: 0.0196  lr: 0.01  max_mem: 5088M
[11/22 02:07:40] d2.utils.events INFO:  eta: 0:03:38  iter: 199  total_loss: 0.1527  loss_cls: 0.05935  loss_box_reg: 0.06089  loss_rpn_cls: 0.009619  loss_rpn_loc: 0.02501  time: 0.2192  data_time: 0.0219  lr: 0.01  max_mem: 5088M
[11/22 02:07:44] d2.utils.events INFO:  eta: 0:03:33  iter: 219  total_loss: 0.1519  loss_cls: 0.05813  loss_box_reg: 0.05344  loss_rpn_cls: 0.008916  loss_rpn_loc: 0.02753  time: 0.2191  data_time: 0.0202  lr: 0.01  max_mem: 5088M
[11/22 02:07:49] d2.utils.events INFO:  eta: 0:03:29  iter: 239  total_loss: 0.1427  loss_cls: 0.05772  loss_box_reg: 0.05391  loss_rpn_cls: 0.007904  loss_rpn_loc: 0.02253  time: 0.2191  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 02:07:53] d2.utils.events INFO:  eta: 0:03:25  iter: 259  total_loss: 0.133  loss_cls: 0.05316  loss_box_reg: 0.04988  loss_rpn_cls: 0.007205  loss_rpn_loc: 0.02152  time: 0.2191  data_time: 0.0217  lr: 0.01  max_mem: 5088M
[11/22 02:07:57] d2.utils.events INFO:  eta: 0:03:21  iter: 279  total_loss: 0.1434  loss_cls: 0.05429  loss_box_reg: 0.04941  loss_rpn_cls: 0.006563  loss_rpn_loc: 0.02491  time: 0.2190  data_time: 0.0209  lr: 0.01  max_mem: 5088M
[11/22 02:08:02] d2.utils.events INFO:  eta: 0:03:16  iter: 299  total_loss: 0.1342  loss_cls: 0.05047  loss_box_reg: 0.04985  loss_rpn_cls: 0.0062  loss_rpn_loc: 0.02375  time: 0.2190  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 02:08:06] d2.utils.events INFO:  eta: 0:03:12  iter: 319  total_loss: 0.1337  loss_cls: 0.04869  loss_box_reg: 0.04652  loss_rpn_cls: 0.007215  loss_rpn_loc: 0.02349  time: 0.2190  data_time: 0.0175  lr: 0.01  max_mem: 5088M
[11/22 02:08:11] d2.utils.events INFO:  eta: 0:03:08  iter: 339  total_loss: 0.1291  loss_cls: 0.05184  loss_box_reg: 0.04649  loss_rpn_cls: 0.005588  loss_rpn_loc: 0.01836  time: 0.2190  data_time: 0.0188  lr: 0.01  max_mem: 5088M
[11/22 02:08:15] d2.utils.events INFO:  eta: 0:03:03  iter: 359  total_loss: 0.1136  loss_cls: 0.04624  loss_box_reg: 0.04225  loss_rpn_cls: 0.005097  loss_rpn_loc: 0.01826  time: 0.2190  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 02:08:19] d2.utils.events INFO:  eta: 0:02:59  iter: 379  total_loss: 0.1168  loss_cls: 0.05002  loss_box_reg: 0.04409  loss_rpn_cls: 0.005175  loss_rpn_loc: 0.01698  time: 0.2191  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 02:08:24] d2.utils.events INFO:  eta: 0:02:54  iter: 399  total_loss: 0.1171  loss_cls: 0.05034  loss_box_reg: 0.04776  loss_rpn_cls: 0.005128  loss_rpn_loc: 0.01817  time: 0.2189  data_time: 0.0176  lr: 0.01  max_mem: 5088M
[11/22 02:08:28] d2.utils.events INFO:  eta: 0:02:50  iter: 419  total_loss: 0.1201  loss_cls: 0.04869  loss_box_reg: 0.04351  loss_rpn_cls: 0.006734  loss_rpn_loc: 0.02157  time: 0.2188  data_time: 0.0189  lr: 0.01  max_mem: 5088M
[11/22 02:08:33] d2.utils.events INFO:  eta: 0:02:46  iter: 439  total_loss: 0.1218  loss_cls: 0.04705  loss_box_reg: 0.04175  loss_rpn_cls: 0.005842  loss_rpn_loc: 0.01948  time: 0.2189  data_time: 0.0181  lr: 0.01  max_mem: 5088M
[11/22 02:08:37] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1102  loss_cls: 0.04459  loss_box_reg: 0.04166  loss_rpn_cls: 0.005134  loss_rpn_loc: 0.01733  time: 0.2190  data_time: 0.0204  lr: 0.01  max_mem: 5088M
[11/22 02:08:41] d2.utils.events INFO:  eta: 0:02:37  iter: 479  total_loss: 0.1084  loss_cls: 0.04685  loss_box_reg: 0.04216  loss_rpn_cls: 0.004831  loss_rpn_loc: 0.01522  time: 0.2190  data_time: 0.0208  lr: 0.01  max_mem: 5088M
[11/22 02:08:46] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1113  loss_cls: 0.04999  loss_box_reg: 0.04294  loss_rpn_cls: 0.004375  loss_rpn_loc: 0.01449  time: 0.2189  data_time: 0.0187  lr: 0.01  max_mem: 5088M
[11/22 02:08:50] d2.utils.events INFO:  eta: 0:02:28  iter: 519  total_loss: 0.1085  loss_cls: 0.04513  loss_box_reg: 0.03826  loss_rpn_cls: 0.004252  loss_rpn_loc: 0.01711  time: 0.2193  data_time: 0.0192  lr: 0.01  max_mem: 5088M
[11/22 02:08:55] d2.utils.events INFO:  eta: 0:02:24  iter: 539  total_loss: 0.1045  loss_cls: 0.0453  loss_box_reg: 0.03897  loss_rpn_cls: 0.004345  loss_rpn_loc: 0.0155  time: 0.2193  data_time: 0.0202  lr: 0.01  max_mem: 5088M
[11/22 02:08:59] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1065  loss_cls: 0.04497  loss_box_reg: 0.03879  loss_rpn_cls: 0.004499  loss_rpn_loc: 0.01914  time: 0.2193  data_time: 0.0200  lr: 0.01  max_mem: 5088M
[11/22 02:09:04] d2.utils.events INFO:  eta: 0:02:15  iter: 579  total_loss: 0.1097  loss_cls: 0.04671  loss_box_reg: 0.04167  loss_rpn_cls: 0.00411  loss_rpn_loc: 0.01643  time: 0.2192  data_time: 0.0179  lr: 0.01  max_mem: 5088M
[11/22 02:09:08] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1112  loss_cls: 0.04675  loss_box_reg: 0.04019  loss_rpn_cls: 0.004276  loss_rpn_loc: 0.02032  time: 0.2192  data_time: 0.0179  lr: 0.01  max_mem: 5088M
[11/22 02:09:12] d2.utils.events INFO:  eta: 0:02:06  iter: 619  total_loss: 0.1088  loss_cls: 0.04362  loss_box_reg: 0.03823  loss_rpn_cls: 0.004161  loss_rpn_loc: 0.0209  time: 0.2192  data_time: 0.0203  lr: 0.01  max_mem: 5088M
[11/22 02:09:17] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1077  loss_cls: 0.04343  loss_box_reg: 0.03862  loss_rpn_cls: 0.004076  loss_rpn_loc: 0.01727  time: 0.2193  data_time: 0.0196  lr: 0.01  max_mem: 5088M
[11/22 02:09:21] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1054  loss_cls: 0.04457  loss_box_reg: 0.03851  loss_rpn_cls: 0.003643  loss_rpn_loc: 0.01447  time: 0.2193  data_time: 0.0177  lr: 0.01  max_mem: 5088M
[11/22 02:09:26] d2.utils.events INFO:  eta: 0:01:53  iter: 679  total_loss: 0.1012  loss_cls: 0.04223  loss_box_reg: 0.03666  loss_rpn_cls: 0.00439  loss_rpn_loc: 0.01745  time: 0.2192  data_time: 0.0199  lr: 0.01  max_mem: 5088M
[11/22 02:09:30] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.105  loss_cls: 0.0443  loss_box_reg: 0.03814  loss_rpn_cls: 0.003249  loss_rpn_loc: 0.01576  time: 0.2193  data_time: 0.0207  lr: 0.01  max_mem: 5088M
[11/22 02:09:34] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.0983  loss_cls: 0.04214  loss_box_reg: 0.03461  loss_rpn_cls: 0.003842  loss_rpn_loc: 0.01661  time: 0.2193  data_time: 0.0172  lr: 0.01  max_mem: 5088M
[11/22 02:09:39] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.1007  loss_cls: 0.04383  loss_box_reg: 0.03627  loss_rpn_cls: 0.003526  loss_rpn_loc: 0.01753  time: 0.2193  data_time: 0.0174  lr: 0.01  max_mem: 5088M
[11/22 02:09:43] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.09765  loss_cls: 0.04081  loss_box_reg: 0.03468  loss_rpn_cls: 0.003852  loss_rpn_loc: 0.01538  time: 0.2193  data_time: 0.0194  lr: 0.01  max_mem: 5088M
[11/22 02:09:48] d2.utils.events INFO:  eta: 0:01:31  iter: 779  total_loss: 0.09778  loss_cls: 0.04257  loss_box_reg: 0.03624  loss_rpn_cls: 0.003666  loss_rpn_loc: 0.01372  time: 0.2194  data_time: 0.0200  lr: 0.01  max_mem: 5088M
[11/22 02:09:52] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.09804  loss_cls: 0.04222  loss_box_reg: 0.03465  loss_rpn_cls: 0.00359  loss_rpn_loc: 0.01545  time: 0.2193  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 02:09:56] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.1019  loss_cls: 0.04329  loss_box_reg: 0.03488  loss_rpn_cls: 0.003954  loss_rpn_loc: 0.01551  time: 0.2193  data_time: 0.0179  lr: 0.01  max_mem: 5088M
[11/22 02:10:01] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09684  loss_cls: 0.04066  loss_box_reg: 0.03245  loss_rpn_cls: 0.003813  loss_rpn_loc: 0.01534  time: 0.2193  data_time: 0.0194  lr: 0.01  max_mem: 5088M
[11/22 02:10:05] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.1019  loss_cls: 0.04086  loss_box_reg: 0.03342  loss_rpn_cls: 0.004526  loss_rpn_loc: 0.01767  time: 0.2192  data_time: 0.0182  lr: 0.01  max_mem: 5088M
[11/22 02:10:10] d2.utils.events INFO:  eta: 0:01:09  iter: 879  total_loss: 0.09452  loss_cls: 0.03997  loss_box_reg: 0.03268  loss_rpn_cls: 0.003286  loss_rpn_loc: 0.01336  time: 0.2193  data_time: 0.0177  lr: 0.01  max_mem: 5088M
[11/22 02:10:14] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09669  loss_cls: 0.04011  loss_box_reg: 0.03405  loss_rpn_cls: 0.004064  loss_rpn_loc: 0.01862  time: 0.2193  data_time: 0.0185  lr: 0.01  max_mem: 5088M
[11/22 02:10:19] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09261  loss_cls: 0.04061  loss_box_reg: 0.03101  loss_rpn_cls: 0.003564  loss_rpn_loc: 0.01271  time: 0.2193  data_time: 0.0189  lr: 0.01  max_mem: 5088M
[11/22 02:10:23] d2.utils.events INFO:  eta: 0:00:56  iter: 939  total_loss: 0.09743  loss_cls: 0.04298  loss_box_reg: 0.0344  loss_rpn_cls: 0.003687  loss_rpn_loc: 0.01888  time: 0.2193  data_time: 0.0183  lr: 0.01  max_mem: 5088M
[11/22 02:10:27] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09491  loss_cls: 0.04048  loss_box_reg: 0.03394  loss_rpn_cls: 0.003469  loss_rpn_loc: 0.01499  time: 0.2194  data_time: 0.0193  lr: 0.01  max_mem: 5088M
[11/22 02:10:32] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.08666  loss_cls: 0.03916  loss_box_reg: 0.03068  loss_rpn_cls: 0.003641  loss_rpn_loc: 0.01054  time: 0.2194  data_time: 0.0209  lr: 0.001  max_mem: 5088M
[11/22 02:10:36] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08304  loss_cls: 0.03736  loss_box_reg: 0.03206  loss_rpn_cls: 0.00342  loss_rpn_loc: 0.009204  time: 0.2194  data_time: 0.0204  lr: 0.001  max_mem: 5088M
[11/22 02:10:41] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.08506  loss_cls: 0.04075  loss_box_reg: 0.03149  loss_rpn_cls: 0.003149  loss_rpn_loc: 0.007735  time: 0.2194  data_time: 0.0196  lr: 0.001  max_mem: 5088M
[11/22 02:10:45] d2.utils.events INFO:  eta: 0:00:34  iter: 1039  total_loss: 0.0844  loss_cls: 0.04  loss_box_reg: 0.03159  loss_rpn_cls: 0.00276  loss_rpn_loc: 0.007795  time: 0.2193  data_time: 0.0190  lr: 0.001  max_mem: 5088M
[11/22 02:10:49] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08436  loss_cls: 0.03966  loss_box_reg: 0.03096  loss_rpn_cls: 0.002981  loss_rpn_loc: 0.00816  time: 0.2193  data_time: 0.0197  lr: 0.001  max_mem: 5088M
[11/22 02:10:54] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.08118  loss_cls: 0.04139  loss_box_reg: 0.02997  loss_rpn_cls: 0.002925  loss_rpn_loc: 0.006419  time: 0.2193  data_time: 0.0187  lr: 0.001  max_mem: 5088M
[11/22 02:10:58] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.0783  loss_cls: 0.0365  loss_box_reg: 0.03003  loss_rpn_cls: 0.003054  loss_rpn_loc: 0.007645  time: 0.2193  data_time: 0.0202  lr: 0.001  max_mem: 5088M
[11/22 02:11:03] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.085  loss_cls: 0.03995  loss_box_reg: 0.03169  loss_rpn_cls: 0.003744  loss_rpn_loc: 0.008439  time: 0.2193  data_time: 0.0193  lr: 0.001  max_mem: 5088M
[11/22 02:11:07] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08527  loss_cls: 0.03946  loss_box_reg: 0.03204  loss_rpn_cls: 0.003535  loss_rpn_loc: 0.007093  time: 0.2192  data_time: 0.0191  lr: 0.001  max_mem: 5088M
[11/22 02:11:11] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.08177  loss_cls: 0.0418  loss_box_reg: 0.03146  loss_rpn_cls: 0.002645  loss_rpn_loc: 0.00729  time: 0.2192  data_time: 0.0194  lr: 0.001  max_mem: 5088M
[11/22 02:11:16] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.0824  loss_cls: 0.0392  loss_box_reg: 0.03175  loss_rpn_cls: 0.003528  loss_rpn_loc: 0.008478  time: 0.2192  data_time: 0.0181  lr: 0.001  max_mem: 5088M
[11/22 02:11:20] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 02:11:22] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.08605  loss_cls: 0.04078  loss_box_reg: 0.03381  loss_rpn_cls: 0.002932  loss_rpn_loc: 0.006437  time: 0.2192  data_time: 0.0178  lr: 0.001  max_mem: 5088M
[11/22 02:11:22] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:22 (0.2193 s / it)
[11/22 02:11:22] d2.engine.hooks INFO: Total training time: 0:04:25 (0:00:03 on hooks)
[11/22 02:11:24] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 02:11:24] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:11:24] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 02:11:24] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 02:11:24] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 02:11:24] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 02:11:25] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:11:25] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 02:11:25] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 02:11:25] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 02:11:38] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0637 s / img. ETA=0:01:15
[11/22 02:11:41] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0638 s / img. ETA=0:01:12
[11/22 02:11:45] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0636 s / img. ETA=0:01:09
[11/22 02:11:48] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0637 s / img. ETA=0:01:06
[11/22 02:11:51] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0644 s / img. ETA=0:01:03
[11/22 02:11:55] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0648 s / img. ETA=0:01:00
[11/22 02:11:58] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0647 s / img. ETA=0:00:57
[11/22 02:12:01] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0645 s / img. ETA=0:00:54
[11/22 02:12:04] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0646 s / img. ETA=0:00:50
[11/22 02:12:07] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0645 s / img. ETA=0:00:47
[11/22 02:12:10] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0643 s / img. ETA=0:00:44
[11/22 02:12:14] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0644 s / img. ETA=0:00:41
[11/22 02:12:17] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0644 s / img. ETA=0:00:37
[11/22 02:12:20] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0645 s / img. ETA=0:00:34
[11/22 02:12:24] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0646 s / img. ETA=0:00:31
[11/22 02:12:27] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0647 s / img. ETA=0:00:28
[11/22 02:12:30] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0648 s / img. ETA=0:00:25
[11/22 02:12:33] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0647 s / img. ETA=0:00:21
[11/22 02:12:37] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0647 s / img. ETA=0:00:18
[11/22 02:12:40] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0646 s / img. ETA=0:00:15
[11/22 02:12:43] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0645 s / img. ETA=0:00:12
[11/22 02:12:46] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0645 s / img. ETA=0:00:08
[11/22 02:12:49] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0644 s / img. ETA=0:00:05
[11/22 02:12:52] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0644 s / img. ETA=0:00:02
[11/22 02:12:55] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:19 (0.064071 s / img per device, on 4 devices)
[11/22 02:12:55] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:16 (0.061980 s / img per device, on 4 devices)
[11/22 02:12:55] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 02:13:03] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.646 | 69.417 | 52.199 |   59.463    | 52.630 |
[11/22 02:13:03] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 32.344 | 57.471 | 32.079 | 32.344 | 57.471  | 32.079  |
[11/22 02:13:03] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 02:13:03] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 02:13:03] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 02:13:03] defrcn.evaluation.testing INFO: copypaste: 32.3440,57.4709,32.0790,32.3440,57.4709,32.0790
[11/22 02:13:18] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 02:13:18] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 02:13:18] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 02:13:18] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 02:13:18] d2.utils.env INFO: Using a generated random seed 21022762
[11/22 02:13:18] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 02:13:18] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 02:13:20] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 02:13:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:13:20] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 02:13:20] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 02:13:20] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 02:13:20] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 02:13:21] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 02:13:21] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:13:21] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 02:13:21] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 02:13:23] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 02:13:37] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0655 s / img. ETA=0:01:17
[11/22 02:13:40] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0636 s / img. ETA=0:01:12
[11/22 02:13:43] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0641 s / img. ETA=0:01:09
[11/22 02:13:46] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0643 s / img. ETA=0:01:06
[11/22 02:13:49] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0643 s / img. ETA=0:01:03
[11/22 02:13:53] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0644 s / img. ETA=0:01:00
[11/22 02:13:56] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0647 s / img. ETA=0:00:57
[11/22 02:13:59] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0647 s / img. ETA=0:00:54
[11/22 02:14:02] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0644 s / img. ETA=0:00:50
[11/22 02:14:06] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0643 s / img. ETA=0:00:47
[11/22 02:14:09] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0640 s / img. ETA=0:00:44
[11/22 02:14:12] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0639 s / img. ETA=0:00:40
[11/22 02:14:15] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0640 s / img. ETA=0:00:37
[11/22 02:14:18] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0640 s / img. ETA=0:00:34
[11/22 02:14:21] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0640 s / img. ETA=0:00:31
[11/22 02:14:25] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0639 s / img. ETA=0:00:27
[11/22 02:14:28] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0639 s / img. ETA=0:00:24
[11/22 02:14:31] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0638 s / img. ETA=0:00:21
[11/22 02:14:34] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0637 s / img. ETA=0:00:18
[11/22 02:14:37] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0637 s / img. ETA=0:00:15
[11/22 02:14:40] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0637 s / img. ETA=0:00:11
[11/22 02:14:43] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0637 s / img. ETA=0:00:08
[11/22 02:14:47] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0636 s / img. ETA=0:00:05
[11/22 02:14:50] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0635 s / img. ETA=0:00:02
[11/22 02:14:52] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:18 (0.063260 s / img per device, on 4 devices)
[11/22 02:14:52] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:14 (0.060596 s / img per device, on 4 devices)
[11/22 02:14:53] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 02:15:18] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   85.323    |  86.632   | 72.414 |  74.028  | 88.634 | 87.925 | 69.142  |    73.854     | 86.610 | 85.081  |  86.342  |    56.448     | 81.786  | 84.933  |   82.337    | 61.658 | 71.830 | 61.840 |   62.124    | 52.355 |
[11/22 02:15:18] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.475 | 75.565 | 52.295 | 53.417 | 80.099  | 59.464  | 33.648 | 61.961  | 30.788  |
[11/22 02:15:18] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 02:15:18] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 02:15:18] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 02:15:18] defrcn.evaluation.testing INFO: copypaste: 48.4746,75.5649,52.2947,53.4167,80.0994,59.4636,33.6481,61.9613,30.7880
[11/22 02:15:33] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 02:15:33] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 02:15:33] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_2shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 02:15:33] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 02:15:33] d2.utils.env INFO: Using a generated random seed 35852477
[11/22 02:15:33] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 02:15:33] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 02:15:33] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 2            |    bus     | 2            |    cow     | 2            |
| motorbike  | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 02:15:33] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 02:15:33] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 02:15:33] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 02:15:33] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 02:15:34] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 02:15:34] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 02:15:42] d2.utils.events INFO:  eta: 0:04:19  iter: 19  total_loss: 0.6048  loss_cls: 0.3355  loss_box_reg: 0.1722  loss_rpn_cls: 0.04757  loss_rpn_loc: 0.04954  time: 0.2202  data_time: 0.2056  lr: 0.01  max_mem: 4910M
[11/22 02:15:46] d2.utils.events INFO:  eta: 0:04:16  iter: 39  total_loss: 0.3545  loss_cls: 0.1391  loss_box_reg: 0.1482  loss_rpn_cls: 0.02841  loss_rpn_loc: 0.04195  time: 0.2216  data_time: 0.0198  lr: 0.01  max_mem: 5087M
[11/22 02:15:51] d2.utils.events INFO:  eta: 0:04:12  iter: 59  total_loss: 0.2829  loss_cls: 0.1014  loss_box_reg: 0.1325  loss_rpn_cls: 0.01888  loss_rpn_loc: 0.03135  time: 0.2220  data_time: 0.0240  lr: 0.01  max_mem: 5087M
[11/22 02:15:55] d2.utils.events INFO:  eta: 0:04:07  iter: 79  total_loss: 0.2467  loss_cls: 0.08552  loss_box_reg: 0.1042  loss_rpn_cls: 0.01674  loss_rpn_loc: 0.03625  time: 0.2222  data_time: 0.0220  lr: 0.01  max_mem: 5087M
[11/22 02:16:00] d2.utils.events INFO:  eta: 0:04:03  iter: 99  total_loss: 0.2162  loss_cls: 0.07728  loss_box_reg: 0.09319  loss_rpn_cls: 0.01274  loss_rpn_loc: 0.03068  time: 0.2223  data_time: 0.0197  lr: 0.01  max_mem: 5087M
[11/22 02:16:04] d2.utils.events INFO:  eta: 0:03:59  iter: 119  total_loss: 0.2032  loss_cls: 0.07359  loss_box_reg: 0.07773  loss_rpn_cls: 0.01174  loss_rpn_loc: 0.03202  time: 0.2218  data_time: 0.0210  lr: 0.01  max_mem: 5087M
[11/22 02:16:09] d2.utils.events INFO:  eta: 0:03:54  iter: 139  total_loss: 0.1858  loss_cls: 0.06838  loss_box_reg: 0.07169  loss_rpn_cls: 0.01237  loss_rpn_loc: 0.02862  time: 0.2215  data_time: 0.0186  lr: 0.01  max_mem: 5087M
[11/22 02:16:13] d2.utils.events INFO:  eta: 0:03:49  iter: 159  total_loss: 0.169  loss_cls: 0.06377  loss_box_reg: 0.066  loss_rpn_cls: 0.01133  loss_rpn_loc: 0.02327  time: 0.2215  data_time: 0.0191  lr: 0.01  max_mem: 5087M
[11/22 02:16:18] d2.utils.events INFO:  eta: 0:03:45  iter: 179  total_loss: 0.1707  loss_cls: 0.06124  loss_box_reg: 0.06633  loss_rpn_cls: 0.009358  loss_rpn_loc: 0.0315  time: 0.2213  data_time: 0.0172  lr: 0.01  max_mem: 5087M
[11/22 02:16:22] d2.utils.events INFO:  eta: 0:03:40  iter: 199  total_loss: 0.1488  loss_cls: 0.05429  loss_box_reg: 0.05812  loss_rpn_cls: 0.009122  loss_rpn_loc: 0.02334  time: 0.2214  data_time: 0.0196  lr: 0.01  max_mem: 5087M
[11/22 02:16:26] d2.utils.events INFO:  eta: 0:03:36  iter: 219  total_loss: 0.1532  loss_cls: 0.05638  loss_box_reg: 0.06204  loss_rpn_cls: 0.008778  loss_rpn_loc: 0.02535  time: 0.2213  data_time: 0.0210  lr: 0.01  max_mem: 5087M
[11/22 02:16:31] d2.utils.events INFO:  eta: 0:03:31  iter: 239  total_loss: 0.1463  loss_cls: 0.05701  loss_box_reg: 0.05568  loss_rpn_cls: 0.007981  loss_rpn_loc: 0.02571  time: 0.2215  data_time: 0.0191  lr: 0.01  max_mem: 5087M
[11/22 02:16:35] d2.utils.events INFO:  eta: 0:03:27  iter: 259  total_loss: 0.1396  loss_cls: 0.05299  loss_box_reg: 0.05119  loss_rpn_cls: 0.008113  loss_rpn_loc: 0.0233  time: 0.2217  data_time: 0.0205  lr: 0.01  max_mem: 5087M
[11/22 02:16:40] d2.utils.events INFO:  eta: 0:03:23  iter: 279  total_loss: 0.1339  loss_cls: 0.05417  loss_box_reg: 0.0545  loss_rpn_cls: 0.00613  loss_rpn_loc: 0.01914  time: 0.2214  data_time: 0.0181  lr: 0.01  max_mem: 5087M
[11/22 02:16:44] d2.utils.events INFO:  eta: 0:03:18  iter: 299  total_loss: 0.1339  loss_cls: 0.05109  loss_box_reg: 0.05158  loss_rpn_cls: 0.006022  loss_rpn_loc: 0.02048  time: 0.2212  data_time: 0.0178  lr: 0.01  max_mem: 5087M
[11/22 02:16:49] d2.utils.events INFO:  eta: 0:03:14  iter: 319  total_loss: 0.1349  loss_cls: 0.05389  loss_box_reg: 0.05398  loss_rpn_cls: 0.006076  loss_rpn_loc: 0.02213  time: 0.2212  data_time: 0.0168  lr: 0.01  max_mem: 5087M
[11/22 02:16:53] d2.utils.events INFO:  eta: 0:03:09  iter: 339  total_loss: 0.1314  loss_cls: 0.05269  loss_box_reg: 0.05244  loss_rpn_cls: 0.005099  loss_rpn_loc: 0.01675  time: 0.2213  data_time: 0.0190  lr: 0.01  max_mem: 5087M
[11/22 02:16:57] d2.utils.events INFO:  eta: 0:03:05  iter: 359  total_loss: 0.1339  loss_cls: 0.04967  loss_box_reg: 0.05167  loss_rpn_cls: 0.00539  loss_rpn_loc: 0.02061  time: 0.2212  data_time: 0.0175  lr: 0.01  max_mem: 5087M
[11/22 02:17:02] d2.utils.events INFO:  eta: 0:03:00  iter: 379  total_loss: 0.1233  loss_cls: 0.04694  loss_box_reg: 0.05065  loss_rpn_cls: 0.006274  loss_rpn_loc: 0.01875  time: 0.2210  data_time: 0.0206  lr: 0.01  max_mem: 5087M
[11/22 02:17:06] d2.utils.events INFO:  eta: 0:02:56  iter: 399  total_loss: 0.1242  loss_cls: 0.0481  loss_box_reg: 0.04596  loss_rpn_cls: 0.005625  loss_rpn_loc: 0.01912  time: 0.2210  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 02:17:11] d2.utils.events INFO:  eta: 0:02:51  iter: 419  total_loss: 0.1247  loss_cls: 0.04916  loss_box_reg: 0.04707  loss_rpn_cls: 0.006042  loss_rpn_loc: 0.0181  time: 0.2208  data_time: 0.0173  lr: 0.01  max_mem: 5087M
[11/22 02:17:15] d2.utils.events INFO:  eta: 0:02:47  iter: 439  total_loss: 0.1187  loss_cls: 0.04787  loss_box_reg: 0.04446  loss_rpn_cls: 0.005085  loss_rpn_loc: 0.01827  time: 0.2208  data_time: 0.0174  lr: 0.01  max_mem: 5087M
[11/22 02:17:19] d2.utils.events INFO:  eta: 0:02:42  iter: 459  total_loss: 0.1177  loss_cls: 0.04978  loss_box_reg: 0.04822  loss_rpn_cls: 0.004011  loss_rpn_loc: 0.01689  time: 0.2207  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 02:17:24] d2.utils.events INFO:  eta: 0:02:38  iter: 479  total_loss: 0.1185  loss_cls: 0.04754  loss_box_reg: 0.04254  loss_rpn_cls: 0.004318  loss_rpn_loc: 0.01862  time: 0.2205  data_time: 0.0194  lr: 0.01  max_mem: 5087M
[11/22 02:17:28] d2.utils.events INFO:  eta: 0:02:33  iter: 499  total_loss: 0.1135  loss_cls: 0.04406  loss_box_reg: 0.0438  loss_rpn_cls: 0.004932  loss_rpn_loc: 0.01769  time: 0.2204  data_time: 0.0170  lr: 0.01  max_mem: 5087M
[11/22 02:17:33] d2.utils.events INFO:  eta: 0:02:29  iter: 519  total_loss: 0.1131  loss_cls: 0.04508  loss_box_reg: 0.04407  loss_rpn_cls: 0.00428  loss_rpn_loc: 0.01615  time: 0.2204  data_time: 0.0191  lr: 0.01  max_mem: 5087M
[11/22 02:17:37] d2.utils.events INFO:  eta: 0:02:25  iter: 539  total_loss: 0.1091  loss_cls: 0.0429  loss_box_reg: 0.04201  loss_rpn_cls: 0.003496  loss_rpn_loc: 0.01438  time: 0.2203  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 02:17:41] d2.utils.events INFO:  eta: 0:02:20  iter: 559  total_loss: 0.1132  loss_cls: 0.04516  loss_box_reg: 0.04423  loss_rpn_cls: 0.004295  loss_rpn_loc: 0.02114  time: 0.2202  data_time: 0.0189  lr: 0.01  max_mem: 5087M
[11/22 02:17:46] d2.utils.events INFO:  eta: 0:02:16  iter: 579  total_loss: 0.115  loss_cls: 0.04498  loss_box_reg: 0.04327  loss_rpn_cls: 0.004134  loss_rpn_loc: 0.02069  time: 0.2202  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 02:17:50] d2.utils.events INFO:  eta: 0:02:11  iter: 599  total_loss: 0.1132  loss_cls: 0.04739  loss_box_reg: 0.04378  loss_rpn_cls: 0.003409  loss_rpn_loc: 0.01988  time: 0.2202  data_time: 0.0172  lr: 0.01  max_mem: 5087M
[11/22 02:17:55] d2.utils.events INFO:  eta: 0:02:07  iter: 619  total_loss: 0.1094  loss_cls: 0.04302  loss_box_reg: 0.04047  loss_rpn_cls: 0.004586  loss_rpn_loc: 0.01843  time: 0.2201  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 02:17:59] d2.utils.events INFO:  eta: 0:02:02  iter: 639  total_loss: 0.1056  loss_cls: 0.04213  loss_box_reg: 0.03811  loss_rpn_cls: 0.004793  loss_rpn_loc: 0.01918  time: 0.2201  data_time: 0.0187  lr: 0.01  max_mem: 5087M
[11/22 02:18:03] d2.utils.events INFO:  eta: 0:01:58  iter: 659  total_loss: 0.1047  loss_cls: 0.04082  loss_box_reg: 0.03981  loss_rpn_cls: 0.004638  loss_rpn_loc: 0.01458  time: 0.2200  data_time: 0.0171  lr: 0.01  max_mem: 5087M
[11/22 02:18:08] d2.utils.events INFO:  eta: 0:01:54  iter: 679  total_loss: 0.1061  loss_cls: 0.04592  loss_box_reg: 0.04089  loss_rpn_cls: 0.003869  loss_rpn_loc: 0.01433  time: 0.2200  data_time: 0.0175  lr: 0.01  max_mem: 5087M
[11/22 02:18:12] d2.utils.events INFO:  eta: 0:01:49  iter: 699  total_loss: 0.1003  loss_cls: 0.04343  loss_box_reg: 0.03686  loss_rpn_cls: 0.004303  loss_rpn_loc: 0.01506  time: 0.2198  data_time: 0.0174  lr: 0.01  max_mem: 5087M
[11/22 02:18:17] d2.utils.events INFO:  eta: 0:01:45  iter: 719  total_loss: 0.1063  loss_cls: 0.04169  loss_box_reg: 0.03924  loss_rpn_cls: 0.00446  loss_rpn_loc: 0.01741  time: 0.2200  data_time: 0.0177  lr: 0.01  max_mem: 5087M
[11/22 02:18:21] d2.utils.events INFO:  eta: 0:01:40  iter: 739  total_loss: 0.09992  loss_cls: 0.04215  loss_box_reg: 0.03913  loss_rpn_cls: 0.003943  loss_rpn_loc: 0.01274  time: 0.2201  data_time: 0.0168  lr: 0.01  max_mem: 5087M
[11/22 02:18:25] d2.utils.events INFO:  eta: 0:01:36  iter: 759  total_loss: 0.09885  loss_cls: 0.04296  loss_box_reg: 0.03773  loss_rpn_cls: 0.002936  loss_rpn_loc: 0.01348  time: 0.2201  data_time: 0.0157  lr: 0.01  max_mem: 5087M
[11/22 02:18:30] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.09768  loss_cls: 0.0442  loss_box_reg: 0.03792  loss_rpn_cls: 0.003429  loss_rpn_loc: 0.01358  time: 0.2200  data_time: 0.0168  lr: 0.01  max_mem: 5087M
[11/22 02:18:34] d2.utils.events INFO:  eta: 0:01:27  iter: 799  total_loss: 0.1006  loss_cls: 0.04243  loss_box_reg: 0.03714  loss_rpn_cls: 0.004188  loss_rpn_loc: 0.01805  time: 0.2200  data_time: 0.0168  lr: 0.01  max_mem: 5087M
[11/22 02:18:39] d2.utils.events INFO:  eta: 0:01:23  iter: 819  total_loss: 0.09927  loss_cls: 0.04126  loss_box_reg: 0.03642  loss_rpn_cls: 0.005064  loss_rpn_loc: 0.01878  time: 0.2200  data_time: 0.0172  lr: 0.01  max_mem: 5087M
[11/22 02:18:43] d2.utils.events INFO:  eta: 0:01:18  iter: 839  total_loss: 0.09879  loss_cls: 0.04325  loss_box_reg: 0.03638  loss_rpn_cls: 0.004182  loss_rpn_loc: 0.0155  time: 0.2200  data_time: 0.0174  lr: 0.01  max_mem: 5087M
[11/22 02:18:47] d2.utils.events INFO:  eta: 0:01:14  iter: 859  total_loss: 0.09627  loss_cls: 0.04025  loss_box_reg: 0.03488  loss_rpn_cls: 0.003199  loss_rpn_loc: 0.01368  time: 0.2200  data_time: 0.0171  lr: 0.01  max_mem: 5087M
[11/22 02:18:52] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.09937  loss_cls: 0.03963  loss_box_reg: 0.03499  loss_rpn_cls: 0.004206  loss_rpn_loc: 0.01923  time: 0.2200  data_time: 0.0166  lr: 0.01  max_mem: 5087M
[11/22 02:18:56] d2.utils.events INFO:  eta: 0:01:05  iter: 899  total_loss: 0.09315  loss_cls: 0.04123  loss_box_reg: 0.03539  loss_rpn_cls: 0.003709  loss_rpn_loc: 0.01196  time: 0.2199  data_time: 0.0173  lr: 0.01  max_mem: 5087M
[11/22 02:19:01] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.09556  loss_cls: 0.04082  loss_box_reg: 0.0365  loss_rpn_cls: 0.00402  loss_rpn_loc: 0.01363  time: 0.2199  data_time: 0.0181  lr: 0.01  max_mem: 5087M
[11/22 02:19:05] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.08923  loss_cls: 0.03904  loss_box_reg: 0.03351  loss_rpn_cls: 0.003171  loss_rpn_loc: 0.01249  time: 0.2199  data_time: 0.0182  lr: 0.01  max_mem: 5087M
[11/22 02:19:09] d2.utils.events INFO:  eta: 0:00:52  iter: 959  total_loss: 0.09538  loss_cls: 0.04321  loss_box_reg: 0.0351  loss_rpn_cls: 0.002921  loss_rpn_loc: 0.01197  time: 0.2199  data_time: 0.0180  lr: 0.01  max_mem: 5087M
[11/22 02:19:14] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.09314  loss_cls: 0.04207  loss_box_reg: 0.03639  loss_rpn_cls: 0.003145  loss_rpn_loc: 0.01011  time: 0.2198  data_time: 0.0163  lr: 0.001  max_mem: 5087M
[11/22 02:19:18] d2.utils.events INFO:  eta: 0:00:43  iter: 999  total_loss: 0.08915  loss_cls: 0.04007  loss_box_reg: 0.0344  loss_rpn_cls: 0.003096  loss_rpn_loc: 0.008064  time: 0.2198  data_time: 0.0183  lr: 0.001  max_mem: 5087M
[11/22 02:19:23] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.0874  loss_cls: 0.03923  loss_box_reg: 0.0332  loss_rpn_cls: 0.003096  loss_rpn_loc: 0.008646  time: 0.2198  data_time: 0.0184  lr: 0.001  max_mem: 5087M
[11/22 02:19:27] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.08473  loss_cls: 0.03959  loss_box_reg: 0.03237  loss_rpn_cls: 0.003004  loss_rpn_loc: 0.007832  time: 0.2198  data_time: 0.0186  lr: 0.001  max_mem: 5087M
[11/22 02:19:31] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.08815  loss_cls: 0.03894  loss_box_reg: 0.03373  loss_rpn_cls: 0.004325  loss_rpn_loc: 0.008203  time: 0.2198  data_time: 0.0166  lr: 0.001  max_mem: 5087M
[11/22 02:19:36] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.0844  loss_cls: 0.03797  loss_box_reg: 0.03311  loss_rpn_cls: 0.002999  loss_rpn_loc: 0.008608  time: 0.2198  data_time: 0.0178  lr: 0.001  max_mem: 5087M
[11/22 02:19:40] d2.utils.events INFO:  eta: 0:00:21  iter: 1099  total_loss: 0.08155  loss_cls: 0.03937  loss_box_reg: 0.03228  loss_rpn_cls: 0.002815  loss_rpn_loc: 0.007256  time: 0.2198  data_time: 0.0173  lr: 0.001  max_mem: 5087M
[11/22 02:19:45] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.08436  loss_cls: 0.03868  loss_box_reg: 0.03267  loss_rpn_cls: 0.002643  loss_rpn_loc: 0.00834  time: 0.2198  data_time: 0.0173  lr: 0.001  max_mem: 5087M
[11/22 02:19:49] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.08503  loss_cls: 0.04149  loss_box_reg: 0.03274  loss_rpn_cls: 0.002919  loss_rpn_loc: 0.007023  time: 0.2198  data_time: 0.0191  lr: 0.001  max_mem: 5087M
[11/22 02:19:54] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.09051  loss_cls: 0.041  loss_box_reg: 0.03452  loss_rpn_cls: 0.00338  loss_rpn_loc: 0.008123  time: 0.2198  data_time: 0.0172  lr: 0.001  max_mem: 5087M
[11/22 02:19:58] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.08794  loss_cls: 0.03873  loss_box_reg: 0.03507  loss_rpn_cls: 0.003862  loss_rpn_loc: 0.008419  time: 0.2198  data_time: 0.0161  lr: 0.001  max_mem: 5087M
[11/22 02:20:02] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final.pth
[11/22 02:20:04] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.0839  loss_cls: 0.04026  loss_box_reg: 0.03155  loss_rpn_cls: 0.002728  loss_rpn_loc: 0.007376  time: 0.2198  data_time: 0.0180  lr: 0.001  max_mem: 5087M
[11/22 02:20:04] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:23 (0.2198 s / it)
[11/22 02:20:04] d2.engine.hooks INFO: Total training time: 0:04:26 (0:00:03 on hooks)
[11/22 02:20:06] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 02:20:06] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:20:06] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 02:20:07] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 02:20:07] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 02:20:07] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 02:20:08] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:20:08] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 02:20:08] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 02:20:08] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 02:20:22] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0666 s / img. ETA=0:01:19
[11/22 02:20:25] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0642 s / img. ETA=0:01:13
[11/22 02:20:28] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0643 s / img. ETA=0:01:09
[11/22 02:20:31] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0641 s / img. ETA=0:01:06
[11/22 02:20:34] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0639 s / img. ETA=0:01:03
[11/22 02:20:37] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0638 s / img. ETA=0:00:59
[11/22 02:20:41] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0636 s / img. ETA=0:00:56
[11/22 02:20:44] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0634 s / img. ETA=0:00:53
[11/22 02:20:47] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0634 s / img. ETA=0:00:49
[11/22 02:20:50] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0632 s / img. ETA=0:00:46
[11/22 02:20:53] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0632 s / img. ETA=0:00:43
[11/22 02:20:56] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0632 s / img. ETA=0:00:40
[11/22 02:20:59] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0631 s / img. ETA=0:00:37
[11/22 02:21:02] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0629 s / img. ETA=0:00:33
[11/22 02:21:05] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0629 s / img. ETA=0:00:30
[11/22 02:21:09] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0628 s / img. ETA=0:00:27
[11/22 02:21:12] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0626 s / img. ETA=0:00:24
[11/22 02:21:15] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0626 s / img. ETA=0:00:21
[11/22 02:21:18] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0626 s / img. ETA=0:00:18
[11/22 02:21:21] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0627 s / img. ETA=0:00:14
[11/22 02:21:24] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0626 s / img. ETA=0:00:11
[11/22 02:21:27] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0626 s / img. ETA=0:00:08
[11/22 02:21:30] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0625 s / img. ETA=0:00:05
[11/22 02:21:33] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0623 s / img. ETA=0:00:02
[11/22 02:21:36] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:17 (0.062449 s / img per device, on 4 devices)
[11/22 02:21:36] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:14 (0.060017 s / img per device, on 4 devices)
[11/22 02:21:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 02:21:42] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 53.177 | 71.202 | 47.441 |   58.746    | 52.562 |
[11/22 02:21:42] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.687 | 56.626 | 30.752 | 31.687 | 56.626  | 30.752  |
[11/22 02:21:42] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 02:21:42] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 02:21:42] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 02:21:42] defrcn.evaluation.testing INFO: copypaste: 31.6872,56.6256,30.7520,31.6872,56.6256,30.7520
[11/22 02:21:59] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 02:21:59] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5'], resume=False, start_iter=-1)
[11/22 02:21:59] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_2shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_2shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 02:21:59] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/config.yaml
[11/22 02:21:59] d2.utils.env INFO: Using a generated random seed 62234084
[11/22 02:21:59] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 02:22:00] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/2shot_seed5/model_final-merge.pth ...
[11/22 02:22:01] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 02:22:01] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:22:01] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 02:22:01] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 02:22:01] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 02:22:01] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 02:22:03] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 2            |   bicycle   | 2            |    boat     | 2            |
|   bottle   | 2            |     car     | 2            |     cat     | 2            |
|   chair    | 2            | diningtable | 2            |     dog     | 2            |
|   horse    | 2            |   person    | 2            | pottedplant | 2            |
|   sheep    | 2            |    train    | 2            |  tvmonitor  | 2            |
|    bird    | 2            |     bus     | 2            |     cow     | 2            |
| motorbike  | 2            |    sofa     | 2            |             |              |
|   total    | 40           |             |              |             |              |[0m
[11/22 02:22:03] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 02:22:03] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 02:22:03] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 02:22:05] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 02:22:18] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0660 s / img. ETA=0:01:18
[11/22 02:22:21] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0647 s / img. ETA=0:01:13
[11/22 02:22:24] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0647 s / img. ETA=0:01:10
[11/22 02:22:27] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0649 s / img. ETA=0:01:07
[11/22 02:22:31] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0647 s / img. ETA=0:01:03
[11/22 02:22:34] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0648 s / img. ETA=0:01:00
[11/22 02:22:37] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0645 s / img. ETA=0:00:57
[11/22 02:22:40] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0642 s / img. ETA=0:00:53
[11/22 02:22:43] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0642 s / img. ETA=0:00:50
[11/22 02:22:46] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0640 s / img. ETA=0:00:47
[11/22 02:22:49] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0638 s / img. ETA=0:00:43
[11/22 02:22:53] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0637 s / img. ETA=0:00:40
[11/22 02:22:56] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0637 s / img. ETA=0:00:37
[11/22 02:22:59] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0636 s / img. ETA=0:00:34
[11/22 02:23:02] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0635 s / img. ETA=0:00:31
[11/22 02:23:05] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0634 s / img. ETA=0:00:27
[11/22 02:23:08] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0635 s / img. ETA=0:00:24
[11/22 02:23:11] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0633 s / img. ETA=0:00:21
[11/22 02:23:14] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0632 s / img. ETA=0:00:18
[11/22 02:23:17] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0631 s / img. ETA=0:00:15
[11/22 02:23:21] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0631 s / img. ETA=0:00:11
[11/22 02:23:24] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0629 s / img. ETA=0:00:08
[11/22 02:23:27] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0628 s / img. ETA=0:00:05
[11/22 02:23:29] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0626 s / img. ETA=0:00:02
[11/22 02:23:32] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:17 (0.062449 s / img per device, on 4 devices)
[11/22 02:23:32] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:13 (0.059863 s / img per device, on 4 devices)
[11/22 02:23:32] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 02:23:58] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.790    |  86.764   | 73.567 |  73.577  | 88.664 | 88.167 | 68.617  |    74.811     | 87.139 | 84.741  |  86.252  |    54.913     | 81.661  | 85.178  |   82.124    | 60.637 | 70.530 | 64.896 |   58.783    | 52.305 |
[11/22 02:23:58] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.225 | 75.406 | 51.953 | 53.270 | 80.064  | 58.858  | 33.091 | 61.430  | 31.238  |
[11/22 02:23:58] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 02:23:58] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 02:23:58] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 02:23:58] defrcn.evaluation.testing INFO: copypaste: 48.2250,75.4058,51.9526,53.2697,80.0643,58.8576,33.0911,61.4303,31.2378
