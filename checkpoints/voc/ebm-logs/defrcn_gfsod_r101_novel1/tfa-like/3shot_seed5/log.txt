[11/21 18:41:01] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 18:41:01] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/21 18:41:01] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_3shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1280,)
  MAX_ITER: 1600
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 18:41:01] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/21 18:41:01] d2.utils.env INFO: Using a generated random seed 3273433
[11/21 18:41:01] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 18:41:01] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 15 images left.
[11/21 18:41:01] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 3            |    bus     | 3            |    cow     | 3            |
| motorbike  | 3            |    sofa    | 3            |            |              |
|   total    | 15           |            |              |            |              |[0m
[11/21 18:41:01] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/21 18:41:01] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/21 18:41:02] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/21 18:41:02] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 18:41:02] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/21 18:41:02] d2.engine.train_loop INFO: Starting training from iteration 0
[11/21 18:41:10] d2.utils.events INFO:  eta: 0:05:40  iter: 19  total_loss: 0.5225  loss_cls: 0.2741  loss_box_reg: 0.1401  loss_rpn_cls: 0.04697  loss_rpn_loc: 0.06114  time: 0.2182  data_time: 0.1997  lr: 0.01  max_mem: 4918M
[11/21 18:41:14] d2.utils.events INFO:  eta: 0:05:37  iter: 39  total_loss: 0.3692  loss_cls: 0.1479  loss_box_reg: 0.1331  loss_rpn_cls: 0.02967  loss_rpn_loc: 0.0487  time: 0.2178  data_time: 0.0192  lr: 0.01  max_mem: 4918M
[11/21 18:41:19] d2.utils.events INFO:  eta: 0:05:33  iter: 59  total_loss: 0.2885  loss_cls: 0.0942  loss_box_reg: 0.1184  loss_rpn_cls: 0.02481  loss_rpn_loc: 0.04678  time: 0.2174  data_time: 0.0203  lr: 0.01  max_mem: 4918M
[11/21 18:41:23] d2.utils.events INFO:  eta: 0:05:30  iter: 79  total_loss: 0.253  loss_cls: 0.07964  loss_box_reg: 0.1053  loss_rpn_cls: 0.01893  loss_rpn_loc: 0.04237  time: 0.2177  data_time: 0.0183  lr: 0.01  max_mem: 4918M
[11/21 18:41:27] d2.utils.events INFO:  eta: 0:05:26  iter: 99  total_loss: 0.2345  loss_cls: 0.07553  loss_box_reg: 0.09733  loss_rpn_cls: 0.02003  loss_rpn_loc: 0.04616  time: 0.2172  data_time: 0.0195  lr: 0.01  max_mem: 4918M
[11/21 18:41:32] d2.utils.events INFO:  eta: 0:05:21  iter: 119  total_loss: 0.2045  loss_cls: 0.0631  loss_box_reg: 0.08137  loss_rpn_cls: 0.01504  loss_rpn_loc: 0.03747  time: 0.2173  data_time: 0.0209  lr: 0.01  max_mem: 5091M
[11/21 18:41:36] d2.utils.events INFO:  eta: 0:05:17  iter: 139  total_loss: 0.1994  loss_cls: 0.06645  loss_box_reg: 0.07599  loss_rpn_cls: 0.01475  loss_rpn_loc: 0.036  time: 0.2174  data_time: 0.0180  lr: 0.01  max_mem: 5091M
[11/21 18:41:40] d2.utils.events INFO:  eta: 0:05:12  iter: 159  total_loss: 0.1785  loss_cls: 0.06124  loss_box_reg: 0.06513  loss_rpn_cls: 0.01412  loss_rpn_loc: 0.03651  time: 0.2173  data_time: 0.0186  lr: 0.01  max_mem: 5091M
[11/21 18:41:45] d2.utils.events INFO:  eta: 0:05:08  iter: 179  total_loss: 0.1631  loss_cls: 0.05864  loss_box_reg: 0.06094  loss_rpn_cls: 0.01121  loss_rpn_loc: 0.03204  time: 0.2176  data_time: 0.0195  lr: 0.01  max_mem: 5091M
[11/21 18:41:49] d2.utils.events INFO:  eta: 0:05:04  iter: 199  total_loss: 0.1632  loss_cls: 0.05783  loss_box_reg: 0.05806  loss_rpn_cls: 0.01108  loss_rpn_loc: 0.03324  time: 0.2177  data_time: 0.0212  lr: 0.01  max_mem: 5091M
[11/21 18:41:54] d2.utils.events INFO:  eta: 0:04:59  iter: 219  total_loss: 0.151  loss_cls: 0.05428  loss_box_reg: 0.05154  loss_rpn_cls: 0.01248  loss_rpn_loc: 0.03605  time: 0.2177  data_time: 0.0212  lr: 0.01  max_mem: 5091M
[11/21 18:41:58] d2.utils.events INFO:  eta: 0:04:54  iter: 239  total_loss: 0.1498  loss_cls: 0.05584  loss_box_reg: 0.04912  loss_rpn_cls: 0.0106  loss_rpn_loc: 0.02796  time: 0.2179  data_time: 0.0205  lr: 0.01  max_mem: 5091M
[11/21 18:42:02] d2.utils.events INFO:  eta: 0:04:50  iter: 259  total_loss: 0.1427  loss_cls: 0.05406  loss_box_reg: 0.04872  loss_rpn_cls: 0.008818  loss_rpn_loc: 0.02559  time: 0.2180  data_time: 0.0202  lr: 0.01  max_mem: 5091M
[11/21 18:42:07] d2.utils.events INFO:  eta: 0:04:46  iter: 279  total_loss: 0.1419  loss_cls: 0.05269  loss_box_reg: 0.04932  loss_rpn_cls: 0.0102  loss_rpn_loc: 0.02996  time: 0.2180  data_time: 0.0195  lr: 0.01  max_mem: 5091M
[11/21 18:42:11] d2.utils.events INFO:  eta: 0:04:42  iter: 299  total_loss: 0.1379  loss_cls: 0.04953  loss_box_reg: 0.04476  loss_rpn_cls: 0.009396  loss_rpn_loc: 0.02962  time: 0.2180  data_time: 0.0195  lr: 0.01  max_mem: 5091M
[11/21 18:42:16] d2.utils.events INFO:  eta: 0:04:38  iter: 319  total_loss: 0.1399  loss_cls: 0.04664  loss_box_reg: 0.04929  loss_rpn_cls: 0.01021  loss_rpn_loc: 0.02979  time: 0.2182  data_time: 0.0203  lr: 0.01  max_mem: 5091M
[11/21 18:42:20] d2.utils.events INFO:  eta: 0:04:33  iter: 339  total_loss: 0.1351  loss_cls: 0.04615  loss_box_reg: 0.04306  loss_rpn_cls: 0.009568  loss_rpn_loc: 0.02925  time: 0.2183  data_time: 0.0188  lr: 0.01  max_mem: 5091M
[11/21 18:42:24] d2.utils.events INFO:  eta: 0:04:29  iter: 359  total_loss: 0.1314  loss_cls: 0.05052  loss_box_reg: 0.04688  loss_rpn_cls: 0.007245  loss_rpn_loc: 0.02526  time: 0.2183  data_time: 0.0194  lr: 0.01  max_mem: 5091M
[11/21 18:42:29] d2.utils.events INFO:  eta: 0:04:25  iter: 379  total_loss: 0.1253  loss_cls: 0.04618  loss_box_reg: 0.04312  loss_rpn_cls: 0.007336  loss_rpn_loc: 0.02685  time: 0.2183  data_time: 0.0182  lr: 0.01  max_mem: 5091M
[11/21 18:42:33] d2.utils.events INFO:  eta: 0:04:20  iter: 399  total_loss: 0.1219  loss_cls: 0.04392  loss_box_reg: 0.04085  loss_rpn_cls: 0.007058  loss_rpn_loc: 0.02648  time: 0.2182  data_time: 0.0169  lr: 0.01  max_mem: 5091M
[11/21 18:42:38] d2.utils.events INFO:  eta: 0:04:16  iter: 419  total_loss: 0.1227  loss_cls: 0.04903  loss_box_reg: 0.04076  loss_rpn_cls: 0.007974  loss_rpn_loc: 0.02304  time: 0.2186  data_time: 0.0177  lr: 0.01  max_mem: 5091M
[11/21 18:42:43] d2.utils.events INFO:  eta: 0:04:12  iter: 439  total_loss: 0.1294  loss_cls: 0.04711  loss_box_reg: 0.04169  loss_rpn_cls: 0.007986  loss_rpn_loc: 0.03164  time: 0.2185  data_time: 0.0166  lr: 0.01  max_mem: 5091M
[11/21 18:42:47] d2.utils.events INFO:  eta: 0:04:07  iter: 459  total_loss: 0.1229  loss_cls: 0.04451  loss_box_reg: 0.03818  loss_rpn_cls: 0.007816  loss_rpn_loc: 0.0301  time: 0.2185  data_time: 0.0192  lr: 0.01  max_mem: 5091M
[11/21 18:42:51] d2.utils.events INFO:  eta: 0:04:03  iter: 479  total_loss: 0.1218  loss_cls: 0.04523  loss_box_reg: 0.04112  loss_rpn_cls: 0.006841  loss_rpn_loc: 0.02755  time: 0.2186  data_time: 0.0182  lr: 0.01  max_mem: 5091M
[11/21 18:42:56] d2.utils.events INFO:  eta: 0:03:59  iter: 499  total_loss: 0.114  loss_cls: 0.04365  loss_box_reg: 0.03881  loss_rpn_cls: 0.006917  loss_rpn_loc: 0.02353  time: 0.2187  data_time: 0.0208  lr: 0.01  max_mem: 5091M
[11/21 18:43:00] d2.utils.events INFO:  eta: 0:03:54  iter: 519  total_loss: 0.1129  loss_cls: 0.04119  loss_box_reg: 0.0374  loss_rpn_cls: 0.008054  loss_rpn_loc: 0.02624  time: 0.2190  data_time: 0.0190  lr: 0.01  max_mem: 5091M
[11/21 18:43:05] d2.utils.events INFO:  eta: 0:03:50  iter: 539  total_loss: 0.1105  loss_cls: 0.04458  loss_box_reg: 0.03802  loss_rpn_cls: 0.00626  loss_rpn_loc: 0.02279  time: 0.2189  data_time: 0.0185  lr: 0.01  max_mem: 5091M
[11/21 18:43:09] d2.utils.events INFO:  eta: 0:03:46  iter: 559  total_loss: 0.119  loss_cls: 0.04393  loss_box_reg: 0.03787  loss_rpn_cls: 0.006871  loss_rpn_loc: 0.02644  time: 0.2189  data_time: 0.0186  lr: 0.01  max_mem: 5091M
[11/21 18:43:14] d2.utils.events INFO:  eta: 0:03:41  iter: 579  total_loss: 0.1222  loss_cls: 0.04121  loss_box_reg: 0.03712  loss_rpn_cls: 0.007344  loss_rpn_loc: 0.02889  time: 0.2190  data_time: 0.0204  lr: 0.01  max_mem: 5091M
[11/21 18:43:18] d2.utils.events INFO:  eta: 0:03:37  iter: 599  total_loss: 0.1132  loss_cls: 0.04088  loss_box_reg: 0.03618  loss_rpn_cls: 0.006077  loss_rpn_loc: 0.0271  time: 0.2189  data_time: 0.0191  lr: 0.01  max_mem: 5091M
[11/21 18:43:22] d2.utils.events INFO:  eta: 0:03:33  iter: 619  total_loss: 0.1095  loss_cls: 0.04446  loss_box_reg: 0.03774  loss_rpn_cls: 0.006921  loss_rpn_loc: 0.02095  time: 0.2190  data_time: 0.0198  lr: 0.01  max_mem: 5091M
[11/21 18:43:27] d2.utils.events INFO:  eta: 0:03:29  iter: 639  total_loss: 0.1151  loss_cls: 0.04389  loss_box_reg: 0.04016  loss_rpn_cls: 0.005877  loss_rpn_loc: 0.02255  time: 0.2190  data_time: 0.0194  lr: 0.01  max_mem: 5091M
[11/21 18:43:31] d2.utils.events INFO:  eta: 0:03:24  iter: 659  total_loss: 0.1105  loss_cls: 0.04283  loss_box_reg: 0.0376  loss_rpn_cls: 0.005732  loss_rpn_loc: 0.02263  time: 0.2191  data_time: 0.0203  lr: 0.01  max_mem: 5091M
[11/21 18:43:36] d2.utils.events INFO:  eta: 0:03:20  iter: 679  total_loss: 0.1047  loss_cls: 0.03938  loss_box_reg: 0.03628  loss_rpn_cls: 0.00596  loss_rpn_loc: 0.02422  time: 0.2192  data_time: 0.0175  lr: 0.01  max_mem: 5091M
[11/21 18:43:40] d2.utils.events INFO:  eta: 0:03:16  iter: 699  total_loss: 0.1022  loss_cls: 0.04165  loss_box_reg: 0.03607  loss_rpn_cls: 0.005359  loss_rpn_loc: 0.02008  time: 0.2192  data_time: 0.0204  lr: 0.01  max_mem: 5091M
[11/21 18:43:45] d2.utils.events INFO:  eta: 0:03:11  iter: 719  total_loss: 0.1035  loss_cls: 0.04132  loss_box_reg: 0.0355  loss_rpn_cls: 0.006141  loss_rpn_loc: 0.01923  time: 0.2194  data_time: 0.0182  lr: 0.01  max_mem: 5091M
[11/21 18:43:49] d2.utils.events INFO:  eta: 0:03:07  iter: 739  total_loss: 0.1074  loss_cls: 0.04184  loss_box_reg: 0.03527  loss_rpn_cls: 0.00623  loss_rpn_loc: 0.02473  time: 0.2194  data_time: 0.0184  lr: 0.01  max_mem: 5091M
[11/21 18:43:53] d2.utils.events INFO:  eta: 0:03:03  iter: 759  total_loss: 0.1068  loss_cls: 0.03934  loss_box_reg: 0.0346  loss_rpn_cls: 0.006407  loss_rpn_loc: 0.02707  time: 0.2194  data_time: 0.0192  lr: 0.01  max_mem: 5091M
[11/21 18:43:58] d2.utils.events INFO:  eta: 0:02:58  iter: 779  total_loss: 0.1022  loss_cls: 0.03956  loss_box_reg: 0.0347  loss_rpn_cls: 0.006328  loss_rpn_loc: 0.01931  time: 0.2194  data_time: 0.0210  lr: 0.01  max_mem: 5091M
[11/21 18:44:02] d2.utils.events INFO:  eta: 0:02:54  iter: 799  total_loss: 0.1067  loss_cls: 0.04144  loss_box_reg: 0.03536  loss_rpn_cls: 0.006013  loss_rpn_loc: 0.02237  time: 0.2195  data_time: 0.0200  lr: 0.01  max_mem: 5091M
[11/21 18:44:07] d2.utils.events INFO:  eta: 0:02:50  iter: 819  total_loss: 0.1067  loss_cls: 0.03854  loss_box_reg: 0.03365  loss_rpn_cls: 0.004985  loss_rpn_loc: 0.02376  time: 0.2194  data_time: 0.0198  lr: 0.01  max_mem: 5091M
[11/21 18:44:11] d2.utils.events INFO:  eta: 0:02:45  iter: 839  total_loss: 0.1018  loss_cls: 0.04143  loss_box_reg: 0.03521  loss_rpn_cls: 0.004756  loss_rpn_loc: 0.0195  time: 0.2195  data_time: 0.0192  lr: 0.01  max_mem: 5091M
[11/21 18:44:15] d2.utils.events INFO:  eta: 0:02:41  iter: 859  total_loss: 0.1011  loss_cls: 0.03842  loss_box_reg: 0.0331  loss_rpn_cls: 0.005242  loss_rpn_loc: 0.02306  time: 0.2194  data_time: 0.0197  lr: 0.01  max_mem: 5091M
[11/21 18:44:20] d2.utils.events INFO:  eta: 0:02:37  iter: 879  total_loss: 0.09662  loss_cls: 0.03948  loss_box_reg: 0.03286  loss_rpn_cls: 0.006266  loss_rpn_loc: 0.02001  time: 0.2194  data_time: 0.0189  lr: 0.01  max_mem: 5091M
[11/21 18:44:24] d2.utils.events INFO:  eta: 0:02:32  iter: 899  total_loss: 0.09678  loss_cls: 0.03993  loss_box_reg: 0.03413  loss_rpn_cls: 0.006453  loss_rpn_loc: 0.02005  time: 0.2194  data_time: 0.0181  lr: 0.01  max_mem: 5091M
[11/21 18:44:29] d2.utils.events INFO:  eta: 0:02:28  iter: 919  total_loss: 0.09983  loss_cls: 0.03937  loss_box_reg: 0.03241  loss_rpn_cls: 0.005096  loss_rpn_loc: 0.02118  time: 0.2193  data_time: 0.0186  lr: 0.01  max_mem: 5091M
[11/21 18:44:33] d2.utils.events INFO:  eta: 0:02:23  iter: 939  total_loss: 0.09417  loss_cls: 0.0388  loss_box_reg: 0.03246  loss_rpn_cls: 0.00475  loss_rpn_loc: 0.01712  time: 0.2193  data_time: 0.0200  lr: 0.01  max_mem: 5091M
[11/21 18:44:37] d2.utils.events INFO:  eta: 0:02:19  iter: 959  total_loss: 0.09497  loss_cls: 0.04024  loss_box_reg: 0.03282  loss_rpn_cls: 0.004899  loss_rpn_loc: 0.02017  time: 0.2193  data_time: 0.0194  lr: 0.01  max_mem: 5091M
[11/21 18:44:42] d2.utils.events INFO:  eta: 0:02:15  iter: 979  total_loss: 0.09392  loss_cls: 0.03701  loss_box_reg: 0.03074  loss_rpn_cls: 0.004748  loss_rpn_loc: 0.0197  time: 0.2192  data_time: 0.0205  lr: 0.01  max_mem: 5091M
[11/21 18:44:46] d2.utils.events INFO:  eta: 0:02:10  iter: 999  total_loss: 0.09834  loss_cls: 0.03843  loss_box_reg: 0.03288  loss_rpn_cls: 0.005235  loss_rpn_loc: 0.02127  time: 0.2192  data_time: 0.0193  lr: 0.01  max_mem: 5091M
[11/21 18:44:51] d2.utils.events INFO:  eta: 0:02:06  iter: 1019  total_loss: 0.09514  loss_cls: 0.03804  loss_box_reg: 0.03261  loss_rpn_cls: 0.00452  loss_rpn_loc: 0.02098  time: 0.2192  data_time: 0.0198  lr: 0.01  max_mem: 5091M
[11/21 18:44:55] d2.utils.events INFO:  eta: 0:02:02  iter: 1039  total_loss: 0.09577  loss_cls: 0.03882  loss_box_reg: 0.03223  loss_rpn_cls: 0.005318  loss_rpn_loc: 0.02134  time: 0.2192  data_time: 0.0200  lr: 0.01  max_mem: 5091M
[11/21 18:44:59] d2.utils.events INFO:  eta: 0:01:57  iter: 1059  total_loss: 0.09832  loss_cls: 0.03787  loss_box_reg: 0.03088  loss_rpn_cls: 0.004783  loss_rpn_loc: 0.02201  time: 0.2191  data_time: 0.0200  lr: 0.01  max_mem: 5091M
[11/21 18:45:04] d2.utils.events INFO:  eta: 0:01:53  iter: 1079  total_loss: 0.09379  loss_cls: 0.03827  loss_box_reg: 0.03066  loss_rpn_cls: 0.004408  loss_rpn_loc: 0.02047  time: 0.2191  data_time: 0.0202  lr: 0.01  max_mem: 5091M
[11/21 18:45:08] d2.utils.events INFO:  eta: 0:01:49  iter: 1099  total_loss: 0.09278  loss_cls: 0.03564  loss_box_reg: 0.03014  loss_rpn_cls: 0.00642  loss_rpn_loc: 0.01863  time: 0.2192  data_time: 0.0206  lr: 0.01  max_mem: 5091M
[11/21 18:45:13] d2.utils.events INFO:  eta: 0:01:44  iter: 1119  total_loss: 0.09861  loss_cls: 0.03811  loss_box_reg: 0.03137  loss_rpn_cls: 0.004327  loss_rpn_loc: 0.01975  time: 0.2192  data_time: 0.0214  lr: 0.01  max_mem: 5091M
[11/21 18:45:17] d2.utils.events INFO:  eta: 0:01:40  iter: 1139  total_loss: 0.09043  loss_cls: 0.03867  loss_box_reg: 0.03135  loss_rpn_cls: 0.004488  loss_rpn_loc: 0.01575  time: 0.2191  data_time: 0.0215  lr: 0.01  max_mem: 5091M
[11/21 18:45:21] d2.utils.events INFO:  eta: 0:01:36  iter: 1159  total_loss: 0.09661  loss_cls: 0.03834  loss_box_reg: 0.03036  loss_rpn_cls: 0.004347  loss_rpn_loc: 0.02037  time: 0.2192  data_time: 0.0215  lr: 0.01  max_mem: 5091M
[11/21 18:45:26] d2.utils.events INFO:  eta: 0:01:31  iter: 1179  total_loss: 0.08609  loss_cls: 0.03601  loss_box_reg: 0.02862  loss_rpn_cls: 0.003752  loss_rpn_loc: 0.01666  time: 0.2191  data_time: 0.0189  lr: 0.01  max_mem: 5091M
[11/21 18:45:30] d2.utils.events INFO:  eta: 0:01:27  iter: 1199  total_loss: 0.08523  loss_cls: 0.03539  loss_box_reg: 0.02823  loss_rpn_cls: 0.004128  loss_rpn_loc: 0.01672  time: 0.2191  data_time: 0.0195  lr: 0.01  max_mem: 5091M
[11/21 18:45:34] d2.utils.events INFO:  eta: 0:01:22  iter: 1219  total_loss: 0.09245  loss_cls: 0.03699  loss_box_reg: 0.0301  loss_rpn_cls: 0.004349  loss_rpn_loc: 0.01799  time: 0.2191  data_time: 0.0191  lr: 0.01  max_mem: 5091M
[11/21 18:45:39] d2.utils.events INFO:  eta: 0:01:18  iter: 1239  total_loss: 0.08748  loss_cls: 0.03685  loss_box_reg: 0.03053  loss_rpn_cls: 0.005062  loss_rpn_loc: 0.01927  time: 0.2191  data_time: 0.0184  lr: 0.01  max_mem: 5091M
[11/21 18:45:43] d2.utils.events INFO:  eta: 0:01:14  iter: 1259  total_loss: 0.08914  loss_cls: 0.03544  loss_box_reg: 0.02881  loss_rpn_cls: 0.005071  loss_rpn_loc: 0.02029  time: 0.2191  data_time: 0.0193  lr: 0.01  max_mem: 5091M
[11/21 18:45:48] d2.utils.events INFO:  eta: 0:01:09  iter: 1279  total_loss: 0.08737  loss_cls: 0.03433  loss_box_reg: 0.02952  loss_rpn_cls: 0.003669  loss_rpn_loc: 0.01808  time: 0.2191  data_time: 0.0175  lr: 0.01  max_mem: 5091M
[11/21 18:45:52] d2.utils.events INFO:  eta: 0:01:05  iter: 1299  total_loss: 0.08568  loss_cls: 0.03792  loss_box_reg: 0.02926  loss_rpn_cls: 0.004789  loss_rpn_loc: 0.01483  time: 0.2191  data_time: 0.0193  lr: 0.001  max_mem: 5091M
[11/21 18:45:56] d2.utils.events INFO:  eta: 0:01:01  iter: 1319  total_loss: 0.08063  loss_cls: 0.03421  loss_box_reg: 0.02885  loss_rpn_cls: 0.004245  loss_rpn_loc: 0.01279  time: 0.2190  data_time: 0.0182  lr: 0.001  max_mem: 5091M
[11/21 18:46:01] d2.utils.events INFO:  eta: 0:00:56  iter: 1339  total_loss: 0.08364  loss_cls: 0.03616  loss_box_reg: 0.02952  loss_rpn_cls: 0.004909  loss_rpn_loc: 0.01182  time: 0.2190  data_time: 0.0179  lr: 0.001  max_mem: 5091M
[11/21 18:46:05] d2.utils.events INFO:  eta: 0:00:52  iter: 1359  total_loss: 0.07617  loss_cls: 0.03469  loss_box_reg: 0.02811  loss_rpn_cls: 0.003454  loss_rpn_loc: 0.009318  time: 0.2190  data_time: 0.0213  lr: 0.001  max_mem: 5091M
[11/21 18:46:10] d2.utils.events INFO:  eta: 0:00:48  iter: 1379  total_loss: 0.08063  loss_cls: 0.03548  loss_box_reg: 0.02968  loss_rpn_cls: 0.003857  loss_rpn_loc: 0.0107  time: 0.2191  data_time: 0.0197  lr: 0.001  max_mem: 5091M
[11/21 18:46:14] d2.utils.events INFO:  eta: 0:00:43  iter: 1399  total_loss: 0.0826  loss_cls: 0.03634  loss_box_reg: 0.03097  loss_rpn_cls: 0.003819  loss_rpn_loc: 0.01041  time: 0.2190  data_time: 0.0209  lr: 0.001  max_mem: 5091M
[11/21 18:46:18] d2.utils.events INFO:  eta: 0:00:39  iter: 1419  total_loss: 0.07857  loss_cls: 0.03613  loss_box_reg: 0.02852  loss_rpn_cls: 0.00342  loss_rpn_loc: 0.009179  time: 0.2190  data_time: 0.0203  lr: 0.001  max_mem: 5091M
[11/21 18:46:23] d2.utils.events INFO:  eta: 0:00:34  iter: 1439  total_loss: 0.08452  loss_cls: 0.036  loss_box_reg: 0.03001  loss_rpn_cls: 0.004809  loss_rpn_loc: 0.01324  time: 0.2191  data_time: 0.0199  lr: 0.001  max_mem: 5091M
[11/21 18:46:27] d2.utils.events INFO:  eta: 0:00:30  iter: 1459  total_loss: 0.08209  loss_cls: 0.03771  loss_box_reg: 0.0284  loss_rpn_cls: 0.003242  loss_rpn_loc: 0.009466  time: 0.2190  data_time: 0.0213  lr: 0.001  max_mem: 5091M
[11/21 18:46:32] d2.utils.events INFO:  eta: 0:00:26  iter: 1479  total_loss: 0.0848  loss_cls: 0.03619  loss_box_reg: 0.02996  loss_rpn_cls: 0.004043  loss_rpn_loc: 0.01291  time: 0.2190  data_time: 0.0178  lr: 0.001  max_mem: 5091M
[11/21 18:46:36] d2.utils.events INFO:  eta: 0:00:21  iter: 1499  total_loss: 0.07789  loss_cls: 0.03632  loss_box_reg: 0.02963  loss_rpn_cls: 0.003738  loss_rpn_loc: 0.01137  time: 0.2190  data_time: 0.0182  lr: 0.001  max_mem: 5091M
[11/21 18:46:41] d2.utils.events INFO:  eta: 0:00:17  iter: 1519  total_loss: 0.08095  loss_cls: 0.03561  loss_box_reg: 0.02832  loss_rpn_cls: 0.00439  loss_rpn_loc: 0.01085  time: 0.2190  data_time: 0.0187  lr: 0.001  max_mem: 5091M
[11/21 18:46:45] d2.utils.events INFO:  eta: 0:00:13  iter: 1539  total_loss: 0.08503  loss_cls: 0.03849  loss_box_reg: 0.02832  loss_rpn_cls: 0.004368  loss_rpn_loc: 0.01111  time: 0.2190  data_time: 0.0188  lr: 0.001  max_mem: 5091M
[11/21 18:46:49] d2.utils.events INFO:  eta: 0:00:08  iter: 1559  total_loss: 0.07589  loss_cls: 0.0341  loss_box_reg: 0.02749  loss_rpn_cls: 0.00267  loss_rpn_loc: 0.009838  time: 0.2190  data_time: 0.0199  lr: 0.001  max_mem: 5091M
[11/21 18:46:54] d2.utils.events INFO:  eta: 0:00:04  iter: 1579  total_loss: 0.07937  loss_cls: 0.03403  loss_box_reg: 0.02877  loss_rpn_cls: 0.003416  loss_rpn_loc: 0.00885  time: 0.2190  data_time: 0.0209  lr: 0.001  max_mem: 5091M
[11/21 18:46:58] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final.pth
[11/21 18:47:00] d2.utils.events INFO:  eta: 0:00:00  iter: 1599  total_loss: 0.08343  loss_cls: 0.03534  loss_box_reg: 0.02827  loss_rpn_cls: 0.003492  loss_rpn_loc: 0.01104  time: 0.2190  data_time: 0.0191  lr: 0.001  max_mem: 5091M
[11/21 18:47:00] d2.engine.hooks INFO: Overall training speed: 1598 iterations in 0:05:49 (0.2190 s / it)
[11/21 18:47:00] d2.engine.hooks INFO: Total training time: 0:05:53 (0:00:03 on hooks)
[11/21 18:47:01] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/21 18:47:01] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:47:01] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 18:47:01] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/21 18:47:01] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 18:47:01] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 18:47:02] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:47:02] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/21 18:47:02] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 18:47:03] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 18:47:17] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0648 s / img. ETA=0:01:16
[11/21 18:47:20] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0635 s / img. ETA=0:01:12
[11/21 18:47:23] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0634 s / img. ETA=0:01:08
[11/21 18:47:26] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0644 s / img. ETA=0:01:06
[11/21 18:47:30] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0644 s / img. ETA=0:01:03
[11/21 18:47:33] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0648 s / img. ETA=0:01:00
[11/21 18:47:36] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0647 s / img. ETA=0:00:57
[11/21 18:47:39] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0647 s / img. ETA=0:00:54
[11/21 18:47:43] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0647 s / img. ETA=0:00:50
[11/21 18:47:46] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0650 s / img. ETA=0:00:47
[11/21 18:47:49] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0646 s / img. ETA=0:00:44
[11/21 18:47:52] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0647 s / img. ETA=0:00:41
[11/21 18:47:56] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0646 s / img. ETA=0:00:37
[11/21 18:47:59] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0645 s / img. ETA=0:00:34
[11/21 18:48:02] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0647 s / img. ETA=0:00:31
[11/21 18:48:05] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0646 s / img. ETA=0:00:28
[11/21 18:48:08] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0646 s / img. ETA=0:00:25
[11/21 18:48:11] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0644 s / img. ETA=0:00:21
[11/21 18:48:15] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0643 s / img. ETA=0:00:18
[11/21 18:48:18] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0642 s / img. ETA=0:00:15
[11/21 18:48:21] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0641 s / img. ETA=0:00:12
[11/21 18:48:24] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0641 s / img. ETA=0:00:08
[11/21 18:48:27] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0640 s / img. ETA=0:00:05
[11/21 18:48:30] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0639 s / img. ETA=0:00:02
[11/21 18:48:33] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:19 (0.064071 s / img per device, on 4 devices)
[11/21 18:48:33] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:16 (0.061663 s / img per device, on 4 devices)
[11/21 18:48:33] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 18:48:40] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 57.641 | 74.957 | 45.784 |   58.269    | 50.122 |
[11/21 18:48:40] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 33.067 | 57.355 | 33.430 | 33.067 | 57.355  | 33.430  |
[11/21 18:48:40] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/21 18:48:40] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 18:48:40] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/21 18:48:40] defrcn.evaluation.testing INFO: copypaste: 33.0666,57.3546,33.4295,33.0666,57.3546,33.4295
[11/21 18:48:57] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 18:48:57] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5'], resume=False, start_iter=-1)
[11/21 18:48:57] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_3shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 18:48:57] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/21 18:48:57] d2.utils.env INFO: Using a generated random seed 59370505
[11/21 18:48:57] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 18:48:57] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth ...
[11/21 18:48:59] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/21 18:48:59] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:48:59] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 18:48:59] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/21 18:49:00] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 18:49:00] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 18:49:02] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 3            |   bicycle   | 3            |    boat     | 3            |
|   bottle   | 3            |     car     | 3            |     cat     | 3            |
|   chair    | 3            | diningtable | 3            |     dog     | 3            |
|   horse    | 3            |   person    | 3            | pottedplant | 3            |
|   sheep    | 3            |    train    | 3            |  tvmonitor  | 3            |
|    bird    | 3            |     bus     | 3            |     cow     | 3            |
| motorbike  | 3            |    sofa     | 3            |             |              |
|   total    | 60           |             |              |             |              |[0m
[11/21 18:49:02] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 18:49:02] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/21 18:49:02] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/21 18:49:04] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 18:49:17] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0614 s / img. ETA=0:01:12
[11/21 18:49:20] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0605 s / img. ETA=0:01:08
[11/21 18:49:23] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0604 s / img. ETA=0:01:05
[11/21 18:49:26] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0603 s / img. ETA=0:01:02
[11/21 18:49:29] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0602 s / img. ETA=0:00:59
[11/21 18:49:32] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0601 s / img. ETA=0:00:56
[11/21 18:49:35] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0598 s / img. ETA=0:00:53
[11/21 18:49:38] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0597 s / img. ETA=0:00:50
[11/21 18:49:41] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0596 s / img. ETA=0:00:47
[11/21 18:49:44] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0595 s / img. ETA=0:00:43
[11/21 18:49:47] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0594 s / img. ETA=0:00:40
[11/21 18:49:50] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0594 s / img. ETA=0:00:37
[11/21 18:49:53] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0593 s / img. ETA=0:00:34
[11/21 18:49:56] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0592 s / img. ETA=0:00:31
[11/21 18:49:59] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0593 s / img. ETA=0:00:28
[11/21 18:50:02] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0592 s / img. ETA=0:00:25
[11/21 18:50:05] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0592 s / img. ETA=0:00:22
[11/21 18:50:08] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0591 s / img. ETA=0:00:19
[11/21 18:50:10] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0591 s / img. ETA=0:00:17
[11/21 18:50:13] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0591 s / img. ETA=0:00:14
[11/21 18:50:16] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0592 s / img. ETA=0:00:11
[11/21 18:50:20] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0593 s / img. ETA=0:00:08
[11/21 18:50:23] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0593 s / img. ETA=0:00:05
[11/21 18:50:25] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0593 s / img. ETA=0:00:02
[11/21 18:50:28] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:13 (0.059205 s / img per device, on 4 devices)
[11/21 18:50:28] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.056950 s / img per device, on 4 devices)
[11/21 18:50:30] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 18:50:56] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.644    |  85.657   | 72.625 |  73.941  | 88.762 | 88.510 | 69.486  |    73.801     | 87.378 | 83.876  |  86.083  |    54.749     | 81.565  | 84.998  |   82.664    | 62.322 | 74.881 | 61.153 |   59.386    | 50.257 |
[11/21 18:50:56] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.216 | 75.337 | 51.987 | 53.070 | 79.916  | 58.879  | 33.653 | 61.600  | 31.310  |
[11/21 18:50:56] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/21 18:50:56] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 18:50:56] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/21 18:50:56] defrcn.evaluation.testing INFO: copypaste: 48.2156,75.3368,51.9870,53.0697,79.9159,58.8795,33.6530,61.5996,31.3096
[11/21 20:35:37] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 20:35:37] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/21 20:35:37] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_3shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1280,)
  MAX_ITER: 1600
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 20:35:37] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/21 20:35:37] d2.utils.env INFO: Using a generated random seed 41657685
[11/21 20:35:38] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 20:35:38] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 15 images left.
[11/21 20:35:38] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 3            |    bus     | 3            |    cow     | 3            |
| motorbike  | 3            |    sofa    | 3            |            |              |
|   total    | 15           |            |              |            |              |[0m
[11/21 20:35:38] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/21 20:35:38] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/21 20:35:38] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/21 20:35:38] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 20:35:38] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/21 20:35:38] d2.engine.train_loop INFO: Starting training from iteration 0
[11/21 20:35:45] d2.utils.events INFO:  eta: 0:05:11  iter: 19  total_loss: 0.5827  loss_cls: 0.3325  loss_box_reg: 0.1497  loss_rpn_cls: 0.04801  loss_rpn_loc: 0.06123  time: 0.1968  data_time: 0.1437  lr: 0.01  max_mem: 5087M
[11/21 20:35:49] d2.utils.events INFO:  eta: 0:05:07  iter: 39  total_loss: 0.4055  loss_cls: 0.1684  loss_box_reg: 0.1338  loss_rpn_cls: 0.02977  loss_rpn_loc: 0.05565  time: 0.1968  data_time: 0.0134  lr: 0.01  max_mem: 5087M
[11/21 20:35:53] d2.utils.events INFO:  eta: 0:05:02  iter: 59  total_loss: 0.3057  loss_cls: 0.1078  loss_box_reg: 0.1227  loss_rpn_cls: 0.02277  loss_rpn_loc: 0.04495  time: 0.1958  data_time: 0.0140  lr: 0.01  max_mem: 5087M
[11/21 20:35:57] d2.utils.events INFO:  eta: 0:04:58  iter: 79  total_loss: 0.2637  loss_cls: 0.08852  loss_box_reg: 0.1043  loss_rpn_cls: 0.02037  loss_rpn_loc: 0.04579  time: 0.1955  data_time: 0.0143  lr: 0.01  max_mem: 5087M
[11/21 20:36:00] d2.utils.events INFO:  eta: 0:04:54  iter: 99  total_loss: 0.2447  loss_cls: 0.08184  loss_box_reg: 0.09408  loss_rpn_cls: 0.01923  loss_rpn_loc: 0.04266  time: 0.1952  data_time: 0.0155  lr: 0.01  max_mem: 5087M
[11/21 20:36:04] d2.utils.events INFO:  eta: 0:04:48  iter: 119  total_loss: 0.2188  loss_cls: 0.07312  loss_box_reg: 0.08364  loss_rpn_cls: 0.0162  loss_rpn_loc: 0.04271  time: 0.1946  data_time: 0.0144  lr: 0.01  max_mem: 5087M
[11/21 20:36:08] d2.utils.events INFO:  eta: 0:04:43  iter: 139  total_loss: 0.2084  loss_cls: 0.0665  loss_box_reg: 0.07558  loss_rpn_cls: 0.015  loss_rpn_loc: 0.03926  time: 0.1945  data_time: 0.0136  lr: 0.01  max_mem: 5087M
[11/21 20:36:12] d2.utils.events INFO:  eta: 0:04:39  iter: 159  total_loss: 0.177  loss_cls: 0.06554  loss_box_reg: 0.06524  loss_rpn_cls: 0.01213  loss_rpn_loc: 0.0324  time: 0.1943  data_time: 0.0137  lr: 0.01  max_mem: 5087M
[11/21 20:36:16] d2.utils.events INFO:  eta: 0:04:35  iter: 179  total_loss: 0.1692  loss_cls: 0.06059  loss_box_reg: 0.06335  loss_rpn_cls: 0.01089  loss_rpn_loc: 0.02983  time: 0.1941  data_time: 0.0143  lr: 0.01  max_mem: 5087M
[11/21 20:36:20] d2.utils.events INFO:  eta: 0:04:31  iter: 199  total_loss: 0.1799  loss_cls: 0.05833  loss_box_reg: 0.05943  loss_rpn_cls: 0.01365  loss_rpn_loc: 0.04492  time: 0.1940  data_time: 0.0144  lr: 0.01  max_mem: 5087M
[11/21 20:36:24] d2.utils.events INFO:  eta: 0:04:27  iter: 219  total_loss: 0.1603  loss_cls: 0.05585  loss_box_reg: 0.05579  loss_rpn_cls: 0.01133  loss_rpn_loc: 0.0362  time: 0.1942  data_time: 0.0156  lr: 0.01  max_mem: 5087M
[11/21 20:36:28] d2.utils.events INFO:  eta: 0:04:22  iter: 239  total_loss: 0.157  loss_cls: 0.05504  loss_box_reg: 0.05468  loss_rpn_cls: 0.01067  loss_rpn_loc: 0.03347  time: 0.1938  data_time: 0.0146  lr: 0.01  max_mem: 5087M
[11/21 20:36:31] d2.utils.events INFO:  eta: 0:04:18  iter: 259  total_loss: 0.1519  loss_cls: 0.05524  loss_box_reg: 0.0519  loss_rpn_cls: 0.01025  loss_rpn_loc: 0.03215  time: 0.1937  data_time: 0.0137  lr: 0.01  max_mem: 5087M
[11/21 20:36:36] d2.utils.events INFO:  eta: 0:04:14  iter: 279  total_loss: 0.153  loss_cls: 0.05852  loss_box_reg: 0.05365  loss_rpn_cls: 0.00953  loss_rpn_loc: 0.02773  time: 0.1937  data_time: 0.0156  lr: 0.01  max_mem: 5087M
[11/21 20:36:39] d2.utils.events INFO:  eta: 0:04:10  iter: 299  total_loss: 0.1428  loss_cls: 0.05181  loss_box_reg: 0.0505  loss_rpn_cls: 0.009824  loss_rpn_loc: 0.03025  time: 0.1936  data_time: 0.0149  lr: 0.01  max_mem: 5087M
[11/21 20:36:43] d2.utils.events INFO:  eta: 0:04:06  iter: 319  total_loss: 0.1337  loss_cls: 0.05269  loss_box_reg: 0.05024  loss_rpn_cls: 0.007182  loss_rpn_loc: 0.02531  time: 0.1934  data_time: 0.0158  lr: 0.01  max_mem: 5087M
[11/21 20:36:47] d2.utils.events INFO:  eta: 0:04:02  iter: 339  total_loss: 0.134  loss_cls: 0.04968  loss_box_reg: 0.04643  loss_rpn_cls: 0.008012  loss_rpn_loc: 0.0272  time: 0.1933  data_time: 0.0149  lr: 0.01  max_mem: 5087M
[11/21 20:36:51] d2.utils.events INFO:  eta: 0:03:58  iter: 359  total_loss: 0.1327  loss_cls: 0.05084  loss_box_reg: 0.04765  loss_rpn_cls: 0.008768  loss_rpn_loc: 0.02671  time: 0.1934  data_time: 0.0154  lr: 0.01  max_mem: 5087M
[11/21 20:36:55] d2.utils.events INFO:  eta: 0:03:55  iter: 379  total_loss: 0.1325  loss_cls: 0.05096  loss_box_reg: 0.04852  loss_rpn_cls: 0.007936  loss_rpn_loc: 0.02454  time: 0.1934  data_time: 0.0140  lr: 0.01  max_mem: 5087M
[11/21 20:36:59] d2.utils.events INFO:  eta: 0:03:51  iter: 399  total_loss: 0.1319  loss_cls: 0.04974  loss_box_reg: 0.04584  loss_rpn_cls: 0.006908  loss_rpn_loc: 0.02811  time: 0.1934  data_time: 0.0152  lr: 0.01  max_mem: 5087M
[11/21 20:37:03] d2.utils.events INFO:  eta: 0:03:47  iter: 419  total_loss: 0.125  loss_cls: 0.04771  loss_box_reg: 0.0477  loss_rpn_cls: 0.006817  loss_rpn_loc: 0.02349  time: 0.1933  data_time: 0.0140  lr: 0.01  max_mem: 5087M
[11/21 20:37:06] d2.utils.events INFO:  eta: 0:03:43  iter: 439  total_loss: 0.1261  loss_cls: 0.04806  loss_box_reg: 0.04514  loss_rpn_cls: 0.007045  loss_rpn_loc: 0.02421  time: 0.1933  data_time: 0.0142  lr: 0.01  max_mem: 5087M
[11/21 20:37:10] d2.utils.events INFO:  eta: 0:03:39  iter: 459  total_loss: 0.1217  loss_cls: 0.0441  loss_box_reg: 0.04301  loss_rpn_cls: 0.007553  loss_rpn_loc: 0.02595  time: 0.1934  data_time: 0.0152  lr: 0.01  max_mem: 5087M
[11/21 20:37:14] d2.utils.events INFO:  eta: 0:03:35  iter: 479  total_loss: 0.1238  loss_cls: 0.04606  loss_box_reg: 0.04521  loss_rpn_cls: 0.00675  loss_rpn_loc: 0.02474  time: 0.1934  data_time: 0.0144  lr: 0.01  max_mem: 5087M
[11/21 20:37:18] d2.utils.events INFO:  eta: 0:03:32  iter: 499  total_loss: 0.1293  loss_cls: 0.04703  loss_box_reg: 0.04493  loss_rpn_cls: 0.006569  loss_rpn_loc: 0.02556  time: 0.1933  data_time: 0.0135  lr: 0.01  max_mem: 5087M
[11/21 20:37:22] d2.utils.events INFO:  eta: 0:03:28  iter: 519  total_loss: 0.1168  loss_cls: 0.04436  loss_box_reg: 0.04203  loss_rpn_cls: 0.006652  loss_rpn_loc: 0.02316  time: 0.1933  data_time: 0.0136  lr: 0.01  max_mem: 5087M
[11/21 20:37:26] d2.utils.events INFO:  eta: 0:03:24  iter: 539  total_loss: 0.1271  loss_cls: 0.04478  loss_box_reg: 0.04404  loss_rpn_cls: 0.005955  loss_rpn_loc: 0.0289  time: 0.1934  data_time: 0.0164  lr: 0.01  max_mem: 5087M
[11/21 20:37:30] d2.utils.events INFO:  eta: 0:03:20  iter: 559  total_loss: 0.1224  loss_cls: 0.04368  loss_box_reg: 0.04103  loss_rpn_cls: 0.007464  loss_rpn_loc: 0.02981  time: 0.1934  data_time: 0.0138  lr: 0.01  max_mem: 5087M
[11/21 20:37:34] d2.utils.events INFO:  eta: 0:03:16  iter: 579  total_loss: 0.1157  loss_cls: 0.04207  loss_box_reg: 0.03946  loss_rpn_cls: 0.006321  loss_rpn_loc: 0.0242  time: 0.1933  data_time: 0.0144  lr: 0.01  max_mem: 5087M
[11/21 20:37:38] d2.utils.events INFO:  eta: 0:03:12  iter: 599  total_loss: 0.1163  loss_cls: 0.04237  loss_box_reg: 0.03946  loss_rpn_cls: 0.006951  loss_rpn_loc: 0.02466  time: 0.1934  data_time: 0.0151  lr: 0.01  max_mem: 5087M
[11/21 20:37:41] d2.utils.events INFO:  eta: 0:03:09  iter: 619  total_loss: 0.1183  loss_cls: 0.04281  loss_box_reg: 0.04146  loss_rpn_cls: 0.006049  loss_rpn_loc: 0.025  time: 0.1934  data_time: 0.0163  lr: 0.01  max_mem: 5087M
[11/21 20:37:45] d2.utils.events INFO:  eta: 0:03:05  iter: 639  total_loss: 0.1093  loss_cls: 0.04422  loss_box_reg: 0.04016  loss_rpn_cls: 0.006095  loss_rpn_loc: 0.02511  time: 0.1934  data_time: 0.0143  lr: 0.01  max_mem: 5087M
[11/21 20:37:49] d2.utils.events INFO:  eta: 0:03:01  iter: 659  total_loss: 0.1081  loss_cls: 0.04268  loss_box_reg: 0.03941  loss_rpn_cls: 0.006328  loss_rpn_loc: 0.0209  time: 0.1933  data_time: 0.0141  lr: 0.01  max_mem: 5087M
[11/21 20:37:53] d2.utils.events INFO:  eta: 0:02:57  iter: 679  total_loss: 0.1097  loss_cls: 0.04216  loss_box_reg: 0.04054  loss_rpn_cls: 0.00599  loss_rpn_loc: 0.01989  time: 0.1934  data_time: 0.0148  lr: 0.01  max_mem: 5087M
[11/21 20:37:57] d2.utils.events INFO:  eta: 0:02:53  iter: 699  total_loss: 0.1067  loss_cls: 0.03977  loss_box_reg: 0.03743  loss_rpn_cls: 0.005617  loss_rpn_loc: 0.02348  time: 0.1936  data_time: 0.0144  lr: 0.01  max_mem: 5087M
[11/21 20:38:01] d2.utils.events INFO:  eta: 0:02:49  iter: 719  total_loss: 0.1155  loss_cls: 0.04614  loss_box_reg: 0.0427  loss_rpn_cls: 0.006927  loss_rpn_loc: 0.02395  time: 0.1936  data_time: 0.0149  lr: 0.01  max_mem: 5087M
[11/21 20:38:05] d2.utils.events INFO:  eta: 0:02:45  iter: 739  total_loss: 0.1153  loss_cls: 0.04153  loss_box_reg: 0.03981  loss_rpn_cls: 0.00649  loss_rpn_loc: 0.02206  time: 0.1937  data_time: 0.0141  lr: 0.01  max_mem: 5087M
[11/21 20:38:09] d2.utils.events INFO:  eta: 0:02:42  iter: 759  total_loss: 0.1052  loss_cls: 0.04018  loss_box_reg: 0.0389  loss_rpn_cls: 0.006107  loss_rpn_loc: 0.02196  time: 0.1938  data_time: 0.0172  lr: 0.01  max_mem: 5087M
[11/21 20:38:13] d2.utils.events INFO:  eta: 0:02:38  iter: 779  total_loss: 0.108  loss_cls: 0.03931  loss_box_reg: 0.03805  loss_rpn_cls: 0.006442  loss_rpn_loc: 0.02409  time: 0.1938  data_time: 0.0134  lr: 0.01  max_mem: 5087M
[11/21 20:38:17] d2.utils.events INFO:  eta: 0:02:34  iter: 799  total_loss: 0.1097  loss_cls: 0.04071  loss_box_reg: 0.03706  loss_rpn_cls: 0.005834  loss_rpn_loc: 0.02338  time: 0.1938  data_time: 0.0155  lr: 0.01  max_mem: 5087M
[11/21 20:38:21] d2.utils.events INFO:  eta: 0:02:30  iter: 819  total_loss: 0.1092  loss_cls: 0.04213  loss_box_reg: 0.04134  loss_rpn_cls: 0.004772  loss_rpn_loc: 0.02302  time: 0.1938  data_time: 0.0152  lr: 0.01  max_mem: 5087M
[11/21 20:38:24] d2.utils.events INFO:  eta: 0:02:26  iter: 839  total_loss: 0.1062  loss_cls: 0.03896  loss_box_reg: 0.03656  loss_rpn_cls: 0.005278  loss_rpn_loc: 0.02168  time: 0.1938  data_time: 0.0152  lr: 0.01  max_mem: 5087M
[11/21 20:38:28] d2.utils.events INFO:  eta: 0:02:22  iter: 859  total_loss: 0.106  loss_cls: 0.04086  loss_box_reg: 0.03848  loss_rpn_cls: 0.006608  loss_rpn_loc: 0.02216  time: 0.1938  data_time: 0.0140  lr: 0.01  max_mem: 5087M
[11/21 20:38:32] d2.utils.events INFO:  eta: 0:02:18  iter: 879  total_loss: 0.1019  loss_cls: 0.03965  loss_box_reg: 0.03575  loss_rpn_cls: 0.005099  loss_rpn_loc: 0.02013  time: 0.1938  data_time: 0.0149  lr: 0.01  max_mem: 5087M
[11/21 20:38:36] d2.utils.events INFO:  eta: 0:02:15  iter: 899  total_loss: 0.1021  loss_cls: 0.03843  loss_box_reg: 0.03625  loss_rpn_cls: 0.004815  loss_rpn_loc: 0.02019  time: 0.1938  data_time: 0.0139  lr: 0.01  max_mem: 5087M
[11/21 20:38:40] d2.utils.events INFO:  eta: 0:02:11  iter: 919  total_loss: 0.1045  loss_cls: 0.04107  loss_box_reg: 0.03645  loss_rpn_cls: 0.005707  loss_rpn_loc: 0.02476  time: 0.1938  data_time: 0.0123  lr: 0.01  max_mem: 5087M
[11/21 20:38:44] d2.utils.events INFO:  eta: 0:02:07  iter: 939  total_loss: 0.1057  loss_cls: 0.03857  loss_box_reg: 0.0356  loss_rpn_cls: 0.006222  loss_rpn_loc: 0.02085  time: 0.1938  data_time: 0.0167  lr: 0.01  max_mem: 5087M
[11/21 20:38:48] d2.utils.events INFO:  eta: 0:02:03  iter: 959  total_loss: 0.09934  loss_cls: 0.0385  loss_box_reg: 0.03435  loss_rpn_cls: 0.00655  loss_rpn_loc: 0.02331  time: 0.1938  data_time: 0.0161  lr: 0.01  max_mem: 5087M
[11/21 20:38:52] d2.utils.events INFO:  eta: 0:01:59  iter: 979  total_loss: 0.09829  loss_cls: 0.04008  loss_box_reg: 0.03451  loss_rpn_cls: 0.004998  loss_rpn_loc: 0.01869  time: 0.1938  data_time: 0.0154  lr: 0.01  max_mem: 5087M
[11/21 20:38:55] d2.utils.events INFO:  eta: 0:01:55  iter: 999  total_loss: 0.1015  loss_cls: 0.03969  loss_box_reg: 0.03673  loss_rpn_cls: 0.00451  loss_rpn_loc: 0.01719  time: 0.1938  data_time: 0.0149  lr: 0.01  max_mem: 5087M
[11/21 20:38:59] d2.utils.events INFO:  eta: 0:01:51  iter: 1019  total_loss: 0.09661  loss_cls: 0.03904  loss_box_reg: 0.03525  loss_rpn_cls: 0.005074  loss_rpn_loc: 0.01953  time: 0.1937  data_time: 0.0146  lr: 0.01  max_mem: 5087M
[11/21 20:39:03] d2.utils.events INFO:  eta: 0:01:47  iter: 1039  total_loss: 0.09511  loss_cls: 0.03682  loss_box_reg: 0.03416  loss_rpn_cls: 0.003774  loss_rpn_loc: 0.0195  time: 0.1937  data_time: 0.0149  lr: 0.01  max_mem: 5087M
[11/21 20:39:07] d2.utils.events INFO:  eta: 0:01:44  iter: 1059  total_loss: 0.09772  loss_cls: 0.03968  loss_box_reg: 0.03454  loss_rpn_cls: 0.005161  loss_rpn_loc: 0.01787  time: 0.1937  data_time: 0.0164  lr: 0.01  max_mem: 5087M
[11/21 20:39:11] d2.utils.events INFO:  eta: 0:01:40  iter: 1079  total_loss: 0.09945  loss_cls: 0.03735  loss_box_reg: 0.03547  loss_rpn_cls: 0.004612  loss_rpn_loc: 0.019  time: 0.1937  data_time: 0.0163  lr: 0.01  max_mem: 5087M
[11/21 20:39:15] d2.utils.events INFO:  eta: 0:01:36  iter: 1099  total_loss: 0.105  loss_cls: 0.03911  loss_box_reg: 0.03421  loss_rpn_cls: 0.004793  loss_rpn_loc: 0.02252  time: 0.1937  data_time: 0.0148  lr: 0.01  max_mem: 5087M
[11/21 20:39:19] d2.utils.events INFO:  eta: 0:01:32  iter: 1119  total_loss: 0.09855  loss_cls: 0.03828  loss_box_reg: 0.03459  loss_rpn_cls: 0.004795  loss_rpn_loc: 0.02062  time: 0.1938  data_time: 0.0150  lr: 0.01  max_mem: 5087M
[11/21 20:39:23] d2.utils.events INFO:  eta: 0:01:28  iter: 1139  total_loss: 0.0972  loss_cls: 0.03681  loss_box_reg: 0.03277  loss_rpn_cls: 0.005609  loss_rpn_loc: 0.0202  time: 0.1938  data_time: 0.0157  lr: 0.01  max_mem: 5087M
[11/21 20:39:27] d2.utils.events INFO:  eta: 0:01:24  iter: 1159  total_loss: 0.0983  loss_cls: 0.03676  loss_box_reg: 0.03438  loss_rpn_cls: 0.004612  loss_rpn_loc: 0.02089  time: 0.1938  data_time: 0.0133  lr: 0.01  max_mem: 5087M
[11/21 20:39:30] d2.utils.events INFO:  eta: 0:01:21  iter: 1179  total_loss: 0.09541  loss_cls: 0.03984  loss_box_reg: 0.03433  loss_rpn_cls: 0.004515  loss_rpn_loc: 0.01787  time: 0.1938  data_time: 0.0152  lr: 0.01  max_mem: 5087M
[11/21 20:39:34] d2.utils.events INFO:  eta: 0:01:17  iter: 1199  total_loss: 0.1003  loss_cls: 0.04049  loss_box_reg: 0.03169  loss_rpn_cls: 0.005998  loss_rpn_loc: 0.01939  time: 0.1937  data_time: 0.0145  lr: 0.01  max_mem: 5087M
[11/21 20:39:38] d2.utils.events INFO:  eta: 0:01:13  iter: 1219  total_loss: 0.09326  loss_cls: 0.03614  loss_box_reg: 0.03378  loss_rpn_cls: 0.00517  loss_rpn_loc: 0.0196  time: 0.1938  data_time: 0.0147  lr: 0.01  max_mem: 5087M
[11/21 20:39:42] d2.utils.events INFO:  eta: 0:01:09  iter: 1239  total_loss: 0.09687  loss_cls: 0.03904  loss_box_reg: 0.03219  loss_rpn_cls: 0.004213  loss_rpn_loc: 0.02015  time: 0.1937  data_time: 0.0174  lr: 0.01  max_mem: 5087M
[11/21 20:39:46] d2.utils.events INFO:  eta: 0:01:05  iter: 1259  total_loss: 0.09292  loss_cls: 0.03895  loss_box_reg: 0.03367  loss_rpn_cls: 0.004033  loss_rpn_loc: 0.01676  time: 0.1937  data_time: 0.0140  lr: 0.01  max_mem: 5087M
[11/21 20:39:50] d2.utils.events INFO:  eta: 0:01:01  iter: 1279  total_loss: 0.1025  loss_cls: 0.03915  loss_box_reg: 0.03374  loss_rpn_cls: 0.006597  loss_rpn_loc: 0.02161  time: 0.1937  data_time: 0.0145  lr: 0.01  max_mem: 5087M
[11/21 20:39:54] d2.utils.events INFO:  eta: 0:00:57  iter: 1299  total_loss: 0.091  loss_cls: 0.03565  loss_box_reg: 0.03197  loss_rpn_cls: 0.004025  loss_rpn_loc: 0.01385  time: 0.1937  data_time: 0.0156  lr: 0.001  max_mem: 5087M
[11/21 20:39:58] d2.utils.events INFO:  eta: 0:00:54  iter: 1319  total_loss: 0.08931  loss_cls: 0.03786  loss_box_reg: 0.03348  loss_rpn_cls: 0.004709  loss_rpn_loc: 0.01186  time: 0.1937  data_time: 0.0144  lr: 0.001  max_mem: 5087M
[11/21 20:40:01] d2.utils.events INFO:  eta: 0:00:50  iter: 1339  total_loss: 0.08746  loss_cls: 0.03837  loss_box_reg: 0.03317  loss_rpn_cls: 0.004464  loss_rpn_loc: 0.01227  time: 0.1937  data_time: 0.0163  lr: 0.001  max_mem: 5087M
[11/21 20:40:05] d2.utils.events INFO:  eta: 0:00:46  iter: 1359  total_loss: 0.08771  loss_cls: 0.03883  loss_box_reg: 0.03114  loss_rpn_cls: 0.004278  loss_rpn_loc: 0.01062  time: 0.1937  data_time: 0.0150  lr: 0.001  max_mem: 5087M
[11/21 20:40:09] d2.utils.events INFO:  eta: 0:00:42  iter: 1379  total_loss: 0.08402  loss_cls: 0.03522  loss_box_reg: 0.03158  loss_rpn_cls: 0.00428  loss_rpn_loc: 0.01272  time: 0.1937  data_time: 0.0154  lr: 0.001  max_mem: 5087M
[11/21 20:40:13] d2.utils.events INFO:  eta: 0:00:38  iter: 1399  total_loss: 0.08554  loss_cls: 0.03668  loss_box_reg: 0.03248  loss_rpn_cls: 0.004134  loss_rpn_loc: 0.01175  time: 0.1937  data_time: 0.0141  lr: 0.001  max_mem: 5087M
[11/21 20:40:17] d2.utils.events INFO:  eta: 0:00:34  iter: 1419  total_loss: 0.08475  loss_cls: 0.03533  loss_box_reg: 0.03155  loss_rpn_cls: 0.004377  loss_rpn_loc: 0.01231  time: 0.1937  data_time: 0.0147  lr: 0.001  max_mem: 5087M
[11/21 20:40:21] d2.utils.events INFO:  eta: 0:00:30  iter: 1439  total_loss: 0.08485  loss_cls: 0.03633  loss_box_reg: 0.03107  loss_rpn_cls: 0.003621  loss_rpn_loc: 0.01055  time: 0.1937  data_time: 0.0148  lr: 0.001  max_mem: 5087M
[11/21 20:40:25] d2.utils.events INFO:  eta: 0:00:27  iter: 1459  total_loss: 0.084  loss_cls: 0.03557  loss_box_reg: 0.0304  loss_rpn_cls: 0.003912  loss_rpn_loc: 0.01011  time: 0.1937  data_time: 0.0135  lr: 0.001  max_mem: 5087M
[11/21 20:40:29] d2.utils.events INFO:  eta: 0:00:23  iter: 1479  total_loss: 0.08527  loss_cls: 0.03771  loss_box_reg: 0.03061  loss_rpn_cls: 0.00369  loss_rpn_loc: 0.0114  time: 0.1936  data_time: 0.0153  lr: 0.001  max_mem: 5087M
[11/21 20:40:32] d2.utils.events INFO:  eta: 0:00:19  iter: 1499  total_loss: 0.08421  loss_cls: 0.03652  loss_box_reg: 0.0307  loss_rpn_cls: 0.004506  loss_rpn_loc: 0.01207  time: 0.1936  data_time: 0.0153  lr: 0.001  max_mem: 5087M
[11/21 20:40:36] d2.utils.events INFO:  eta: 0:00:15  iter: 1519  total_loss: 0.08626  loss_cls: 0.03869  loss_box_reg: 0.03298  loss_rpn_cls: 0.003912  loss_rpn_loc: 0.01141  time: 0.1936  data_time: 0.0128  lr: 0.001  max_mem: 5087M
[11/21 20:40:40] d2.utils.events INFO:  eta: 0:00:11  iter: 1539  total_loss: 0.08767  loss_cls: 0.03842  loss_box_reg: 0.03243  loss_rpn_cls: 0.003697  loss_rpn_loc: 0.01154  time: 0.1936  data_time: 0.0144  lr: 0.001  max_mem: 5087M
[11/21 20:40:44] d2.utils.events INFO:  eta: 0:00:07  iter: 1559  total_loss: 0.07977  loss_cls: 0.03597  loss_box_reg: 0.03034  loss_rpn_cls: 0.004062  loss_rpn_loc: 0.01188  time: 0.1936  data_time: 0.0149  lr: 0.001  max_mem: 5087M
[11/21 20:40:48] d2.utils.events INFO:  eta: 0:00:03  iter: 1579  total_loss: 0.08489  loss_cls: 0.03694  loss_box_reg: 0.03216  loss_rpn_cls: 0.004342  loss_rpn_loc: 0.01075  time: 0.1936  data_time: 0.0145  lr: 0.001  max_mem: 5087M
[11/21 20:40:52] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final.pth
[11/21 20:40:53] d2.utils.events INFO:  eta: 0:00:00  iter: 1599  total_loss: 0.0873  loss_cls: 0.03752  loss_box_reg: 0.03288  loss_rpn_cls: 0.003158  loss_rpn_loc: 0.01019  time: 0.1936  data_time: 0.0137  lr: 0.001  max_mem: 5087M
[11/21 20:40:53] d2.engine.hooks INFO: Overall training speed: 1598 iterations in 0:05:09 (0.1936 s / it)
[11/21 20:40:53] d2.engine.hooks INFO: Total training time: 0:05:12 (0:00:02 on hooks)
[11/21 20:40:54] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/21 20:40:54] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 20:40:54] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 20:40:54] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/21 20:40:54] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 20:40:54] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 20:40:55] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 20:40:55] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/21 20:40:55] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 20:40:55] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 20:41:05] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0583 s / img. ETA=0:01:09
[11/21 20:41:08] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0579 s / img. ETA=0:01:05
[11/21 20:41:11] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0579 s / img. ETA=0:01:03
[11/21 20:41:14] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0582 s / img. ETA=0:01:00
[11/21 20:41:17] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0580 s / img. ETA=0:00:57
[11/21 20:41:20] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0581 s / img. ETA=0:00:54
[11/21 20:41:23] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0578 s / img. ETA=0:00:51
[11/21 20:41:26] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0577 s / img. ETA=0:00:48
[11/21 20:41:28] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0575 s / img. ETA=0:00:45
[11/21 20:41:31] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0573 s / img. ETA=0:00:42
[11/21 20:41:34] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0573 s / img. ETA=0:00:39
[11/21 20:41:37] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0573 s / img. ETA=0:00:36
[11/21 20:41:40] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0572 s / img. ETA=0:00:33
[11/21 20:41:43] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0573 s / img. ETA=0:00:30
[11/21 20:41:45] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0573 s / img. ETA=0:00:27
[11/21 20:41:48] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0572 s / img. ETA=0:00:25
[11/21 20:41:51] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0571 s / img. ETA=0:00:22
[11/21 20:41:54] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0571 s / img. ETA=0:00:19
[11/21 20:41:57] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0570 s / img. ETA=0:00:16
[11/21 20:41:59] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0569 s / img. ETA=0:00:13
[11/21 20:42:02] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0570 s / img. ETA=0:00:10
[11/21 20:42:05] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0570 s / img. ETA=0:00:07
[11/21 20:42:08] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0569 s / img. ETA=0:00:05
[11/21 20:42:11] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0569 s / img. ETA=0:00:02
[11/21 20:42:13] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:10 (0.056772 s / img per device, on 4 devices)
[11/21 20:42:13] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:08 (0.055244 s / img per device, on 4 devices)
[11/21 20:42:13] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 20:42:19] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 57.690 | 74.057 | 39.810 |   57.463    | 49.546 |
[11/21 20:42:19] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 31.364 | 55.713 | 31.663 | 31.364 | 55.713  | 31.663  |
[11/21 20:42:19] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/21 20:42:19] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 20:42:19] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/21 20:42:19] defrcn.evaluation.testing INFO: copypaste: 31.3637,55.7133,31.6629,31.3637,55.7133,31.6629
[11/21 20:42:34] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 20:42:34] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5'], resume=False, start_iter=-1)
[11/21 20:42:34] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_3shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 20:42:34] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/21 20:42:34] d2.utils.env INFO: Using a generated random seed 37962463
[11/21 20:42:34] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 20:42:34] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth ...
[11/21 20:42:35] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/21 20:42:35] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 20:42:35] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 20:42:35] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/21 20:42:35] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 20:42:35] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 20:42:37] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 3            |   bicycle   | 3            |    boat     | 3            |
|   bottle   | 3            |     car     | 3            |     cat     | 3            |
|   chair    | 3            | diningtable | 3            |     dog     | 3            |
|   horse    | 3            |   person    | 3            | pottedplant | 3            |
|   sheep    | 3            |    train    | 3            |  tvmonitor  | 3            |
|    bird    | 3            |     bus     | 3            |     cow     | 3            |
| motorbike  | 3            |    sofa     | 3            |             |              |
|   total    | 60           |             |              |             |              |[0m
[11/21 20:42:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 20:42:37] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/21 20:42:37] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/21 20:42:40] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 20:42:50] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0577 s / img. ETA=0:01:08
[11/21 20:42:53] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0577 s / img. ETA=0:01:05
[11/21 20:42:56] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0578 s / img. ETA=0:01:02
[11/21 20:42:59] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0577 s / img. ETA=0:00:59
[11/21 20:43:02] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0573 s / img. ETA=0:00:56
[11/21 20:43:04] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0572 s / img. ETA=0:00:53
[11/21 20:43:07] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0569 s / img. ETA=0:00:50
[11/21 20:43:10] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0567 s / img. ETA=0:00:47
[11/21 20:43:13] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0566 s / img. ETA=0:00:44
[11/21 20:43:16] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0565 s / img. ETA=0:00:41
[11/21 20:43:18] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0564 s / img. ETA=0:00:38
[11/21 20:43:21] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0564 s / img. ETA=0:00:35
[11/21 20:43:24] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0563 s / img. ETA=0:00:33
[11/21 20:43:27] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0563 s / img. ETA=0:00:30
[11/21 20:43:30] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0564 s / img. ETA=0:00:27
[11/21 20:43:32] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0563 s / img. ETA=0:00:24
[11/21 20:43:35] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0563 s / img. ETA=0:00:21
[11/21 20:43:38] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0562 s / img. ETA=0:00:19
[11/21 20:43:41] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0562 s / img. ETA=0:00:16
[11/21 20:43:43] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0562 s / img. ETA=0:00:13
[11/21 20:43:46] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0562 s / img. ETA=0:00:10
[11/21 20:43:49] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0562 s / img. ETA=0:00:07
[11/21 20:43:52] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0561 s / img. ETA=0:00:04
[11/21 20:43:54] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0560 s / img. ETA=0:00:02
[11/21 20:43:57] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:09 (0.055961 s / img per device, on 4 devices)
[11/21 20:43:57] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:06 (0.053900 s / img per device, on 4 devices)
[11/21 20:43:59] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 20:44:22] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.134    |  86.051   | 72.234 |  73.694  | 88.517 | 88.380 | 69.602  |    73.759     | 86.868 | 82.883  |  86.234  |    54.538     | 81.091  | 85.186  |   82.191    | 61.545 | 73.305 | 53.505 |   60.063    | 48.181 |
[11/21 20:44:22] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.625 | 74.598 | 50.953 | 53.255 | 79.691  | 58.677  | 30.735 | 59.320  | 27.780  |
[11/21 20:44:22] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/21 20:44:22] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 20:44:22] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/21 20:44:22] defrcn.evaluation.testing INFO: copypaste: 47.6248,74.5980,50.9529,53.2548,79.6907,58.6771,30.7349,59.3200,27.7804
[11/21 21:05:37] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 21:05:37] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/21 21:05:37] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_3shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1280,)
  MAX_ITER: 1600
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 21:05:37] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/21 21:05:37] d2.utils.env INFO: Using a generated random seed 41006312
[11/21 21:05:37] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 21:05:37] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 15 images left.
[11/21 21:05:37] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 3            |    bus     | 3            |    cow     | 3            |
| motorbike  | 3            |    sofa    | 3            |            |              |
|   total    | 15           |            |              |            |              |[0m
[11/21 21:05:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/21 21:05:37] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/21 21:05:37] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/21 21:05:37] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 21:05:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/21 21:05:38] d2.engine.train_loop INFO: Starting training from iteration 0
[11/21 21:05:44] d2.utils.events INFO:  eta: 0:05:10  iter: 19  total_loss: 0.5416  loss_cls: 0.3225  loss_box_reg: 0.135  loss_rpn_cls: 0.04749  loss_rpn_loc: 0.05214  time: 0.1975  data_time: 0.1451  lr: 0.01  max_mem: 5085M
[11/21 21:05:48] d2.utils.events INFO:  eta: 0:05:11  iter: 39  total_loss: 0.4018  loss_cls: 0.1736  loss_box_reg: 0.1313  loss_rpn_cls: 0.02916  loss_rpn_loc: 0.04646  time: 0.2003  data_time: 0.0142  lr: 0.01  max_mem: 5085M
[11/21 21:05:52] d2.utils.events INFO:  eta: 0:05:04  iter: 59  total_loss: 0.2967  loss_cls: 0.1045  loss_box_reg: 0.1155  loss_rpn_cls: 0.02437  loss_rpn_loc: 0.04373  time: 0.1991  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/21 21:05:56] d2.utils.events INFO:  eta: 0:05:00  iter: 79  total_loss: 0.2621  loss_cls: 0.08972  loss_box_reg: 0.1025  loss_rpn_cls: 0.01981  loss_rpn_loc: 0.04169  time: 0.1988  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 21:06:00] d2.utils.events INFO:  eta: 0:04:54  iter: 99  total_loss: 0.2255  loss_cls: 0.07974  loss_box_reg: 0.0928  loss_rpn_cls: 0.01738  loss_rpn_loc: 0.03565  time: 0.1979  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/21 21:06:04] d2.utils.events INFO:  eta: 0:04:51  iter: 119  total_loss: 0.2111  loss_cls: 0.07381  loss_box_reg: 0.0809  loss_rpn_cls: 0.01445  loss_rpn_loc: 0.03891  time: 0.1981  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/21 21:06:08] d2.utils.events INFO:  eta: 0:04:48  iter: 139  total_loss: 0.1967  loss_cls: 0.06807  loss_box_reg: 0.07253  loss_rpn_cls: 0.01506  loss_rpn_loc: 0.0384  time: 0.1980  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 21:06:12] d2.utils.events INFO:  eta: 0:04:44  iter: 159  total_loss: 0.1888  loss_cls: 0.06638  loss_box_reg: 0.06999  loss_rpn_cls: 0.01515  loss_rpn_loc: 0.03844  time: 0.1983  data_time: 0.0160  lr: 0.01  max_mem: 5085M
[11/21 21:06:16] d2.utils.events INFO:  eta: 0:04:40  iter: 179  total_loss: 0.187  loss_cls: 0.06334  loss_box_reg: 0.06369  loss_rpn_cls: 0.01514  loss_rpn_loc: 0.04515  time: 0.1983  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/21 21:06:20] d2.utils.events INFO:  eta: 0:04:37  iter: 199  total_loss: 0.1689  loss_cls: 0.0602  loss_box_reg: 0.06113  loss_rpn_cls: 0.01159  loss_rpn_loc: 0.03259  time: 0.1987  data_time: 0.0154  lr: 0.01  max_mem: 5085M
[11/21 21:06:24] d2.utils.events INFO:  eta: 0:04:34  iter: 219  total_loss: 0.1612  loss_cls: 0.05523  loss_box_reg: 0.05418  loss_rpn_cls: 0.01237  loss_rpn_loc: 0.03406  time: 0.1986  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/21 21:06:28] d2.utils.events INFO:  eta: 0:04:29  iter: 239  total_loss: 0.1458  loss_cls: 0.05646  loss_box_reg: 0.05552  loss_rpn_cls: 0.008194  loss_rpn_loc: 0.03003  time: 0.1984  data_time: 0.0135  lr: 0.01  max_mem: 5085M
[11/21 21:06:32] d2.utils.events INFO:  eta: 0:04:25  iter: 259  total_loss: 0.15  loss_cls: 0.05653  loss_box_reg: 0.05241  loss_rpn_cls: 0.01054  loss_rpn_loc: 0.02603  time: 0.1983  data_time: 0.0142  lr: 0.01  max_mem: 5085M
[11/21 21:06:36] d2.utils.events INFO:  eta: 0:04:21  iter: 279  total_loss: 0.1429  loss_cls: 0.05364  loss_box_reg: 0.0498  loss_rpn_cls: 0.008397  loss_rpn_loc: 0.03015  time: 0.1984  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 21:06:40] d2.utils.events INFO:  eta: 0:04:16  iter: 299  total_loss: 0.1371  loss_cls: 0.05089  loss_box_reg: 0.04584  loss_rpn_cls: 0.008714  loss_rpn_loc: 0.02735  time: 0.1982  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 21:06:44] d2.utils.events INFO:  eta: 0:04:12  iter: 319  total_loss: 0.1364  loss_cls: 0.04905  loss_box_reg: 0.04728  loss_rpn_cls: 0.008603  loss_rpn_loc: 0.02846  time: 0.1981  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/21 21:06:48] d2.utils.events INFO:  eta: 0:04:08  iter: 339  total_loss: 0.1311  loss_cls: 0.04902  loss_box_reg: 0.04561  loss_rpn_cls: 0.008842  loss_rpn_loc: 0.02861  time: 0.1983  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/21 21:06:52] d2.utils.events INFO:  eta: 0:04:05  iter: 359  total_loss: 0.1328  loss_cls: 0.04939  loss_box_reg: 0.04532  loss_rpn_cls: 0.008926  loss_rpn_loc: 0.02672  time: 0.1984  data_time: 0.0129  lr: 0.01  max_mem: 5085M
[11/21 21:06:56] d2.utils.events INFO:  eta: 0:04:01  iter: 379  total_loss: 0.1255  loss_cls: 0.05132  loss_box_reg: 0.04502  loss_rpn_cls: 0.007672  loss_rpn_loc: 0.02279  time: 0.1982  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/21 21:07:00] d2.utils.events INFO:  eta: 0:03:56  iter: 399  total_loss: 0.1219  loss_cls: 0.04895  loss_box_reg: 0.04352  loss_rpn_cls: 0.007102  loss_rpn_loc: 0.02452  time: 0.1982  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/21 21:07:04] d2.utils.events INFO:  eta: 0:03:52  iter: 419  total_loss: 0.1305  loss_cls: 0.04994  loss_box_reg: 0.04491  loss_rpn_cls: 0.007416  loss_rpn_loc: 0.02399  time: 0.1981  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/21 21:07:08] d2.utils.events INFO:  eta: 0:03:48  iter: 439  total_loss: 0.1236  loss_cls: 0.04917  loss_box_reg: 0.0429  loss_rpn_cls: 0.006567  loss_rpn_loc: 0.02721  time: 0.1979  data_time: 0.0133  lr: 0.01  max_mem: 5085M
[11/21 21:07:12] d2.utils.events INFO:  eta: 0:03:44  iter: 459  total_loss: 0.1243  loss_cls: 0.04653  loss_box_reg: 0.04273  loss_rpn_cls: 0.007808  loss_rpn_loc: 0.02725  time: 0.1978  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/21 21:07:15] d2.utils.events INFO:  eta: 0:03:40  iter: 479  total_loss: 0.1149  loss_cls: 0.04618  loss_box_reg: 0.0441  loss_rpn_cls: 0.005102  loss_rpn_loc: 0.02046  time: 0.1979  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/21 21:07:19] d2.utils.events INFO:  eta: 0:03:36  iter: 499  total_loss: 0.1183  loss_cls: 0.05146  loss_box_reg: 0.04235  loss_rpn_cls: 0.005956  loss_rpn_loc: 0.0229  time: 0.1976  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/21 21:07:23] d2.utils.events INFO:  eta: 0:03:32  iter: 519  total_loss: 0.1185  loss_cls: 0.04556  loss_box_reg: 0.03943  loss_rpn_cls: 0.006592  loss_rpn_loc: 0.02411  time: 0.1977  data_time: 0.0164  lr: 0.01  max_mem: 5085M
[11/21 21:07:27] d2.utils.events INFO:  eta: 0:03:29  iter: 539  total_loss: 0.1261  loss_cls: 0.04801  loss_box_reg: 0.04144  loss_rpn_cls: 0.006322  loss_rpn_loc: 0.02443  time: 0.1977  data_time: 0.0142  lr: 0.01  max_mem: 5085M
[11/21 21:07:31] d2.utils.events INFO:  eta: 0:03:24  iter: 559  total_loss: 0.1178  loss_cls: 0.04526  loss_box_reg: 0.04066  loss_rpn_cls: 0.00721  loss_rpn_loc: 0.02537  time: 0.1976  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/21 21:07:35] d2.utils.events INFO:  eta: 0:03:20  iter: 579  total_loss: 0.1122  loss_cls: 0.04685  loss_box_reg: 0.03865  loss_rpn_cls: 0.005424  loss_rpn_loc: 0.01846  time: 0.1976  data_time: 0.0136  lr: 0.01  max_mem: 5085M
[11/21 21:07:39] d2.utils.events INFO:  eta: 0:03:17  iter: 599  total_loss: 0.1193  loss_cls: 0.04599  loss_box_reg: 0.04073  loss_rpn_cls: 0.006312  loss_rpn_loc: 0.02324  time: 0.1977  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/21 21:07:43] d2.utils.events INFO:  eta: 0:03:13  iter: 619  total_loss: 0.1175  loss_cls: 0.04579  loss_box_reg: 0.03995  loss_rpn_cls: 0.006071  loss_rpn_loc: 0.02154  time: 0.1976  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/21 21:07:47] d2.utils.events INFO:  eta: 0:03:08  iter: 639  total_loss: 0.1116  loss_cls: 0.04575  loss_box_reg: 0.03875  loss_rpn_cls: 0.004938  loss_rpn_loc: 0.01897  time: 0.1976  data_time: 0.0158  lr: 0.01  max_mem: 5085M
[11/21 21:07:51] d2.utils.events INFO:  eta: 0:03:04  iter: 659  total_loss: 0.1172  loss_cls: 0.04555  loss_box_reg: 0.0402  loss_rpn_cls: 0.006149  loss_rpn_loc: 0.02295  time: 0.1978  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/21 21:07:55] d2.utils.events INFO:  eta: 0:03:01  iter: 679  total_loss: 0.1136  loss_cls: 0.04542  loss_box_reg: 0.0367  loss_rpn_cls: 0.006366  loss_rpn_loc: 0.02452  time: 0.1978  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/21 21:07:59] d2.utils.events INFO:  eta: 0:02:57  iter: 699  total_loss: 0.1086  loss_cls: 0.04385  loss_box_reg: 0.03604  loss_rpn_cls: 0.004667  loss_rpn_loc: 0.01887  time: 0.1978  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/21 21:08:03] d2.utils.events INFO:  eta: 0:02:53  iter: 719  total_loss: 0.1118  loss_cls: 0.04352  loss_box_reg: 0.03689  loss_rpn_cls: 0.00618  loss_rpn_loc: 0.0218  time: 0.1977  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/21 21:08:07] d2.utils.events INFO:  eta: 0:02:49  iter: 739  total_loss: 0.1082  loss_cls: 0.04623  loss_box_reg: 0.03646  loss_rpn_cls: 0.005449  loss_rpn_loc: 0.02007  time: 0.1978  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/21 21:08:11] d2.utils.events INFO:  eta: 0:02:45  iter: 759  total_loss: 0.1094  loss_cls: 0.04245  loss_box_reg: 0.03537  loss_rpn_cls: 0.006842  loss_rpn_loc: 0.02286  time: 0.1978  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/21 21:08:15] d2.utils.events INFO:  eta: 0:02:41  iter: 779  total_loss: 0.103  loss_cls: 0.04406  loss_box_reg: 0.03525  loss_rpn_cls: 0.004696  loss_rpn_loc: 0.01877  time: 0.1978  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/21 21:08:19] d2.utils.events INFO:  eta: 0:02:37  iter: 799  total_loss: 0.1039  loss_cls: 0.04355  loss_box_reg: 0.03747  loss_rpn_cls: 0.00442  loss_rpn_loc: 0.01949  time: 0.1978  data_time: 0.0166  lr: 0.01  max_mem: 5085M
[11/21 21:08:23] d2.utils.events INFO:  eta: 0:02:33  iter: 819  total_loss: 0.1095  loss_cls: 0.04001  loss_box_reg: 0.03647  loss_rpn_cls: 0.006263  loss_rpn_loc: 0.02233  time: 0.1978  data_time: 0.0137  lr: 0.01  max_mem: 5085M
[11/21 21:08:27] d2.utils.events INFO:  eta: 0:02:29  iter: 839  total_loss: 0.1082  loss_cls: 0.04278  loss_box_reg: 0.03484  loss_rpn_cls: 0.005233  loss_rpn_loc: 0.02371  time: 0.1978  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/21 21:08:31] d2.utils.events INFO:  eta: 0:02:25  iter: 859  total_loss: 0.107  loss_cls: 0.04168  loss_box_reg: 0.0358  loss_rpn_cls: 0.005038  loss_rpn_loc: 0.02318  time: 0.1978  data_time: 0.0127  lr: 0.01  max_mem: 5085M
[11/21 21:08:35] d2.utils.events INFO:  eta: 0:02:21  iter: 879  total_loss: 0.1078  loss_cls: 0.04326  loss_box_reg: 0.03665  loss_rpn_cls: 0.005697  loss_rpn_loc: 0.02306  time: 0.1978  data_time: 0.0142  lr: 0.01  max_mem: 5085M
[11/21 21:08:39] d2.utils.events INFO:  eta: 0:02:17  iter: 899  total_loss: 0.1031  loss_cls: 0.0412  loss_box_reg: 0.03532  loss_rpn_cls: 0.005351  loss_rpn_loc: 0.02007  time: 0.1977  data_time: 0.0139  lr: 0.01  max_mem: 5085M
[11/21 21:08:43] d2.utils.events INFO:  eta: 0:02:13  iter: 919  total_loss: 0.09931  loss_cls: 0.04035  loss_box_reg: 0.03285  loss_rpn_cls: 0.005338  loss_rpn_loc: 0.01761  time: 0.1976  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/21 21:08:46] d2.utils.events INFO:  eta: 0:02:09  iter: 939  total_loss: 0.1049  loss_cls: 0.04149  loss_box_reg: 0.0333  loss_rpn_cls: 0.005925  loss_rpn_loc: 0.02123  time: 0.1975  data_time: 0.0135  lr: 0.01  max_mem: 5085M
[11/21 21:08:50] d2.utils.events INFO:  eta: 0:02:05  iter: 959  total_loss: 0.1041  loss_cls: 0.04016  loss_box_reg: 0.03357  loss_rpn_cls: 0.004761  loss_rpn_loc: 0.02014  time: 0.1976  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/21 21:08:55] d2.utils.events INFO:  eta: 0:02:01  iter: 979  total_loss: 0.1072  loss_cls: 0.04096  loss_box_reg: 0.03562  loss_rpn_cls: 0.005366  loss_rpn_loc: 0.01995  time: 0.1975  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/21 21:08:59] d2.utils.events INFO:  eta: 0:01:57  iter: 999  total_loss: 0.09608  loss_cls: 0.04059  loss_box_reg: 0.03338  loss_rpn_cls: 0.004165  loss_rpn_loc: 0.01718  time: 0.1974  data_time: 0.0144  lr: 0.01  max_mem: 5085M
[11/21 21:09:03] d2.utils.events INFO:  eta: 0:01:53  iter: 1019  total_loss: 0.1009  loss_cls: 0.04125  loss_box_reg: 0.03383  loss_rpn_cls: 0.006026  loss_rpn_loc: 0.0203  time: 0.1974  data_time: 0.0132  lr: 0.01  max_mem: 5085M
[11/21 21:09:07] d2.utils.events INFO:  eta: 0:01:49  iter: 1039  total_loss: 0.09791  loss_cls: 0.04021  loss_box_reg: 0.03396  loss_rpn_cls: 0.003129  loss_rpn_loc: 0.01978  time: 0.1973  data_time: 0.0138  lr: 0.01  max_mem: 5085M
[11/21 21:09:11] d2.utils.events INFO:  eta: 0:01:45  iter: 1059  total_loss: 0.09597  loss_cls: 0.04045  loss_box_reg: 0.03135  loss_rpn_cls: 0.004097  loss_rpn_loc: 0.0182  time: 0.1973  data_time: 0.0154  lr: 0.01  max_mem: 5085M
[11/21 21:09:15] d2.utils.events INFO:  eta: 0:01:41  iter: 1079  total_loss: 0.09783  loss_cls: 0.04098  loss_box_reg: 0.03209  loss_rpn_cls: 0.005749  loss_rpn_loc: 0.02178  time: 0.1973  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/21 21:09:19] d2.utils.events INFO:  eta: 0:01:38  iter: 1099  total_loss: 0.09937  loss_cls: 0.03814  loss_box_reg: 0.03393  loss_rpn_cls: 0.005159  loss_rpn_loc: 0.02138  time: 0.1973  data_time: 0.0132  lr: 0.01  max_mem: 5085M
[11/21 21:09:23] d2.utils.events INFO:  eta: 0:01:34  iter: 1119  total_loss: 0.09926  loss_cls: 0.04027  loss_box_reg: 0.03279  loss_rpn_cls: 0.00369  loss_rpn_loc: 0.01903  time: 0.1973  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/21 21:09:27] d2.utils.events INFO:  eta: 0:01:30  iter: 1139  total_loss: 0.09737  loss_cls: 0.04366  loss_box_reg: 0.03449  loss_rpn_cls: 0.004713  loss_rpn_loc: 0.01748  time: 0.1973  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/21 21:09:31] d2.utils.events INFO:  eta: 0:01:26  iter: 1159  total_loss: 0.09894  loss_cls: 0.04138  loss_box_reg: 0.03248  loss_rpn_cls: 0.004127  loss_rpn_loc: 0.01878  time: 0.1973  data_time: 0.0149  lr: 0.01  max_mem: 5085M
[11/21 21:09:35] d2.utils.events INFO:  eta: 0:01:22  iter: 1179  total_loss: 0.09563  loss_cls: 0.04042  loss_box_reg: 0.03079  loss_rpn_cls: 0.003948  loss_rpn_loc: 0.01801  time: 0.1973  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/21 21:09:39] d2.utils.events INFO:  eta: 0:01:18  iter: 1199  total_loss: 0.09471  loss_cls: 0.03885  loss_box_reg: 0.03375  loss_rpn_cls: 0.004147  loss_rpn_loc: 0.01566  time: 0.1972  data_time: 0.0133  lr: 0.01  max_mem: 5085M
[11/21 21:09:42] d2.utils.events INFO:  eta: 0:01:14  iter: 1219  total_loss: 0.09686  loss_cls: 0.04251  loss_box_reg: 0.03046  loss_rpn_cls: 0.004545  loss_rpn_loc: 0.01816  time: 0.1972  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/21 21:09:46] d2.utils.events INFO:  eta: 0:01:10  iter: 1239  total_loss: 0.09423  loss_cls: 0.04049  loss_box_reg: 0.03004  loss_rpn_cls: 0.004382  loss_rpn_loc: 0.01521  time: 0.1972  data_time: 0.0151  lr: 0.01  max_mem: 5085M
[11/21 21:09:50] d2.utils.events INFO:  eta: 0:01:06  iter: 1259  total_loss: 0.09065  loss_cls: 0.03728  loss_box_reg: 0.02966  loss_rpn_cls: 0.00406  loss_rpn_loc: 0.01622  time: 0.1972  data_time: 0.0136  lr: 0.01  max_mem: 5085M
[11/21 21:09:55] d2.utils.events INFO:  eta: 0:01:02  iter: 1279  total_loss: 0.0953  loss_cls: 0.03737  loss_box_reg: 0.03023  loss_rpn_cls: 0.004235  loss_rpn_loc: 0.01838  time: 0.1971  data_time: 0.0134  lr: 0.01  max_mem: 5085M
[11/21 21:09:58] d2.utils.events INFO:  eta: 0:00:58  iter: 1299  total_loss: 0.0913  loss_cls: 0.0392  loss_box_reg: 0.03158  loss_rpn_cls: 0.004688  loss_rpn_loc: 0.01597  time: 0.1971  data_time: 0.0150  lr: 0.001  max_mem: 5085M
[11/21 21:10:02] d2.utils.events INFO:  eta: 0:00:54  iter: 1319  total_loss: 0.08625  loss_cls: 0.03875  loss_box_reg: 0.02905  loss_rpn_cls: 0.004995  loss_rpn_loc: 0.01134  time: 0.1971  data_time: 0.0136  lr: 0.001  max_mem: 5085M
[11/21 21:10:06] d2.utils.events INFO:  eta: 0:00:50  iter: 1339  total_loss: 0.0888  loss_cls: 0.03677  loss_box_reg: 0.03073  loss_rpn_cls: 0.005233  loss_rpn_loc: 0.01315  time: 0.1971  data_time: 0.0167  lr: 0.001  max_mem: 5085M
[11/21 21:10:10] d2.utils.events INFO:  eta: 0:00:46  iter: 1359  total_loss: 0.08333  loss_cls: 0.03824  loss_box_reg: 0.03102  loss_rpn_cls: 0.003997  loss_rpn_loc: 0.0127  time: 0.1971  data_time: 0.0146  lr: 0.001  max_mem: 5085M
[11/21 21:10:14] d2.utils.events INFO:  eta: 0:00:43  iter: 1379  total_loss: 0.08676  loss_cls: 0.03766  loss_box_reg: 0.03056  loss_rpn_cls: 0.004582  loss_rpn_loc: 0.01186  time: 0.1971  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/21 21:10:18] d2.utils.events INFO:  eta: 0:00:39  iter: 1399  total_loss: 0.08439  loss_cls: 0.0394  loss_box_reg: 0.02969  loss_rpn_cls: 0.004283  loss_rpn_loc: 0.01158  time: 0.1971  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/21 21:10:22] d2.utils.events INFO:  eta: 0:00:35  iter: 1419  total_loss: 0.08264  loss_cls: 0.03914  loss_box_reg: 0.03023  loss_rpn_cls: 0.003682  loss_rpn_loc: 0.01002  time: 0.1971  data_time: 0.0137  lr: 0.001  max_mem: 5085M
[11/21 21:10:26] d2.utils.events INFO:  eta: 0:00:31  iter: 1439  total_loss: 0.08391  loss_cls: 0.03805  loss_box_reg: 0.03029  loss_rpn_cls: 0.003418  loss_rpn_loc: 0.01013  time: 0.1971  data_time: 0.0140  lr: 0.001  max_mem: 5085M
[11/21 21:10:30] d2.utils.events INFO:  eta: 0:00:27  iter: 1459  total_loss: 0.08172  loss_cls: 0.03688  loss_box_reg: 0.0301  loss_rpn_cls: 0.003906  loss_rpn_loc: 0.01164  time: 0.1971  data_time: 0.0136  lr: 0.001  max_mem: 5085M
[11/21 21:10:34] d2.utils.events INFO:  eta: 0:00:23  iter: 1479  total_loss: 0.08312  loss_cls: 0.03944  loss_box_reg: 0.02824  loss_rpn_cls: 0.003081  loss_rpn_loc: 0.01064  time: 0.1971  data_time: 0.0151  lr: 0.001  max_mem: 5085M
[11/21 21:10:38] d2.utils.events INFO:  eta: 0:00:19  iter: 1499  total_loss: 0.08106  loss_cls: 0.03847  loss_box_reg: 0.02748  loss_rpn_cls: 0.004011  loss_rpn_loc: 0.009682  time: 0.1971  data_time: 0.0164  lr: 0.001  max_mem: 5085M
[11/21 21:10:42] d2.utils.events INFO:  eta: 0:00:15  iter: 1519  total_loss: 0.08396  loss_cls: 0.03806  loss_box_reg: 0.02855  loss_rpn_cls: 0.003849  loss_rpn_loc: 0.01145  time: 0.1971  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/21 21:10:46] d2.utils.events INFO:  eta: 0:00:11  iter: 1539  total_loss: 0.08144  loss_cls: 0.03829  loss_box_reg: 0.02851  loss_rpn_cls: 0.003826  loss_rpn_loc: 0.01104  time: 0.1971  data_time: 0.0144  lr: 0.001  max_mem: 5085M
[11/21 21:10:50] d2.utils.events INFO:  eta: 0:00:07  iter: 1559  total_loss: 0.08378  loss_cls: 0.03924  loss_box_reg: 0.02919  loss_rpn_cls: 0.004004  loss_rpn_loc: 0.01008  time: 0.1970  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/21 21:10:54] d2.utils.events INFO:  eta: 0:00:03  iter: 1579  total_loss: 0.08561  loss_cls: 0.03502  loss_box_reg: 0.02992  loss_rpn_cls: 0.004143  loss_rpn_loc: 0.01077  time: 0.1971  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/21 21:10:58] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final.pth
[11/21 21:11:00] d2.utils.events INFO:  eta: 0:00:00  iter: 1599  total_loss: 0.08345  loss_cls: 0.04048  loss_box_reg: 0.02935  loss_rpn_cls: 0.003084  loss_rpn_loc: 0.009374  time: 0.1970  data_time: 0.0136  lr: 0.001  max_mem: 5085M
[11/21 21:11:00] d2.engine.hooks INFO: Overall training speed: 1598 iterations in 0:05:14 (0.1970 s / it)
[11/21 21:11:00] d2.engine.hooks INFO: Total training time: 0:05:19 (0:00:04 on hooks)
[11/21 21:11:00] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/21 21:11:00] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 21:11:00] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 21:11:00] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/21 21:11:00] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 21:11:00] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 21:11:01] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 21:11:01] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/21 21:11:01] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/21 21:11:02] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 21:11:12] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0578 s / img. ETA=0:01:08
[11/21 21:11:15] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0568 s / img. ETA=0:01:04
[11/21 21:11:18] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0567 s / img. ETA=0:01:01
[11/21 21:11:20] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0566 s / img. ETA=0:00:58
[11/21 21:11:23] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0564 s / img. ETA=0:00:55
[11/21 21:11:26] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0564 s / img. ETA=0:00:52
[11/21 21:11:29] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0561 s / img. ETA=0:00:49
[11/21 21:11:32] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0560 s / img. ETA=0:00:46
[11/21 21:11:34] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0559 s / img. ETA=0:00:44
[11/21 21:11:37] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0559 s / img. ETA=0:00:41
[11/21 21:11:40] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0558 s / img. ETA=0:00:38
[11/21 21:11:43] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0560 s / img. ETA=0:00:35
[11/21 21:11:46] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0560 s / img. ETA=0:00:32
[11/21 21:11:48] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0560 s / img. ETA=0:00:30
[11/21 21:11:51] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0561 s / img. ETA=0:00:27
[11/21 21:11:54] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0561 s / img. ETA=0:00:24
[11/21 21:11:57] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0561 s / img. ETA=0:00:21
[11/21 21:12:00] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0560 s / img. ETA=0:00:18
[11/21 21:12:02] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0559 s / img. ETA=0:00:16
[11/21 21:12:05] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0559 s / img. ETA=0:00:13
[11/21 21:12:08] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0559 s / img. ETA=0:00:10
[11/21 21:12:11] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0559 s / img. ETA=0:00:07
[11/21 21:12:13] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0559 s / img. ETA=0:00:04
[11/21 21:12:16] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0559 s / img. ETA=0:00:02
[11/21 21:12:19] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:09 (0.055961 s / img per device, on 4 devices)
[11/21 21:12:19] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:06 (0.054145 s / img per device, on 4 devices)
[11/21 21:12:19] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 21:12:24] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 56.979 | 72.681 | 38.859 |   57.702    | 49.097 |
[11/21 21:12:24] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 30.893 | 55.064 | 30.435 | 30.893 | 55.064  | 30.435  |
[11/21 21:12:24] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/21 21:12:24] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 21:12:24] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/21 21:12:24] defrcn.evaluation.testing INFO: copypaste: 30.8929,55.0638,30.4350,30.8929,55.0638,30.4350
[11/21 21:12:39] detectron2 INFO: Rank of current process: 0. World size: 4
[11/21 21:12:39] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5'], resume=False, start_iter=-1)
[11/21 21:12:39] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_3shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/21 21:12:39] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/21 21:12:39] d2.utils.env INFO: Using a generated random seed 43462442
[11/21 21:12:39] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/21 21:12:40] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth ...
[11/21 21:12:40] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/21 21:12:40] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 21:12:40] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/21 21:12:40] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/21 21:12:40] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/21 21:12:40] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/21 21:12:42] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 3            |   bicycle   | 3            |    boat     | 3            |
|   bottle   | 3            |     car     | 3            |     cat     | 3            |
|   chair    | 3            | diningtable | 3            |     dog     | 3            |
|   horse    | 3            |   person    | 3            | pottedplant | 3            |
|   sheep    | 3            |    train    | 3            |  tvmonitor  | 3            |
|    bird    | 3            |     bus     | 3            |     cow     | 3            |
| motorbike  | 3            |    sofa     | 3            |             |              |
|   total    | 60           |             |              |             |              |[0m
[11/21 21:12:42] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/21 21:12:42] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/21 21:12:42] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/21 21:12:45] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/21 21:12:55] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0580 s / img. ETA=0:01:08
[11/21 21:12:58] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0570 s / img. ETA=0:01:04
[11/21 21:13:01] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0569 s / img. ETA=0:01:01
[11/21 21:13:04] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0569 s / img. ETA=0:00:59
[11/21 21:13:06] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0568 s / img. ETA=0:00:56
[11/21 21:13:09] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0567 s / img. ETA=0:00:53
[11/21 21:13:12] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0567 s / img. ETA=0:00:50
[11/21 21:13:15] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0566 s / img. ETA=0:00:47
[11/21 21:13:18] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0567 s / img. ETA=0:00:44
[11/21 21:13:20] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0565 s / img. ETA=0:00:41
[11/21 21:13:23] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0564 s / img. ETA=0:00:38
[11/21 21:13:26] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0564 s / img. ETA=0:00:35
[11/21 21:13:29] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0563 s / img. ETA=0:00:33
[11/21 21:13:32] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0562 s / img. ETA=0:00:30
[11/21 21:13:34] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0562 s / img. ETA=0:00:27
[11/21 21:13:37] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0561 s / img. ETA=0:00:24
[11/21 21:13:40] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0561 s / img. ETA=0:00:21
[11/21 21:13:43] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0560 s / img. ETA=0:00:18
[11/21 21:13:45] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0559 s / img. ETA=0:00:16
[11/21 21:13:48] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0559 s / img. ETA=0:00:13
[11/21 21:13:51] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0559 s / img. ETA=0:00:10
[11/21 21:13:54] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0558 s / img. ETA=0:00:07
[11/21 21:13:56] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0558 s / img. ETA=0:00:04
[11/21 21:13:59] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0557 s / img. ETA=0:00:02
[11/21 21:14:02] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:09 (0.055961 s / img per device, on 4 devices)
[11/21 21:14:02] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:06 (0.053664 s / img per device, on 4 devices)
[11/21 21:14:03] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/21 21:14:25] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   83.956    |  86.001   | 73.442 |  73.970  | 88.409 | 88.220 | 68.891  |    74.916     | 86.763 | 83.992  |  86.224  |    55.202     | 81.009  | 85.793  |   82.085    | 61.685 | 74.339 | 55.317 |   58.896    | 49.358 |
[11/21 21:14:25] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.115 | 74.923 | 51.899 | 53.392 | 79.925  | 59.208  | 32.285 | 59.919  | 29.971  |
[11/21 21:14:25] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/21 21:14:25] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/21 21:14:25] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/21 21:14:25] defrcn.evaluation.testing INFO: copypaste: 48.1150,74.9233,51.8989,53.3918,79.9248,59.2082,32.2847,59.9190,29.9711
[11/22 06:56:41] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 06:56:41] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 06:56:41] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel1_3shot_seed5", )
  TEST: ("voc_2007_test_novel1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1280,)
  MAX_ITER: 1600
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 06:56:41] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/22 06:56:41] d2.utils.env INFO: Using a generated random seed 42284602
[11/22 06:56:42] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 06:56:42] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 15 images left.
[11/22 06:56:42] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 3            |    bus     | 3            |    cow     | 3            |
| motorbike  | 3            |    sofa    | 3            |            |              |
|   total    | 15           |            |              |            |              |[0m
[11/22 06:56:42] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 06:56:42] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 06:56:42] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/22 06:56:42] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 06:56:42] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base1/model_final-remove.pth ...
[11/22 06:56:42] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 06:56:49] d2.utils.events INFO:  eta: 0:04:55  iter: 19  total_loss: 0.5347  loss_cls: 0.3066  loss_box_reg: 0.1515  loss_rpn_cls: 0.04405  loss_rpn_loc: 0.06485  time: 0.1896  data_time: 0.1399  lr: 0.01  max_mem: 5085M
[11/22 06:56:53] d2.utils.events INFO:  eta: 0:04:57  iter: 39  total_loss: 0.3661  loss_cls: 0.1765  loss_box_reg: 0.1325  loss_rpn_cls: 0.02906  loss_rpn_loc: 0.04508  time: 0.1925  data_time: 0.0149  lr: 0.01  max_mem: 5085M
[11/22 06:56:57] d2.utils.events INFO:  eta: 0:04:57  iter: 59  total_loss: 0.2927  loss_cls: 0.09959  loss_box_reg: 0.1125  loss_rpn_cls: 0.02392  loss_rpn_loc: 0.0537  time: 0.1943  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/22 06:57:00] d2.utils.events INFO:  eta: 0:04:52  iter: 79  total_loss: 0.2666  loss_cls: 0.08853  loss_box_reg: 0.1057  loss_rpn_cls: 0.02001  loss_rpn_loc: 0.04637  time: 0.1942  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/22 06:57:04] d2.utils.events INFO:  eta: 0:04:51  iter: 99  total_loss: 0.2372  loss_cls: 0.08614  loss_box_reg: 0.09576  loss_rpn_cls: 0.01778  loss_rpn_loc: 0.04167  time: 0.1944  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/22 06:57:08] d2.utils.events INFO:  eta: 0:04:47  iter: 119  total_loss: 0.2151  loss_cls: 0.07025  loss_box_reg: 0.07967  loss_rpn_cls: 0.0162  loss_rpn_loc: 0.04107  time: 0.1945  data_time: 0.0161  lr: 0.01  max_mem: 5085M
[11/22 06:57:12] d2.utils.events INFO:  eta: 0:04:43  iter: 139  total_loss: 0.1953  loss_cls: 0.06789  loss_box_reg: 0.07167  loss_rpn_cls: 0.01414  loss_rpn_loc: 0.04007  time: 0.1945  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/22 06:57:16] d2.utils.events INFO:  eta: 0:04:39  iter: 159  total_loss: 0.1771  loss_cls: 0.0662  loss_box_reg: 0.0643  loss_rpn_cls: 0.01016  loss_rpn_loc: 0.03402  time: 0.1946  data_time: 0.0132  lr: 0.01  max_mem: 5085M
[11/22 06:57:20] d2.utils.events INFO:  eta: 0:04:35  iter: 179  total_loss: 0.1795  loss_cls: 0.06086  loss_box_reg: 0.06119  loss_rpn_cls: 0.01378  loss_rpn_loc: 0.03935  time: 0.1944  data_time: 0.0136  lr: 0.01  max_mem: 5085M
[11/22 06:57:24] d2.utils.events INFO:  eta: 0:04:31  iter: 199  total_loss: 0.1628  loss_cls: 0.05873  loss_box_reg: 0.0573  loss_rpn_cls: 0.01236  loss_rpn_loc: 0.03012  time: 0.1946  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/22 06:57:28] d2.utils.events INFO:  eta: 0:04:28  iter: 219  total_loss: 0.154  loss_cls: 0.05537  loss_box_reg: 0.05324  loss_rpn_cls: 0.01113  loss_rpn_loc: 0.03134  time: 0.1947  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/22 06:57:32] d2.utils.events INFO:  eta: 0:04:24  iter: 239  total_loss: 0.147  loss_cls: 0.05572  loss_box_reg: 0.05044  loss_rpn_cls: 0.009526  loss_rpn_loc: 0.03044  time: 0.1945  data_time: 0.0162  lr: 0.01  max_mem: 5085M
[11/22 06:57:36] d2.utils.events INFO:  eta: 0:04:19  iter: 259  total_loss: 0.1491  loss_cls: 0.05566  loss_box_reg: 0.05118  loss_rpn_cls: 0.01212  loss_rpn_loc: 0.03424  time: 0.1944  data_time: 0.0159  lr: 0.01  max_mem: 5085M
[11/22 06:57:39] d2.utils.events INFO:  eta: 0:04:15  iter: 279  total_loss: 0.1425  loss_cls: 0.0531  loss_box_reg: 0.04745  loss_rpn_cls: 0.009783  loss_rpn_loc: 0.0309  time: 0.1943  data_time: 0.0139  lr: 0.01  max_mem: 5085M
[11/22 06:57:43] d2.utils.events INFO:  eta: 0:04:11  iter: 299  total_loss: 0.1445  loss_cls: 0.0509  loss_box_reg: 0.04846  loss_rpn_cls: 0.01055  loss_rpn_loc: 0.02817  time: 0.1943  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/22 06:57:47] d2.utils.events INFO:  eta: 0:04:07  iter: 319  total_loss: 0.1342  loss_cls: 0.05017  loss_box_reg: 0.04564  loss_rpn_cls: 0.00949  loss_rpn_loc: 0.02802  time: 0.1942  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/22 06:57:51] d2.utils.events INFO:  eta: 0:04:03  iter: 339  total_loss: 0.1383  loss_cls: 0.04902  loss_box_reg: 0.04625  loss_rpn_cls: 0.01088  loss_rpn_loc: 0.03105  time: 0.1941  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 06:57:55] d2.utils.events INFO:  eta: 0:03:59  iter: 359  total_loss: 0.1342  loss_cls: 0.05038  loss_box_reg: 0.0465  loss_rpn_cls: 0.007424  loss_rpn_loc: 0.02196  time: 0.1943  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 06:57:59] d2.utils.events INFO:  eta: 0:03:55  iter: 379  total_loss: 0.1334  loss_cls: 0.04964  loss_box_reg: 0.045  loss_rpn_cls: 0.01001  loss_rpn_loc: 0.03001  time: 0.1943  data_time: 0.0166  lr: 0.01  max_mem: 5085M
[11/22 06:58:03] d2.utils.events INFO:  eta: 0:03:51  iter: 399  total_loss: 0.1317  loss_cls: 0.04905  loss_box_reg: 0.04426  loss_rpn_cls: 0.008075  loss_rpn_loc: 0.02983  time: 0.1943  data_time: 0.0151  lr: 0.01  max_mem: 5085M
[11/22 06:58:07] d2.utils.events INFO:  eta: 0:03:47  iter: 419  total_loss: 0.1227  loss_cls: 0.04685  loss_box_reg: 0.04292  loss_rpn_cls: 0.008751  loss_rpn_loc: 0.02562  time: 0.1941  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 06:58:10] d2.utils.events INFO:  eta: 0:03:43  iter: 439  total_loss: 0.1237  loss_cls: 0.04717  loss_box_reg: 0.04314  loss_rpn_cls: 0.006992  loss_rpn_loc: 0.02917  time: 0.1941  data_time: 0.0153  lr: 0.01  max_mem: 5085M
[11/22 06:58:14] d2.utils.events INFO:  eta: 0:03:39  iter: 459  total_loss: 0.1274  loss_cls: 0.04622  loss_box_reg: 0.04177  loss_rpn_cls: 0.008367  loss_rpn_loc: 0.02729  time: 0.1940  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/22 06:58:18] d2.utils.events INFO:  eta: 0:03:36  iter: 479  total_loss: 0.1225  loss_cls: 0.04465  loss_box_reg: 0.04199  loss_rpn_cls: 0.00697  loss_rpn_loc: 0.02798  time: 0.1940  data_time: 0.0129  lr: 0.01  max_mem: 5085M
[11/22 06:58:22] d2.utils.events INFO:  eta: 0:03:31  iter: 499  total_loss: 0.1223  loss_cls: 0.04613  loss_box_reg: 0.04263  loss_rpn_cls: 0.007153  loss_rpn_loc: 0.02591  time: 0.1939  data_time: 0.0139  lr: 0.01  max_mem: 5085M
[11/22 06:58:26] d2.utils.events INFO:  eta: 0:03:28  iter: 519  total_loss: 0.1158  loss_cls: 0.04394  loss_box_reg: 0.03942  loss_rpn_cls: 0.005384  loss_rpn_loc: 0.01955  time: 0.1939  data_time: 0.0130  lr: 0.01  max_mem: 5085M
[11/22 06:58:30] d2.utils.events INFO:  eta: 0:03:24  iter: 539  total_loss: 0.1173  loss_cls: 0.0464  loss_box_reg: 0.03908  loss_rpn_cls: 0.006195  loss_rpn_loc: 0.02113  time: 0.1938  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/22 06:58:34] d2.utils.events INFO:  eta: 0:03:20  iter: 559  total_loss: 0.1218  loss_cls: 0.04336  loss_box_reg: 0.03817  loss_rpn_cls: 0.008728  loss_rpn_loc: 0.02892  time: 0.1937  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/22 06:58:38] d2.utils.events INFO:  eta: 0:03:16  iter: 579  total_loss: 0.115  loss_cls: 0.04406  loss_box_reg: 0.04062  loss_rpn_cls: 0.005971  loss_rpn_loc: 0.02253  time: 0.1937  data_time: 0.0132  lr: 0.01  max_mem: 5085M
[11/22 06:58:41] d2.utils.events INFO:  eta: 0:03:12  iter: 599  total_loss: 0.1139  loss_cls: 0.0405  loss_box_reg: 0.03947  loss_rpn_cls: 0.007464  loss_rpn_loc: 0.02574  time: 0.1936  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 06:58:45] d2.utils.events INFO:  eta: 0:03:08  iter: 619  total_loss: 0.1103  loss_cls: 0.04285  loss_box_reg: 0.03915  loss_rpn_cls: 0.006583  loss_rpn_loc: 0.02143  time: 0.1936  data_time: 0.0142  lr: 0.01  max_mem: 5085M
[11/22 06:58:49] d2.utils.events INFO:  eta: 0:03:04  iter: 639  total_loss: 0.1109  loss_cls: 0.04394  loss_box_reg: 0.04117  loss_rpn_cls: 0.006314  loss_rpn_loc: 0.02107  time: 0.1935  data_time: 0.0139  lr: 0.01  max_mem: 5085M
[11/22 06:58:53] d2.utils.events INFO:  eta: 0:03:00  iter: 659  total_loss: 0.1102  loss_cls: 0.0444  loss_box_reg: 0.0372  loss_rpn_cls: 0.005381  loss_rpn_loc: 0.01771  time: 0.1934  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/22 06:58:57] d2.utils.events INFO:  eta: 0:02:56  iter: 679  total_loss: 0.1098  loss_cls: 0.04425  loss_box_reg: 0.03632  loss_rpn_cls: 0.005652  loss_rpn_loc: 0.02199  time: 0.1935  data_time: 0.0146  lr: 0.01  max_mem: 5085M
[11/22 06:59:01] d2.utils.events INFO:  eta: 0:02:53  iter: 699  total_loss: 0.1181  loss_cls: 0.04456  loss_box_reg: 0.03915  loss_rpn_cls: 0.006261  loss_rpn_loc: 0.02361  time: 0.1936  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/22 06:59:05] d2.utils.events INFO:  eta: 0:02:49  iter: 719  total_loss: 0.106  loss_cls: 0.0449  loss_box_reg: 0.03811  loss_rpn_cls: 0.004587  loss_rpn_loc: 0.01802  time: 0.1936  data_time: 0.0138  lr: 0.01  max_mem: 5085M
[11/22 06:59:09] d2.utils.events INFO:  eta: 0:02:45  iter: 739  total_loss: 0.1085  loss_cls: 0.04531  loss_box_reg: 0.03667  loss_rpn_cls: 0.004893  loss_rpn_loc: 0.02026  time: 0.1936  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/22 06:59:12] d2.utils.events INFO:  eta: 0:02:41  iter: 759  total_loss: 0.1075  loss_cls: 0.04133  loss_box_reg: 0.03591  loss_rpn_cls: 0.005785  loss_rpn_loc: 0.02494  time: 0.1936  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/22 06:59:16] d2.utils.events INFO:  eta: 0:02:37  iter: 779  total_loss: 0.1097  loss_cls: 0.04085  loss_box_reg: 0.03547  loss_rpn_cls: 0.005656  loss_rpn_loc: 0.02473  time: 0.1936  data_time: 0.0134  lr: 0.01  max_mem: 5085M
[11/22 06:59:20] d2.utils.events INFO:  eta: 0:02:33  iter: 799  total_loss: 0.1047  loss_cls: 0.04073  loss_box_reg: 0.03319  loss_rpn_cls: 0.005552  loss_rpn_loc: 0.02457  time: 0.1936  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/22 06:59:24] d2.utils.events INFO:  eta: 0:02:29  iter: 819  total_loss: 0.1075  loss_cls: 0.04426  loss_box_reg: 0.03652  loss_rpn_cls: 0.005841  loss_rpn_loc: 0.01909  time: 0.1935  data_time: 0.0143  lr: 0.01  max_mem: 5085M
[11/22 06:59:28] d2.utils.events INFO:  eta: 0:02:26  iter: 839  total_loss: 0.103  loss_cls: 0.04205  loss_box_reg: 0.03595  loss_rpn_cls: 0.005496  loss_rpn_loc: 0.01967  time: 0.1934  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/22 06:59:32] d2.utils.events INFO:  eta: 0:02:22  iter: 859  total_loss: 0.1004  loss_cls: 0.04228  loss_box_reg: 0.03309  loss_rpn_cls: 0.005844  loss_rpn_loc: 0.01963  time: 0.1934  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/22 06:59:35] d2.utils.events INFO:  eta: 0:02:18  iter: 879  total_loss: 0.1023  loss_cls: 0.04021  loss_box_reg: 0.03392  loss_rpn_cls: 0.005348  loss_rpn_loc: 0.02633  time: 0.1934  data_time: 0.0148  lr: 0.01  max_mem: 5085M
[11/22 06:59:39] d2.utils.events INFO:  eta: 0:02:14  iter: 899  total_loss: 0.09915  loss_cls: 0.03994  loss_box_reg: 0.0348  loss_rpn_cls: 0.005028  loss_rpn_loc: 0.02092  time: 0.1935  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/22 06:59:43] d2.utils.events INFO:  eta: 0:02:10  iter: 919  total_loss: 0.105  loss_cls: 0.04242  loss_box_reg: 0.03589  loss_rpn_cls: 0.006122  loss_rpn_loc: 0.02365  time: 0.1935  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/22 06:59:47] d2.utils.events INFO:  eta: 0:02:06  iter: 939  total_loss: 0.1008  loss_cls: 0.03964  loss_box_reg: 0.03298  loss_rpn_cls: 0.005167  loss_rpn_loc: 0.02154  time: 0.1935  data_time: 0.0150  lr: 0.01  max_mem: 5085M
[11/22 06:59:51] d2.utils.events INFO:  eta: 0:02:03  iter: 959  total_loss: 0.1005  loss_cls: 0.03788  loss_box_reg: 0.03248  loss_rpn_cls: 0.005167  loss_rpn_loc: 0.02229  time: 0.1936  data_time: 0.0141  lr: 0.01  max_mem: 5085M
[11/22 06:59:55] d2.utils.events INFO:  eta: 0:01:59  iter: 979  total_loss: 0.09693  loss_cls: 0.03962  loss_box_reg: 0.0335  loss_rpn_cls: 0.004131  loss_rpn_loc: 0.01903  time: 0.1936  data_time: 0.0155  lr: 0.01  max_mem: 5085M
[11/22 06:59:59] d2.utils.events INFO:  eta: 0:01:55  iter: 999  total_loss: 0.09358  loss_cls: 0.03763  loss_box_reg: 0.03142  loss_rpn_cls: 0.004577  loss_rpn_loc: 0.01949  time: 0.1936  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/22 07:00:03] d2.utils.events INFO:  eta: 0:01:51  iter: 1019  total_loss: 0.09805  loss_cls: 0.03969  loss_box_reg: 0.03297  loss_rpn_cls: 0.004897  loss_rpn_loc: 0.01993  time: 0.1936  data_time: 0.0140  lr: 0.01  max_mem: 5085M
[11/22 07:00:07] d2.utils.events INFO:  eta: 0:01:47  iter: 1039  total_loss: 0.09517  loss_cls: 0.03703  loss_box_reg: 0.03012  loss_rpn_cls: 0.005579  loss_rpn_loc: 0.01933  time: 0.1936  data_time: 0.0163  lr: 0.01  max_mem: 5085M
[11/22 07:00:11] d2.utils.events INFO:  eta: 0:01:43  iter: 1059  total_loss: 0.09368  loss_cls: 0.03964  loss_box_reg: 0.03022  loss_rpn_cls: 0.00391  loss_rpn_loc: 0.02055  time: 0.1936  data_time: 0.0156  lr: 0.01  max_mem: 5085M
[11/22 07:00:14] d2.utils.events INFO:  eta: 0:01:40  iter: 1079  total_loss: 0.09347  loss_cls: 0.03772  loss_box_reg: 0.03263  loss_rpn_cls: 0.003768  loss_rpn_loc: 0.01759  time: 0.1936  data_time: 0.0147  lr: 0.01  max_mem: 5085M
[11/22 07:00:18] d2.utils.events INFO:  eta: 0:01:36  iter: 1099  total_loss: 0.09905  loss_cls: 0.03791  loss_box_reg: 0.0316  loss_rpn_cls: 0.004611  loss_rpn_loc: 0.01977  time: 0.1937  data_time: 0.0145  lr: 0.01  max_mem: 5085M
[11/22 07:00:22] d2.utils.events INFO:  eta: 0:01:32  iter: 1119  total_loss: 0.09965  loss_cls: 0.03849  loss_box_reg: 0.03303  loss_rpn_cls: 0.006178  loss_rpn_loc: 0.02353  time: 0.1937  data_time: 0.0152  lr: 0.01  max_mem: 5085M
[11/22 07:00:26] d2.utils.events INFO:  eta: 0:01:28  iter: 1139  total_loss: 0.102  loss_cls: 0.04122  loss_box_reg: 0.03535  loss_rpn_cls: 0.005162  loss_rpn_loc: 0.02319  time: 0.1937  data_time: 0.0135  lr: 0.01  max_mem: 5085M
[11/22 07:00:30] d2.utils.events INFO:  eta: 0:01:24  iter: 1159  total_loss: 0.09686  loss_cls: 0.03585  loss_box_reg: 0.02868  loss_rpn_cls: 0.005421  loss_rpn_loc: 0.02203  time: 0.1937  data_time: 0.0130  lr: 0.01  max_mem: 5085M
[11/22 07:00:34] d2.utils.events INFO:  eta: 0:01:20  iter: 1179  total_loss: 0.09658  loss_cls: 0.03647  loss_box_reg: 0.03184  loss_rpn_cls: 0.005451  loss_rpn_loc: 0.0204  time: 0.1936  data_time: 0.0138  lr: 0.01  max_mem: 5085M
[11/22 07:00:38] d2.utils.events INFO:  eta: 0:01:16  iter: 1199  total_loss: 0.0964  loss_cls: 0.03805  loss_box_reg: 0.0306  loss_rpn_cls: 0.00553  loss_rpn_loc: 0.01895  time: 0.1937  data_time: 0.0139  lr: 0.01  max_mem: 5085M
[11/22 07:00:42] d2.utils.events INFO:  eta: 0:01:13  iter: 1219  total_loss: 0.09263  loss_cls: 0.03739  loss_box_reg: 0.03082  loss_rpn_cls: 0.004845  loss_rpn_loc: 0.01876  time: 0.1936  data_time: 0.0137  lr: 0.01  max_mem: 5085M
[11/22 07:00:45] d2.utils.events INFO:  eta: 0:01:09  iter: 1239  total_loss: 0.09838  loss_cls: 0.038  loss_box_reg: 0.03229  loss_rpn_cls: 0.003931  loss_rpn_loc: 0.01969  time: 0.1936  data_time: 0.0136  lr: 0.01  max_mem: 5085M
[11/22 07:00:49] d2.utils.events INFO:  eta: 0:01:05  iter: 1259  total_loss: 0.08843  loss_cls: 0.03756  loss_box_reg: 0.0311  loss_rpn_cls: 0.003497  loss_rpn_loc: 0.01474  time: 0.1936  data_time: 0.0149  lr: 0.01  max_mem: 5085M
[11/22 07:00:53] d2.utils.events INFO:  eta: 0:01:01  iter: 1279  total_loss: 0.08607  loss_cls: 0.0362  loss_box_reg: 0.02795  loss_rpn_cls: 0.004519  loss_rpn_loc: 0.01506  time: 0.1936  data_time: 0.0133  lr: 0.01  max_mem: 5085M
[11/22 07:00:57] d2.utils.events INFO:  eta: 0:00:57  iter: 1299  total_loss: 0.08659  loss_cls: 0.03731  loss_box_reg: 0.03007  loss_rpn_cls: 0.003695  loss_rpn_loc: 0.01402  time: 0.1935  data_time: 0.0145  lr: 0.001  max_mem: 5085M
[11/22 07:01:01] d2.utils.events INFO:  eta: 0:00:53  iter: 1319  total_loss: 0.08111  loss_cls: 0.03692  loss_box_reg: 0.02783  loss_rpn_cls: 0.003883  loss_rpn_loc: 0.01247  time: 0.1935  data_time: 0.0148  lr: 0.001  max_mem: 5085M
[11/22 07:01:05] d2.utils.events INFO:  eta: 0:00:49  iter: 1339  total_loss: 0.08848  loss_cls: 0.03862  loss_box_reg: 0.03083  loss_rpn_cls: 0.004589  loss_rpn_loc: 0.01337  time: 0.1935  data_time: 0.0139  lr: 0.001  max_mem: 5085M
[11/22 07:01:09] d2.utils.events INFO:  eta: 0:00:46  iter: 1359  total_loss: 0.08391  loss_cls: 0.03728  loss_box_reg: 0.02899  loss_rpn_cls: 0.004045  loss_rpn_loc: 0.01207  time: 0.1935  data_time: 0.0143  lr: 0.001  max_mem: 5085M
[11/22 07:01:12] d2.utils.events INFO:  eta: 0:00:42  iter: 1379  total_loss: 0.08444  loss_cls: 0.03749  loss_box_reg: 0.03133  loss_rpn_cls: 0.004636  loss_rpn_loc: 0.01228  time: 0.1935  data_time: 0.0140  lr: 0.001  max_mem: 5085M
[11/22 07:01:16] d2.utils.events INFO:  eta: 0:00:38  iter: 1399  total_loss: 0.07747  loss_cls: 0.03564  loss_box_reg: 0.02781  loss_rpn_cls: 0.003502  loss_rpn_loc: 0.01083  time: 0.1934  data_time: 0.0138  lr: 0.001  max_mem: 5085M
[11/22 07:01:20] d2.utils.events INFO:  eta: 0:00:34  iter: 1419  total_loss: 0.08893  loss_cls: 0.03525  loss_box_reg: 0.03045  loss_rpn_cls: 0.006205  loss_rpn_loc: 0.01594  time: 0.1934  data_time: 0.0126  lr: 0.001  max_mem: 5085M
[11/22 07:01:24] d2.utils.events INFO:  eta: 0:00:30  iter: 1439  total_loss: 0.08239  loss_cls: 0.03755  loss_box_reg: 0.03056  loss_rpn_cls: 0.003545  loss_rpn_loc: 0.009456  time: 0.1934  data_time: 0.0135  lr: 0.001  max_mem: 5085M
[11/22 07:01:28] d2.utils.events INFO:  eta: 0:00:26  iter: 1459  total_loss: 0.08255  loss_cls: 0.03502  loss_box_reg: 0.02812  loss_rpn_cls: 0.004026  loss_rpn_loc: 0.01172  time: 0.1933  data_time: 0.0139  lr: 0.001  max_mem: 5085M
[11/22 07:01:32] d2.utils.events INFO:  eta: 0:00:23  iter: 1479  total_loss: 0.08011  loss_cls: 0.03713  loss_box_reg: 0.02865  loss_rpn_cls: 0.003612  loss_rpn_loc: 0.009881  time: 0.1933  data_time: 0.0146  lr: 0.001  max_mem: 5085M
[11/22 07:01:35] d2.utils.events INFO:  eta: 0:00:19  iter: 1499  total_loss: 0.08106  loss_cls: 0.03814  loss_box_reg: 0.0283  loss_rpn_cls: 0.004005  loss_rpn_loc: 0.009849  time: 0.1933  data_time: 0.0141  lr: 0.001  max_mem: 5085M
[11/22 07:01:39] d2.utils.events INFO:  eta: 0:00:15  iter: 1519  total_loss: 0.07871  loss_cls: 0.03342  loss_box_reg: 0.02811  loss_rpn_cls: 0.002909  loss_rpn_loc: 0.00997  time: 0.1933  data_time: 0.0140  lr: 0.001  max_mem: 5085M
[11/22 07:01:43] d2.utils.events INFO:  eta: 0:00:11  iter: 1539  total_loss: 0.0786  loss_cls: 0.03747  loss_box_reg: 0.02996  loss_rpn_cls: 0.004209  loss_rpn_loc: 0.01071  time: 0.1933  data_time: 0.0125  lr: 0.001  max_mem: 5085M
[11/22 07:01:47] d2.utils.events INFO:  eta: 0:00:07  iter: 1559  total_loss: 0.08714  loss_cls: 0.04149  loss_box_reg: 0.03122  loss_rpn_cls: 0.003013  loss_rpn_loc: 0.0108  time: 0.1933  data_time: 0.0135  lr: 0.001  max_mem: 5085M
[11/22 07:01:51] d2.utils.events INFO:  eta: 0:00:03  iter: 1579  total_loss: 0.08301  loss_cls: 0.03513  loss_box_reg: 0.02874  loss_rpn_cls: 0.003661  loss_rpn_loc: 0.01177  time: 0.1932  data_time: 0.0129  lr: 0.001  max_mem: 5085M
[11/22 07:01:55] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final.pth
[11/22 07:01:56] d2.utils.events INFO:  eta: 0:00:00  iter: 1599  total_loss: 0.08644  loss_cls: 0.0361  loss_box_reg: 0.02926  loss_rpn_cls: 0.004381  loss_rpn_loc: 0.01238  time: 0.1932  data_time: 0.0146  lr: 0.001  max_mem: 5085M
[11/22 07:01:56] d2.engine.hooks INFO: Overall training speed: 1598 iterations in 0:05:08 (0.1932 s / it)
[11/22 07:01:56] d2.engine.hooks INFO: Total training time: 0:05:10 (0:00:01 on hooks)
[11/22 07:01:57] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    bird    | 576          |    bus     | 254          |    cow     | 329          |
| motorbike  | 369          |    sofa    | 396          |            |              |
|   total    | 1924         |            |              |            |              |[0m
[11/22 07:01:57] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 07:01:57] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 07:01:57] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 07:01:57] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 07:01:57] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 07:01:58] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 07:01:58] d2.data.common INFO: Serializing 15 elements to byte tensors and concatenating them all ...
[11/22 07:01:58] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 07:01:58] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 07:02:08] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0582 s / img. ETA=0:01:09
[11/22 07:02:11] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0568 s / img. ETA=0:01:04
[11/22 07:02:14] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0572 s / img. ETA=0:01:02
[11/22 07:02:17] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0573 s / img. ETA=0:00:59
[11/22 07:02:20] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0572 s / img. ETA=0:00:56
[11/22 07:02:23] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0574 s / img. ETA=0:00:53
[11/22 07:02:26] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0572 s / img. ETA=0:00:50
[11/22 07:02:28] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0571 s / img. ETA=0:00:47
[11/22 07:02:31] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0571 s / img. ETA=0:00:45
[11/22 07:02:34] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0572 s / img. ETA=0:00:42
[11/22 07:02:37] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0572 s / img. ETA=0:00:39
[11/22 07:02:40] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0573 s / img. ETA=0:00:36
[11/22 07:02:43] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0573 s / img. ETA=0:00:33
[11/22 07:02:46] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0573 s / img. ETA=0:00:30
[11/22 07:02:49] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0574 s / img. ETA=0:00:27
[11/22 07:02:51] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0573 s / img. ETA=0:00:25
[11/22 07:02:54] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0574 s / img. ETA=0:00:22
[11/22 07:02:57] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0573 s / img. ETA=0:00:19
[11/22 07:03:00] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0573 s / img. ETA=0:00:16
[11/22 07:03:03] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0573 s / img. ETA=0:00:13
[11/22 07:03:06] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0574 s / img. ETA=0:00:10
[11/22 07:03:09] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0574 s / img. ETA=0:00:07
[11/22 07:03:12] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0574 s / img. ETA=0:00:05
[11/22 07:03:14] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0574 s / img. ETA=0:00:02
[11/22 07:03:17] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:11 (0.057583 s / img per device, on 4 devices)
[11/22 07:03:17] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:08 (0.055623 s / img per device, on 4 devices)
[11/22 07:03:17] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 07:03:23] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:------:|:------:|:------:|:-----------:|:------:|
| 57.969 | 72.449 | 40.671 |   57.889    | 50.200 |
[11/22 07:03:23] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 32.060 | 55.836 | 33.221 | 32.060 | 55.836  | 33.221  |
[11/22 07:03:23] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel1 in csv format:
[11/22 07:03:23] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 07:03:23] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 07:03:23] defrcn.evaluation.testing INFO: copypaste: 32.0599,55.8356,33.2213,32.0599,55.8356,33.2213
[11/22 07:03:37] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 07:03:37] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5'], resume=False, start_iter=-1)
[11/22 07:03:37] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel1_3shot_seed5.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all1_3shot_seed5", )
  TEST: ("voc_2007_test_all1",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 07:03:37] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/config.yaml
[11/22 07:03:37] d2.utils.env INFO: Using a generated random seed 37907251
[11/22 07:03:37] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 07:03:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel1/tfa-like/3shot_seed5/model_final-merge.pth ...
[11/22 07:03:38] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 311          |   bicycle   | 389          |    boat     | 393          |
|   bottle   | 657          |     car     | 1541         |     cat     | 370          |
|   chair    | 1374         | diningtable | 299          |     dog     | 530          |
|   horse    | 395          |   person    | 5227         | pottedplant | 592          |
|   sheep    | 311          |    train    | 302          |  tvmonitor  | 361          |
|    bird    | 576          |     bus     | 254          |     cow     | 329          |
| motorbike  | 369          |    sofa     | 396          |             |              |
|   total    | 14976        |             |              |             |              |[0m
[11/22 07:03:38] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 07:03:38] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 07:03:38] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 07:03:38] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 07:03:38] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 07:03:41] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category  | #instances   |  category   | #instances   |  category   | #instances   |
|:----------:|:-------------|:-----------:|:-------------|:-----------:|:-------------|
| aeroplane  | 3            |   bicycle   | 3            |    boat     | 3            |
|   bottle   | 3            |     car     | 3            |     cat     | 3            |
|   chair    | 3            | diningtable | 3            |     dog     | 3            |
|   horse    | 3            |   person    | 3            | pottedplant | 3            |
|   sheep    | 3            |    train    | 3            |  tvmonitor  | 3            |
|    bird    | 3            |     bus     | 3            |     cow     | 3            |
| motorbike  | 3            |    sofa     | 3            |             |              |
|   total    | 60           |             |              |             |              |[0m
[11/22 07:03:41] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 07:03:41] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/22 07:03:41] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/22 07:03:43] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 07:03:54] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0586 s / img. ETA=0:01:09
[11/22 07:03:57] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0577 s / img. ETA=0:01:05
[11/22 07:04:00] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0577 s / img. ETA=0:01:02
[11/22 07:04:02] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0576 s / img. ETA=0:00:59
[11/22 07:04:05] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0575 s / img. ETA=0:00:56
[11/22 07:04:08] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0576 s / img. ETA=0:00:54
[11/22 07:04:11] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0574 s / img. ETA=0:00:50
[11/22 07:04:14] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0572 s / img. ETA=0:00:47
[11/22 07:04:17] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0572 s / img. ETA=0:00:45
[11/22 07:04:19] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0571 s / img. ETA=0:00:42
[11/22 07:04:22] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0569 s / img. ETA=0:00:39
[11/22 07:04:25] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0569 s / img. ETA=0:00:36
[11/22 07:04:28] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0568 s / img. ETA=0:00:33
[11/22 07:04:31] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0567 s / img. ETA=0:00:30
[11/22 07:04:33] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0567 s / img. ETA=0:00:27
[11/22 07:04:36] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0566 s / img. ETA=0:00:24
[11/22 07:04:39] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0566 s / img. ETA=0:00:21
[11/22 07:04:42] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0565 s / img. ETA=0:00:19
[11/22 07:04:45] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0565 s / img. ETA=0:00:16
[11/22 07:04:47] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0566 s / img. ETA=0:00:13
[11/22 07:04:50] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0565 s / img. ETA=0:00:10
[11/22 07:04:53] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0565 s / img. ETA=0:00:07
[11/22 07:04:56] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0565 s / img. ETA=0:00:04
[11/22 07:04:59] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0564 s / img. ETA=0:00:02
[11/22 07:05:01] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:09 (0.055961 s / img per device, on 4 devices)
[11/22 07:05:01] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:06 (0.054294 s / img per device, on 4 devices)
[11/22 07:05:03] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all1 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 07:05:26] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  boat  |  bottle  |  car   |  cat   |  chair  |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  sheep  |  train  |  tvmonitor  |  bird  |  bus   |  cow   |  motorbike  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-------:|:-----------:|:------:|:------:|:------:|:-----------:|:------:|
|   84.082    |  86.170   | 71.578 |  73.376  | 88.575 | 88.517 | 68.274  |    74.580     | 87.008 | 83.848  |  86.115  |    55.097     | 81.269  | 85.825  |   81.676    | 62.531 | 73.067 | 55.750 |   60.094    | 48.665 |
[11/22 07:05:26] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 48.465 | 74.805 | 52.657 | 53.700 | 79.733  | 59.744  | 32.761 | 60.021  | 31.393  |
[11/22 07:05:26] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all1 in csv format:
[11/22 07:05:26] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 07:05:26] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 07:05:26] defrcn.evaluation.testing INFO: copypaste: 48.4650,74.8047,52.6566,53.6998,79.7325,59.7444,32.7607,60.0211,31.3929
