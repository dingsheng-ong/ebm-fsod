[11/18 16:24:19] detectron2 INFO: Rank of current process: 0. World size: 4
[11/18 16:24:19] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/18 16:24:19] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel3_2shot_seed3", )
  TEST: ("voc_2007_test_novel3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/18 16:24:20] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/18 16:24:20] d2.utils.env INFO: Using a generated random seed 21710020
[11/18 16:24:20] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/18 16:24:20] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/18 16:24:20] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 2            |    cat     | 2            | motorbike  | 2            |
|   sheep    | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/18 16:24:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/18 16:24:20] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/18 16:24:20] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/18 16:24:20] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/18 16:24:21] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth ...
[11/18 16:24:21] d2.engine.train_loop INFO: Starting training from iteration 0
[11/18 16:24:34] d2.utils.events INFO:  eta: 0:10:17  iter: 19  total_loss: 0.6097  loss_cls: 0.3205  loss_box_reg: 0.1691  loss_rpn_cls: 0.04198  loss_rpn_loc: 0.05271  time: 0.5274  data_time: 0.1116  lr: 0.01  max_mem: 5123M
[11/18 16:24:44] d2.utils.events INFO:  eta: 0:10:05  iter: 39  total_loss: 0.3802  loss_cls: 0.1696  loss_box_reg: 0.1431  loss_rpn_cls: 0.02583  loss_rpn_loc: 0.04542  time: 0.5243  data_time: 0.0144  lr: 0.01  max_mem: 5123M
[11/18 16:24:54] d2.utils.events INFO:  eta: 0:09:53  iter: 59  total_loss: 0.294  loss_cls: 0.1119  loss_box_reg: 0.1261  loss_rpn_cls: 0.01848  loss_rpn_loc: 0.03816  time: 0.5237  data_time: 0.0123  lr: 0.01  max_mem: 5123M
[11/18 16:25:05] d2.utils.events INFO:  eta: 0:09:43  iter: 79  total_loss: 0.2375  loss_cls: 0.08378  loss_box_reg: 0.1063  loss_rpn_cls: 0.01317  loss_rpn_loc: 0.03363  time: 0.5209  data_time: 0.0147  lr: 0.01  max_mem: 5123M
[11/18 16:25:15] d2.utils.events INFO:  eta: 0:09:33  iter: 99  total_loss: 0.2062  loss_cls: 0.07417  loss_box_reg: 0.09222  loss_rpn_cls: 0.01049  loss_rpn_loc: 0.03073  time: 0.5217  data_time: 0.0139  lr: 0.01  max_mem: 5219M
[11/18 16:25:26] d2.utils.events INFO:  eta: 0:09:22  iter: 119  total_loss: 0.1777  loss_cls: 0.06228  loss_box_reg: 0.07199  loss_rpn_cls: 0.01033  loss_rpn_loc: 0.02666  time: 0.5215  data_time: 0.0143  lr: 0.01  max_mem: 5220M
[11/18 16:25:36] d2.utils.events INFO:  eta: 0:09:11  iter: 139  total_loss: 0.1624  loss_cls: 0.06075  loss_box_reg: 0.06435  loss_rpn_cls: 0.009959  loss_rpn_loc: 0.02684  time: 0.5212  data_time: 0.0142  lr: 0.01  max_mem: 5220M
[11/18 16:25:46] d2.utils.events INFO:  eta: 0:09:01  iter: 159  total_loss: 0.1452  loss_cls: 0.05668  loss_box_reg: 0.05474  loss_rpn_cls: 0.007958  loss_rpn_loc: 0.02469  time: 0.5202  data_time: 0.0118  lr: 0.01  max_mem: 5220M
[11/18 16:25:57] d2.utils.events INFO:  eta: 0:08:50  iter: 179  total_loss: 0.1352  loss_cls: 0.05403  loss_box_reg: 0.05127  loss_rpn_cls: 0.00675  loss_rpn_loc: 0.02005  time: 0.5200  data_time: 0.0138  lr: 0.01  max_mem: 5220M
[11/18 16:26:07] d2.utils.events INFO:  eta: 0:08:40  iter: 199  total_loss: 0.1335  loss_cls: 0.05284  loss_box_reg: 0.04948  loss_rpn_cls: 0.007087  loss_rpn_loc: 0.02729  time: 0.5202  data_time: 0.0122  lr: 0.01  max_mem: 5220M
[11/18 16:26:17] d2.utils.events INFO:  eta: 0:08:28  iter: 219  total_loss: 0.1294  loss_cls: 0.05172  loss_box_reg: 0.04765  loss_rpn_cls: 0.006599  loss_rpn_loc: 0.02195  time: 0.5198  data_time: 0.0153  lr: 0.01  max_mem: 5220M
[11/18 16:26:28] d2.utils.events INFO:  eta: 0:08:17  iter: 239  total_loss: 0.1219  loss_cls: 0.0465  loss_box_reg: 0.04356  loss_rpn_cls: 0.005431  loss_rpn_loc: 0.02182  time: 0.5190  data_time: 0.0134  lr: 0.01  max_mem: 5220M
[11/18 16:26:38] d2.utils.events INFO:  eta: 0:08:07  iter: 259  total_loss: 0.1158  loss_cls: 0.04801  loss_box_reg: 0.04254  loss_rpn_cls: 0.00515  loss_rpn_loc: 0.01782  time: 0.5190  data_time: 0.0131  lr: 0.01  max_mem: 5220M
[11/18 16:26:48] d2.utils.events INFO:  eta: 0:07:57  iter: 279  total_loss: 0.1135  loss_cls: 0.04587  loss_box_reg: 0.041  loss_rpn_cls: 0.005413  loss_rpn_loc: 0.02003  time: 0.5189  data_time: 0.0131  lr: 0.01  max_mem: 5220M
[11/18 16:26:59] d2.utils.events INFO:  eta: 0:07:46  iter: 299  total_loss: 0.1083  loss_cls: 0.04304  loss_box_reg: 0.03907  loss_rpn_cls: 0.005203  loss_rpn_loc: 0.02083  time: 0.5185  data_time: 0.0127  lr: 0.01  max_mem: 5220M
[11/18 16:27:09] d2.utils.events INFO:  eta: 0:07:35  iter: 319  total_loss: 0.1031  loss_cls: 0.04539  loss_box_reg: 0.03727  loss_rpn_cls: 0.004774  loss_rpn_loc: 0.01831  time: 0.5182  data_time: 0.0130  lr: 0.01  max_mem: 5221M
[11/18 16:27:19] d2.utils.events INFO:  eta: 0:07:25  iter: 339  total_loss: 0.1039  loss_cls: 0.04209  loss_box_reg: 0.03697  loss_rpn_cls: 0.003991  loss_rpn_loc: 0.01825  time: 0.5181  data_time: 0.0143  lr: 0.01  max_mem: 5221M
[11/18 16:27:30] d2.utils.events INFO:  eta: 0:07:14  iter: 359  total_loss: 0.1036  loss_cls: 0.04251  loss_box_reg: 0.03685  loss_rpn_cls: 0.003843  loss_rpn_loc: 0.0182  time: 0.5182  data_time: 0.0149  lr: 0.01  max_mem: 5221M
[11/18 16:27:40] d2.utils.events INFO:  eta: 0:07:04  iter: 379  total_loss: 0.1059  loss_cls: 0.03912  loss_box_reg: 0.03507  loss_rpn_cls: 0.005014  loss_rpn_loc: 0.02455  time: 0.5184  data_time: 0.0128  lr: 0.01  max_mem: 5221M
[11/18 16:27:51] d2.utils.events INFO:  eta: 0:06:53  iter: 399  total_loss: 0.1024  loss_cls: 0.04104  loss_box_reg: 0.03549  loss_rpn_cls: 0.004565  loss_rpn_loc: 0.01982  time: 0.5185  data_time: 0.0159  lr: 0.01  max_mem: 5221M
[11/18 16:28:01] d2.utils.events INFO:  eta: 0:06:43  iter: 419  total_loss: 0.09435  loss_cls: 0.03959  loss_box_reg: 0.03347  loss_rpn_cls: 0.004015  loss_rpn_loc: 0.0157  time: 0.5183  data_time: 0.0129  lr: 0.01  max_mem: 5221M
[11/18 16:28:11] d2.utils.events INFO:  eta: 0:06:33  iter: 439  total_loss: 0.09298  loss_cls: 0.03919  loss_box_reg: 0.03237  loss_rpn_cls: 0.003667  loss_rpn_loc: 0.01558  time: 0.5186  data_time: 0.0130  lr: 0.01  max_mem: 5221M
[11/18 16:28:22] d2.utils.events INFO:  eta: 0:06:22  iter: 459  total_loss: 0.09063  loss_cls: 0.03794  loss_box_reg: 0.03278  loss_rpn_cls: 0.003326  loss_rpn_loc: 0.01638  time: 0.5190  data_time: 0.0126  lr: 0.01  max_mem: 5221M
[11/18 16:28:32] d2.utils.events INFO:  eta: 0:06:12  iter: 479  total_loss: 0.09361  loss_cls: 0.03865  loss_box_reg: 0.03182  loss_rpn_cls: 0.003643  loss_rpn_loc: 0.01824  time: 0.5190  data_time: 0.0125  lr: 0.01  max_mem: 5221M
[11/18 16:28:43] d2.utils.events INFO:  eta: 0:06:02  iter: 499  total_loss: 0.09456  loss_cls: 0.03623  loss_box_reg: 0.03071  loss_rpn_cls: 0.003385  loss_rpn_loc: 0.01978  time: 0.5190  data_time: 0.0135  lr: 0.01  max_mem: 5221M
[11/18 16:28:53] d2.utils.events INFO:  eta: 0:05:51  iter: 519  total_loss: 0.088  loss_cls: 0.0379  loss_box_reg: 0.03142  loss_rpn_cls: 0.004186  loss_rpn_loc: 0.01629  time: 0.5191  data_time: 0.0136  lr: 0.01  max_mem: 5221M
[11/18 16:29:04] d2.utils.events INFO:  eta: 0:05:41  iter: 539  total_loss: 0.09407  loss_cls: 0.03729  loss_box_reg: 0.02936  loss_rpn_cls: 0.003222  loss_rpn_loc: 0.01777  time: 0.5190  data_time: 0.0125  lr: 0.01  max_mem: 5221M
[11/18 16:29:14] d2.utils.events INFO:  eta: 0:05:31  iter: 559  total_loss: 0.0887  loss_cls: 0.03641  loss_box_reg: 0.03033  loss_rpn_cls: 0.003493  loss_rpn_loc: 0.01914  time: 0.5188  data_time: 0.0135  lr: 0.01  max_mem: 5221M
[11/18 16:29:24] d2.utils.events INFO:  eta: 0:05:20  iter: 579  total_loss: 0.08992  loss_cls: 0.0361  loss_box_reg: 0.0296  loss_rpn_cls: 0.003649  loss_rpn_loc: 0.01932  time: 0.5191  data_time: 0.0141  lr: 0.01  max_mem: 5221M
[11/18 16:29:35] d2.utils.events INFO:  eta: 0:05:10  iter: 599  total_loss: 0.08449  loss_cls: 0.03726  loss_box_reg: 0.02954  loss_rpn_cls: 0.003479  loss_rpn_loc: 0.01684  time: 0.5190  data_time: 0.0137  lr: 0.01  max_mem: 5221M
[11/18 16:29:45] d2.utils.events INFO:  eta: 0:05:00  iter: 619  total_loss: 0.08394  loss_cls: 0.03525  loss_box_reg: 0.02914  loss_rpn_cls: 0.003457  loss_rpn_loc: 0.01654  time: 0.5191  data_time: 0.0142  lr: 0.01  max_mem: 5221M
[11/18 16:29:55] d2.utils.events INFO:  eta: 0:04:49  iter: 639  total_loss: 0.08278  loss_cls: 0.03492  loss_box_reg: 0.02824  loss_rpn_cls: 0.003417  loss_rpn_loc: 0.01567  time: 0.5190  data_time: 0.0140  lr: 0.01  max_mem: 5221M
[11/18 16:30:06] d2.utils.events INFO:  eta: 0:04:39  iter: 659  total_loss: 0.07905  loss_cls: 0.03424  loss_box_reg: 0.02861  loss_rpn_cls: 0.003239  loss_rpn_loc: 0.01543  time: 0.5189  data_time: 0.0126  lr: 0.01  max_mem: 5221M
[11/18 16:30:16] d2.utils.events INFO:  eta: 0:04:28  iter: 679  total_loss: 0.0823  loss_cls: 0.03398  loss_box_reg: 0.02775  loss_rpn_cls: 0.003451  loss_rpn_loc: 0.01634  time: 0.5188  data_time: 0.0136  lr: 0.01  max_mem: 5221M
[11/18 16:30:27] d2.utils.events INFO:  eta: 0:04:18  iter: 699  total_loss: 0.08115  loss_cls: 0.03429  loss_box_reg: 0.02882  loss_rpn_cls: 0.002683  loss_rpn_loc: 0.01366  time: 0.5190  data_time: 0.0116  lr: 0.01  max_mem: 5221M
[11/18 16:30:37] d2.utils.events INFO:  eta: 0:04:08  iter: 719  total_loss: 0.08028  loss_cls: 0.03566  loss_box_reg: 0.02714  loss_rpn_cls: 0.00295  loss_rpn_loc: 0.01542  time: 0.5191  data_time: 0.0131  lr: 0.01  max_mem: 5221M
[11/18 16:30:47] d2.utils.events INFO:  eta: 0:03:57  iter: 739  total_loss: 0.08038  loss_cls: 0.0347  loss_box_reg: 0.02693  loss_rpn_cls: 0.003413  loss_rpn_loc: 0.01532  time: 0.5190  data_time: 0.0128  lr: 0.01  max_mem: 5221M
[11/18 16:30:58] d2.utils.events INFO:  eta: 0:03:47  iter: 759  total_loss: 0.07788  loss_cls: 0.03409  loss_box_reg: 0.0267  loss_rpn_cls: 0.002734  loss_rpn_loc: 0.01354  time: 0.5189  data_time: 0.0126  lr: 0.01  max_mem: 5221M
[11/18 16:31:08] d2.utils.events INFO:  eta: 0:03:37  iter: 779  total_loss: 0.08015  loss_cls: 0.03246  loss_box_reg: 0.02661  loss_rpn_cls: 0.003086  loss_rpn_loc: 0.01705  time: 0.5188  data_time: 0.0115  lr: 0.01  max_mem: 5221M
[11/18 16:31:18] d2.utils.events INFO:  eta: 0:03:26  iter: 799  total_loss: 0.07892  loss_cls: 0.03372  loss_box_reg: 0.02666  loss_rpn_cls: 0.002801  loss_rpn_loc: 0.01294  time: 0.5187  data_time: 0.0107  lr: 0.01  max_mem: 5221M
[11/18 16:31:29] d2.utils.events INFO:  eta: 0:03:16  iter: 819  total_loss: 0.07439  loss_cls: 0.03372  loss_box_reg: 0.02543  loss_rpn_cls: 0.002642  loss_rpn_loc: 0.01233  time: 0.5189  data_time: 0.0115  lr: 0.01  max_mem: 5221M
[11/18 16:31:39] d2.utils.events INFO:  eta: 0:03:06  iter: 839  total_loss: 0.07608  loss_cls: 0.03259  loss_box_reg: 0.02562  loss_rpn_cls: 0.002488  loss_rpn_loc: 0.01294  time: 0.5188  data_time: 0.0132  lr: 0.01  max_mem: 5221M
[11/18 16:31:50] d2.utils.events INFO:  eta: 0:02:55  iter: 859  total_loss: 0.07571  loss_cls: 0.03272  loss_box_reg: 0.0255  loss_rpn_cls: 0.00286  loss_rpn_loc: 0.01378  time: 0.5189  data_time: 0.0138  lr: 0.01  max_mem: 5221M
[11/18 16:32:00] d2.utils.events INFO:  eta: 0:02:45  iter: 879  total_loss: 0.07663  loss_cls: 0.03322  loss_box_reg: 0.02556  loss_rpn_cls: 0.002699  loss_rpn_loc: 0.01389  time: 0.5187  data_time: 0.0120  lr: 0.01  max_mem: 5221M
[11/18 16:32:10] d2.utils.events INFO:  eta: 0:02:35  iter: 899  total_loss: 0.07363  loss_cls: 0.03153  loss_box_reg: 0.02468  loss_rpn_cls: 0.002412  loss_rpn_loc: 0.01381  time: 0.5185  data_time: 0.0117  lr: 0.01  max_mem: 5221M
[11/18 16:32:20] d2.utils.events INFO:  eta: 0:02:24  iter: 919  total_loss: 0.07358  loss_cls: 0.03191  loss_box_reg: 0.0249  loss_rpn_cls: 0.002509  loss_rpn_loc: 0.01403  time: 0.5185  data_time: 0.0130  lr: 0.01  max_mem: 5221M
[11/18 16:32:31] d2.utils.events INFO:  eta: 0:02:14  iter: 939  total_loss: 0.07217  loss_cls: 0.0317  loss_box_reg: 0.0259  loss_rpn_cls: 0.0025  loss_rpn_loc: 0.01318  time: 0.5183  data_time: 0.0123  lr: 0.01  max_mem: 5221M
[11/18 16:32:41] d2.utils.events INFO:  eta: 0:02:04  iter: 959  total_loss: 0.07781  loss_cls: 0.03158  loss_box_reg: 0.02481  loss_rpn_cls: 0.002984  loss_rpn_loc: 0.01696  time: 0.5184  data_time: 0.0111  lr: 0.01  max_mem: 5221M
[11/18 16:32:52] d2.utils.events INFO:  eta: 0:01:53  iter: 979  total_loss: 0.07092  loss_cls: 0.03141  loss_box_reg: 0.02441  loss_rpn_cls: 0.002826  loss_rpn_loc: 0.01169  time: 0.5185  data_time: 0.0135  lr: 0.001  max_mem: 5221M
[11/18 16:33:02] d2.utils.events INFO:  eta: 0:01:43  iter: 999  total_loss: 0.06741  loss_cls: 0.0313  loss_box_reg: 0.023  loss_rpn_cls: 0.002713  loss_rpn_loc: 0.007879  time: 0.5186  data_time: 0.0115  lr: 0.001  max_mem: 5221M
[11/18 16:33:12] d2.utils.events INFO:  eta: 0:01:33  iter: 1019  total_loss: 0.06685  loss_cls: 0.0313  loss_box_reg: 0.02467  loss_rpn_cls: 0.002814  loss_rpn_loc: 0.007686  time: 0.5186  data_time: 0.0122  lr: 0.001  max_mem: 5221M
[11/18 16:33:23] d2.utils.events INFO:  eta: 0:01:22  iter: 1039  total_loss: 0.06694  loss_cls: 0.03312  loss_box_reg: 0.02379  loss_rpn_cls: 0.002453  loss_rpn_loc: 0.007723  time: 0.5187  data_time: 0.0116  lr: 0.001  max_mem: 5221M
[11/18 16:33:33] d2.utils.events INFO:  eta: 0:01:12  iter: 1059  total_loss: 0.06763  loss_cls: 0.03192  loss_box_reg: 0.02451  loss_rpn_cls: 0.002484  loss_rpn_loc: 0.007292  time: 0.5187  data_time: 0.0120  lr: 0.001  max_mem: 5221M
[11/18 16:33:44] d2.utils.events INFO:  eta: 0:01:02  iter: 1079  total_loss: 0.06669  loss_cls: 0.03136  loss_box_reg: 0.02323  loss_rpn_cls: 0.002586  loss_rpn_loc: 0.008423  time: 0.5189  data_time: 0.0127  lr: 0.001  max_mem: 5221M
[11/18 16:33:54] d2.utils.events INFO:  eta: 0:00:51  iter: 1099  total_loss: 0.06663  loss_cls: 0.03047  loss_box_reg: 0.02412  loss_rpn_cls: 0.002791  loss_rpn_loc: 0.006486  time: 0.5189  data_time: 0.0140  lr: 0.001  max_mem: 5221M
[11/18 16:34:05] d2.utils.events INFO:  eta: 0:00:41  iter: 1119  total_loss: 0.0656  loss_cls: 0.03116  loss_box_reg: 0.02341  loss_rpn_cls: 0.002554  loss_rpn_loc: 0.00727  time: 0.5190  data_time: 0.0141  lr: 0.001  max_mem: 5221M
[11/18 16:34:15] d2.utils.events INFO:  eta: 0:00:31  iter: 1139  total_loss: 0.06628  loss_cls: 0.03293  loss_box_reg: 0.02335  loss_rpn_cls: 0.002303  loss_rpn_loc: 0.007388  time: 0.5191  data_time: 0.0137  lr: 0.001  max_mem: 5221M
[11/18 16:34:26] d2.utils.events INFO:  eta: 0:00:20  iter: 1159  total_loss: 0.06584  loss_cls: 0.03129  loss_box_reg: 0.02305  loss_rpn_cls: 0.002295  loss_rpn_loc: 0.006499  time: 0.5192  data_time: 0.0130  lr: 0.001  max_mem: 5221M
[11/18 16:34:36] d2.utils.events INFO:  eta: 0:00:10  iter: 1179  total_loss: 0.06472  loss_cls: 0.03118  loss_box_reg: 0.02323  loss_rpn_cls: 0.002179  loss_rpn_loc: 0.00685  time: 0.5193  data_time: 0.0137  lr: 0.001  max_mem: 5221M
[11/18 16:34:47] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final.pth
[11/18 16:34:48] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.06608  loss_cls: 0.03178  loss_box_reg: 0.02319  loss_rpn_cls: 0.002197  loss_rpn_loc: 0.007496  time: 0.5194  data_time: 0.0126  lr: 0.001  max_mem: 5221M
[11/18 16:34:48] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:10:22 (0.5194 s / it)
[11/18 16:34:48] d2.engine.hooks INFO: Total training time: 0:10:23 (0:00:01 on hooks)
[11/18 16:34:48] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 393          |    cat     | 370          | motorbike  | 369          |
|   sheep    | 311          |    sofa    | 396          |            |              |
|   total    | 1839         |            |              |            |              |[0m
[11/18 16:34:48] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 16:34:48] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/18 16:34:48] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/18 16:34:48] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/18 16:34:48] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/18 16:34:49] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 16:34:49] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/18 16:34:49] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/18 16:34:50] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/18 16:35:02] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.1200 s / img. ETA=0:02:22
[11/18 16:35:08] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.1183 s / img. ETA=0:02:14
[11/18 16:35:14] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.1189 s / img. ETA=0:02:09
[11/18 16:35:19] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.1185 s / img. ETA=0:02:03
[11/18 16:35:25] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.1182 s / img. ETA=0:01:56
[11/18 16:35:31] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.1178 s / img. ETA=0:01:50
[11/18 16:35:37] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.1176 s / img. ETA=0:01:44
[11/18 16:35:43] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.1172 s / img. ETA=0:01:38
[11/18 16:35:48] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.1173 s / img. ETA=0:01:32
[11/18 16:35:54] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.1171 s / img. ETA=0:01:26
[11/18 16:36:00] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.1171 s / img. ETA=0:01:20
[11/18 16:36:06] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.1172 s / img. ETA=0:01:14
[11/18 16:36:12] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.1170 s / img. ETA=0:01:08
[11/18 16:36:17] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.1168 s / img. ETA=0:01:02
[11/18 16:36:23] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.1169 s / img. ETA=0:00:57
[11/18 16:36:29] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.1168 s / img. ETA=0:00:51
[11/18 16:36:35] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.1168 s / img. ETA=0:00:45
[11/18 16:36:41] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.1168 s / img. ETA=0:00:39
[11/18 16:36:47] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.1167 s / img. ETA=0:00:33
[11/18 16:36:52] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.1167 s / img. ETA=0:00:27
[11/18 16:36:58] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.1166 s / img. ETA=0:00:21
[11/18 16:37:04] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.1166 s / img. ETA=0:00:16
[11/18 16:37:10] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.1166 s / img. ETA=0:00:10
[11/18 16:37:15] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.1165 s / img. ETA=0:00:04
[11/18 16:37:20] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:23 (0.115977 s / img per device, on 4 devices)
[11/18 16:37:20] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:21 (0.114771 s / img per device, on 4 devices)
[11/18 16:37:20] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel3 using 2007 metric. Note that results do not use the official Matlab API.
[11/18 16:37:26] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:------:|:------:|:-----------:|:-------:|:------:|
| 33.547 | 69.556 |   71.603    | 54.819  | 43.983 |
[11/18 16:37:26] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 28.555 | 54.702 | 26.255 | 28.555 | 54.702  | 26.255  |
[11/18 16:37:26] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel3 in csv format:
[11/18 16:37:26] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/18 16:37:26] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/18 16:37:26] defrcn.evaluation.testing INFO: copypaste: 28.5549,54.7016,26.2553,28.5549,54.7016,26.2553
[11/18 16:37:37] detectron2 INFO: Rank of current process: 0. World size: 4
[11/18 16:37:37] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3', 'SEED', '21710020'], resume=False, start_iter=-1)
[11/18 16:37:37] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all3_2shot_seed3", )
  TEST: ("voc_2007_test_all3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/18 16:37:37] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/18 16:37:37] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/18 16:37:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth ...
[11/18 16:37:38] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 311          |  bicycle   | 389          |    bird     | 576          |
|   bottle    | 657          |    bus     | 254          |     car     | 1541         |
|    chair    | 1374         |    cow     | 329          | diningtable | 299          |
|     dog     | 530          |   horse    | 395          |   person    | 5227         |
| pottedplant | 592          |   train    | 302          |  tvmonitor  | 361          |
|    boat     | 393          |    cat     | 370          |  motorbike  | 369          |
|    sheep    | 311          |    sofa    | 396          |             |              |
|    total    | 14976        |            |              |             |              |[0m
[11/18 16:37:38] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 16:37:38] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/18 16:37:38] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/18 16:37:38] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/18 16:37:38] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/18 16:37:40] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 2            |  bicycle   | 2            |    bird     | 2            |
|   bottle    | 2            |    bus     | 2            |     car     | 2            |
|    chair    | 2            |    cow     | 2            | diningtable | 2            |
|     dog     | 2            |   horse    | 2            |   person    | 2            |
| pottedplant | 2            |   train    | 2            |  tvmonitor  | 2            |
|    boat     | 2            |    cat     | 2            |  motorbike  | 2            |
|    sheep    | 2            |    sofa    | 2            |             |              |
|    total    | 40           |            |              |             |              |[0m
[11/18 16:37:40] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/18 16:37:40] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/18 16:37:40] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/18 16:37:43] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/18 16:37:54] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.1205 s / img. ETA=0:02:23
[11/18 16:38:00] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.1189 s / img. ETA=0:02:15
[11/18 16:38:06] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.1192 s / img. ETA=0:02:09
[11/18 16:38:12] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.1189 s / img. ETA=0:02:03
[11/18 16:38:17] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.1187 s / img. ETA=0:01:57
[11/18 16:38:23] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.1187 s / img. ETA=0:01:51
[11/18 16:38:29] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.1183 s / img. ETA=0:01:45
[11/18 16:38:35] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.1179 s / img. ETA=0:01:38
[11/18 16:38:41] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.1179 s / img. ETA=0:01:32
[11/18 16:38:47] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.1177 s / img. ETA=0:01:26
[11/18 16:38:53] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.1177 s / img. ETA=0:01:20
[11/18 16:38:58] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.1177 s / img. ETA=0:01:15
[11/18 16:39:04] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.1176 s / img. ETA=0:01:09
[11/18 16:39:10] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.1174 s / img. ETA=0:01:03
[11/18 16:39:16] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.1175 s / img. ETA=0:00:57
[11/18 16:39:22] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.1173 s / img. ETA=0:00:51
[11/18 16:39:28] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.1173 s / img. ETA=0:00:45
[11/18 16:39:33] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.1174 s / img. ETA=0:00:39
[11/18 16:39:39] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.1173 s / img. ETA=0:00:33
[11/18 16:39:45] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.1172 s / img. ETA=0:00:27
[11/18 16:39:51] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.1171 s / img. ETA=0:00:22
[11/18 16:39:57] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.1171 s / img. ETA=0:00:16
[11/18 16:40:02] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.1171 s / img. ETA=0:00:10
[11/18 16:40:08] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.1170 s / img. ETA=0:00:04
[11/18 16:40:13] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:24 (0.116788 s / img per device, on 4 devices)
[11/18 16:40:13] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:21 (0.114736 s / img per device, on 4 devices)
[11/18 16:40:13] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all3 using 2007 metric. Note that results do not use the official Matlab API.
[11/18 16:40:35] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  bird  |  bottle  |  bus   |  car   |  chair  |  cow   |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  train  |  tvmonitor  |  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-----------:|:------:|:------:|:-----------:|:-------:|:------:|
|   84.256    |  85.963   | 83.446 |  73.841  | 86.296 | 88.573 | 68.746  | 82.569 |    73.299     | 83.925 | 88.392  |  86.244  |    55.128     | 84.855  |   81.938    | 30.799 | 72.725 |   72.338    | 68.196  | 48.348 |
[11/18 16:40:35] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.117 | 74.994 | 49.327 | 52.865 | 80.498  | 56.993  | 29.872 | 58.481  | 26.329  |
[11/18 16:40:35] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all3 in csv format:
[11/18 16:40:35] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/18 16:40:35] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/18 16:40:35] defrcn.evaluation.testing INFO: copypaste: 47.1166,74.9940,49.3269,52.8646,80.4982,56.9929,29.8724,58.4814,26.3289
[11/22 05:11:36] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:11:36] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 05:11:36] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel3_2shot_seed3", )
  TEST: ("voc_2007_test_novel3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:11:36] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:11:36] d2.utils.env INFO: Using a generated random seed 39786510
[11/22 05:11:37] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:11:37] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 05:11:37] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 2            |    cat     | 2            | motorbike  | 2            |
|   sheep    | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 05:11:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 05:11:37] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 05:11:37] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:11:37] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:11:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth ...
[11/22 05:11:37] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 05:11:46] d2.utils.events INFO:  eta: 0:04:28  iter: 19  total_loss: 0.5777  loss_cls: 0.3275  loss_box_reg: 0.163  loss_rpn_cls: 0.04065  loss_rpn_loc: 0.0521  time: 0.2273  data_time: 0.1994  lr: 0.01  max_mem: 5177M
[11/22 05:11:50] d2.utils.events INFO:  eta: 0:04:21  iter: 39  total_loss: 0.3982  loss_cls: 0.1791  loss_box_reg: 0.1441  loss_rpn_cls: 0.02501  loss_rpn_loc: 0.04031  time: 0.2251  data_time: 0.0214  lr: 0.01  max_mem: 5177M
[11/22 05:11:55] d2.utils.events INFO:  eta: 0:04:15  iter: 59  total_loss: 0.2902  loss_cls: 0.1059  loss_box_reg: 0.1265  loss_rpn_cls: 0.01756  loss_rpn_loc: 0.03714  time: 0.2238  data_time: 0.0245  lr: 0.01  max_mem: 5177M
[11/22 05:11:59] d2.utils.events INFO:  eta: 0:04:11  iter: 79  total_loss: 0.2409  loss_cls: 0.08409  loss_box_reg: 0.1043  loss_rpn_cls: 0.01452  loss_rpn_loc: 0.03582  time: 0.2232  data_time: 0.0213  lr: 0.01  max_mem: 5177M
[11/22 05:12:03] d2.utils.events INFO:  eta: 0:04:06  iter: 99  total_loss: 0.2061  loss_cls: 0.07214  loss_box_reg: 0.089  loss_rpn_cls: 0.01099  loss_rpn_loc: 0.03132  time: 0.2231  data_time: 0.0216  lr: 0.01  max_mem: 5177M
[11/22 05:12:08] d2.utils.events INFO:  eta: 0:04:01  iter: 119  total_loss: 0.1726  loss_cls: 0.06275  loss_box_reg: 0.07134  loss_rpn_cls: 0.009514  loss_rpn_loc: 0.02987  time: 0.2224  data_time: 0.0216  lr: 0.01  max_mem: 5177M
[11/22 05:12:12] d2.utils.events INFO:  eta: 0:03:56  iter: 139  total_loss: 0.1574  loss_cls: 0.05968  loss_box_reg: 0.06034  loss_rpn_cls: 0.009163  loss_rpn_loc: 0.02485  time: 0.2224  data_time: 0.0211  lr: 0.01  max_mem: 5177M
[11/22 05:12:17] d2.utils.events INFO:  eta: 0:03:52  iter: 159  total_loss: 0.1441  loss_cls: 0.05682  loss_box_reg: 0.05621  loss_rpn_cls: 0.007601  loss_rpn_loc: 0.02611  time: 0.2227  data_time: 0.0229  lr: 0.01  max_mem: 5177M
[11/22 05:12:21] d2.utils.events INFO:  eta: 0:03:47  iter: 179  total_loss: 0.1439  loss_cls: 0.05565  loss_box_reg: 0.05325  loss_rpn_cls: 0.007788  loss_rpn_loc: 0.02654  time: 0.2225  data_time: 0.0220  lr: 0.01  max_mem: 5177M
[11/22 05:12:26] d2.utils.events INFO:  eta: 0:03:42  iter: 199  total_loss: 0.1335  loss_cls: 0.05066  loss_box_reg: 0.04831  loss_rpn_cls: 0.007539  loss_rpn_loc: 0.02678  time: 0.2224  data_time: 0.0224  lr: 0.01  max_mem: 5177M
[11/22 05:12:30] d2.utils.events INFO:  eta: 0:03:38  iter: 219  total_loss: 0.1255  loss_cls: 0.0492  loss_box_reg: 0.04469  loss_rpn_cls: 0.006103  loss_rpn_loc: 0.02524  time: 0.2223  data_time: 0.0235  lr: 0.01  max_mem: 5177M
[11/22 05:12:35] d2.utils.events INFO:  eta: 0:03:33  iter: 239  total_loss: 0.1176  loss_cls: 0.0476  loss_box_reg: 0.0441  loss_rpn_cls: 0.0056  loss_rpn_loc: 0.02074  time: 0.2223  data_time: 0.0190  lr: 0.01  max_mem: 5177M
[11/22 05:12:39] d2.utils.events INFO:  eta: 0:03:29  iter: 259  total_loss: 0.1181  loss_cls: 0.04504  loss_box_reg: 0.04104  loss_rpn_cls: 0.005388  loss_rpn_loc: 0.0237  time: 0.2222  data_time: 0.0249  lr: 0.01  max_mem: 5177M
[11/22 05:12:44] d2.utils.events INFO:  eta: 0:03:24  iter: 279  total_loss: 0.1153  loss_cls: 0.04282  loss_box_reg: 0.03967  loss_rpn_cls: 0.005755  loss_rpn_loc: 0.02516  time: 0.2221  data_time: 0.0223  lr: 0.01  max_mem: 5177M
[11/22 05:12:48] d2.utils.events INFO:  eta: 0:03:19  iter: 299  total_loss: 0.1128  loss_cls: 0.04309  loss_box_reg: 0.03872  loss_rpn_cls: 0.004908  loss_rpn_loc: 0.02314  time: 0.2222  data_time: 0.0195  lr: 0.01  max_mem: 5177M
[11/22 05:12:53] d2.utils.events INFO:  eta: 0:03:15  iter: 319  total_loss: 0.1062  loss_cls: 0.04523  loss_box_reg: 0.03563  loss_rpn_cls: 0.005539  loss_rpn_loc: 0.02069  time: 0.2223  data_time: 0.0220  lr: 0.01  max_mem: 5177M
[11/22 05:12:57] d2.utils.events INFO:  eta: 0:03:11  iter: 339  total_loss: 0.1093  loss_cls: 0.04409  loss_box_reg: 0.03828  loss_rpn_cls: 0.004881  loss_rpn_loc: 0.02039  time: 0.2225  data_time: 0.0201  lr: 0.01  max_mem: 5177M
[11/22 05:13:01] d2.utils.events INFO:  eta: 0:03:06  iter: 359  total_loss: 0.1021  loss_cls: 0.04114  loss_box_reg: 0.03517  loss_rpn_cls: 0.004435  loss_rpn_loc: 0.02128  time: 0.2224  data_time: 0.0210  lr: 0.01  max_mem: 5177M
[11/22 05:13:06] d2.utils.events INFO:  eta: 0:03:02  iter: 379  total_loss: 0.0994  loss_cls: 0.03932  loss_box_reg: 0.03519  loss_rpn_cls: 0.004137  loss_rpn_loc: 0.01813  time: 0.2224  data_time: 0.0220  lr: 0.01  max_mem: 5177M
[11/22 05:13:10] d2.utils.events INFO:  eta: 0:02:57  iter: 399  total_loss: 0.09477  loss_cls: 0.03979  loss_box_reg: 0.03443  loss_rpn_cls: 0.003735  loss_rpn_loc: 0.01775  time: 0.2224  data_time: 0.0243  lr: 0.01  max_mem: 5177M
[11/22 05:13:15] d2.utils.events INFO:  eta: 0:02:53  iter: 419  total_loss: 0.09933  loss_cls: 0.04071  loss_box_reg: 0.03508  loss_rpn_cls: 0.00422  loss_rpn_loc: 0.01799  time: 0.2225  data_time: 0.0227  lr: 0.01  max_mem: 5177M
[11/22 05:13:19] d2.utils.events INFO:  eta: 0:02:49  iter: 439  total_loss: 0.09483  loss_cls: 0.03912  loss_box_reg: 0.03374  loss_rpn_cls: 0.004169  loss_rpn_loc: 0.01906  time: 0.2224  data_time: 0.0204  lr: 0.01  max_mem: 5177M
[11/22 05:13:24] d2.utils.events INFO:  eta: 0:02:44  iter: 459  total_loss: 0.09343  loss_cls: 0.03884  loss_box_reg: 0.0326  loss_rpn_cls: 0.004322  loss_rpn_loc: 0.01767  time: 0.2224  data_time: 0.0202  lr: 0.01  max_mem: 5177M
[11/22 05:13:28] d2.utils.events INFO:  eta: 0:02:40  iter: 479  total_loss: 0.08996  loss_cls: 0.0375  loss_box_reg: 0.03167  loss_rpn_cls: 0.00336  loss_rpn_loc: 0.01654  time: 0.2224  data_time: 0.0209  lr: 0.01  max_mem: 5177M
[11/22 05:13:33] d2.utils.events INFO:  eta: 0:02:35  iter: 499  total_loss: 0.09579  loss_cls: 0.03955  loss_box_reg: 0.03343  loss_rpn_cls: 0.003622  loss_rpn_loc: 0.01867  time: 0.2223  data_time: 0.0207  lr: 0.01  max_mem: 5177M
[11/22 05:13:37] d2.utils.events INFO:  eta: 0:02:31  iter: 519  total_loss: 0.09019  loss_cls: 0.03826  loss_box_reg: 0.0302  loss_rpn_cls: 0.003878  loss_rpn_loc: 0.01873  time: 0.2223  data_time: 0.0215  lr: 0.01  max_mem: 5177M
[11/22 05:13:42] d2.utils.events INFO:  eta: 0:02:26  iter: 539  total_loss: 0.09094  loss_cls: 0.03787  loss_box_reg: 0.03157  loss_rpn_cls: 0.003645  loss_rpn_loc: 0.01597  time: 0.2223  data_time: 0.0206  lr: 0.01  max_mem: 5177M
[11/22 05:13:46] d2.utils.events INFO:  eta: 0:02:22  iter: 559  total_loss: 0.09038  loss_cls: 0.03752  loss_box_reg: 0.03129  loss_rpn_cls: 0.003688  loss_rpn_loc: 0.01574  time: 0.2223  data_time: 0.0215  lr: 0.01  max_mem: 5177M
[11/22 05:13:51] d2.utils.events INFO:  eta: 0:02:17  iter: 579  total_loss: 0.0854  loss_cls: 0.03643  loss_box_reg: 0.02873  loss_rpn_cls: 0.003403  loss_rpn_loc: 0.01357  time: 0.2224  data_time: 0.0212  lr: 0.01  max_mem: 5177M
[11/22 05:13:55] d2.utils.events INFO:  eta: 0:02:13  iter: 599  total_loss: 0.08111  loss_cls: 0.03458  loss_box_reg: 0.02921  loss_rpn_cls: 0.0031  loss_rpn_loc: 0.01394  time: 0.2224  data_time: 0.0224  lr: 0.01  max_mem: 5177M
[11/22 05:14:00] d2.utils.events INFO:  eta: 0:02:09  iter: 619  total_loss: 0.08217  loss_cls: 0.03503  loss_box_reg: 0.02955  loss_rpn_cls: 0.003031  loss_rpn_loc: 0.01581  time: 0.2225  data_time: 0.0224  lr: 0.01  max_mem: 5177M
[11/22 05:14:04] d2.utils.events INFO:  eta: 0:02:04  iter: 639  total_loss: 0.08248  loss_cls: 0.03525  loss_box_reg: 0.02866  loss_rpn_cls: 0.002796  loss_rpn_loc: 0.01454  time: 0.2225  data_time: 0.0206  lr: 0.01  max_mem: 5177M
[11/22 05:14:09] d2.utils.events INFO:  eta: 0:02:00  iter: 659  total_loss: 0.08056  loss_cls: 0.03649  loss_box_reg: 0.02844  loss_rpn_cls: 0.002592  loss_rpn_loc: 0.01355  time: 0.2225  data_time: 0.0217  lr: 0.01  max_mem: 5177M
[11/22 05:14:13] d2.utils.events INFO:  eta: 0:01:55  iter: 679  total_loss: 0.08161  loss_cls: 0.03401  loss_box_reg: 0.02762  loss_rpn_cls: 0.003044  loss_rpn_loc: 0.01535  time: 0.2226  data_time: 0.0217  lr: 0.01  max_mem: 5177M
[11/22 05:14:18] d2.utils.events INFO:  eta: 0:01:51  iter: 699  total_loss: 0.08161  loss_cls: 0.0334  loss_box_reg: 0.0275  loss_rpn_cls: 0.002955  loss_rpn_loc: 0.01911  time: 0.2226  data_time: 0.0217  lr: 0.01  max_mem: 5177M
[11/22 05:14:22] d2.utils.events INFO:  eta: 0:01:46  iter: 719  total_loss: 0.07628  loss_cls: 0.03363  loss_box_reg: 0.0278  loss_rpn_cls: 0.002752  loss_rpn_loc: 0.01369  time: 0.2227  data_time: 0.0208  lr: 0.01  max_mem: 5177M
[11/22 05:14:27] d2.utils.events INFO:  eta: 0:01:42  iter: 739  total_loss: 0.08234  loss_cls: 0.03444  loss_box_reg: 0.02685  loss_rpn_cls: 0.003537  loss_rpn_loc: 0.01563  time: 0.2228  data_time: 0.0225  lr: 0.01  max_mem: 5177M
[11/22 05:14:31] d2.utils.events INFO:  eta: 0:01:37  iter: 759  total_loss: 0.07758  loss_cls: 0.03264  loss_box_reg: 0.02656  loss_rpn_cls: 0.002966  loss_rpn_loc: 0.01345  time: 0.2228  data_time: 0.0226  lr: 0.01  max_mem: 5177M
[11/22 05:14:36] d2.utils.events INFO:  eta: 0:01:33  iter: 779  total_loss: 0.07764  loss_cls: 0.0329  loss_box_reg: 0.02544  loss_rpn_cls: 0.003111  loss_rpn_loc: 0.01207  time: 0.2229  data_time: 0.0211  lr: 0.01  max_mem: 5177M
[11/22 05:14:40] d2.utils.events INFO:  eta: 0:01:29  iter: 799  total_loss: 0.07683  loss_cls: 0.033  loss_box_reg: 0.02575  loss_rpn_cls: 0.002787  loss_rpn_loc: 0.01355  time: 0.2229  data_time: 0.0228  lr: 0.01  max_mem: 5177M
[11/22 05:14:45] d2.utils.events INFO:  eta: 0:01:24  iter: 819  total_loss: 0.07148  loss_cls: 0.0315  loss_box_reg: 0.02661  loss_rpn_cls: 0.002576  loss_rpn_loc: 0.01212  time: 0.2229  data_time: 0.0209  lr: 0.01  max_mem: 5177M
[11/22 05:14:49] d2.utils.events INFO:  eta: 0:01:20  iter: 839  total_loss: 0.07864  loss_cls: 0.0336  loss_box_reg: 0.02747  loss_rpn_cls: 0.002817  loss_rpn_loc: 0.01371  time: 0.2229  data_time: 0.0227  lr: 0.01  max_mem: 5177M
[11/22 05:14:54] d2.utils.events INFO:  eta: 0:01:15  iter: 859  total_loss: 0.07484  loss_cls: 0.03212  loss_box_reg: 0.02582  loss_rpn_cls: 0.0023  loss_rpn_loc: 0.01338  time: 0.2228  data_time: 0.0228  lr: 0.01  max_mem: 5177M
[11/22 05:14:58] d2.utils.events INFO:  eta: 0:01:11  iter: 879  total_loss: 0.07605  loss_cls: 0.03241  loss_box_reg: 0.02571  loss_rpn_cls: 0.002864  loss_rpn_loc: 0.01767  time: 0.2228  data_time: 0.0238  lr: 0.01  max_mem: 5177M
[11/22 05:15:02] d2.utils.events INFO:  eta: 0:01:06  iter: 899  total_loss: 0.07382  loss_cls: 0.03124  loss_box_reg: 0.02397  loss_rpn_cls: 0.002786  loss_rpn_loc: 0.01684  time: 0.2227  data_time: 0.0208  lr: 0.01  max_mem: 5177M
[11/22 05:15:07] d2.utils.events INFO:  eta: 0:01:02  iter: 919  total_loss: 0.07129  loss_cls: 0.03165  loss_box_reg: 0.02329  loss_rpn_cls: 0.002703  loss_rpn_loc: 0.01396  time: 0.2227  data_time: 0.0218  lr: 0.01  max_mem: 5177M
[11/22 05:15:11] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.07569  loss_cls: 0.03161  loss_box_reg: 0.02632  loss_rpn_cls: 0.002569  loss_rpn_loc: 0.0151  time: 0.2228  data_time: 0.0207  lr: 0.01  max_mem: 5177M
[11/22 05:15:16] d2.utils.events INFO:  eta: 0:00:53  iter: 959  total_loss: 0.07181  loss_cls: 0.03272  loss_box_reg: 0.02461  loss_rpn_cls: 0.002586  loss_rpn_loc: 0.01364  time: 0.2228  data_time: 0.0220  lr: 0.01  max_mem: 5177M
[11/22 05:15:20] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.06766  loss_cls: 0.03198  loss_box_reg: 0.02514  loss_rpn_cls: 0.002673  loss_rpn_loc: 0.01045  time: 0.2228  data_time: 0.0198  lr: 0.001  max_mem: 5177M
[11/22 05:15:25] d2.utils.events INFO:  eta: 0:00:44  iter: 999  total_loss: 0.06713  loss_cls: 0.03169  loss_box_reg: 0.02484  loss_rpn_cls: 0.002877  loss_rpn_loc: 0.008861  time: 0.2227  data_time: 0.0212  lr: 0.001  max_mem: 5177M
[11/22 05:15:29] d2.utils.events INFO:  eta: 0:00:40  iter: 1019  total_loss: 0.06837  loss_cls: 0.03275  loss_box_reg: 0.02451  loss_rpn_cls: 0.002883  loss_rpn_loc: 0.007706  time: 0.2227  data_time: 0.0201  lr: 0.001  max_mem: 5177M
[11/22 05:15:34] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.06633  loss_cls: 0.03173  loss_box_reg: 0.02349  loss_rpn_cls: 0.00275  loss_rpn_loc: 0.007477  time: 0.2231  data_time: 0.0297  lr: 0.001  max_mem: 5177M
[11/22 05:15:39] d2.utils.events INFO:  eta: 0:00:31  iter: 1059  total_loss: 0.06761  loss_cls: 0.03114  loss_box_reg: 0.02446  loss_rpn_cls: 0.002514  loss_rpn_loc: 0.007818  time: 0.2231  data_time: 0.0196  lr: 0.001  max_mem: 5177M
[11/22 05:15:43] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.06426  loss_cls: 0.03141  loss_box_reg: 0.02381  loss_rpn_cls: 0.002571  loss_rpn_loc: 0.007488  time: 0.2231  data_time: 0.0198  lr: 0.001  max_mem: 5177M
[11/22 05:15:47] d2.utils.events INFO:  eta: 0:00:22  iter: 1099  total_loss: 0.06615  loss_cls: 0.03033  loss_box_reg: 0.02429  loss_rpn_cls: 0.002434  loss_rpn_loc: 0.008204  time: 0.2230  data_time: 0.0210  lr: 0.001  max_mem: 5177M
[11/22 05:15:52] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.06462  loss_cls: 0.0305  loss_box_reg: 0.02387  loss_rpn_cls: 0.002297  loss_rpn_loc: 0.006473  time: 0.2230  data_time: 0.0202  lr: 0.001  max_mem: 5177M
[11/22 05:15:56] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.0635  loss_cls: 0.031  loss_box_reg: 0.022  loss_rpn_cls: 0.002002  loss_rpn_loc: 0.006008  time: 0.2230  data_time: 0.0230  lr: 0.001  max_mem: 5177M
[11/22 05:16:01] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.06593  loss_cls: 0.03122  loss_box_reg: 0.02352  loss_rpn_cls: 0.002629  loss_rpn_loc: 0.006659  time: 0.2230  data_time: 0.0222  lr: 0.001  max_mem: 5177M
[11/22 05:16:05] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.06552  loss_cls: 0.03105  loss_box_reg: 0.02313  loss_rpn_cls: 0.002145  loss_rpn_loc: 0.005789  time: 0.2230  data_time: 0.0224  lr: 0.001  max_mem: 5177M
[11/22 05:16:10] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final.pth
[11/22 05:16:12] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.06622  loss_cls: 0.03276  loss_box_reg: 0.02403  loss_rpn_cls: 0.001962  loss_rpn_loc: 0.00608  time: 0.2230  data_time: 0.0230  lr: 0.001  max_mem: 5177M
[11/22 05:16:12] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:27 (0.2230 s / it)
[11/22 05:16:12] d2.engine.hooks INFO: Total training time: 0:04:30 (0:00:02 on hooks)
[11/22 05:16:13] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 393          |    cat     | 370          | motorbike  | 369          |
|   sheep    | 311          |    sofa    | 396          |            |              |
|   total    | 1839         |            |              |            |              |[0m
[11/22 05:16:13] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:16:13] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:16:13] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 05:16:13] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:16:13] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:16:14] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:16:14] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:16:14] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:16:14] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:16:27] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0630 s / img. ETA=0:01:14
[11/22 05:16:30] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0623 s / img. ETA=0:01:10
[11/22 05:16:33] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0626 s / img. ETA=0:01:08
[11/22 05:16:36] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0626 s / img. ETA=0:01:04
[11/22 05:16:39] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0624 s / img. ETA=0:01:01
[11/22 05:16:43] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0624 s / img. ETA=0:00:58
[11/22 05:16:46] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0623 s / img. ETA=0:00:55
[11/22 05:16:49] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0621 s / img. ETA=0:00:52
[11/22 05:16:52] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0620 s / img. ETA=0:00:48
[11/22 05:16:55] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0620 s / img. ETA=0:00:45
[11/22 05:16:58] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0621 s / img. ETA=0:00:42
[11/22 05:17:01] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0621 s / img. ETA=0:00:39
[11/22 05:17:04] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0620 s / img. ETA=0:00:36
[11/22 05:17:07] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0620 s / img. ETA=0:00:33
[11/22 05:17:10] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0621 s / img. ETA=0:00:30
[11/22 05:17:14] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0620 s / img. ETA=0:00:27
[11/22 05:17:17] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0620 s / img. ETA=0:00:24
[11/22 05:17:20] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0620 s / img. ETA=0:00:20
[11/22 05:17:23] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0619 s / img. ETA=0:00:17
[11/22 05:17:26] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0619 s / img. ETA=0:00:14
[11/22 05:17:29] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0618 s / img. ETA=0:00:11
[11/22 05:17:32] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0617 s / img. ETA=0:00:08
[11/22 05:17:35] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0617 s / img. ETA=0:00:05
[11/22 05:17:38] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0617 s / img. ETA=0:00:02
[11/22 05:17:41] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:16 (0.061638 s / img per device, on 4 devices)
[11/22 05:17:41] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:13 (0.059670 s / img per device, on 4 devices)
[11/22 05:17:41] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:17:48] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:------:|:------:|:-----------:|:-------:|:------:|
| 31.471 | 67.881 |   72.125    | 54.725  | 45.035 |
[11/22 05:17:48] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 28.156 | 54.247 | 26.715 | 28.156 | 54.247  | 26.715  |
[11/22 05:17:48] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel3 in csv format:
[11/22 05:17:48] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:17:48] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 05:17:48] defrcn.evaluation.testing INFO: copypaste: 28.1564,54.2475,26.7150,28.1564,54.2475,26.7150
[11/22 05:18:03] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:18:03] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3'], resume=False, start_iter=-1)
[11/22 05:18:03] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all3_2shot_seed3", )
  TEST: ("voc_2007_test_all3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:18:03] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:18:03] d2.utils.env INFO: Using a generated random seed 6704509
[11/22 05:18:04] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:18:04] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth ...
[11/22 05:18:05] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 311          |  bicycle   | 389          |    bird     | 576          |
|   bottle    | 657          |    bus     | 254          |     car     | 1541         |
|    chair    | 1374         |    cow     | 329          | diningtable | 299          |
|     dog     | 530          |   horse    | 395          |   person    | 5227         |
| pottedplant | 592          |   train    | 302          |  tvmonitor  | 361          |
|    boat     | 393          |    cat     | 370          |  motorbike  | 369          |
|    sheep    | 311          |    sofa    | 396          |             |              |
|    total    | 14976        |            |              |             |              |[0m
[11/22 05:18:05] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:18:05] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:18:05] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 05:18:05] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:18:05] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:18:06] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 2            |  bicycle   | 2            |    bird     | 2            |
|   bottle    | 2            |    bus     | 2            |     car     | 2            |
|    chair    | 2            |    cow     | 2            | diningtable | 2            |
|     dog     | 2            |   horse    | 2            |   person    | 2            |
| pottedplant | 2            |   train    | 2            |  tvmonitor  | 2            |
|    boat     | 2            |    cat     | 2            |  motorbike  | 2            |
|    sheep    | 2            |    sofa    | 2            |             |              |
|    total    | 40           |            |              |             |              |[0m
[11/22 05:18:06] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:18:06] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 05:18:06] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 05:18:08] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:18:22] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0652 s / img. ETA=0:01:17
[11/22 05:18:25] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0645 s / img. ETA=0:01:13
[11/22 05:18:28] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0648 s / img. ETA=0:01:10
[11/22 05:18:31] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0650 s / img. ETA=0:01:07
[11/22 05:18:35] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0647 s / img. ETA=0:01:03
[11/22 05:18:38] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0648 s / img. ETA=0:01:00
[11/22 05:18:41] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0646 s / img. ETA=0:00:57
[11/22 05:18:44] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0645 s / img. ETA=0:00:54
[11/22 05:18:47] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0645 s / img. ETA=0:00:50
[11/22 05:18:51] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0644 s / img. ETA=0:00:47
[11/22 05:18:54] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0645 s / img. ETA=0:00:44
[11/22 05:18:57] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0647 s / img. ETA=0:00:41
[11/22 05:19:00] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0648 s / img. ETA=0:00:38
[11/22 05:19:04] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0649 s / img. ETA=0:00:34
[11/22 05:19:07] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0650 s / img. ETA=0:00:31
[11/22 05:19:10] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0650 s / img. ETA=0:00:28
[11/22 05:19:14] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0651 s / img. ETA=0:00:25
[11/22 05:19:17] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0652 s / img. ETA=0:00:22
[11/22 05:19:20] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0651 s / img. ETA=0:00:18
[11/22 05:19:23] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0651 s / img. ETA=0:00:15
[11/22 05:19:27] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0651 s / img. ETA=0:00:12
[11/22 05:19:30] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0651 s / img. ETA=0:00:08
[11/22 05:19:33] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0651 s / img. ETA=0:00:05
[11/22 05:19:36] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0651 s / img. ETA=0:00:02
[11/22 05:19:39] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:20 (0.064882 s / img per device, on 4 devices)
[11/22 05:19:39] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:16 (0.062242 s / img per device, on 4 devices)
[11/22 05:19:39] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:20:07] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  bird  |  bottle  |  bus   |  car   |  chair  |  cow   |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  train  |  tvmonitor  |  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-----------:|:------:|:------:|:-----------:|:-------:|:------:|
|   83.545    |  86.185   | 84.700 |  74.116  | 87.654 | 88.590 | 68.706  | 83.574 |    76.098     | 85.308 | 88.674  |  86.234  |    55.947     | 83.403  |   82.215    | 31.132 | 70.783 |   72.211    | 69.014  | 48.689 |
[11/22 05:20:07] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.176 | 75.339 | 49.279 | 52.970 | 80.997  | 57.004  | 29.794 | 58.366  | 26.103  |
[11/22 05:20:07] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all3 in csv format:
[11/22 05:20:07] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:20:07] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 05:20:07] defrcn.evaluation.testing INFO: copypaste: 47.1760,75.3390,49.2790,52.9700,80.9967,57.0043,29.7939,58.3658,26.1030
[11/22 05:20:19] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:20:19] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 05:20:19] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel3_2shot_seed3", )
  TEST: ("voc_2007_test_novel3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:20:19] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:20:19] d2.utils.env INFO: Using a generated random seed 22289533
[11/22 05:20:19] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:20:19] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 05:20:19] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 2            |    cat     | 2            | motorbike  | 2            |
|   sheep    | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 05:20:19] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 05:20:19] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 05:20:20] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:20:20] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:20:20] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth ...
[11/22 05:20:20] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 05:20:28] d2.utils.events INFO:  eta: 0:04:24  iter: 19  total_loss: 0.5972  loss_cls: 0.3267  loss_box_reg: 0.166  loss_rpn_cls: 0.03778  loss_rpn_loc: 0.06116  time: 0.2241  data_time: 0.1922  lr: 0.01  max_mem: 5087M
[11/22 05:20:32] d2.utils.events INFO:  eta: 0:04:19  iter: 39  total_loss: 0.3682  loss_cls: 0.163  loss_box_reg: 0.1451  loss_rpn_cls: 0.02429  loss_rpn_loc: 0.03513  time: 0.2228  data_time: 0.0219  lr: 0.01  max_mem: 5087M
[11/22 05:20:37] d2.utils.events INFO:  eta: 0:04:13  iter: 59  total_loss: 0.2978  loss_cls: 0.1106  loss_box_reg: 0.1254  loss_rpn_cls: 0.01709  loss_rpn_loc: 0.04136  time: 0.2222  data_time: 0.0270  lr: 0.01  max_mem: 5178M
[11/22 05:20:41] d2.utils.events INFO:  eta: 0:04:09  iter: 79  total_loss: 0.2362  loss_cls: 0.07916  loss_box_reg: 0.1023  loss_rpn_cls: 0.01377  loss_rpn_loc: 0.03359  time: 0.2226  data_time: 0.0232  lr: 0.01  max_mem: 5178M
[11/22 05:20:46] d2.utils.events INFO:  eta: 0:04:04  iter: 99  total_loss: 0.1984  loss_cls: 0.07043  loss_box_reg: 0.088  loss_rpn_cls: 0.01172  loss_rpn_loc: 0.02855  time: 0.2234  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:20:50] d2.utils.events INFO:  eta: 0:03:59  iter: 119  total_loss: 0.1762  loss_cls: 0.06265  loss_box_reg: 0.07279  loss_rpn_cls: 0.009241  loss_rpn_loc: 0.0264  time: 0.2229  data_time: 0.0234  lr: 0.01  max_mem: 5178M
[11/22 05:20:55] d2.utils.events INFO:  eta: 0:03:55  iter: 139  total_loss: 0.1581  loss_cls: 0.05955  loss_box_reg: 0.06115  loss_rpn_cls: 0.008858  loss_rpn_loc: 0.02745  time: 0.2231  data_time: 0.0243  lr: 0.01  max_mem: 5178M
[11/22 05:20:59] d2.utils.events INFO:  eta: 0:03:50  iter: 159  total_loss: 0.143  loss_cls: 0.05671  loss_box_reg: 0.05445  loss_rpn_cls: 0.00736  loss_rpn_loc: 0.0244  time: 0.2230  data_time: 0.0224  lr: 0.01  max_mem: 5178M
[11/22 05:21:04] d2.utils.events INFO:  eta: 0:03:46  iter: 179  total_loss: 0.1357  loss_cls: 0.05392  loss_box_reg: 0.05044  loss_rpn_cls: 0.006498  loss_rpn_loc: 0.0264  time: 0.2226  data_time: 0.0217  lr: 0.01  max_mem: 5178M
[11/22 05:21:08] d2.utils.events INFO:  eta: 0:03:41  iter: 199  total_loss: 0.1248  loss_cls: 0.05077  loss_box_reg: 0.04554  loss_rpn_cls: 0.006381  loss_rpn_loc: 0.02048  time: 0.2226  data_time: 0.0236  lr: 0.01  max_mem: 5178M
[11/22 05:21:13] d2.utils.events INFO:  eta: 0:03:37  iter: 219  total_loss: 0.1222  loss_cls: 0.04832  loss_box_reg: 0.04513  loss_rpn_cls: 0.006455  loss_rpn_loc: 0.02088  time: 0.2225  data_time: 0.0241  lr: 0.01  max_mem: 5178M
[11/22 05:21:17] d2.utils.events INFO:  eta: 0:03:32  iter: 239  total_loss: 0.1199  loss_cls: 0.04855  loss_box_reg: 0.04348  loss_rpn_cls: 0.005956  loss_rpn_loc: 0.02221  time: 0.2223  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:21:21] d2.utils.events INFO:  eta: 0:03:28  iter: 259  total_loss: 0.117  loss_cls: 0.04484  loss_box_reg: 0.04075  loss_rpn_cls: 0.005835  loss_rpn_loc: 0.02203  time: 0.2224  data_time: 0.0239  lr: 0.01  max_mem: 5178M
[11/22 05:21:26] d2.utils.events INFO:  eta: 0:03:24  iter: 279  total_loss: 0.1069  loss_cls: 0.04546  loss_box_reg: 0.03997  loss_rpn_cls: 0.005139  loss_rpn_loc: 0.01781  time: 0.2225  data_time: 0.0206  lr: 0.01  max_mem: 5178M
[11/22 05:21:30] d2.utils.events INFO:  eta: 0:03:19  iter: 299  total_loss: 0.1051  loss_cls: 0.04339  loss_box_reg: 0.03959  loss_rpn_cls: 0.004665  loss_rpn_loc: 0.01945  time: 0.2226  data_time: 0.0228  lr: 0.01  max_mem: 5178M
[11/22 05:21:35] d2.utils.events INFO:  eta: 0:03:15  iter: 319  total_loss: 0.1059  loss_cls: 0.04294  loss_box_reg: 0.03742  loss_rpn_cls: 0.004082  loss_rpn_loc: 0.01883  time: 0.2226  data_time: 0.0224  lr: 0.01  max_mem: 5178M
[11/22 05:21:39] d2.utils.events INFO:  eta: 0:03:10  iter: 339  total_loss: 0.1006  loss_cls: 0.0425  loss_box_reg: 0.03671  loss_rpn_cls: 0.004404  loss_rpn_loc: 0.01818  time: 0.2225  data_time: 0.0223  lr: 0.01  max_mem: 5178M
[11/22 05:21:44] d2.utils.events INFO:  eta: 0:03:06  iter: 359  total_loss: 0.09987  loss_cls: 0.0385  loss_box_reg: 0.03552  loss_rpn_cls: 0.004086  loss_rpn_loc: 0.0186  time: 0.2225  data_time: 0.0250  lr: 0.01  max_mem: 5178M
[11/22 05:21:48] d2.utils.events INFO:  eta: 0:03:01  iter: 379  total_loss: 0.1017  loss_cls: 0.03982  loss_box_reg: 0.03452  loss_rpn_cls: 0.004425  loss_rpn_loc: 0.02025  time: 0.2225  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:21:53] d2.utils.events INFO:  eta: 0:02:57  iter: 399  total_loss: 0.09938  loss_cls: 0.03779  loss_box_reg: 0.03369  loss_rpn_cls: 0.003849  loss_rpn_loc: 0.02128  time: 0.2224  data_time: 0.0226  lr: 0.01  max_mem: 5178M
[11/22 05:21:57] d2.utils.events INFO:  eta: 0:02:53  iter: 419  total_loss: 0.09713  loss_cls: 0.03728  loss_box_reg: 0.03367  loss_rpn_cls: 0.00405  loss_rpn_loc: 0.02083  time: 0.2225  data_time: 0.0222  lr: 0.01  max_mem: 5178M
[11/22 05:22:02] d2.utils.events INFO:  eta: 0:02:48  iter: 439  total_loss: 0.09414  loss_cls: 0.03775  loss_box_reg: 0.03145  loss_rpn_cls: 0.003984  loss_rpn_loc: 0.01808  time: 0.2225  data_time: 0.0209  lr: 0.01  max_mem: 5178M
[11/22 05:22:06] d2.utils.events INFO:  eta: 0:02:44  iter: 459  total_loss: 0.09792  loss_cls: 0.03945  loss_box_reg: 0.03235  loss_rpn_cls: 0.004237  loss_rpn_loc: 0.02217  time: 0.2224  data_time: 0.0239  lr: 0.01  max_mem: 5178M
[11/22 05:22:11] d2.utils.events INFO:  eta: 0:02:39  iter: 479  total_loss: 0.0942  loss_cls: 0.03749  loss_box_reg: 0.03211  loss_rpn_cls: 0.004095  loss_rpn_loc: 0.0199  time: 0.2225  data_time: 0.0209  lr: 0.01  max_mem: 5178M
[11/22 05:22:15] d2.utils.events INFO:  eta: 0:02:35  iter: 499  total_loss: 0.09315  loss_cls: 0.03769  loss_box_reg: 0.03176  loss_rpn_cls: 0.004152  loss_rpn_loc: 0.0185  time: 0.2224  data_time: 0.0205  lr: 0.01  max_mem: 5178M
[11/22 05:22:19] d2.utils.events INFO:  eta: 0:02:30  iter: 519  total_loss: 0.08714  loss_cls: 0.03729  loss_box_reg: 0.03157  loss_rpn_cls: 0.003582  loss_rpn_loc: 0.01556  time: 0.2224  data_time: 0.0224  lr: 0.01  max_mem: 5178M
[11/22 05:22:24] d2.utils.events INFO:  eta: 0:02:26  iter: 539  total_loss: 0.08642  loss_cls: 0.03352  loss_box_reg: 0.03025  loss_rpn_cls: 0.003879  loss_rpn_loc: 0.01563  time: 0.2223  data_time: 0.0241  lr: 0.01  max_mem: 5178M
[11/22 05:22:28] d2.utils.events INFO:  eta: 0:02:21  iter: 559  total_loss: 0.08484  loss_cls: 0.03687  loss_box_reg: 0.02949  loss_rpn_cls: 0.003246  loss_rpn_loc: 0.01414  time: 0.2224  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:22:33] d2.utils.events INFO:  eta: 0:02:17  iter: 579  total_loss: 0.08421  loss_cls: 0.03411  loss_box_reg: 0.02834  loss_rpn_cls: 0.003383  loss_rpn_loc: 0.01778  time: 0.2224  data_time: 0.0222  lr: 0.01  max_mem: 5178M
[11/22 05:22:37] d2.utils.events INFO:  eta: 0:02:13  iter: 599  total_loss: 0.09072  loss_cls: 0.03889  loss_box_reg: 0.02989  loss_rpn_cls: 0.003753  loss_rpn_loc: 0.01601  time: 0.2225  data_time: 0.0238  lr: 0.01  max_mem: 5178M
[11/22 05:22:42] d2.utils.events INFO:  eta: 0:02:08  iter: 619  total_loss: 0.08313  loss_cls: 0.03512  loss_box_reg: 0.02881  loss_rpn_cls: 0.003216  loss_rpn_loc: 0.01399  time: 0.2224  data_time: 0.0227  lr: 0.01  max_mem: 5178M
[11/22 05:22:46] d2.utils.events INFO:  eta: 0:02:04  iter: 639  total_loss: 0.08083  loss_cls: 0.03472  loss_box_reg: 0.0273  loss_rpn_cls: 0.002974  loss_rpn_loc: 0.01372  time: 0.2224  data_time: 0.0217  lr: 0.01  max_mem: 5178M
[11/22 05:22:51] d2.utils.events INFO:  eta: 0:01:59  iter: 659  total_loss: 0.08464  loss_cls: 0.03484  loss_box_reg: 0.02961  loss_rpn_cls: 0.003323  loss_rpn_loc: 0.01735  time: 0.2224  data_time: 0.0204  lr: 0.01  max_mem: 5178M
[11/22 05:22:55] d2.utils.events INFO:  eta: 0:01:55  iter: 679  total_loss: 0.08247  loss_cls: 0.03498  loss_box_reg: 0.02875  loss_rpn_cls: 0.002912  loss_rpn_loc: 0.01527  time: 0.2225  data_time: 0.0227  lr: 0.01  max_mem: 5178M
[11/22 05:23:00] d2.utils.events INFO:  eta: 0:01:50  iter: 699  total_loss: 0.08324  loss_cls: 0.03434  loss_box_reg: 0.02884  loss_rpn_cls: 0.003548  loss_rpn_loc: 0.01697  time: 0.2226  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:23:04] d2.utils.events INFO:  eta: 0:01:46  iter: 719  total_loss: 0.08115  loss_cls: 0.0327  loss_box_reg: 0.02691  loss_rpn_cls: 0.002934  loss_rpn_loc: 0.0164  time: 0.2226  data_time: 0.0237  lr: 0.01  max_mem: 5178M
[11/22 05:23:09] d2.utils.events INFO:  eta: 0:01:42  iter: 739  total_loss: 0.07574  loss_cls: 0.03217  loss_box_reg: 0.02652  loss_rpn_cls: 0.002842  loss_rpn_loc: 0.01594  time: 0.2226  data_time: 0.0222  lr: 0.01  max_mem: 5178M
[11/22 05:23:13] d2.utils.events INFO:  eta: 0:01:37  iter: 759  total_loss: 0.07859  loss_cls: 0.03233  loss_box_reg: 0.02678  loss_rpn_cls: 0.002934  loss_rpn_loc: 0.01356  time: 0.2227  data_time: 0.0217  lr: 0.01  max_mem: 5178M
[11/22 05:23:18] d2.utils.events INFO:  eta: 0:01:33  iter: 779  total_loss: 0.07434  loss_cls: 0.03306  loss_box_reg: 0.02621  loss_rpn_cls: 0.002465  loss_rpn_loc: 0.01291  time: 0.2226  data_time: 0.0215  lr: 0.01  max_mem: 5178M
[11/22 05:23:22] d2.utils.events INFO:  eta: 0:01:28  iter: 799  total_loss: 0.07455  loss_cls: 0.03189  loss_box_reg: 0.02635  loss_rpn_cls: 0.002928  loss_rpn_loc: 0.01309  time: 0.2226  data_time: 0.0225  lr: 0.01  max_mem: 5178M
[11/22 05:23:27] d2.utils.events INFO:  eta: 0:01:24  iter: 819  total_loss: 0.07726  loss_cls: 0.03248  loss_box_reg: 0.02669  loss_rpn_cls: 0.002493  loss_rpn_loc: 0.01776  time: 0.2226  data_time: 0.0207  lr: 0.01  max_mem: 5178M
[11/22 05:23:31] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.0759  loss_cls: 0.03274  loss_box_reg: 0.02522  loss_rpn_cls: 0.002955  loss_rpn_loc: 0.01554  time: 0.2226  data_time: 0.0223  lr: 0.01  max_mem: 5178M
[11/22 05:23:36] d2.utils.events INFO:  eta: 0:01:15  iter: 859  total_loss: 0.07186  loss_cls: 0.03176  loss_box_reg: 0.02474  loss_rpn_cls: 0.002399  loss_rpn_loc: 0.01188  time: 0.2226  data_time: 0.0215  lr: 0.01  max_mem: 5178M
[11/22 05:23:40] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.07527  loss_cls: 0.03147  loss_box_reg: 0.02501  loss_rpn_cls: 0.002456  loss_rpn_loc: 0.01497  time: 0.2225  data_time: 0.0220  lr: 0.01  max_mem: 5178M
[11/22 05:23:44] d2.utils.events INFO:  eta: 0:01:06  iter: 899  total_loss: 0.07216  loss_cls: 0.03119  loss_box_reg: 0.0246  loss_rpn_cls: 0.002465  loss_rpn_loc: 0.0142  time: 0.2226  data_time: 0.0220  lr: 0.01  max_mem: 5178M
[11/22 05:23:49] d2.utils.events INFO:  eta: 0:01:02  iter: 919  total_loss: 0.07233  loss_cls: 0.0315  loss_box_reg: 0.02486  loss_rpn_cls: 0.002526  loss_rpn_loc: 0.01394  time: 0.2226  data_time: 0.0221  lr: 0.01  max_mem: 5178M
[11/22 05:23:53] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.07091  loss_cls: 0.03106  loss_box_reg: 0.02392  loss_rpn_cls: 0.002142  loss_rpn_loc: 0.01095  time: 0.2225  data_time: 0.0214  lr: 0.01  max_mem: 5178M
[11/22 05:23:58] d2.utils.events INFO:  eta: 0:00:53  iter: 959  total_loss: 0.07045  loss_cls: 0.03106  loss_box_reg: 0.0248  loss_rpn_cls: 0.002974  loss_rpn_loc: 0.01287  time: 0.2225  data_time: 0.0217  lr: 0.01  max_mem: 5178M
[11/22 05:24:02] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.07075  loss_cls: 0.0311  loss_box_reg: 0.02524  loss_rpn_cls: 0.00269  loss_rpn_loc: 0.009726  time: 0.2225  data_time: 0.0216  lr: 0.001  max_mem: 5178M
[11/22 05:24:07] d2.utils.events INFO:  eta: 0:00:44  iter: 999  total_loss: 0.06679  loss_cls: 0.03251  loss_box_reg: 0.02378  loss_rpn_cls: 0.002748  loss_rpn_loc: 0.008145  time: 0.2225  data_time: 0.0213  lr: 0.001  max_mem: 5178M
[11/22 05:24:11] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.06639  loss_cls: 0.0325  loss_box_reg: 0.02364  loss_rpn_cls: 0.002322  loss_rpn_loc: 0.007921  time: 0.2225  data_time: 0.0213  lr: 0.001  max_mem: 5178M
[11/22 05:24:16] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.06227  loss_cls: 0.03109  loss_box_reg: 0.02316  loss_rpn_cls: 0.001954  loss_rpn_loc: 0.0067  time: 0.2225  data_time: 0.0210  lr: 0.001  max_mem: 5178M
[11/22 05:24:20] d2.utils.events INFO:  eta: 0:00:31  iter: 1059  total_loss: 0.06728  loss_cls: 0.0318  loss_box_reg: 0.0248  loss_rpn_cls: 0.002509  loss_rpn_loc: 0.008026  time: 0.2225  data_time: 0.0220  lr: 0.001  max_mem: 5178M
[11/22 05:24:25] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.0632  loss_cls: 0.03099  loss_box_reg: 0.02347  loss_rpn_cls: 0.00225  loss_rpn_loc: 0.006774  time: 0.2225  data_time: 0.0220  lr: 0.001  max_mem: 5178M
[11/22 05:24:29] d2.utils.events INFO:  eta: 0:00:22  iter: 1099  total_loss: 0.06546  loss_cls: 0.03178  loss_box_reg: 0.02352  loss_rpn_cls: 0.002062  loss_rpn_loc: 0.006628  time: 0.2227  data_time: 0.0219  lr: 0.001  max_mem: 5178M
[11/22 05:24:34] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.06672  loss_cls: 0.03206  loss_box_reg: 0.02436  loss_rpn_cls: 0.002168  loss_rpn_loc: 0.008647  time: 0.2227  data_time: 0.0226  lr: 0.001  max_mem: 5178M
[11/22 05:24:38] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.0666  loss_cls: 0.03162  loss_box_reg: 0.02469  loss_rpn_cls: 0.002531  loss_rpn_loc: 0.006636  time: 0.2226  data_time: 0.0225  lr: 0.001  max_mem: 5178M
[11/22 05:24:43] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.06255  loss_cls: 0.03142  loss_box_reg: 0.02295  loss_rpn_cls: 0.00228  loss_rpn_loc: 0.006377  time: 0.2226  data_time: 0.0218  lr: 0.001  max_mem: 5178M
[11/22 05:24:47] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.06721  loss_cls: 0.03255  loss_box_reg: 0.02321  loss_rpn_cls: 0.002077  loss_rpn_loc: 0.006961  time: 0.2226  data_time: 0.0220  lr: 0.001  max_mem: 5178M
[11/22 05:24:52] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final.pth
[11/22 05:24:53] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.0631  loss_cls: 0.03097  loss_box_reg: 0.02395  loss_rpn_cls: 0.002181  loss_rpn_loc: 0.007164  time: 0.2226  data_time: 0.0215  lr: 0.001  max_mem: 5178M
[11/22 05:24:53] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:26 (0.2226 s / it)
[11/22 05:24:53] d2.engine.hooks INFO: Total training time: 0:04:29 (0:00:03 on hooks)
[11/22 05:24:56] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 393          |    cat     | 370          | motorbike  | 369          |
|   sheep    | 311          |    sofa    | 396          |            |              |
|   total    | 1839         |            |              |            |              |[0m
[11/22 05:24:56] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:24:56] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:24:56] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 05:24:56] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:24:56] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:24:57] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:24:57] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:24:57] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:24:57] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:25:10] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0650 s / img. ETA=0:01:17
[11/22 05:25:14] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0656 s / img. ETA=0:01:14
[11/22 05:25:17] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0663 s / img. ETA=0:01:12
[11/22 05:25:20] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0664 s / img. ETA=0:01:08
[11/22 05:25:23] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0658 s / img. ETA=0:01:04
[11/22 05:25:27] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0655 s / img. ETA=0:01:01
[11/22 05:25:30] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0651 s / img. ETA=0:00:57
[11/22 05:25:33] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0649 s / img. ETA=0:00:54
[11/22 05:25:36] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0648 s / img. ETA=0:00:51
[11/22 05:25:39] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0646 s / img. ETA=0:00:47
[11/22 05:25:42] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0644 s / img. ETA=0:00:44
[11/22 05:25:46] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0643 s / img. ETA=0:00:40
[11/22 05:25:49] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0641 s / img. ETA=0:00:37
[11/22 05:25:52] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0639 s / img. ETA=0:00:34
[11/22 05:25:55] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0640 s / img. ETA=0:00:31
[11/22 05:25:58] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0640 s / img. ETA=0:00:28
[11/22 05:26:01] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0639 s / img. ETA=0:00:24
[11/22 05:26:04] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0638 s / img. ETA=0:00:21
[11/22 05:26:07] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0637 s / img. ETA=0:00:18
[11/22 05:26:11] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0636 s / img. ETA=0:00:15
[11/22 05:26:14] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0636 s / img. ETA=0:00:11
[11/22 05:26:17] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0635 s / img. ETA=0:00:08
[11/22 05:26:20] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0634 s / img. ETA=0:00:05
[11/22 05:26:23] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0633 s / img. ETA=0:00:02
[11/22 05:26:26] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:18 (0.063260 s / img per device, on 4 devices)
[11/22 05:26:26] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:15 (0.061271 s / img per device, on 4 devices)
[11/22 05:26:27] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:26:34] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:------:|:------:|:-----------:|:-------:|:------:|
| 30.896 | 68.579 |   72.232    | 54.328  | 46.813 |
[11/22 05:26:34] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 27.861 | 54.569 | 25.542 | 27.861 | 54.569  | 25.542  |
[11/22 05:26:34] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel3 in csv format:
[11/22 05:26:34] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:26:34] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 05:26:34] defrcn.evaluation.testing INFO: copypaste: 27.8609,54.5694,25.5418,27.8609,54.5694,25.5418
[11/22 05:26:51] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:26:51] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3'], resume=False, start_iter=-1)
[11/22 05:26:51] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all3_2shot_seed3", )
  TEST: ("voc_2007_test_all3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:26:51] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:26:51] d2.utils.env INFO: Using a generated random seed 54485231
[11/22 05:26:51] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:26:51] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth ...
[11/22 05:26:53] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 311          |  bicycle   | 389          |    bird     | 576          |
|   bottle    | 657          |    bus     | 254          |     car     | 1541         |
|    chair    | 1374         |    cow     | 329          | diningtable | 299          |
|     dog     | 530          |   horse    | 395          |   person    | 5227         |
| pottedplant | 592          |   train    | 302          |  tvmonitor  | 361          |
|    boat     | 393          |    cat     | 370          |  motorbike  | 369          |
|    sheep    | 311          |    sofa    | 396          |             |              |
|    total    | 14976        |            |              |             |              |[0m
[11/22 05:26:53] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:26:53] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:26:53] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 05:26:53] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:26:53] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:26:55] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 2            |  bicycle   | 2            |    bird     | 2            |
|   bottle    | 2            |    bus     | 2            |     car     | 2            |
|    chair    | 2            |    cow     | 2            | diningtable | 2            |
|     dog     | 2            |   horse    | 2            |   person    | 2            |
| pottedplant | 2            |   train    | 2            |  tvmonitor  | 2            |
|    boat     | 2            |    cat     | 2            |  motorbike  | 2            |
|    sheep    | 2            |    sofa    | 2            |             |              |
|    total    | 40           |            |              |             |              |[0m
[11/22 05:26:55] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:26:55] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 05:26:55] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 05:26:56] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:27:09] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0625 s / img. ETA=0:01:14
[11/22 05:27:12] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0618 s / img. ETA=0:01:10
[11/22 05:27:15] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0619 s / img. ETA=0:01:07
[11/22 05:27:18] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0617 s / img. ETA=0:01:04
[11/22 05:27:21] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0616 s / img. ETA=0:01:00
[11/22 05:27:25] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0616 s / img. ETA=0:00:57
[11/22 05:27:28] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0614 s / img. ETA=0:00:54
[11/22 05:27:31] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0613 s / img. ETA=0:00:51
[11/22 05:27:34] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0612 s / img. ETA=0:00:48
[11/22 05:27:37] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0611 s / img. ETA=0:00:45
[11/22 05:27:40] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0611 s / img. ETA=0:00:42
[11/22 05:27:43] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0611 s / img. ETA=0:00:39
[11/22 05:27:46] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0611 s / img. ETA=0:00:35
[11/22 05:27:49] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0610 s / img. ETA=0:00:32
[11/22 05:27:52] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0609 s / img. ETA=0:00:29
[11/22 05:27:55] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0609 s / img. ETA=0:00:26
[11/22 05:27:58] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0608 s / img. ETA=0:00:23
[11/22 05:28:01] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0608 s / img. ETA=0:00:20
[11/22 05:28:04] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0607 s / img. ETA=0:00:17
[11/22 05:28:07] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0607 s / img. ETA=0:00:14
[11/22 05:28:10] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0606 s / img. ETA=0:00:11
[11/22 05:28:13] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0606 s / img. ETA=0:00:08
[11/22 05:28:16] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0606 s / img. ETA=0:00:05
[11/22 05:28:19] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0605 s / img. ETA=0:00:02
[11/22 05:28:21] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 05:28:21] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:11 (0.058100 s / img per device, on 4 devices)
[11/22 05:28:24] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:28:50] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  bird  |  bottle  |  bus   |  car   |  chair  |  cow   |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  train  |  tvmonitor  |  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-----------:|:------:|:------:|:-----------:|:-------:|:------:|
|   83.805    |  86.455   | 84.296 |  73.950  | 87.390 | 88.529 | 67.969  | 83.859 |    73.584     | 84.248 | 88.091  |  86.269  |    55.713     | 83.347  |   82.475    | 28.733 | 71.755 |   72.737    | 68.573  | 50.829 |
[11/22 05:28:50] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.084 | 75.130 | 49.356 | 52.851 | 80.665  | 56.908  | 29.784 | 58.525  | 26.698  |
[11/22 05:28:50] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all3 in csv format:
[11/22 05:28:50] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:28:50] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 05:28:50] defrcn.evaluation.testing INFO: copypaste: 47.0841,75.1304,49.3559,52.8509,80.6654,56.9083,29.7836,58.5254,26.6985
[11/22 05:29:05] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:29:05] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 05:29:05] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel3_2shot_seed3", )
  TEST: ("voc_2007_test_novel3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:29:05] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:29:05] d2.utils.env INFO: Using a generated random seed 8275503
[11/22 05:29:05] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:29:05] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 05:29:05] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 2            |    cat     | 2            | motorbike  | 2            |
|   sheep    | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 05:29:05] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 05:29:05] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 05:29:06] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:29:06] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:29:06] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth ...
[11/22 05:29:06] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 05:29:14] d2.utils.events INFO:  eta: 0:04:23  iter: 19  total_loss: 0.5605  loss_cls: 0.3075  loss_box_reg: 0.165  loss_rpn_cls: 0.03616  loss_rpn_loc: 0.05486  time: 0.2241  data_time: 0.1966  lr: 0.01  max_mem: 5178M
[11/22 05:29:18] d2.utils.events INFO:  eta: 0:04:18  iter: 39  total_loss: 0.3878  loss_cls: 0.1753  loss_box_reg: 0.1428  loss_rpn_cls: 0.02607  loss_rpn_loc: 0.04662  time: 0.2239  data_time: 0.0204  lr: 0.01  max_mem: 5178M
[11/22 05:29:23] d2.utils.events INFO:  eta: 0:04:14  iter: 59  total_loss: 0.2838  loss_cls: 0.105  loss_box_reg: 0.125  loss_rpn_cls: 0.01586  loss_rpn_loc: 0.03009  time: 0.2233  data_time: 0.0224  lr: 0.01  max_mem: 5178M
[11/22 05:29:27] d2.utils.events INFO:  eta: 0:04:09  iter: 79  total_loss: 0.2427  loss_cls: 0.08892  loss_box_reg: 0.1093  loss_rpn_cls: 0.01431  loss_rpn_loc: 0.03169  time: 0.2229  data_time: 0.0245  lr: 0.01  max_mem: 5178M
[11/22 05:29:32] d2.utils.events INFO:  eta: 0:04:04  iter: 99  total_loss: 0.1968  loss_cls: 0.07168  loss_box_reg: 0.08883  loss_rpn_cls: 0.01211  loss_rpn_loc: 0.02984  time: 0.2224  data_time: 0.0227  lr: 0.01  max_mem: 5178M
[11/22 05:29:36] d2.utils.events INFO:  eta: 0:03:59  iter: 119  total_loss: 0.1743  loss_cls: 0.06589  loss_box_reg: 0.07325  loss_rpn_cls: 0.009649  loss_rpn_loc: 0.02658  time: 0.2224  data_time: 0.0215  lr: 0.01  max_mem: 5178M
[11/22 05:29:41] d2.utils.events INFO:  eta: 0:03:55  iter: 139  total_loss: 0.1599  loss_cls: 0.06301  loss_box_reg: 0.06238  loss_rpn_cls: 0.008759  loss_rpn_loc: 0.02275  time: 0.2226  data_time: 0.0220  lr: 0.01  max_mem: 5178M
[11/22 05:29:45] d2.utils.events INFO:  eta: 0:03:51  iter: 159  total_loss: 0.147  loss_cls: 0.057  loss_box_reg: 0.05582  loss_rpn_cls: 0.008565  loss_rpn_loc: 0.02282  time: 0.2225  data_time: 0.0236  lr: 0.01  max_mem: 5178M
[11/22 05:29:49] d2.utils.events INFO:  eta: 0:03:46  iter: 179  total_loss: 0.1365  loss_cls: 0.05255  loss_box_reg: 0.04805  loss_rpn_cls: 0.00659  loss_rpn_loc: 0.02676  time: 0.2222  data_time: 0.0230  lr: 0.01  max_mem: 5178M
[11/22 05:29:54] d2.utils.events INFO:  eta: 0:03:42  iter: 199  total_loss: 0.1229  loss_cls: 0.05043  loss_box_reg: 0.0471  loss_rpn_cls: 0.006441  loss_rpn_loc: 0.01979  time: 0.2224  data_time: 0.0221  lr: 0.01  max_mem: 5178M
[11/22 05:29:58] d2.utils.events INFO:  eta: 0:03:38  iter: 219  total_loss: 0.1252  loss_cls: 0.04886  loss_box_reg: 0.04519  loss_rpn_cls: 0.006039  loss_rpn_loc: 0.02441  time: 0.2224  data_time: 0.0211  lr: 0.01  max_mem: 5178M
[11/22 05:30:03] d2.utils.events INFO:  eta: 0:03:33  iter: 239  total_loss: 0.1202  loss_cls: 0.04757  loss_box_reg: 0.04433  loss_rpn_cls: 0.006329  loss_rpn_loc: 0.01932  time: 0.2225  data_time: 0.0231  lr: 0.01  max_mem: 5178M
[11/22 05:30:07] d2.utils.events INFO:  eta: 0:03:29  iter: 259  total_loss: 0.1098  loss_cls: 0.04631  loss_box_reg: 0.04066  loss_rpn_cls: 0.005177  loss_rpn_loc: 0.01727  time: 0.2225  data_time: 0.0216  lr: 0.01  max_mem: 5178M
[11/22 05:30:12] d2.utils.events INFO:  eta: 0:03:24  iter: 279  total_loss: 0.1131  loss_cls: 0.04546  loss_box_reg: 0.04124  loss_rpn_cls: 0.005098  loss_rpn_loc: 0.01913  time: 0.2224  data_time: 0.0224  lr: 0.01  max_mem: 5178M
[11/22 05:30:16] d2.utils.events INFO:  eta: 0:03:20  iter: 299  total_loss: 0.1146  loss_cls: 0.04392  loss_box_reg: 0.0404  loss_rpn_cls: 0.004633  loss_rpn_loc: 0.02215  time: 0.2225  data_time: 0.0241  lr: 0.01  max_mem: 5178M
[11/22 05:30:21] d2.utils.events INFO:  eta: 0:03:15  iter: 319  total_loss: 0.109  loss_cls: 0.04298  loss_box_reg: 0.03896  loss_rpn_cls: 0.004508  loss_rpn_loc: 0.02028  time: 0.2225  data_time: 0.0228  lr: 0.01  max_mem: 5178M
[11/22 05:30:25] d2.utils.events INFO:  eta: 0:03:11  iter: 339  total_loss: 0.1008  loss_cls: 0.04118  loss_box_reg: 0.03695  loss_rpn_cls: 0.004038  loss_rpn_loc: 0.02088  time: 0.2225  data_time: 0.0255  lr: 0.01  max_mem: 5178M
[11/22 05:30:30] d2.utils.events INFO:  eta: 0:03:06  iter: 359  total_loss: 0.09924  loss_cls: 0.04088  loss_box_reg: 0.0359  loss_rpn_cls: 0.004545  loss_rpn_loc: 0.01918  time: 0.2227  data_time: 0.0227  lr: 0.01  max_mem: 5178M
[11/22 05:30:34] d2.utils.events INFO:  eta: 0:03:02  iter: 379  total_loss: 0.1  loss_cls: 0.04351  loss_box_reg: 0.03777  loss_rpn_cls: 0.004082  loss_rpn_loc: 0.01775  time: 0.2226  data_time: 0.0222  lr: 0.01  max_mem: 5178M
[11/22 05:30:39] d2.utils.events INFO:  eta: 0:02:57  iter: 399  total_loss: 0.1007  loss_cls: 0.03824  loss_box_reg: 0.03324  loss_rpn_cls: 0.004294  loss_rpn_loc: 0.02043  time: 0.2226  data_time: 0.0223  lr: 0.01  max_mem: 5178M
[11/22 05:30:43] d2.utils.events INFO:  eta: 0:02:53  iter: 419  total_loss: 0.09837  loss_cls: 0.03968  loss_box_reg: 0.03365  loss_rpn_cls: 0.004477  loss_rpn_loc: 0.01845  time: 0.2225  data_time: 0.0209  lr: 0.01  max_mem: 5178M
[11/22 05:30:48] d2.utils.events INFO:  eta: 0:02:48  iter: 439  total_loss: 0.09272  loss_cls: 0.03781  loss_box_reg: 0.03176  loss_rpn_cls: 0.003571  loss_rpn_loc: 0.01431  time: 0.2223  data_time: 0.0226  lr: 0.01  max_mem: 5178M
[11/22 05:30:52] d2.utils.events INFO:  eta: 0:02:44  iter: 459  total_loss: 0.09701  loss_cls: 0.04  loss_box_reg: 0.03332  loss_rpn_cls: 0.004192  loss_rpn_loc: 0.01676  time: 0.2222  data_time: 0.0220  lr: 0.01  max_mem: 5178M
[11/22 05:30:56] d2.utils.events INFO:  eta: 0:02:39  iter: 479  total_loss: 0.09245  loss_cls: 0.03802  loss_box_reg: 0.0333  loss_rpn_cls: 0.003433  loss_rpn_loc: 0.01762  time: 0.2222  data_time: 0.0201  lr: 0.01  max_mem: 5178M
[11/22 05:31:01] d2.utils.events INFO:  eta: 0:02:35  iter: 499  total_loss: 0.09337  loss_cls: 0.03991  loss_box_reg: 0.03225  loss_rpn_cls: 0.003577  loss_rpn_loc: 0.0193  time: 0.2222  data_time: 0.0228  lr: 0.01  max_mem: 5178M
[11/22 05:31:05] d2.utils.events INFO:  eta: 0:02:30  iter: 519  total_loss: 0.08965  loss_cls: 0.03623  loss_box_reg: 0.03228  loss_rpn_cls: 0.003755  loss_rpn_loc: 0.01932  time: 0.2222  data_time: 0.0235  lr: 0.01  max_mem: 5178M
[11/22 05:31:10] d2.utils.events INFO:  eta: 0:02:26  iter: 539  total_loss: 0.08621  loss_cls: 0.03732  loss_box_reg: 0.03209  loss_rpn_cls: 0.003489  loss_rpn_loc: 0.01475  time: 0.2222  data_time: 0.0226  lr: 0.01  max_mem: 5178M
[11/22 05:31:14] d2.utils.events INFO:  eta: 0:02:22  iter: 559  total_loss: 0.08525  loss_cls: 0.03571  loss_box_reg: 0.0312  loss_rpn_cls: 0.003014  loss_rpn_loc: 0.01294  time: 0.2222  data_time: 0.0205  lr: 0.01  max_mem: 5178M
[11/22 05:31:19] d2.utils.events INFO:  eta: 0:02:17  iter: 579  total_loss: 0.08394  loss_cls: 0.03627  loss_box_reg: 0.02817  loss_rpn_cls: 0.002995  loss_rpn_loc: 0.01416  time: 0.2221  data_time: 0.0223  lr: 0.01  max_mem: 5178M
[11/22 05:31:23] d2.utils.events INFO:  eta: 0:02:13  iter: 599  total_loss: 0.08423  loss_cls: 0.03711  loss_box_reg: 0.02887  loss_rpn_cls: 0.00346  loss_rpn_loc: 0.01562  time: 0.2221  data_time: 0.0203  lr: 0.01  max_mem: 5178M
[11/22 05:31:28] d2.utils.events INFO:  eta: 0:02:08  iter: 619  total_loss: 0.08538  loss_cls: 0.03589  loss_box_reg: 0.02984  loss_rpn_cls: 0.003387  loss_rpn_loc: 0.01713  time: 0.2221  data_time: 0.0237  lr: 0.01  max_mem: 5178M
[11/22 05:31:32] d2.utils.events INFO:  eta: 0:02:04  iter: 639  total_loss: 0.08583  loss_cls: 0.03575  loss_box_reg: 0.02896  loss_rpn_cls: 0.003487  loss_rpn_loc: 0.01487  time: 0.2222  data_time: 0.0212  lr: 0.01  max_mem: 5178M
[11/22 05:31:37] d2.utils.events INFO:  eta: 0:01:59  iter: 659  total_loss: 0.08372  loss_cls: 0.03386  loss_box_reg: 0.02844  loss_rpn_cls: 0.003208  loss_rpn_loc: 0.01676  time: 0.2221  data_time: 0.0216  lr: 0.01  max_mem: 5178M
[11/22 05:31:41] d2.utils.events INFO:  eta: 0:01:55  iter: 679  total_loss: 0.08412  loss_cls: 0.03527  loss_box_reg: 0.02833  loss_rpn_cls: 0.003499  loss_rpn_loc: 0.01567  time: 0.2223  data_time: 0.0214  lr: 0.01  max_mem: 5178M
[11/22 05:31:46] d2.utils.events INFO:  eta: 0:01:50  iter: 699  total_loss: 0.08251  loss_cls: 0.03426  loss_box_reg: 0.02791  loss_rpn_cls: 0.003072  loss_rpn_loc: 0.0147  time: 0.2222  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:31:50] d2.utils.events INFO:  eta: 0:01:46  iter: 719  total_loss: 0.08051  loss_cls: 0.03523  loss_box_reg: 0.02748  loss_rpn_cls: 0.002784  loss_rpn_loc: 0.01446  time: 0.2223  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:31:54] d2.utils.events INFO:  eta: 0:01:42  iter: 739  total_loss: 0.07794  loss_cls: 0.03384  loss_box_reg: 0.02666  loss_rpn_cls: 0.002794  loss_rpn_loc: 0.01554  time: 0.2223  data_time: 0.0205  lr: 0.01  max_mem: 5178M
[11/22 05:31:59] d2.utils.events INFO:  eta: 0:01:37  iter: 759  total_loss: 0.07899  loss_cls: 0.03488  loss_box_reg: 0.02751  loss_rpn_cls: 0.002759  loss_rpn_loc: 0.01542  time: 0.2222  data_time: 0.0197  lr: 0.01  max_mem: 5178M
[11/22 05:32:03] d2.utils.events INFO:  eta: 0:01:33  iter: 779  total_loss: 0.07664  loss_cls: 0.03345  loss_box_reg: 0.02638  loss_rpn_cls: 0.002343  loss_rpn_loc: 0.01377  time: 0.2223  data_time: 0.0217  lr: 0.01  max_mem: 5178M
[11/22 05:32:08] d2.utils.events INFO:  eta: 0:01:28  iter: 799  total_loss: 0.07742  loss_cls: 0.03329  loss_box_reg: 0.02618  loss_rpn_cls: 0.002793  loss_rpn_loc: 0.0153  time: 0.2223  data_time: 0.0206  lr: 0.01  max_mem: 5178M
[11/22 05:32:12] d2.utils.events INFO:  eta: 0:01:24  iter: 819  total_loss: 0.07693  loss_cls: 0.03252  loss_box_reg: 0.02545  loss_rpn_cls: 0.002902  loss_rpn_loc: 0.01388  time: 0.2223  data_time: 0.0219  lr: 0.01  max_mem: 5178M
[11/22 05:32:17] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.07843  loss_cls: 0.03414  loss_box_reg: 0.0273  loss_rpn_cls: 0.002596  loss_rpn_loc: 0.01264  time: 0.2223  data_time: 0.0228  lr: 0.01  max_mem: 5178M
[11/22 05:32:21] d2.utils.events INFO:  eta: 0:01:15  iter: 859  total_loss: 0.07412  loss_cls: 0.0326  loss_box_reg: 0.02676  loss_rpn_cls: 0.002832  loss_rpn_loc: 0.01288  time: 0.2223  data_time: 0.0209  lr: 0.01  max_mem: 5178M
[11/22 05:32:26] d2.utils.events INFO:  eta: 0:01:11  iter: 879  total_loss: 0.07345  loss_cls: 0.03206  loss_box_reg: 0.02585  loss_rpn_cls: 0.002445  loss_rpn_loc: 0.01136  time: 0.2224  data_time: 0.0225  lr: 0.01  max_mem: 5178M
[11/22 05:32:30] d2.utils.events INFO:  eta: 0:01:06  iter: 899  total_loss: 0.07598  loss_cls: 0.03216  loss_box_reg: 0.02624  loss_rpn_cls: 0.003008  loss_rpn_loc: 0.0124  time: 0.2223  data_time: 0.0204  lr: 0.01  max_mem: 5178M
[11/22 05:32:35] d2.utils.events INFO:  eta: 0:01:02  iter: 919  total_loss: 0.07306  loss_cls: 0.03264  loss_box_reg: 0.02569  loss_rpn_cls: 0.002604  loss_rpn_loc: 0.01155  time: 0.2223  data_time: 0.0194  lr: 0.01  max_mem: 5178M
[11/22 05:32:39] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.07668  loss_cls: 0.03148  loss_box_reg: 0.02582  loss_rpn_cls: 0.002397  loss_rpn_loc: 0.0142  time: 0.2223  data_time: 0.0194  lr: 0.01  max_mem: 5178M
[11/22 05:32:44] d2.utils.events INFO:  eta: 0:00:53  iter: 959  total_loss: 0.07716  loss_cls: 0.03309  loss_box_reg: 0.02402  loss_rpn_cls: 0.002673  loss_rpn_loc: 0.01633  time: 0.2223  data_time: 0.0226  lr: 0.01  max_mem: 5178M
[11/22 05:32:48] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.07078  loss_cls: 0.03137  loss_box_reg: 0.02432  loss_rpn_cls: 0.002468  loss_rpn_loc: 0.01099  time: 0.2223  data_time: 0.0231  lr: 0.001  max_mem: 5178M
[11/22 05:32:52] d2.utils.events INFO:  eta: 0:00:44  iter: 999  total_loss: 0.06538  loss_cls: 0.03039  loss_box_reg: 0.02347  loss_rpn_cls: 0.002503  loss_rpn_loc: 0.008414  time: 0.2222  data_time: 0.0224  lr: 0.001  max_mem: 5178M
[11/22 05:32:57] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.06832  loss_cls: 0.03054  loss_box_reg: 0.02398  loss_rpn_cls: 0.00287  loss_rpn_loc: 0.008057  time: 0.2222  data_time: 0.0207  lr: 0.001  max_mem: 5178M
[11/22 05:33:01] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.06544  loss_cls: 0.03169  loss_box_reg: 0.02277  loss_rpn_cls: 0.002543  loss_rpn_loc: 0.008157  time: 0.2222  data_time: 0.0221  lr: 0.001  max_mem: 5178M
[11/22 05:33:06] d2.utils.events INFO:  eta: 0:00:31  iter: 1059  total_loss: 0.06684  loss_cls: 0.02991  loss_box_reg: 0.02385  loss_rpn_cls: 0.003151  loss_rpn_loc: 0.00775  time: 0.2222  data_time: 0.0196  lr: 0.001  max_mem: 5178M
[11/22 05:33:10] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.0642  loss_cls: 0.02999  loss_box_reg: 0.02363  loss_rpn_cls: 0.002167  loss_rpn_loc: 0.007053  time: 0.2221  data_time: 0.0195  lr: 0.001  max_mem: 5178M
[11/22 05:33:15] d2.utils.events INFO:  eta: 0:00:22  iter: 1099  total_loss: 0.06395  loss_cls: 0.03058  loss_box_reg: 0.02373  loss_rpn_cls: 0.002503  loss_rpn_loc: 0.005974  time: 0.2221  data_time: 0.0219  lr: 0.001  max_mem: 5178M
[11/22 05:33:19] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.06701  loss_cls: 0.03215  loss_box_reg: 0.02439  loss_rpn_cls: 0.002886  loss_rpn_loc: 0.00679  time: 0.2222  data_time: 0.0197  lr: 0.001  max_mem: 5178M
[11/22 05:33:24] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.06578  loss_cls: 0.03158  loss_box_reg: 0.02393  loss_rpn_cls: 0.00266  loss_rpn_loc: 0.007756  time: 0.2222  data_time: 0.0225  lr: 0.001  max_mem: 5178M
[11/22 05:33:28] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.06503  loss_cls: 0.03092  loss_box_reg: 0.02455  loss_rpn_cls: 0.00234  loss_rpn_loc: 0.006205  time: 0.2221  data_time: 0.0183  lr: 0.001  max_mem: 5178M
[11/22 05:33:33] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.06526  loss_cls: 0.03239  loss_box_reg: 0.02353  loss_rpn_cls: 0.002349  loss_rpn_loc: 0.00658  time: 0.2222  data_time: 0.0209  lr: 0.001  max_mem: 5178M
[11/22 05:33:37] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final.pth
[11/22 05:33:39] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.06628  loss_cls: 0.03288  loss_box_reg: 0.02406  loss_rpn_cls: 0.001958  loss_rpn_loc: 0.006368  time: 0.2222  data_time: 0.0202  lr: 0.001  max_mem: 5178M
[11/22 05:33:39] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:26 (0.2222 s / it)
[11/22 05:33:39] d2.engine.hooks INFO: Total training time: 0:04:28 (0:00:02 on hooks)
[11/22 05:33:41] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 393          |    cat     | 370          | motorbike  | 369          |
|   sheep    | 311          |    sofa    | 396          |            |              |
|   total    | 1839         |            |              |            |              |[0m
[11/22 05:33:41] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:33:41] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:33:41] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 05:33:41] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:33:41] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:33:42] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:33:42] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:33:42] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:33:42] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:33:55] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0635 s / img. ETA=0:01:15
[11/22 05:33:58] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0628 s / img. ETA=0:01:11
[11/22 05:34:01] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0627 s / img. ETA=0:01:08
[11/22 05:34:05] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0625 s / img. ETA=0:01:04
[11/22 05:34:08] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0622 s / img. ETA=0:01:01
[11/22 05:34:11] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0621 s / img. ETA=0:00:58
[11/22 05:34:14] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0619 s / img. ETA=0:00:54
[11/22 05:34:17] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0617 s / img. ETA=0:00:51
[11/22 05:34:20] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0616 s / img. ETA=0:00:48
[11/22 05:34:23] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0615 s / img. ETA=0:00:45
[11/22 05:34:26] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0614 s / img. ETA=0:00:42
[11/22 05:34:29] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0614 s / img. ETA=0:00:39
[11/22 05:34:32] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0614 s / img. ETA=0:00:36
[11/22 05:34:35] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0613 s / img. ETA=0:00:32
[11/22 05:34:38] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0613 s / img. ETA=0:00:29
[11/22 05:34:41] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0613 s / img. ETA=0:00:26
[11/22 05:34:44] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0612 s / img. ETA=0:00:23
[11/22 05:34:47] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0612 s / img. ETA=0:00:20
[11/22 05:34:50] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0612 s / img. ETA=0:00:17
[11/22 05:34:53] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0611 s / img. ETA=0:00:14
[11/22 05:34:56] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0611 s / img. ETA=0:00:11
[11/22 05:34:59] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0610 s / img. ETA=0:00:08
[11/22 05:35:02] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0610 s / img. ETA=0:00:05
[11/22 05:35:05] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0609 s / img. ETA=0:00:02
[11/22 05:35:08] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 05:35:08] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.059032 s / img per device, on 4 devices)
[11/22 05:35:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:35:17] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:------:|:------:|:-----------:|:-------:|:------:|
| 32.037 | 69.605 |   71.857    | 54.599  | 45.811 |
[11/22 05:35:17] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 28.202 | 54.782 | 25.643 | 28.202 | 54.782  | 25.643  |
[11/22 05:35:17] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel3 in csv format:
[11/22 05:35:17] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:35:17] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 05:35:17] defrcn.evaluation.testing INFO: copypaste: 28.2022,54.7819,25.6433,28.2022,54.7819,25.6433
[11/22 05:35:33] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:35:33] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3'], resume=False, start_iter=-1)
[11/22 05:35:33] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all3_2shot_seed3", )
  TEST: ("voc_2007_test_all3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:35:33] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:35:33] d2.utils.env INFO: Using a generated random seed 36834445
[11/22 05:35:34] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:35:34] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth ...
[11/22 05:35:36] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 311          |  bicycle   | 389          |    bird     | 576          |
|   bottle    | 657          |    bus     | 254          |     car     | 1541         |
|    chair    | 1374         |    cow     | 329          | diningtable | 299          |
|     dog     | 530          |   horse    | 395          |   person    | 5227         |
| pottedplant | 592          |   train    | 302          |  tvmonitor  | 361          |
|    boat     | 393          |    cat     | 370          |  motorbike  | 369          |
|    sheep    | 311          |    sofa    | 396          |             |              |
|    total    | 14976        |            |              |             |              |[0m
[11/22 05:35:36] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:35:36] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:35:36] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 05:35:36] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:35:36] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:35:37] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 2            |  bicycle   | 2            |    bird     | 2            |
|   bottle    | 2            |    bus     | 2            |     car     | 2            |
|    chair    | 2            |    cow     | 2            | diningtable | 2            |
|     dog     | 2            |   horse    | 2            |   person    | 2            |
| pottedplant | 2            |   train    | 2            |  tvmonitor  | 2            |
|    boat     | 2            |    cat     | 2            |  motorbike  | 2            |
|    sheep    | 2            |    sofa    | 2            |             |              |
|    total    | 40           |            |              |             |              |[0m
[11/22 05:35:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:35:37] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 05:35:37] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 05:35:38] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:35:51] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0630 s / img. ETA=0:01:14
[11/22 05:35:55] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0622 s / img. ETA=0:01:10
[11/22 05:35:58] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0622 s / img. ETA=0:01:07
[11/22 05:36:01] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0622 s / img. ETA=0:01:04
[11/22 05:36:04] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0621 s / img. ETA=0:01:01
[11/22 05:36:07] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0620 s / img. ETA=0:00:58
[11/22 05:36:10] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0619 s / img. ETA=0:00:54
[11/22 05:36:13] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0618 s / img. ETA=0:00:51
[11/22 05:36:16] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0621 s / img. ETA=0:00:48
[11/22 05:36:19] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0620 s / img. ETA=0:00:45
[11/22 05:36:22] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0620 s / img. ETA=0:00:42
[11/22 05:36:26] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0620 s / img. ETA=0:00:39
[11/22 05:36:29] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0620 s / img. ETA=0:00:36
[11/22 05:36:32] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0620 s / img. ETA=0:00:33
[11/22 05:36:35] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0619 s / img. ETA=0:00:30
[11/22 05:36:38] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0618 s / img. ETA=0:00:27
[11/22 05:36:41] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0618 s / img. ETA=0:00:23
[11/22 05:36:44] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0618 s / img. ETA=0:00:20
[11/22 05:36:47] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0617 s / img. ETA=0:00:17
[11/22 05:36:50] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0616 s / img. ETA=0:00:14
[11/22 05:36:53] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0615 s / img. ETA=0:00:11
[11/22 05:36:56] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0615 s / img. ETA=0:00:08
[11/22 05:36:59] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0615 s / img. ETA=0:00:05
[11/22 05:37:02] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0614 s / img. ETA=0:00:02
[11/22 05:37:05] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 05:37:05] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.058904 s / img per device, on 4 devices)
[11/22 05:37:10] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:37:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  bird  |  bottle  |  bus   |  car   |  chair  |  cow   |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  train  |  tvmonitor  |  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-----------:|:------:|:------:|:-----------:|:-------:|:------:|
|   84.315    |  86.702   | 83.537 |  75.056  | 86.957 | 88.609 | 68.824  | 83.593 |    73.068     | 84.685 | 88.293  |  86.158  |    56.864     | 83.641  |   82.601    | 30.540 | 73.636 |   72.514    | 69.409  | 48.968 |
[11/22 05:37:36] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.404 | 75.398 | 49.851 | 53.184 | 80.860  | 57.363  | 30.067 | 59.013  | 27.313  |
[11/22 05:37:36] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all3 in csv format:
[11/22 05:37:36] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:37:36] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 05:37:36] defrcn.evaluation.testing INFO: copypaste: 47.4044,75.3984,49.8506,53.1837,80.8601,57.3631,30.0665,59.0135,27.3131
[11/22 05:37:51] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:37:51] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/22 05:37:51] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_fsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 5
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_novel3_2shot_seed3", )
  TEST: ("voc_2007_test_novel3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (960,)
  MAX_ITER: 1200
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:37:51] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:37:51] d2.utils.env INFO: Using a generated random seed 54552158
[11/22 05:37:51] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:37:52] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 10 images left.
[11/22 05:37:52] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 2            |    cat     | 2            | motorbike  | 2            |
|   sheep    | 2            |    sofa    | 2            |            |              |
|   total    | 10           |            |              |            |              |[0m
[11/22 05:37:52] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/22 05:37:52] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/22 05:37:52] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:37:52] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:37:52] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_det_r101_base3/model_final-remove.pth ...
[11/22 05:37:52] d2.engine.train_loop INFO: Starting training from iteration 0
[11/22 05:38:00] d2.utils.events INFO:  eta: 0:04:22  iter: 19  total_loss: 0.583  loss_cls: 0.3368  loss_box_reg: 0.165  loss_rpn_cls: 0.03956  loss_rpn_loc: 0.05444  time: 0.2236  data_time: 0.1932  lr: 0.01  max_mem: 5178M
[11/22 05:38:04] d2.utils.events INFO:  eta: 0:04:18  iter: 39  total_loss: 0.3857  loss_cls: 0.1763  loss_box_reg: 0.1473  loss_rpn_cls: 0.02402  loss_rpn_loc: 0.0377  time: 0.2226  data_time: 0.0211  lr: 0.01  max_mem: 5178M
[11/22 05:38:09] d2.utils.events INFO:  eta: 0:04:13  iter: 59  total_loss: 0.2998  loss_cls: 0.112  loss_box_reg: 0.1271  loss_rpn_cls: 0.01741  loss_rpn_loc: 0.03288  time: 0.2219  data_time: 0.0222  lr: 0.01  max_mem: 5178M
[11/22 05:38:13] d2.utils.events INFO:  eta: 0:04:08  iter: 79  total_loss: 0.2356  loss_cls: 0.08361  loss_box_reg: 0.1085  loss_rpn_cls: 0.01299  loss_rpn_loc: 0.0286  time: 0.2213  data_time: 0.0211  lr: 0.01  max_mem: 5178M
[11/22 05:38:18] d2.utils.events INFO:  eta: 0:04:04  iter: 99  total_loss: 0.1964  loss_cls: 0.07206  loss_box_reg: 0.08572  loss_rpn_cls: 0.01117  loss_rpn_loc: 0.02661  time: 0.2214  data_time: 0.0205  lr: 0.01  max_mem: 5178M
[11/22 05:38:22] d2.utils.events INFO:  eta: 0:03:59  iter: 119  total_loss: 0.1729  loss_cls: 0.06488  loss_box_reg: 0.07189  loss_rpn_cls: 0.009119  loss_rpn_loc: 0.02393  time: 0.2210  data_time: 0.0223  lr: 0.01  max_mem: 5178M
[11/22 05:38:27] d2.utils.events INFO:  eta: 0:03:54  iter: 139  total_loss: 0.1608  loss_cls: 0.06073  loss_box_reg: 0.06147  loss_rpn_cls: 0.009028  loss_rpn_loc: 0.02792  time: 0.2211  data_time: 0.0211  lr: 0.01  max_mem: 5178M
[11/22 05:38:31] d2.utils.events INFO:  eta: 0:03:50  iter: 159  total_loss: 0.1476  loss_cls: 0.05638  loss_box_reg: 0.05452  loss_rpn_cls: 0.008408  loss_rpn_loc: 0.02478  time: 0.2212  data_time: 0.0200  lr: 0.01  max_mem: 5178M
[11/22 05:38:35] d2.utils.events INFO:  eta: 0:03:45  iter: 179  total_loss: 0.1422  loss_cls: 0.05556  loss_box_reg: 0.05228  loss_rpn_cls: 0.008655  loss_rpn_loc: 0.02756  time: 0.2211  data_time: 0.0221  lr: 0.01  max_mem: 5178M
[11/22 05:38:40] d2.utils.events INFO:  eta: 0:03:41  iter: 199  total_loss: 0.1272  loss_cls: 0.05434  loss_box_reg: 0.04976  loss_rpn_cls: 0.006208  loss_rpn_loc: 0.01874  time: 0.2212  data_time: 0.0218  lr: 0.01  max_mem: 5178M
[11/22 05:38:44] d2.utils.events INFO:  eta: 0:03:36  iter: 219  total_loss: 0.1266  loss_cls: 0.05015  loss_box_reg: 0.04486  loss_rpn_cls: 0.006404  loss_rpn_loc: 0.02074  time: 0.2210  data_time: 0.0206  lr: 0.01  max_mem: 5178M
[11/22 05:38:49] d2.utils.events INFO:  eta: 0:03:32  iter: 239  total_loss: 0.123  loss_cls: 0.05161  loss_box_reg: 0.04413  loss_rpn_cls: 0.00516  loss_rpn_loc: 0.02017  time: 0.2211  data_time: 0.0197  lr: 0.01  max_mem: 5178M
[11/22 05:38:53] d2.utils.events INFO:  eta: 0:03:27  iter: 259  total_loss: 0.1119  loss_cls: 0.04783  loss_box_reg: 0.04214  loss_rpn_cls: 0.004908  loss_rpn_loc: 0.0191  time: 0.2210  data_time: 0.0184  lr: 0.01  max_mem: 5178M
[11/22 05:38:58] d2.utils.events INFO:  eta: 0:03:23  iter: 279  total_loss: 0.1108  loss_cls: 0.0452  loss_box_reg: 0.04044  loss_rpn_cls: 0.004849  loss_rpn_loc: 0.02045  time: 0.2209  data_time: 0.0207  lr: 0.01  max_mem: 5178M
[11/22 05:39:02] d2.utils.events INFO:  eta: 0:03:18  iter: 299  total_loss: 0.1098  loss_cls: 0.0451  loss_box_reg: 0.04031  loss_rpn_cls: 0.004436  loss_rpn_loc: 0.01799  time: 0.2209  data_time: 0.0210  lr: 0.01  max_mem: 5178M
[11/22 05:39:07] d2.utils.events INFO:  eta: 0:03:14  iter: 319  total_loss: 0.1046  loss_cls: 0.04353  loss_box_reg: 0.03577  loss_rpn_cls: 0.004436  loss_rpn_loc: 0.0191  time: 0.2209  data_time: 0.0189  lr: 0.01  max_mem: 5178M
[11/22 05:39:11] d2.utils.events INFO:  eta: 0:03:10  iter: 339  total_loss: 0.09931  loss_cls: 0.04073  loss_box_reg: 0.03604  loss_rpn_cls: 0.004565  loss_rpn_loc: 0.01929  time: 0.2211  data_time: 0.0202  lr: 0.01  max_mem: 5178M
[11/22 05:39:15] d2.utils.events INFO:  eta: 0:03:05  iter: 359  total_loss: 0.09822  loss_cls: 0.0411  loss_box_reg: 0.03272  loss_rpn_cls: 0.003731  loss_rpn_loc: 0.01999  time: 0.2211  data_time: 0.0211  lr: 0.01  max_mem: 5178M
[11/22 05:39:20] d2.utils.events INFO:  eta: 0:03:01  iter: 379  total_loss: 0.1003  loss_cls: 0.03991  loss_box_reg: 0.03342  loss_rpn_cls: 0.004049  loss_rpn_loc: 0.0205  time: 0.2211  data_time: 0.0203  lr: 0.01  max_mem: 5178M
[11/22 05:39:24] d2.utils.events INFO:  eta: 0:02:56  iter: 399  total_loss: 0.1019  loss_cls: 0.04082  loss_box_reg: 0.03506  loss_rpn_cls: 0.003801  loss_rpn_loc: 0.02086  time: 0.2210  data_time: 0.0214  lr: 0.01  max_mem: 5178M
[11/22 05:39:29] d2.utils.events INFO:  eta: 0:02:52  iter: 419  total_loss: 0.09689  loss_cls: 0.03884  loss_box_reg: 0.03504  loss_rpn_cls: 0.003919  loss_rpn_loc: 0.01617  time: 0.2210  data_time: 0.0201  lr: 0.01  max_mem: 5178M
[11/22 05:39:33] d2.utils.events INFO:  eta: 0:02:47  iter: 439  total_loss: 0.09568  loss_cls: 0.03899  loss_box_reg: 0.03341  loss_rpn_cls: 0.004318  loss_rpn_loc: 0.01873  time: 0.2209  data_time: 0.0206  lr: 0.01  max_mem: 5178M
[11/22 05:39:38] d2.utils.events INFO:  eta: 0:02:43  iter: 459  total_loss: 0.09272  loss_cls: 0.03714  loss_box_reg: 0.03259  loss_rpn_cls: 0.004059  loss_rpn_loc: 0.01887  time: 0.2209  data_time: 0.0201  lr: 0.01  max_mem: 5178M
[11/22 05:39:42] d2.utils.events INFO:  eta: 0:02:39  iter: 479  total_loss: 0.08899  loss_cls: 0.03949  loss_box_reg: 0.03163  loss_rpn_cls: 0.003769  loss_rpn_loc: 0.01578  time: 0.2210  data_time: 0.0205  lr: 0.01  max_mem: 5178M
[11/22 05:39:46] d2.utils.events INFO:  eta: 0:02:34  iter: 499  total_loss: 0.09322  loss_cls: 0.03896  loss_box_reg: 0.03209  loss_rpn_cls: 0.003278  loss_rpn_loc: 0.0163  time: 0.2210  data_time: 0.0206  lr: 0.01  max_mem: 5178M
[11/22 05:39:51] d2.utils.events INFO:  eta: 0:02:30  iter: 519  total_loss: 0.09225  loss_cls: 0.037  loss_box_reg: 0.02973  loss_rpn_cls: 0.003515  loss_rpn_loc: 0.01774  time: 0.2211  data_time: 0.0223  lr: 0.01  max_mem: 5178M
[11/22 05:39:55] d2.utils.events INFO:  eta: 0:02:25  iter: 539  total_loss: 0.08508  loss_cls: 0.03537  loss_box_reg: 0.0293  loss_rpn_cls: 0.00409  loss_rpn_loc: 0.01547  time: 0.2211  data_time: 0.0207  lr: 0.01  max_mem: 5178M
[11/22 05:40:00] d2.utils.events INFO:  eta: 0:02:21  iter: 559  total_loss: 0.08419  loss_cls: 0.03521  loss_box_reg: 0.02755  loss_rpn_cls: 0.003779  loss_rpn_loc: 0.01559  time: 0.2212  data_time: 0.0203  lr: 0.01  max_mem: 5178M
[11/22 05:40:04] d2.utils.events INFO:  eta: 0:02:17  iter: 579  total_loss: 0.08462  loss_cls: 0.03559  loss_box_reg: 0.0299  loss_rpn_cls: 0.003695  loss_rpn_loc: 0.01565  time: 0.2212  data_time: 0.0198  lr: 0.01  max_mem: 5178M
[11/22 05:40:09] d2.utils.events INFO:  eta: 0:02:12  iter: 599  total_loss: 0.08534  loss_cls: 0.03703  loss_box_reg: 0.02969  loss_rpn_cls: 0.003454  loss_rpn_loc: 0.01443  time: 0.2212  data_time: 0.0195  lr: 0.01  max_mem: 5178M
[11/22 05:40:13] d2.utils.events INFO:  eta: 0:02:08  iter: 619  total_loss: 0.08543  loss_cls: 0.03569  loss_box_reg: 0.02953  loss_rpn_cls: 0.002783  loss_rpn_loc: 0.01488  time: 0.2213  data_time: 0.0197  lr: 0.01  max_mem: 5178M
[11/22 05:40:18] d2.utils.events INFO:  eta: 0:02:03  iter: 639  total_loss: 0.08168  loss_cls: 0.0347  loss_box_reg: 0.02862  loss_rpn_cls: 0.002765  loss_rpn_loc: 0.0139  time: 0.2213  data_time: 0.0190  lr: 0.01  max_mem: 5178M
[11/22 05:40:22] d2.utils.events INFO:  eta: 0:01:59  iter: 659  total_loss: 0.0809  loss_cls: 0.03527  loss_box_reg: 0.02738  loss_rpn_cls: 0.003171  loss_rpn_loc: 0.01726  time: 0.2214  data_time: 0.0217  lr: 0.01  max_mem: 5178M
[11/22 05:40:27] d2.utils.events INFO:  eta: 0:01:55  iter: 679  total_loss: 0.08363  loss_cls: 0.03377  loss_box_reg: 0.02711  loss_rpn_cls: 0.003316  loss_rpn_loc: 0.01625  time: 0.2214  data_time: 0.0196  lr: 0.01  max_mem: 5178M
[11/22 05:40:31] d2.utils.events INFO:  eta: 0:01:50  iter: 699  total_loss: 0.07996  loss_cls: 0.03397  loss_box_reg: 0.02816  loss_rpn_cls: 0.003606  loss_rpn_loc: 0.01659  time: 0.2214  data_time: 0.0190  lr: 0.01  max_mem: 5178M
[11/22 05:40:36] d2.utils.events INFO:  eta: 0:01:46  iter: 719  total_loss: 0.08023  loss_cls: 0.03369  loss_box_reg: 0.02741  loss_rpn_cls: 0.002993  loss_rpn_loc: 0.01584  time: 0.2214  data_time: 0.0208  lr: 0.01  max_mem: 5178M
[11/22 05:40:40] d2.utils.events INFO:  eta: 0:01:41  iter: 739  total_loss: 0.08055  loss_cls: 0.03377  loss_box_reg: 0.02715  loss_rpn_cls: 0.003131  loss_rpn_loc: 0.01481  time: 0.2214  data_time: 0.0206  lr: 0.01  max_mem: 5178M
[11/22 05:40:44] d2.utils.events INFO:  eta: 0:01:37  iter: 759  total_loss: 0.07726  loss_cls: 0.033  loss_box_reg: 0.02481  loss_rpn_cls: 0.003145  loss_rpn_loc: 0.01348  time: 0.2213  data_time: 0.0200  lr: 0.01  max_mem: 5178M
[11/22 05:40:49] d2.utils.events INFO:  eta: 0:01:32  iter: 779  total_loss: 0.0782  loss_cls: 0.03374  loss_box_reg: 0.02632  loss_rpn_cls: 0.003313  loss_rpn_loc: 0.01605  time: 0.2213  data_time: 0.0208  lr: 0.01  max_mem: 5178M
[11/22 05:40:53] d2.utils.events INFO:  eta: 0:01:28  iter: 799  total_loss: 0.08263  loss_cls: 0.03289  loss_box_reg: 0.02657  loss_rpn_cls: 0.003058  loss_rpn_loc: 0.0154  time: 0.2214  data_time: 0.0199  lr: 0.01  max_mem: 5178M
[11/22 05:40:58] d2.utils.events INFO:  eta: 0:01:24  iter: 819  total_loss: 0.07679  loss_cls: 0.0331  loss_box_reg: 0.02593  loss_rpn_cls: 0.002994  loss_rpn_loc: 0.01759  time: 0.2214  data_time: 0.0212  lr: 0.01  max_mem: 5178M
[11/22 05:41:02] d2.utils.events INFO:  eta: 0:01:19  iter: 839  total_loss: 0.07943  loss_cls: 0.03272  loss_box_reg: 0.02584  loss_rpn_cls: 0.003293  loss_rpn_loc: 0.01484  time: 0.2213  data_time: 0.0188  lr: 0.01  max_mem: 5178M
[11/22 05:41:07] d2.utils.events INFO:  eta: 0:01:15  iter: 859  total_loss: 0.07824  loss_cls: 0.03325  loss_box_reg: 0.02616  loss_rpn_cls: 0.003143  loss_rpn_loc: 0.01505  time: 0.2214  data_time: 0.0203  lr: 0.01  max_mem: 5178M
[11/22 05:41:11] d2.utils.events INFO:  eta: 0:01:10  iter: 879  total_loss: 0.07825  loss_cls: 0.03244  loss_box_reg: 0.02527  loss_rpn_cls: 0.00313  loss_rpn_loc: 0.01407  time: 0.2214  data_time: 0.0194  lr: 0.01  max_mem: 5178M
[11/22 05:41:16] d2.utils.events INFO:  eta: 0:01:06  iter: 899  total_loss: 0.07259  loss_cls: 0.03169  loss_box_reg: 0.02443  loss_rpn_cls: 0.002918  loss_rpn_loc: 0.01466  time: 0.2213  data_time: 0.0201  lr: 0.01  max_mem: 5178M
[11/22 05:41:20] d2.utils.events INFO:  eta: 0:01:01  iter: 919  total_loss: 0.07401  loss_cls: 0.03165  loss_box_reg: 0.02544  loss_rpn_cls: 0.002759  loss_rpn_loc: 0.01479  time: 0.2213  data_time: 0.0216  lr: 0.01  max_mem: 5178M
[11/22 05:41:24] d2.utils.events INFO:  eta: 0:00:57  iter: 939  total_loss: 0.0756  loss_cls: 0.03039  loss_box_reg: 0.0239  loss_rpn_cls: 0.002748  loss_rpn_loc: 0.01444  time: 0.2213  data_time: 0.0201  lr: 0.01  max_mem: 5178M
[11/22 05:41:29] d2.utils.events INFO:  eta: 0:00:53  iter: 959  total_loss: 0.07515  loss_cls: 0.032  loss_box_reg: 0.02403  loss_rpn_cls: 0.003007  loss_rpn_loc: 0.01392  time: 0.2215  data_time: 0.0198  lr: 0.01  max_mem: 5178M
[11/22 05:41:34] d2.utils.events INFO:  eta: 0:00:48  iter: 979  total_loss: 0.06753  loss_cls: 0.03115  loss_box_reg: 0.02478  loss_rpn_cls: 0.002854  loss_rpn_loc: 0.01121  time: 0.2215  data_time: 0.0191  lr: 0.001  max_mem: 5178M
[11/22 05:41:38] d2.utils.events INFO:  eta: 0:00:44  iter: 999  total_loss: 0.06762  loss_cls: 0.0311  loss_box_reg: 0.02344  loss_rpn_cls: 0.002471  loss_rpn_loc: 0.008009  time: 0.2215  data_time: 0.0194  lr: 0.001  max_mem: 5178M
[11/22 05:41:42] d2.utils.events INFO:  eta: 0:00:39  iter: 1019  total_loss: 0.06676  loss_cls: 0.03106  loss_box_reg: 0.02392  loss_rpn_cls: 0.002655  loss_rpn_loc: 0.008291  time: 0.2215  data_time: 0.0219  lr: 0.001  max_mem: 5178M
[11/22 05:41:47] d2.utils.events INFO:  eta: 0:00:35  iter: 1039  total_loss: 0.06346  loss_cls: 0.03099  loss_box_reg: 0.02264  loss_rpn_cls: 0.002666  loss_rpn_loc: 0.008067  time: 0.2215  data_time: 0.0200  lr: 0.001  max_mem: 5178M
[11/22 05:41:51] d2.utils.events INFO:  eta: 0:00:30  iter: 1059  total_loss: 0.06713  loss_cls: 0.03133  loss_box_reg: 0.02344  loss_rpn_cls: 0.002481  loss_rpn_loc: 0.007247  time: 0.2215  data_time: 0.0187  lr: 0.001  max_mem: 5178M
[11/22 05:41:56] d2.utils.events INFO:  eta: 0:00:26  iter: 1079  total_loss: 0.06611  loss_cls: 0.03187  loss_box_reg: 0.02353  loss_rpn_cls: 0.002385  loss_rpn_loc: 0.007427  time: 0.2215  data_time: 0.0190  lr: 0.001  max_mem: 5178M
[11/22 05:42:00] d2.utils.events INFO:  eta: 0:00:22  iter: 1099  total_loss: 0.06553  loss_cls: 0.03391  loss_box_reg: 0.02381  loss_rpn_cls: 0.002478  loss_rpn_loc: 0.005687  time: 0.2215  data_time: 0.0198  lr: 0.001  max_mem: 5178M
[11/22 05:42:05] d2.utils.events INFO:  eta: 0:00:17  iter: 1119  total_loss: 0.06452  loss_cls: 0.03173  loss_box_reg: 0.02335  loss_rpn_cls: 0.00215  loss_rpn_loc: 0.008144  time: 0.2215  data_time: 0.0204  lr: 0.001  max_mem: 5178M
[11/22 05:42:09] d2.utils.events INFO:  eta: 0:00:13  iter: 1139  total_loss: 0.06705  loss_cls: 0.03222  loss_box_reg: 0.02365  loss_rpn_cls: 0.002648  loss_rpn_loc: 0.007244  time: 0.2215  data_time: 0.0197  lr: 0.001  max_mem: 5178M
[11/22 05:42:14] d2.utils.events INFO:  eta: 0:00:08  iter: 1159  total_loss: 0.06888  loss_cls: 0.03284  loss_box_reg: 0.02436  loss_rpn_cls: 0.002325  loss_rpn_loc: 0.007213  time: 0.2215  data_time: 0.0218  lr: 0.001  max_mem: 5178M
[11/22 05:42:18] d2.utils.events INFO:  eta: 0:00:04  iter: 1179  total_loss: 0.06544  loss_cls: 0.03138  loss_box_reg: 0.02367  loss_rpn_cls: 0.002673  loss_rpn_loc: 0.006288  time: 0.2214  data_time: 0.0199  lr: 0.001  max_mem: 5178M
[11/22 05:42:22] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final.pth
[11/22 05:42:24] d2.utils.events INFO:  eta: 0:00:00  iter: 1199  total_loss: 0.06505  loss_cls: 0.03256  loss_box_reg: 0.02327  loss_rpn_cls: 0.002041  loss_rpn_loc: 0.005223  time: 0.2214  data_time: 0.0218  lr: 0.001  max_mem: 5178M
[11/22 05:42:24] d2.engine.hooks INFO: Overall training speed: 1198 iterations in 0:04:25 (0.2215 s / it)
[11/22 05:42:24] d2.engine.hooks INFO: Total training time: 0:04:28 (0:00:02 on hooks)
[11/22 05:42:26] defrcn.dataloader.build INFO: Distribution of instances among all 5 categories:
[36m|  category  | #instances   |  category  | #instances   |  category  | #instances   |
|:----------:|:-------------|:----------:|:-------------|:----------:|:-------------|
|    boat    | 393          |    cat     | 370          | motorbike  | 369          |
|   sheep    | 311          |    sofa    | 396          |            |              |
|   total    | 1839         |            |              |            |              |[0m
[11/22 05:42:26] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:42:26] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:42:26] d2.data.common INFO: Serialized dataset takes 1.28 MiB
[11/22 05:42:26] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:42:26] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:42:27] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:42:27] d2.data.common INFO: Serializing 10 elements to byte tensors and concatenating them all ...
[11/22 05:42:27] d2.data.common INFO: Serialized dataset takes 0.00 MiB
[11/22 05:42:28] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:42:41] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0628 s / img. ETA=0:01:14
[11/22 05:42:44] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0624 s / img. ETA=0:01:11
[11/22 05:42:47] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0627 s / img. ETA=0:01:08
[11/22 05:42:50] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0626 s / img. ETA=0:01:04
[11/22 05:42:53] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0623 s / img. ETA=0:01:01
[11/22 05:42:56] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0622 s / img. ETA=0:00:58
[11/22 05:42:59] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0620 s / img. ETA=0:00:55
[11/22 05:43:02] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0618 s / img. ETA=0:00:51
[11/22 05:43:05] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0618 s / img. ETA=0:00:48
[11/22 05:43:08] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0617 s / img. ETA=0:00:45
[11/22 05:43:11] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0617 s / img. ETA=0:00:42
[11/22 05:43:15] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0617 s / img. ETA=0:00:39
[11/22 05:43:18] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0616 s / img. ETA=0:00:36
[11/22 05:43:21] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0616 s / img. ETA=0:00:33
[11/22 05:43:24] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0615 s / img. ETA=0:00:30
[11/22 05:43:27] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0614 s / img. ETA=0:00:26
[11/22 05:43:30] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0613 s / img. ETA=0:00:23
[11/22 05:43:33] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0613 s / img. ETA=0:00:20
[11/22 05:43:36] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0612 s / img. ETA=0:00:17
[11/22 05:43:39] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0612 s / img. ETA=0:00:14
[11/22 05:43:42] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0611 s / img. ETA=0:00:11
[11/22 05:43:45] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0610 s / img. ETA=0:00:08
[11/22 05:43:48] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0609 s / img. ETA=0:00:05
[11/22 05:43:51] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0609 s / img. ETA=0:00:02
[11/22 05:43:53] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:15 (0.060827 s / img per device, on 4 devices)
[11/22 05:43:53] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:12 (0.059028 s / img per device, on 4 devices)
[11/22 05:43:54] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_novel3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:44:01] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:------:|:------:|:-----------:|:-------:|:------:|
| 34.154 | 69.013 |   72.109    | 54.490  | 45.878 |
[11/22 05:44:01] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|
| 28.620 | 55.129 | 27.867 | 28.620 | 55.129  | 27.867  |
[11/22 05:44:01] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_novel3 in csv format:
[11/22 05:44:01] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:44:01] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,nAP,nAP50,nAP75
[11/22 05:44:01] defrcn.evaluation.testing INFO: copypaste: 28.6202,55.1288,27.8668,28.6202,55.1288,27.8668
[11/22 05:44:17] detectron2 INFO: Rank of current process: 0. World size: 4
[11/22 05:44:17] detectron2 INFO: Command line arguments: Namespace(config_file='configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3'], resume=False, start_iter=-1)
[11/22 05:44:17] detectron2 INFO: Contents of args.config_file=configs/voc/defrcn_gfsod_r101_novel3_2shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.001
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
INPUT:
  MIN_SIZE_TRAIN: (480, 512, 544, 576, 608, 640, 672, 704, 736, 768, 800)
  MIN_SIZE_TEST: 800
DATASETS:
  TRAIN: ("voc_2007_trainval_all3_2shot_seed3", )
  TEST: ("voc_2007_test_all3",)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1200,)
  MAX_ITER: 1500
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/22 05:44:17] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/config.yaml
[11/22 05:44:17] d2.utils.env INFO: Using a generated random seed 20857137
[11/22 05:44:18] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/22 05:44:18] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/voc/ebm/defrcn_gfsod_r101_novel3/tfa-like/2shot_seed3/model_final-merge.pth ...
[11/22 05:44:19] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 311          |  bicycle   | 389          |    bird     | 576          |
|   bottle    | 657          |    bus     | 254          |     car     | 1541         |
|    chair    | 1374         |    cow     | 329          | diningtable | 299          |
|     dog     | 530          |   horse    | 395          |   person    | 5227         |
| pottedplant | 592          |   train    | 302          |  tvmonitor  | 361          |
|    boat     | 393          |    cat     | 370          |  motorbike  | 369          |
|    sheep    | 311          |    sofa    | 396          |             |              |
|    total    | 14976        |            |              |             |              |[0m
[11/22 05:44:19] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:44:19] d2.data.common INFO: Serializing 4952 elements to byte tensors and concatenating them all ...
[11/22 05:44:19] d2.data.common INFO: Serialized dataset takes 2.22 MiB
[11/22 05:44:19] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/22 05:44:19] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/22 05:44:20] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|  category   | #instances   |  category  | #instances   |  category   | #instances   |
|:-----------:|:-------------|:----------:|:-------------|:-----------:|:-------------|
|  aeroplane  | 2            |  bicycle   | 2            |    bird     | 2            |
|   bottle    | 2            |    bus     | 2            |     car     | 2            |
|    chair    | 2            |    cow     | 2            | diningtable | 2            |
|     dog     | 2            |   horse    | 2            |   person    | 2            |
| pottedplant | 2            |   train    | 2            |  tvmonitor  | 2            |
|    boat     | 2            |    cat     | 2            |  motorbike  | 2            |
|    sheep    | 2            |    sofa    | 2            |             |              |
|    total    | 40           |            |              |             |              |[0m
[11/22 05:44:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/22 05:44:20] d2.data.common INFO: Serializing 40 elements to byte tensors and concatenating them all ...
[11/22 05:44:20] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/22 05:44:22] defrcn.evaluation.evaluator INFO: Start inference on 1238 images
[11/22 05:44:35] defrcn.evaluation.evaluator INFO: Inference done 50/1238. 0.0619 s / img. ETA=0:01:13
[11/22 05:44:38] defrcn.evaluation.evaluator INFO: Inference done 100/1238. 0.0618 s / img. ETA=0:01:10
[11/22 05:44:41] defrcn.evaluation.evaluator INFO: Inference done 150/1238. 0.0616 s / img. ETA=0:01:07
[11/22 05:44:44] defrcn.evaluation.evaluator INFO: Inference done 200/1238. 0.0615 s / img. ETA=0:01:03
[11/22 05:44:47] defrcn.evaluation.evaluator INFO: Inference done 250/1238. 0.0616 s / img. ETA=0:01:00
[11/22 05:44:51] defrcn.evaluation.evaluator INFO: Inference done 300/1238. 0.0617 s / img. ETA=0:00:57
[11/22 05:44:54] defrcn.evaluation.evaluator INFO: Inference done 350/1238. 0.0613 s / img. ETA=0:00:54
[11/22 05:44:56] defrcn.evaluation.evaluator INFO: Inference done 400/1238. 0.0610 s / img. ETA=0:00:51
[11/22 05:44:59] defrcn.evaluation.evaluator INFO: Inference done 450/1238. 0.0609 s / img. ETA=0:00:47
[11/22 05:45:02] defrcn.evaluation.evaluator INFO: Inference done 500/1238. 0.0607 s / img. ETA=0:00:44
[11/22 05:45:05] defrcn.evaluation.evaluator INFO: Inference done 550/1238. 0.0607 s / img. ETA=0:00:41
[11/22 05:45:08] defrcn.evaluation.evaluator INFO: Inference done 600/1238. 0.0607 s / img. ETA=0:00:38
[11/22 05:45:11] defrcn.evaluation.evaluator INFO: Inference done 650/1238. 0.0606 s / img. ETA=0:00:35
[11/22 05:45:14] defrcn.evaluation.evaluator INFO: Inference done 700/1238. 0.0605 s / img. ETA=0:00:32
[11/22 05:45:17] defrcn.evaluation.evaluator INFO: Inference done 750/1238. 0.0604 s / img. ETA=0:00:29
[11/22 05:45:20] defrcn.evaluation.evaluator INFO: Inference done 800/1238. 0.0603 s / img. ETA=0:00:26
[11/22 05:45:23] defrcn.evaluation.evaluator INFO: Inference done 850/1238. 0.0603 s / img. ETA=0:00:23
[11/22 05:45:26] defrcn.evaluation.evaluator INFO: Inference done 900/1238. 0.0603 s / img. ETA=0:00:20
[11/22 05:45:29] defrcn.evaluation.evaluator INFO: Inference done 950/1238. 0.0602 s / img. ETA=0:00:17
[11/22 05:45:32] defrcn.evaluation.evaluator INFO: Inference done 1000/1238. 0.0601 s / img. ETA=0:00:14
[11/22 05:45:35] defrcn.evaluation.evaluator INFO: Inference done 1050/1238. 0.0601 s / img. ETA=0:00:11
[11/22 05:45:38] defrcn.evaluation.evaluator INFO: Inference done 1100/1238. 0.0600 s / img. ETA=0:00:08
[11/22 05:45:41] defrcn.evaluation.evaluator INFO: Inference done 1150/1238. 0.0600 s / img. ETA=0:00:05
[11/22 05:45:44] defrcn.evaluation.evaluator INFO: Inference done 1200/1238. 0.0599 s / img. ETA=0:00:02
[11/22 05:45:47] defrcn.evaluation.evaluator INFO: Total inference time: 0:01:14 (0.060016 s / img per device, on 4 devices)
[11/22 05:45:47] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:01:10 (0.057575 s / img per device, on 4 devices)
[11/22 05:45:52] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluating voc_2007_test_all3 using 2007 metric. Note that results do not use the official Matlab API.
[11/22 05:46:18] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate per-class mAP50:
|  aeroplane  |  bicycle  |  bird  |  bottle  |  bus   |  car   |  chair  |  cow   |  diningtable  |  dog   |  horse  |  person  |  pottedplant  |  train  |  tvmonitor  |  boat  |  cat   |  motorbike  |  sheep  |  sofa  |
|:-----------:|:---------:|:------:|:--------:|:------:|:------:|:-------:|:------:|:-------------:|:------:|:-------:|:--------:|:-------------:|:-------:|:-----------:|:------:|:------:|:-----------:|:-------:|:------:|
|   83.452    |  86.254   | 84.338 |  74.982  | 87.009 | 88.622 | 68.505  | 83.490 |    74.613     | 84.368 | 87.581  |  86.304  |    56.147     | 83.058  |   81.992    | 31.063 | 72.030 |   72.105    | 68.321  | 49.375 |
[11/22 05:46:18] defrcn.evaluation.pascal_voc_evaluation INFO: Evaluate overall bbox:
|   AP   |  AP50  |  AP75  |  bAP   |  bAP50  |  bAP75  |  nAP   |  nAP50  |  nAP75  |
|:------:|:------:|:------:|:------:|:-------:|:-------:|:------:|:-------:|:-------:|
| 47.310 | 75.180 | 50.087 | 52.888 | 80.714  | 56.917  | 30.573 | 58.579  | 29.597  |
[11/22 05:46:18] defrcn.engine.defaults INFO: Evaluation results for voc_2007_test_all3 in csv format:
[11/22 05:46:18] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/22 05:46:18] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,bAP,bAP50,bAP75,nAP,nAP50,nAP75
[11/22 05:46:18] defrcn.evaluation.testing INFO: copypaste: 47.3096,75.1804,50.0867,52.8884,80.7143,56.9167,30.5732,58.5788,29.5968
