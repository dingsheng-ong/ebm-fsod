[11/15 22:47:16] detectron2 INFO: Rank of current process: 0. World size: 4
[11/15 22:47:16] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_fsod_r101_novel_3shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/15 22:47:16] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_fsod_r101_novel_3shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_novel_3shot_seed2", )
  TEST: ('coco14_test_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/15 22:47:16] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/config.yaml
[11/15 22:47:16] d2.utils.env INFO: Using a generated random seed 18219167
[11/15 22:47:16] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/15 22:47:17] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 60 images left.
[11/15 22:47:17] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 3            |  bicycle   | 3            |     car      | 3            |
|  motorcycle  | 3            |  airplane  | 3            |     bus      | 3            |
|    train     | 3            |    boat    | 3            |     bird     | 3            |
|     cat      | 3            |    dog     | 3            |    horse     | 3            |
|    sheep     | 3            |    cow     | 3            |    bottle    | 3            |
|    chair     | 3            |   couch    | 3            | potted plant | 3            |
| dining table | 3            |     tv     | 3            |              |              |
|    total     | 60           |            |              |              |              |[0m
[11/15 22:47:17] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/15 22:47:17] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/15 22:47:17] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/15 22:47:17] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/15 22:47:17] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth ...
[11/15 22:47:18] d2.engine.train_loop INFO: Starting training from iteration 0
[11/15 22:47:32] d2.utils.events INFO:  eta: 0:19:24  iter: 19  total_loss: 0.7659  loss_cls: 0.4633  loss_box_reg: 0.1114  loss_rpn_cls: 0.1325  loss_rpn_loc: 0.07213  time: 0.5864  data_time: 0.1549  lr: 0.01  max_mem: 5384M
[11/15 22:47:44] d2.utils.events INFO:  eta: 0:19:14  iter: 39  total_loss: 0.7309  loss_cls: 0.4655  loss_box_reg: 0.1156  loss_rpn_cls: 0.09674  loss_rpn_loc: 0.05931  time: 0.5881  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/15 22:47:56] d2.utils.events INFO:  eta: 0:19:03  iter: 59  total_loss: 0.5007  loss_cls: 0.26  loss_box_reg: 0.1148  loss_rpn_cls: 0.07535  loss_rpn_loc: 0.05185  time: 0.5920  data_time: 0.0185  lr: 0.01  max_mem: 5385M
[11/15 22:48:08] d2.utils.events INFO:  eta: 0:18:50  iter: 79  total_loss: 0.4178  loss_cls: 0.1832  loss_box_reg: 0.1186  loss_rpn_cls: 0.06311  loss_rpn_loc: 0.04078  time: 0.5943  data_time: 0.0176  lr: 0.01  max_mem: 5385M
[11/15 22:48:20] d2.utils.events INFO:  eta: 0:18:39  iter: 99  total_loss: 0.3664  loss_cls: 0.1667  loss_box_reg: 0.113  loss_rpn_cls: 0.05229  loss_rpn_loc: 0.03955  time: 0.5936  data_time: 0.0174  lr: 0.01  max_mem: 5385M
[11/15 22:48:32] d2.utils.events INFO:  eta: 0:18:28  iter: 119  total_loss: 0.3715  loss_cls: 0.1621  loss_box_reg: 0.1165  loss_rpn_cls: 0.04751  loss_rpn_loc: 0.04453  time: 0.5937  data_time: 0.0183  lr: 0.01  max_mem: 5385M
[11/15 22:48:44] d2.utils.events INFO:  eta: 0:18:16  iter: 139  total_loss: 0.348  loss_cls: 0.1469  loss_box_reg: 0.1146  loss_rpn_cls: 0.04656  loss_rpn_loc: 0.04134  time: 0.5933  data_time: 0.0187  lr: 0.01  max_mem: 5385M
[11/15 22:48:55] d2.utils.events INFO:  eta: 0:18:04  iter: 159  total_loss: 0.3319  loss_cls: 0.1378  loss_box_reg: 0.1113  loss_rpn_cls: 0.04305  loss_rpn_loc: 0.03756  time: 0.5924  data_time: 0.0167  lr: 0.01  max_mem: 5385M
[11/15 22:49:07] d2.utils.events INFO:  eta: 0:17:52  iter: 179  total_loss: 0.327  loss_cls: 0.1316  loss_box_reg: 0.1143  loss_rpn_cls: 0.03556  loss_rpn_loc: 0.03676  time: 0.5915  data_time: 0.0184  lr: 0.01  max_mem: 5385M
[11/15 22:49:19] d2.utils.events INFO:  eta: 0:17:41  iter: 199  total_loss: 0.307  loss_cls: 0.1245  loss_box_reg: 0.1109  loss_rpn_cls: 0.0345  loss_rpn_loc: 0.03616  time: 0.5909  data_time: 0.0160  lr: 0.01  max_mem: 5385M
[11/15 22:49:31] d2.utils.events INFO:  eta: 0:17:29  iter: 219  total_loss: 0.294  loss_cls: 0.1172  loss_box_reg: 0.109  loss_rpn_cls: 0.0317  loss_rpn_loc: 0.0322  time: 0.5908  data_time: 0.0203  lr: 0.01  max_mem: 5385M
[11/15 22:49:42] d2.utils.events INFO:  eta: 0:17:17  iter: 239  total_loss: 0.2836  loss_cls: 0.1137  loss_box_reg: 0.1045  loss_rpn_cls: 0.03029  loss_rpn_loc: 0.03236  time: 0.5904  data_time: 0.0180  lr: 0.01  max_mem: 5385M
[11/15 22:49:54] d2.utils.events INFO:  eta: 0:17:05  iter: 259  total_loss: 0.2775  loss_cls: 0.1123  loss_box_reg: 0.1057  loss_rpn_cls: 0.02857  loss_rpn_loc: 0.03254  time: 0.5902  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/15 22:50:06] d2.utils.events INFO:  eta: 0:16:53  iter: 279  total_loss: 0.2662  loss_cls: 0.1054  loss_box_reg: 0.1015  loss_rpn_cls: 0.02689  loss_rpn_loc: 0.02815  time: 0.5904  data_time: 0.0186  lr: 0.01  max_mem: 5385M
[11/15 22:50:18] d2.utils.events INFO:  eta: 0:16:42  iter: 299  total_loss: 0.2646  loss_cls: 0.1045  loss_box_reg: 0.09795  loss_rpn_cls: 0.0298  loss_rpn_loc: 0.0279  time: 0.5905  data_time: 0.0192  lr: 0.01  max_mem: 5385M
[11/15 22:50:30] d2.utils.events INFO:  eta: 0:16:30  iter: 319  total_loss: 0.2636  loss_cls: 0.09697  loss_box_reg: 0.09925  loss_rpn_cls: 0.0272  loss_rpn_loc: 0.03316  time: 0.5905  data_time: 0.0176  lr: 0.01  max_mem: 5385M
[11/15 22:50:42] d2.utils.events INFO:  eta: 0:16:18  iter: 339  total_loss: 0.2547  loss_cls: 0.09787  loss_box_reg: 0.09602  loss_rpn_cls: 0.02658  loss_rpn_loc: 0.03093  time: 0.5905  data_time: 0.0184  lr: 0.01  max_mem: 5385M
[11/15 22:50:53] d2.utils.events INFO:  eta: 0:16:06  iter: 359  total_loss: 0.2377  loss_cls: 0.09286  loss_box_reg: 0.09297  loss_rpn_cls: 0.02391  loss_rpn_loc: 0.02752  time: 0.5906  data_time: 0.0206  lr: 0.01  max_mem: 5385M
[11/15 22:51:05] d2.utils.events INFO:  eta: 0:15:54  iter: 379  total_loss: 0.2399  loss_cls: 0.09072  loss_box_reg: 0.08901  loss_rpn_cls: 0.02103  loss_rpn_loc: 0.03369  time: 0.5907  data_time: 0.0179  lr: 0.01  max_mem: 5385M
[11/15 22:51:17] d2.utils.events INFO:  eta: 0:15:42  iter: 399  total_loss: 0.2382  loss_cls: 0.08762  loss_box_reg: 0.08941  loss_rpn_cls: 0.02181  loss_rpn_loc: 0.0297  time: 0.5905  data_time: 0.0201  lr: 0.01  max_mem: 5385M
[11/15 22:51:29] d2.utils.events INFO:  eta: 0:15:31  iter: 419  total_loss: 0.2261  loss_cls: 0.08712  loss_box_reg: 0.0881  loss_rpn_cls: 0.01874  loss_rpn_loc: 0.02774  time: 0.5905  data_time: 0.0217  lr: 0.01  max_mem: 5385M
[11/15 22:51:41] d2.utils.events INFO:  eta: 0:15:18  iter: 439  total_loss: 0.2258  loss_cls: 0.08307  loss_box_reg: 0.08562  loss_rpn_cls: 0.02121  loss_rpn_loc: 0.03102  time: 0.5904  data_time: 0.0176  lr: 0.01  max_mem: 5385M
[11/15 22:51:53] d2.utils.events INFO:  eta: 0:15:07  iter: 459  total_loss: 0.2156  loss_cls: 0.08213  loss_box_reg: 0.08531  loss_rpn_cls: 0.01951  loss_rpn_loc: 0.02663  time: 0.5909  data_time: 0.0221  lr: 0.01  max_mem: 5385M
[11/15 22:52:05] d2.utils.events INFO:  eta: 0:14:55  iter: 479  total_loss: 0.212  loss_cls: 0.08154  loss_box_reg: 0.07961  loss_rpn_cls: 0.01824  loss_rpn_loc: 0.02819  time: 0.5908  data_time: 0.0175  lr: 0.01  max_mem: 5385M
[11/15 22:52:16] d2.utils.events INFO:  eta: 0:14:43  iter: 499  total_loss: 0.206  loss_cls: 0.08177  loss_box_reg: 0.07669  loss_rpn_cls: 0.01726  loss_rpn_loc: 0.02772  time: 0.5907  data_time: 0.0180  lr: 0.01  max_mem: 5385M
[11/15 22:52:28] d2.utils.events INFO:  eta: 0:14:32  iter: 519  total_loss: 0.1981  loss_cls: 0.0752  loss_box_reg: 0.07666  loss_rpn_cls: 0.01703  loss_rpn_loc: 0.02587  time: 0.5907  data_time: 0.0162  lr: 0.01  max_mem: 5385M
[11/15 22:52:40] d2.utils.events INFO:  eta: 0:14:20  iter: 539  total_loss: 0.1919  loss_cls: 0.07598  loss_box_reg: 0.07496  loss_rpn_cls: 0.0162  loss_rpn_loc: 0.02524  time: 0.5906  data_time: 0.0175  lr: 0.01  max_mem: 5385M
[11/15 22:52:52] d2.utils.events INFO:  eta: 0:14:08  iter: 559  total_loss: 0.1947  loss_cls: 0.07441  loss_box_reg: 0.0709  loss_rpn_cls: 0.01644  loss_rpn_loc: 0.02942  time: 0.5904  data_time: 0.0170  lr: 0.01  max_mem: 5385M
[11/15 22:53:03] d2.utils.events INFO:  eta: 0:13:56  iter: 579  total_loss: 0.1933  loss_cls: 0.07421  loss_box_reg: 0.07453  loss_rpn_cls: 0.0169  loss_rpn_loc: 0.02894  time: 0.5903  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/15 22:53:15] d2.utils.events INFO:  eta: 0:13:43  iter: 599  total_loss: 0.1818  loss_cls: 0.06711  loss_box_reg: 0.07111  loss_rpn_cls: 0.01669  loss_rpn_loc: 0.02495  time: 0.5905  data_time: 0.0200  lr: 0.01  max_mem: 5385M
[11/15 22:53:27] d2.utils.events INFO:  eta: 0:13:32  iter: 619  total_loss: 0.1765  loss_cls: 0.06865  loss_box_reg: 0.06746  loss_rpn_cls: 0.01553  loss_rpn_loc: 0.02405  time: 0.5904  data_time: 0.0201  lr: 0.01  max_mem: 5385M
[11/15 22:53:39] d2.utils.events INFO:  eta: 0:13:20  iter: 639  total_loss: 0.1704  loss_cls: 0.06642  loss_box_reg: 0.06417  loss_rpn_cls: 0.01505  loss_rpn_loc: 0.023  time: 0.5902  data_time: 0.0172  lr: 0.01  max_mem: 5385M
[11/15 22:53:51] d2.utils.events INFO:  eta: 0:13:08  iter: 659  total_loss: 0.1727  loss_cls: 0.0664  loss_box_reg: 0.06454  loss_rpn_cls: 0.01436  loss_rpn_loc: 0.02824  time: 0.5901  data_time: 0.0172  lr: 0.01  max_mem: 5385M
[11/15 22:54:02] d2.utils.events INFO:  eta: 0:12:56  iter: 679  total_loss: 0.1805  loss_cls: 0.06666  loss_box_reg: 0.06754  loss_rpn_cls: 0.01459  loss_rpn_loc: 0.0281  time: 0.5900  data_time: 0.0174  lr: 0.01  max_mem: 5385M
[11/15 22:54:14] d2.utils.events INFO:  eta: 0:12:44  iter: 699  total_loss: 0.179  loss_cls: 0.06332  loss_box_reg: 0.06341  loss_rpn_cls: 0.0166  loss_rpn_loc: 0.032  time: 0.5899  data_time: 0.0207  lr: 0.01  max_mem: 5385M
[11/15 22:54:26] d2.utils.events INFO:  eta: 0:12:32  iter: 719  total_loss: 0.1654  loss_cls: 0.0614  loss_box_reg: 0.06022  loss_rpn_cls: 0.01361  loss_rpn_loc: 0.03053  time: 0.5898  data_time: 0.0185  lr: 0.01  max_mem: 5385M
[11/15 22:54:37] d2.utils.events INFO:  eta: 0:12:20  iter: 739  total_loss: 0.1611  loss_cls: 0.06283  loss_box_reg: 0.05926  loss_rpn_cls: 0.01495  loss_rpn_loc: 0.02078  time: 0.5896  data_time: 0.0202  lr: 0.01  max_mem: 5385M
[11/15 22:54:49] d2.utils.events INFO:  eta: 0:12:09  iter: 759  total_loss: 0.1562  loss_cls: 0.06076  loss_box_reg: 0.05923  loss_rpn_cls: 0.01222  loss_rpn_loc: 0.02276  time: 0.5896  data_time: 0.0218  lr: 0.01  max_mem: 5385M
[11/15 22:55:01] d2.utils.events INFO:  eta: 0:11:57  iter: 779  total_loss: 0.1577  loss_cls: 0.05936  loss_box_reg: 0.05681  loss_rpn_cls: 0.01407  loss_rpn_loc: 0.02386  time: 0.5895  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/15 22:55:13] d2.utils.events INFO:  eta: 0:11:45  iter: 799  total_loss: 0.1549  loss_cls: 0.05756  loss_box_reg: 0.05571  loss_rpn_cls: 0.0125  loss_rpn_loc: 0.02256  time: 0.5895  data_time: 0.0195  lr: 0.01  max_mem: 5385M
[11/15 22:55:25] d2.utils.events INFO:  eta: 0:11:33  iter: 819  total_loss: 0.1495  loss_cls: 0.0585  loss_box_reg: 0.05603  loss_rpn_cls: 0.01157  loss_rpn_loc: 0.02039  time: 0.5894  data_time: 0.0167  lr: 0.01  max_mem: 5385M
[11/15 22:55:36] d2.utils.events INFO:  eta: 0:11:21  iter: 839  total_loss: 0.1489  loss_cls: 0.05949  loss_box_reg: 0.05432  loss_rpn_cls: 0.012  loss_rpn_loc: 0.02214  time: 0.5893  data_time: 0.0184  lr: 0.01  max_mem: 5385M
[11/15 22:55:48] d2.utils.events INFO:  eta: 0:11:10  iter: 859  total_loss: 0.1437  loss_cls: 0.05675  loss_box_reg: 0.05287  loss_rpn_cls: 0.012  loss_rpn_loc: 0.02273  time: 0.5894  data_time: 0.0169  lr: 0.01  max_mem: 5385M
[11/15 22:56:00] d2.utils.events INFO:  eta: 0:10:58  iter: 879  total_loss: 0.1518  loss_cls: 0.05568  loss_box_reg: 0.05514  loss_rpn_cls: 0.01217  loss_rpn_loc: 0.02654  time: 0.5892  data_time: 0.0182  lr: 0.01  max_mem: 5385M
[11/15 22:56:12] d2.utils.events INFO:  eta: 0:10:46  iter: 899  total_loss: 0.1424  loss_cls: 0.05791  loss_box_reg: 0.05315  loss_rpn_cls: 0.01134  loss_rpn_loc: 0.02074  time: 0.5892  data_time: 0.0186  lr: 0.01  max_mem: 5385M
[11/15 22:56:23] d2.utils.events INFO:  eta: 0:10:34  iter: 919  total_loss: 0.1414  loss_cls: 0.05603  loss_box_reg: 0.05214  loss_rpn_cls: 0.01092  loss_rpn_loc: 0.02047  time: 0.5891  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/15 22:56:35] d2.utils.events INFO:  eta: 0:10:23  iter: 939  total_loss: 0.1396  loss_cls: 0.05361  loss_box_reg: 0.05056  loss_rpn_cls: 0.01027  loss_rpn_loc: 0.02245  time: 0.5891  data_time: 0.0179  lr: 0.01  max_mem: 5385M
[11/15 22:56:47] d2.utils.events INFO:  eta: 0:10:11  iter: 959  total_loss: 0.1393  loss_cls: 0.05542  loss_box_reg: 0.0532  loss_rpn_cls: 0.01087  loss_rpn_loc: 0.02394  time: 0.5891  data_time: 0.0194  lr: 0.01  max_mem: 5385M
[11/15 22:56:59] d2.utils.events INFO:  eta: 0:09:59  iter: 979  total_loss: 0.1415  loss_cls: 0.05271  loss_box_reg: 0.04916  loss_rpn_cls: 0.01117  loss_rpn_loc: 0.02529  time: 0.5892  data_time: 0.0170  lr: 0.01  max_mem: 5385M
[11/15 22:57:11] d2.utils.events INFO:  eta: 0:09:47  iter: 999  total_loss: 0.1311  loss_cls: 0.05083  loss_box_reg: 0.04837  loss_rpn_cls: 0.00997  loss_rpn_loc: 0.01941  time: 0.5892  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/15 22:57:22] d2.utils.events INFO:  eta: 0:09:36  iter: 1019  total_loss: 0.1299  loss_cls: 0.05539  loss_box_reg: 0.04686  loss_rpn_cls: 0.0106  loss_rpn_loc: 0.01807  time: 0.5891  data_time: 0.0185  lr: 0.01  max_mem: 5385M
[11/15 22:57:34] d2.utils.events INFO:  eta: 0:09:24  iter: 1039  total_loss: 0.1349  loss_cls: 0.05246  loss_box_reg: 0.04663  loss_rpn_cls: 0.009281  loss_rpn_loc: 0.02363  time: 0.5891  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/15 22:57:46] d2.utils.events INFO:  eta: 0:09:12  iter: 1059  total_loss: 0.1339  loss_cls: 0.05254  loss_box_reg: 0.04853  loss_rpn_cls: 0.009658  loss_rpn_loc: 0.02218  time: 0.5890  data_time: 0.0172  lr: 0.01  max_mem: 5385M
[11/15 22:57:58] d2.utils.events INFO:  eta: 0:09:00  iter: 1079  total_loss: 0.1409  loss_cls: 0.05088  loss_box_reg: 0.04607  loss_rpn_cls: 0.01114  loss_rpn_loc: 0.02327  time: 0.5890  data_time: 0.0167  lr: 0.01  max_mem: 5385M
[11/15 22:58:09] d2.utils.events INFO:  eta: 0:08:48  iter: 1099  total_loss: 0.1224  loss_cls: 0.05006  loss_box_reg: 0.04587  loss_rpn_cls: 0.008423  loss_rpn_loc: 0.01983  time: 0.5889  data_time: 0.0187  lr: 0.01  max_mem: 5385M
[11/15 22:58:21] d2.utils.events INFO:  eta: 0:08:36  iter: 1119  total_loss: 0.1279  loss_cls: 0.04957  loss_box_reg: 0.04448  loss_rpn_cls: 0.00845  loss_rpn_loc: 0.01902  time: 0.5890  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/15 22:58:33] d2.utils.events INFO:  eta: 0:08:25  iter: 1139  total_loss: 0.127  loss_cls: 0.04909  loss_box_reg: 0.04519  loss_rpn_cls: 0.009058  loss_rpn_loc: 0.02071  time: 0.5891  data_time: 0.0168  lr: 0.01  max_mem: 5385M
[11/15 22:58:45] d2.utils.events INFO:  eta: 0:08:13  iter: 1159  total_loss: 0.1311  loss_cls: 0.04769  loss_box_reg: 0.04411  loss_rpn_cls: 0.009149  loss_rpn_loc: 0.02118  time: 0.5891  data_time: 0.0164  lr: 0.01  max_mem: 5385M
[11/15 22:58:57] d2.utils.events INFO:  eta: 0:08:01  iter: 1179  total_loss: 0.1205  loss_cls: 0.04792  loss_box_reg: 0.04165  loss_rpn_cls: 0.008408  loss_rpn_loc: 0.02124  time: 0.5888  data_time: 0.0209  lr: 0.01  max_mem: 5385M
[11/15 22:59:09] d2.utils.events INFO:  eta: 0:07:49  iter: 1199  total_loss: 0.126  loss_cls: 0.04696  loss_box_reg: 0.04275  loss_rpn_cls: 0.008708  loss_rpn_loc: 0.02226  time: 0.5888  data_time: 0.0193  lr: 0.01  max_mem: 5385M
[11/15 22:59:20] d2.utils.events INFO:  eta: 0:07:37  iter: 1219  total_loss: 0.1282  loss_cls: 0.0475  loss_box_reg: 0.04282  loss_rpn_cls: 0.009667  loss_rpn_loc: 0.02411  time: 0.5888  data_time: 0.0176  lr: 0.01  max_mem: 5385M
[11/15 22:59:32] d2.utils.events INFO:  eta: 0:07:26  iter: 1239  total_loss: 0.1193  loss_cls: 0.04672  loss_box_reg: 0.04409  loss_rpn_cls: 0.009135  loss_rpn_loc: 0.0189  time: 0.5889  data_time: 0.0194  lr: 0.01  max_mem: 5385M
[11/15 22:59:44] d2.utils.events INFO:  eta: 0:07:14  iter: 1259  total_loss: 0.1205  loss_cls: 0.04674  loss_box_reg: 0.04214  loss_rpn_cls: 0.0102  loss_rpn_loc: 0.02252  time: 0.5889  data_time: 0.0209  lr: 0.01  max_mem: 5385M
[11/15 22:59:56] d2.utils.events INFO:  eta: 0:07:02  iter: 1279  total_loss: 0.1219  loss_cls: 0.0467  loss_box_reg: 0.04516  loss_rpn_cls: 0.008297  loss_rpn_loc: 0.01928  time: 0.5888  data_time: 0.0170  lr: 0.01  max_mem: 5385M
[11/15 23:00:07] d2.utils.events INFO:  eta: 0:06:50  iter: 1299  total_loss: 0.114  loss_cls: 0.04454  loss_box_reg: 0.04112  loss_rpn_cls: 0.007309  loss_rpn_loc: 0.01697  time: 0.5888  data_time: 0.0182  lr: 0.01  max_mem: 5385M
[11/15 23:00:19] d2.utils.events INFO:  eta: 0:06:39  iter: 1319  total_loss: 0.116  loss_cls: 0.04532  loss_box_reg: 0.03971  loss_rpn_cls: 0.009949  loss_rpn_loc: 0.01777  time: 0.5888  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/15 23:00:31] d2.utils.events INFO:  eta: 0:06:27  iter: 1339  total_loss: 0.115  loss_cls: 0.04301  loss_box_reg: 0.03885  loss_rpn_cls: 0.008352  loss_rpn_loc: 0.01876  time: 0.5888  data_time: 0.0232  lr: 0.01  max_mem: 5385M
[11/15 23:00:43] d2.utils.events INFO:  eta: 0:06:15  iter: 1359  total_loss: 0.1161  loss_cls: 0.04593  loss_box_reg: 0.0412  loss_rpn_cls: 0.007988  loss_rpn_loc: 0.01747  time: 0.5887  data_time: 0.0170  lr: 0.01  max_mem: 5385M
[11/15 23:00:54] d2.utils.events INFO:  eta: 0:06:03  iter: 1379  total_loss: 0.1173  loss_cls: 0.04535  loss_box_reg: 0.04065  loss_rpn_cls: 0.00784  loss_rpn_loc: 0.02397  time: 0.5886  data_time: 0.0199  lr: 0.01  max_mem: 5385M
[11/15 23:01:06] d2.utils.events INFO:  eta: 0:05:52  iter: 1399  total_loss: 0.1134  loss_cls: 0.04411  loss_box_reg: 0.03871  loss_rpn_cls: 0.009443  loss_rpn_loc: 0.02214  time: 0.5887  data_time: 0.0161  lr: 0.01  max_mem: 5385M
[11/15 23:01:18] d2.utils.events INFO:  eta: 0:05:40  iter: 1419  total_loss: 0.1131  loss_cls: 0.04137  loss_box_reg: 0.04017  loss_rpn_cls: 0.008382  loss_rpn_loc: 0.02495  time: 0.5887  data_time: 0.0203  lr: 0.01  max_mem: 5385M
[11/15 23:01:30] d2.utils.events INFO:  eta: 0:05:28  iter: 1439  total_loss: 0.1107  loss_cls: 0.04421  loss_box_reg: 0.04065  loss_rpn_cls: 0.007723  loss_rpn_loc: 0.02194  time: 0.5886  data_time: 0.0183  lr: 0.01  max_mem: 5385M
[11/15 23:01:42] d2.utils.events INFO:  eta: 0:05:16  iter: 1459  total_loss: 0.115  loss_cls: 0.04335  loss_box_reg: 0.03973  loss_rpn_cls: 0.007566  loss_rpn_loc: 0.0212  time: 0.5886  data_time: 0.0171  lr: 0.01  max_mem: 5385M
[11/15 23:01:53] d2.utils.events INFO:  eta: 0:05:04  iter: 1479  total_loss: 0.1075  loss_cls: 0.04253  loss_box_reg: 0.03734  loss_rpn_cls: 0.008071  loss_rpn_loc: 0.019  time: 0.5886  data_time: 0.0179  lr: 0.01  max_mem: 5385M
[11/15 23:02:05] d2.utils.events INFO:  eta: 0:04:53  iter: 1499  total_loss: 0.1056  loss_cls: 0.04207  loss_box_reg: 0.03909  loss_rpn_cls: 0.006606  loss_rpn_loc: 0.01761  time: 0.5885  data_time: 0.0200  lr: 0.01  max_mem: 5385M
[11/15 23:02:17] d2.utils.events INFO:  eta: 0:04:41  iter: 1519  total_loss: 0.1036  loss_cls: 0.04181  loss_box_reg: 0.03801  loss_rpn_cls: 0.006903  loss_rpn_loc: 0.01826  time: 0.5885  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/15 23:02:29] d2.utils.events INFO:  eta: 0:04:29  iter: 1539  total_loss: 0.1016  loss_cls: 0.04097  loss_box_reg: 0.037  loss_rpn_cls: 0.007122  loss_rpn_loc: 0.01669  time: 0.5885  data_time: 0.0192  lr: 0.01  max_mem: 5385M
[11/15 23:02:40] d2.utils.events INFO:  eta: 0:04:17  iter: 1559  total_loss: 0.1019  loss_cls: 0.04064  loss_box_reg: 0.03625  loss_rpn_cls: 0.006714  loss_rpn_loc: 0.01492  time: 0.5885  data_time: 0.0201  lr: 0.01  max_mem: 5385M
[11/15 23:02:52] d2.utils.events INFO:  eta: 0:04:06  iter: 1579  total_loss: 0.1055  loss_cls: 0.04195  loss_box_reg: 0.03651  loss_rpn_cls: 0.00722  loss_rpn_loc: 0.01892  time: 0.5885  data_time: 0.0206  lr: 0.01  max_mem: 5385M
[11/15 23:03:04] d2.utils.events INFO:  eta: 0:03:54  iter: 1599  total_loss: 0.1094  loss_cls: 0.04086  loss_box_reg: 0.03703  loss_rpn_cls: 0.007294  loss_rpn_loc: 0.01908  time: 0.5885  data_time: 0.0160  lr: 0.01  max_mem: 5385M
[11/15 23:03:16] d2.utils.events INFO:  eta: 0:03:42  iter: 1619  total_loss: 0.1044  loss_cls: 0.04011  loss_box_reg: 0.03545  loss_rpn_cls: 0.007348  loss_rpn_loc: 0.0179  time: 0.5885  data_time: 0.0198  lr: 0.001  max_mem: 5385M
[11/15 23:03:27] d2.utils.events INFO:  eta: 0:03:31  iter: 1639  total_loss: 0.09836  loss_cls: 0.04078  loss_box_reg: 0.03574  loss_rpn_cls: 0.007504  loss_rpn_loc: 0.01375  time: 0.5885  data_time: 0.0167  lr: 0.001  max_mem: 5385M
[11/15 23:03:40] d2.utils.events INFO:  eta: 0:03:19  iter: 1659  total_loss: 0.09667  loss_cls: 0.04007  loss_box_reg: 0.03408  loss_rpn_cls: 0.008047  loss_rpn_loc: 0.01406  time: 0.5887  data_time: 0.0171  lr: 0.001  max_mem: 5385M
[11/15 23:03:51] d2.utils.events INFO:  eta: 0:03:07  iter: 1679  total_loss: 0.09528  loss_cls: 0.04086  loss_box_reg: 0.0336  loss_rpn_cls: 0.00622  loss_rpn_loc: 0.01239  time: 0.5886  data_time: 0.0158  lr: 0.001  max_mem: 5385M
[11/15 23:04:03] d2.utils.events INFO:  eta: 0:02:56  iter: 1699  total_loss: 0.1042  loss_cls: 0.03952  loss_box_reg: 0.03477  loss_rpn_cls: 0.008528  loss_rpn_loc: 0.01272  time: 0.5885  data_time: 0.0144  lr: 0.001  max_mem: 5385M
[11/15 23:04:15] d2.utils.events INFO:  eta: 0:02:44  iter: 1719  total_loss: 0.09458  loss_cls: 0.0403  loss_box_reg: 0.03438  loss_rpn_cls: 0.006677  loss_rpn_loc: 0.01488  time: 0.5884  data_time: 0.0162  lr: 0.001  max_mem: 5385M
[11/15 23:04:27] d2.utils.events INFO:  eta: 0:02:32  iter: 1739  total_loss: 0.09881  loss_cls: 0.04009  loss_box_reg: 0.03358  loss_rpn_cls: 0.006869  loss_rpn_loc: 0.01291  time: 0.5885  data_time: 0.0194  lr: 0.001  max_mem: 5385M
[11/15 23:04:39] d2.utils.events INFO:  eta: 0:02:20  iter: 1759  total_loss: 0.09585  loss_cls: 0.04127  loss_box_reg: 0.03652  loss_rpn_cls: 0.006132  loss_rpn_loc: 0.01376  time: 0.5885  data_time: 0.0180  lr: 0.001  max_mem: 5385M
[11/15 23:04:51] d2.utils.events INFO:  eta: 0:02:09  iter: 1779  total_loss: 0.09095  loss_cls: 0.04069  loss_box_reg: 0.03462  loss_rpn_cls: 0.005454  loss_rpn_loc: 0.01011  time: 0.5885  data_time: 0.0189  lr: 0.001  max_mem: 5385M
[11/15 23:05:03] d2.utils.events INFO:  eta: 0:01:57  iter: 1799  total_loss: 0.09553  loss_cls: 0.0396  loss_box_reg: 0.03564  loss_rpn_cls: 0.007271  loss_rpn_loc: 0.01162  time: 0.5885  data_time: 0.0202  lr: 0.001  max_mem: 5385M
[11/15 23:05:14] d2.utils.events INFO:  eta: 0:01:45  iter: 1819  total_loss: 0.09263  loss_cls: 0.03854  loss_box_reg: 0.03391  loss_rpn_cls: 0.006107  loss_rpn_loc: 0.01122  time: 0.5884  data_time: 0.0201  lr: 0.001  max_mem: 5385M
[11/15 23:05:26] d2.utils.events INFO:  eta: 0:01:33  iter: 1839  total_loss: 0.09277  loss_cls: 0.0398  loss_box_reg: 0.0338  loss_rpn_cls: 0.006171  loss_rpn_loc: 0.01246  time: 0.5884  data_time: 0.0220  lr: 0.001  max_mem: 5385M
[11/15 23:05:38] d2.utils.events INFO:  eta: 0:01:22  iter: 1859  total_loss: 0.09678  loss_cls: 0.04071  loss_box_reg: 0.03504  loss_rpn_cls: 0.007317  loss_rpn_loc: 0.0141  time: 0.5884  data_time: 0.0196  lr: 0.001  max_mem: 5385M
[11/15 23:05:50] d2.utils.events INFO:  eta: 0:01:10  iter: 1879  total_loss: 0.09078  loss_cls: 0.04066  loss_box_reg: 0.03479  loss_rpn_cls: 0.006444  loss_rpn_loc: 0.01159  time: 0.5884  data_time: 0.0177  lr: 0.001  max_mem: 5385M
[11/15 23:06:01] d2.utils.events INFO:  eta: 0:00:58  iter: 1899  total_loss: 0.09056  loss_cls: 0.03817  loss_box_reg: 0.03395  loss_rpn_cls: 0.006301  loss_rpn_loc: 0.01254  time: 0.5883  data_time: 0.0191  lr: 0.001  max_mem: 5385M
[11/15 23:06:13] d2.utils.events INFO:  eta: 0:00:46  iter: 1919  total_loss: 0.09516  loss_cls: 0.04028  loss_box_reg: 0.03606  loss_rpn_cls: 0.005235  loss_rpn_loc: 0.01098  time: 0.5883  data_time: 0.0212  lr: 0.001  max_mem: 5385M
[11/15 23:06:25] d2.utils.events INFO:  eta: 0:00:35  iter: 1939  total_loss: 0.09548  loss_cls: 0.03884  loss_box_reg: 0.03403  loss_rpn_cls: 0.006911  loss_rpn_loc: 0.012  time: 0.5883  data_time: 0.0199  lr: 0.001  max_mem: 5385M
[11/15 23:06:37] d2.utils.events INFO:  eta: 0:00:23  iter: 1959  total_loss: 0.09756  loss_cls: 0.04174  loss_box_reg: 0.03558  loss_rpn_cls: 0.006262  loss_rpn_loc: 0.01158  time: 0.5883  data_time: 0.0195  lr: 0.001  max_mem: 5385M
[11/15 23:06:48] d2.utils.events INFO:  eta: 0:00:11  iter: 1979  total_loss: 0.09438  loss_cls: 0.03886  loss_box_reg: 0.03516  loss_rpn_cls: 0.00637  loss_rpn_loc: 0.01141  time: 0.5883  data_time: 0.0184  lr: 0.001  max_mem: 5385M
[11/15 23:07:00] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/model_final.pth
[11/15 23:07:02] d2.utils.events INFO:  eta: 0:00:00  iter: 1999  total_loss: 0.09624  loss_cls: 0.03984  loss_box_reg: 0.03557  loss_rpn_cls: 0.007504  loss_rpn_loc: 0.01287  time: 0.5883  data_time: 0.0194  lr: 0.001  max_mem: 5385M
[11/15 23:07:02] d2.engine.hooks INFO: Overall training speed: 1998 iterations in 0:19:35 (0.5883 s / it)
[11/15 23:07:02] d2.engine.hooks INFO: Total training time: 0:19:40 (0:00:05 on hooks)
[11/15 23:07:03] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 10538        |  bicycle   | 313          |     car      | 1641         |
|  motorcycle  | 388          |  airplane  | 131          |     bus      | 259          |
|    train     | 212          |    boat    | 458          |     bird     | 453          |
|     cat      | 195          |    dog     | 223          |    horse     | 305          |
|    sheep     | 306          |    cow     | 376          |    bottle    | 939          |
|    chair     | 1594         |   couch    | 236          | potted plant | 429          |
| dining table | 633          |     tv     | 257          |              |              |
|    total     | 19886        |            |              |              |              |[0m
[11/15 23:07:03] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/15 23:07:03] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/15 23:07:04] d2.data.common INFO: Serialized dataset takes 2.08 MiB
[11/15 23:07:04] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/15 23:07:04] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/15 23:07:05] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/15 23:07:05] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/15 23:07:05] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/15 23:07:09] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/15 23:07:24] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1217 s / img. ETA=0:02:26
[11/15 23:07:30] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1210 s / img. ETA=0:02:19
[11/15 23:07:36] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1206 s / img. ETA=0:02:12
[11/15 23:07:42] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1210 s / img. ETA=0:02:07
[11/15 23:07:48] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1211 s / img. ETA=0:02:01
[11/15 23:07:54] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1205 s / img. ETA=0:01:54
[11/15 23:08:00] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1202 s / img. ETA=0:01:48
[11/15 23:08:06] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1206 s / img. ETA=0:01:42
[11/15 23:08:12] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1204 s / img. ETA=0:01:36
[11/15 23:08:17] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1201 s / img. ETA=0:01:30
[11/15 23:08:24] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1204 s / img. ETA=0:01:24
[11/15 23:08:30] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1202 s / img. ETA=0:01:18
[11/15 23:08:36] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1203 s / img. ETA=0:01:12
[11/15 23:08:42] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1204 s / img. ETA=0:01:06
[11/15 23:08:48] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1209 s / img. ETA=0:01:00
[11/15 23:08:54] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1208 s / img. ETA=0:00:54
[11/15 23:09:00] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1208 s / img. ETA=0:00:48
[11/15 23:09:06] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1209 s / img. ETA=0:00:42
[11/15 23:09:12] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1208 s / img. ETA=0:00:36
[11/15 23:09:18] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1207 s / img. ETA=0:00:30
[11/15 23:09:24] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1206 s / img. ETA=0:00:24
[11/15 23:09:30] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1206 s / img. ETA=0:00:18
[11/15 23:09:36] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1205 s / img. ETA=0:00:12
[11/15 23:09:42] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1205 s / img. ETA=0:00:06
[11/15 23:09:48] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1205 s / img. ETA=0:00:00
[11/15 23:09:48] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:30 (0.120482 s / img per device, on 4 devices)
[11/15 23:09:48] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:27 (0.118125 s / img per device, on 4 devices)
[11/15 23:09:52] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/15 23:09:52] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/inference/coco_instances_results.json
[11/15 23:09:52] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/15 23:10:00] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 13.883 | 25.202 | 13.545 | 5.310 | 14.253 | 21.602 |
[11/15 23:10:00] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.801  | bicycle    | 5.107  | car          | 2.335  |
| motorcycle   | 16.898 | airplane   | 32.175 | bus          | 44.216 |
| train        | 23.056 | boat       | 6.519  | bird         | 11.683 |
| cat          | 18.151 | dog        | 3.732  | horse        | 21.366 |
| sheep        | 9.467  | cow        | 17.928 | bottle       | 9.032  |
| chair        | 2.469  | couch      | 8.523  | potted plant | 2.239  |
| dining table | 10.109 | tv         | 30.861 |              |        |
[11/15 23:10:00] defrcn.engine.defaults INFO: Evaluation results for coco14_test_novel in csv format:
[11/15 23:10:00] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/15 23:10:00] defrcn.evaluation.testing INFO: copypaste: nAP,nAP50,nAP75,nAPs,nAPm,nAPl,AP
[11/15 23:10:00] defrcn.evaluation.testing INFO: copypaste: 13.8832,25.2022,13.5450,5.3100,14.2534,21.6021,13.8832
[11/15 23:10:11] detectron2 INFO: Rank of current process: 0. World size: 4
[11/15 23:10:11] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_gfsod_r101_novel_3shot_seed2.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2', 'SEED', '18219167'], resume=False, start_iter=-1)
[11/15 23:10:11] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_gfsod_r101_novel_3shot_seed2.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 80
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_all_3shot_seed2", )
  TEST: ('coco14_test_all',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (3840,)
  MAX_ITER: 4800
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/15 23:10:11] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/config.yaml
[11/15 23:10:12] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/15 23:10:12] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/model_final-merge.pth ...
[11/15 23:10:13] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10538        |   bicycle    | 313          |      car      | 1641         |
|  motorcycle   | 388          |   airplane   | 131          |      bus      | 259          |
|     train     | 212          |    truck     | 352          |     boat      | 458          |
| traffic light | 516          | fire hydrant | 83           |   stop sign   | 84           |
| parking meter | 59           |    bench     | 471          |     bird      | 453          |
|      cat      | 195          |     dog      | 223          |     horse     | 305          |
|     sheep     | 306          |     cow      | 376          |   elephant    | 283          |
|     bear      | 53           |    zebra     | 275          |    giraffe    | 170          |
|   backpack    | 384          |   umbrella   | 387          |    handbag    | 483          |
|      tie      | 290          |   suitcase   | 309          |    frisbee    | 109          |
|     skis      | 281          |  snowboard   | 90           |  sports ball  | 233          |
|     kite      | 381          | baseball bat | 123          | baseball gl.. | 139          |
|  skateboard   | 215          |  surfboard   | 266          | tennis racket | 183          |
|    bottle     | 939          |  wine glass  | 363          |      cup      | 891          |
|     fork      | 234          |    knife     | 290          |     spoon     | 253          |
|     bowl      | 617          |    banana    | 359          |     apple     | 158          |
|   sandwich    | 158          |    orange    | 185          |   broccoli    | 330          |
|    carrot     | 341          |   hot dog    | 160          |     pizza     | 223          |
|     donut     | 225          |     cake     | 236          |     chair     | 1594         |
|     couch     | 236          | potted plant | 429          |      bed      | 195          |
| dining table  | 633          |    toilet    | 179          |      tv       | 257          |
|    laptop     | 236          |    mouse     | 95           |    remote     | 241          |
|   keyboard    | 117          |  cell phone  | 291          |   microwave   | 88           |
|     oven      | 142          |   toaster    | 11           |     sink      | 211          |
| refrigerator  | 107          |     book     | 1031         |     clock     | 290          |
|     vase      | 350          |   scissors   | 56           |  teddy bear   | 238          |
|  hair drier   | 11           |  toothbrush  | 77           |               |              |
|     total     | 35094        |              |              |               |              |[0m
[11/15 23:10:13] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/15 23:10:13] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/15 23:10:14] d2.data.common INFO: Serialized dataset takes 3.00 MiB
[11/15 23:10:14] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/15 23:10:14] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/15 23:10:20] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 3            |   bicycle    | 3            |      car      | 3            |
|  motorcycle   | 3            |   airplane   | 3            |      bus      | 3            |
|     train     | 3            |    truck     | 3            |     boat      | 3            |
| traffic light | 3            | fire hydrant | 3            |   stop sign   | 3            |
| parking meter | 3            |    bench     | 3            |     bird      | 3            |
|      cat      | 3            |     dog      | 3            |     horse     | 3            |
|     sheep     | 3            |     cow      | 3            |   elephant    | 3            |
|     bear      | 3            |    zebra     | 3            |    giraffe    | 3            |
|   backpack    | 3            |   umbrella   | 3            |    handbag    | 3            |
|      tie      | 3            |   suitcase   | 3            |    frisbee    | 3            |
|     skis      | 3            |  snowboard   | 3            |  sports ball  | 3            |
|     kite      | 3            | baseball bat | 3            | baseball gl.. | 3            |
|  skateboard   | 3            |  surfboard   | 3            | tennis racket | 3            |
|    bottle     | 3            |  wine glass  | 3            |      cup      | 3            |
|     fork      | 3            |    knife     | 3            |     spoon     | 3            |
|     bowl      | 3            |    banana    | 3            |     apple     | 3            |
|   sandwich    | 3            |    orange    | 3            |   broccoli    | 3            |
|    carrot     | 3            |   hot dog    | 3            |     pizza     | 3            |
|     donut     | 3            |     cake     | 3            |     chair     | 3            |
|     couch     | 3            | potted plant | 3            |      bed      | 3            |
| dining table  | 3            |    toilet    | 3            |      tv       | 3            |
|    laptop     | 3            |    mouse     | 3            |    remote     | 3            |
|   keyboard    | 3            |  cell phone  | 3            |   microwave   | 3            |
|     oven      | 3            |   toaster    | 3            |     sink      | 3            |
| refrigerator  | 3            |     book     | 3            |     clock     | 3            |
|     vase      | 3            |   scissors   | 3            |  teddy bear   | 3            |
|  hair drier   | 3            |  toothbrush  | 3            |               |              |
|     total     | 240          |              |              |               |              |[0m
[11/15 23:10:20] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/15 23:10:20] d2.data.common INFO: Serializing 240 elements to byte tensors and concatenating them all ...
[11/15 23:10:20] d2.data.common INFO: Serialized dataset takes 0.06 MiB
[11/15 23:10:37] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/15 23:10:51] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1256 s / img. ETA=0:02:30
[11/15 23:10:57] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1243 s / img. ETA=0:02:22
[11/15 23:11:03] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1231 s / img. ETA=0:02:15
[11/15 23:11:09] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1228 s / img. ETA=0:02:08
[11/15 23:11:15] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1228 s / img. ETA=0:02:02
[11/15 23:11:21] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1218 s / img. ETA=0:01:55
[11/15 23:11:27] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1216 s / img. ETA=0:01:49
[11/15 23:11:33] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1216 s / img. ETA=0:01:43
[11/15 23:11:40] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1216 s / img. ETA=0:01:37
[11/15 23:11:45] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1212 s / img. ETA=0:01:30
[11/15 23:11:52] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1214 s / img. ETA=0:01:25
[11/15 23:11:58] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1213 s / img. ETA=0:01:18
[11/15 23:12:04] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1213 s / img. ETA=0:01:12
[11/15 23:12:10] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1210 s / img. ETA=0:01:06
[11/15 23:12:16] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1212 s / img. ETA=0:01:00
[11/15 23:12:22] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1212 s / img. ETA=0:00:54
[11/15 23:12:28] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1212 s / img. ETA=0:00:48
[11/15 23:12:34] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1214 s / img. ETA=0:00:42
[11/15 23:12:40] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1213 s / img. ETA=0:00:36
[11/15 23:12:46] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1213 s / img. ETA=0:00:30
[11/15 23:12:52] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1213 s / img. ETA=0:00:24
[11/15 23:12:58] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1214 s / img. ETA=0:00:18
[11/15 23:13:04] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1215 s / img. ETA=0:00:12
[11/15 23:13:11] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1214 s / img. ETA=0:00:06
[11/15 23:13:17] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1214 s / img. ETA=0:00:00
[11/15 23:13:17] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:31 (0.121285 s / img per device, on 4 devices)
[11/15 23:13:17] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:27 (0.118872 s / img per device, on 4 devices)
[11/15 23:13:21] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/15 23:13:21] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed2/inference/coco_instances_results.json
[11/15 23:13:22] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/15 23:13:46] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 31.115 | 48.538 | 33.119 | 15.021 | 35.123 | 44.122 |
[11/15 23:13:46] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category      | AP     | category     | AP     | category       | AP     |
|:--------------|:-------|:-------------|:-------|:---------------|:-------|
| person        | 1.826  | bicycle      | 5.053  | car            | 1.256  |
| motorcycle    | 17.201 | airplane     | 30.211 | bus            | 43.562 |
| train         | 22.473 | truck        | 30.948 | boat           | 7.476  |
| traffic light | 24.470 | fire hydrant | 65.215 | stop sign      | 69.298 |
| parking meter | 36.647 | bench        | 18.598 | bird           | 11.316 |
| cat           | 19.508 | dog          | 3.535  | horse          | 21.769 |
| sheep         | 12.016 | cow          | 18.029 | elephant       | 63.389 |
| bear          | 56.737 | zebra        | 59.460 | giraffe        | 68.245 |
| backpack      | 16.937 | umbrella     | 31.555 | handbag        | 14.950 |
| tie           | 31.239 | suitcase     | 28.532 | frisbee        | 57.436 |
| skis          | 23.878 | snowboard    | 32.567 | sports ball    | 38.955 |
| kite          | 38.933 | baseball bat | 28.029 | baseball glove | 28.809 |
| skateboard    | 45.144 | surfboard    | 39.842 | tennis racket  | 49.594 |
| bottle        | 9.225  | wine glass   | 30.831 | cup            | 37.416 |
| fork          | 34.925 | knife        | 16.627 | spoon          | 18.474 |
| bowl          | 35.528 | banana       | 25.411 | apple          | 21.067 |
| sandwich      | 35.724 | orange       | 23.265 | broccoli       | 26.090 |
| carrot        | 23.623 | hot dog      | 32.258 | pizza          | 51.905 |
| donut         | 50.094 | cake         | 40.083 | chair          | 2.570  |
| couch         | 9.185  | potted plant | 2.910  | bed            | 41.515 |
| dining table  | 9.371  | toilet       | 54.827 | tv             | 36.375 |
| laptop        | 56.613 | mouse        | 48.564 | remote         | 29.490 |
| keyboard      | 51.198 | cell phone   | 26.235 | microwave      | 52.774 |
| oven          | 36.592 | toaster      | 28.778 | sink           | 32.836 |
| refrigerator  | 50.487 | book         | 8.603  | clock          | 47.933 |
| vase          | 32.735 | scissors     | 26.380 | teddy bear     | 37.830 |
| hair drier    | 17.265 | toothbrush   | 20.934 |                |        |
[11/15 23:14:05] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 36.739 | 56.102 | 39.527 | 18.489 | 42.050 | 51.446 |
[11/15 23:14:05] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category       | AP     | category      | AP     | category     | AP     |
|:---------------|:-------|:--------------|:-------|:-------------|:-------|
| truck          | 30.948 | traffic light | 24.470 | fire hydrant | 65.215 |
| stop sign      | 69.298 | parking meter | 36.647 | bench        | 18.598 |
| elephant       | 63.389 | bear          | 56.737 | zebra        | 59.460 |
| giraffe        | 68.245 | backpack      | 16.937 | umbrella     | 31.555 |
| handbag        | 14.950 | tie           | 31.239 | suitcase     | 28.532 |
| frisbee        | 57.436 | skis          | 23.878 | snowboard    | 32.567 |
| sports ball    | 38.955 | kite          | 38.933 | baseball bat | 28.029 |
| baseball glove | 28.809 | skateboard    | 45.144 | surfboard    | 39.842 |
| tennis racket  | 49.594 | wine glass    | 30.831 | cup          | 37.416 |
| fork           | 34.925 | knife         | 16.627 | spoon        | 18.474 |
| bowl           | 35.528 | banana        | 25.411 | apple        | 21.067 |
| sandwich       | 35.724 | orange        | 23.265 | broccoli     | 26.090 |
| carrot         | 23.623 | hot dog       | 32.258 | pizza        | 51.905 |
| donut          | 50.094 | cake          | 40.083 | bed          | 41.515 |
| toilet         | 54.827 | laptop        | 56.613 | mouse        | 48.564 |
| remote         | 29.490 | keyboard      | 51.198 | cell phone   | 26.235 |
| microwave      | 52.774 | oven          | 36.592 | toaster      | 28.778 |
| sink           | 32.836 | refrigerator  | 50.487 | book         | 8.603  |
| clock          | 47.933 | vase          | 32.735 | scissors     | 26.380 |
| teddy bear     | 37.830 | hair drier    | 17.265 | toothbrush   | 20.934 |
[11/15 23:14:11] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 14.243 | 25.848 | 13.893 | 4.789 | 14.344 | 22.153 |
[11/15 23:14:11] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.826  | bicycle    | 5.053  | car          | 1.256  |
| motorcycle   | 17.201 | airplane   | 30.211 | bus          | 43.562 |
| train        | 22.473 | boat       | 7.476  | bird         | 11.316 |
| cat          | 19.508 | dog        | 3.535  | horse        | 21.769 |
| sheep        | 12.016 | cow        | 18.029 | bottle       | 9.225  |
| chair        | 2.570  | couch      | 9.185  | potted plant | 2.910  |
| dining table | 9.371  | tv         | 36.375 |              |        |
[11/15 23:14:11] defrcn.engine.defaults INFO: Evaluation results for coco14_test_all in csv format:
[11/15 23:14:11] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/15 23:14:11] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,APs,APm,APl,bAP,bAP50,bAP75,bAPs,bAPm,bAPl,nAP,nAP50,nAP75,nAPs,nAPm,nAPl
[11/15 23:14:11] defrcn.evaluation.testing INFO: copypaste: 31.1149,48.5383,33.1186,15.0208,35.1232,44.1223,36.7386,56.1018,39.5273,18.4893,42.0495,51.4455,14.2435,25.8476,13.8926,4.7888,14.3444,22.1527
