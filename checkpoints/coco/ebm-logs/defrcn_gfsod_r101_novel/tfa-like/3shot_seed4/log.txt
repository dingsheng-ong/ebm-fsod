[11/16 04:46:36] detectron2 INFO: Rank of current process: 0. World size: 4
[11/16 04:46:36] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_fsod_r101_novel_3shot_seed4.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/16 04:46:36] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_fsod_r101_novel_3shot_seed4.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_novel_3shot_seed4", )
  TEST: ('coco14_test_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/16 04:46:36] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/config.yaml
[11/16 04:46:36] d2.utils.env INFO: Using a generated random seed 38112449
[11/16 04:46:36] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/16 04:46:37] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 60 images left.
[11/16 04:46:37] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 3            |  bicycle   | 3            |     car      | 3            |
|  motorcycle  | 3            |  airplane  | 3            |     bus      | 3            |
|    train     | 3            |    boat    | 3            |     bird     | 3            |
|     cat      | 3            |    dog     | 3            |    horse     | 3            |
|    sheep     | 3            |    cow     | 3            |    bottle    | 3            |
|    chair     | 3            |   couch    | 3            | potted plant | 3            |
| dining table | 3            |     tv     | 3            |              |              |
|    total     | 60           |            |              |              |              |[0m
[11/16 04:46:37] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/16 04:46:37] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/16 04:46:37] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/16 04:46:37] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/16 04:46:37] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth ...
[11/16 04:46:38] d2.engine.train_loop INFO: Starting training from iteration 0
[11/16 04:46:52] d2.utils.events INFO:  eta: 0:18:51  iter: 19  total_loss: 0.704  loss_cls: 0.4454  loss_box_reg: 0.1136  loss_rpn_cls: 0.1045  loss_rpn_loc: 0.04353  time: 0.5700  data_time: 0.1670  lr: 0.01  max_mem: 5382M
[11/16 04:47:03] d2.utils.events INFO:  eta: 0:18:33  iter: 39  total_loss: 0.6992  loss_cls: 0.4437  loss_box_reg: 0.1211  loss_rpn_cls: 0.07719  loss_rpn_loc: 0.04308  time: 0.5696  data_time: 0.0139  lr: 0.01  max_mem: 5382M
[11/16 04:47:15] d2.utils.events INFO:  eta: 0:18:22  iter: 59  total_loss: 0.4443  loss_cls: 0.2315  loss_box_reg: 0.1166  loss_rpn_cls: 0.06097  loss_rpn_loc: 0.03022  time: 0.5692  data_time: 0.0176  lr: 0.01  max_mem: 5382M
[11/16 04:47:26] d2.utils.events INFO:  eta: 0:18:14  iter: 79  total_loss: 0.3755  loss_cls: 0.1709  loss_box_reg: 0.1172  loss_rpn_cls: 0.0525  loss_rpn_loc: 0.03195  time: 0.5705  data_time: 0.0177  lr: 0.01  max_mem: 5382M
[11/16 04:47:38] d2.utils.events INFO:  eta: 0:18:08  iter: 99  total_loss: 0.363  loss_cls: 0.1564  loss_box_reg: 0.1123  loss_rpn_cls: 0.04624  loss_rpn_loc: 0.02888  time: 0.5720  data_time: 0.0199  lr: 0.01  max_mem: 5382M
[11/16 04:47:50] d2.utils.events INFO:  eta: 0:17:57  iter: 119  total_loss: 0.3366  loss_cls: 0.1508  loss_box_reg: 0.1111  loss_rpn_cls: 0.04339  loss_rpn_loc: 0.02961  time: 0.5730  data_time: 0.0203  lr: 0.01  max_mem: 5382M
[11/16 04:48:01] d2.utils.events INFO:  eta: 0:17:45  iter: 139  total_loss: 0.311  loss_cls: 0.138  loss_box_reg: 0.1129  loss_rpn_cls: 0.03574  loss_rpn_loc: 0.02564  time: 0.5736  data_time: 0.0184  lr: 0.01  max_mem: 5384M
[11/16 04:48:13] d2.utils.events INFO:  eta: 0:17:34  iter: 159  total_loss: 0.301  loss_cls: 0.1329  loss_box_reg: 0.1088  loss_rpn_cls: 0.03371  loss_rpn_loc: 0.023  time: 0.5737  data_time: 0.0185  lr: 0.01  max_mem: 5384M
[11/16 04:48:24] d2.utils.events INFO:  eta: 0:17:22  iter: 179  total_loss: 0.295  loss_cls: 0.1245  loss_box_reg: 0.1111  loss_rpn_cls: 0.03243  loss_rpn_loc: 0.02387  time: 0.5734  data_time: 0.0195  lr: 0.01  max_mem: 5384M
[11/16 04:48:36] d2.utils.events INFO:  eta: 0:17:11  iter: 199  total_loss: 0.2865  loss_cls: 0.1223  loss_box_reg: 0.1061  loss_rpn_cls: 0.03167  loss_rpn_loc: 0.02822  time: 0.5735  data_time: 0.0183  lr: 0.01  max_mem: 5385M
[11/16 04:48:47] d2.utils.events INFO:  eta: 0:17:00  iter: 219  total_loss: 0.2674  loss_cls: 0.1153  loss_box_reg: 0.1044  loss_rpn_cls: 0.02659  loss_rpn_loc: 0.02297  time: 0.5738  data_time: 0.0182  lr: 0.01  max_mem: 5385M
[11/16 04:48:59] d2.utils.events INFO:  eta: 0:16:50  iter: 239  total_loss: 0.2595  loss_cls: 0.1096  loss_box_reg: 0.1025  loss_rpn_cls: 0.02536  loss_rpn_loc: 0.02443  time: 0.5743  data_time: 0.0203  lr: 0.01  max_mem: 5385M
[11/16 04:49:10] d2.utils.events INFO:  eta: 0:16:39  iter: 259  total_loss: 0.2475  loss_cls: 0.1052  loss_box_reg: 0.09937  loss_rpn_cls: 0.02355  loss_rpn_loc: 0.01867  time: 0.5746  data_time: 0.0174  lr: 0.01  max_mem: 5385M
[11/16 04:49:22] d2.utils.events INFO:  eta: 0:16:27  iter: 279  total_loss: 0.2426  loss_cls: 0.09927  loss_box_reg: 0.09919  loss_rpn_cls: 0.02218  loss_rpn_loc: 0.02042  time: 0.5748  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/16 04:49:33] d2.utils.events INFO:  eta: 0:16:16  iter: 299  total_loss: 0.2375  loss_cls: 0.09868  loss_box_reg: 0.09248  loss_rpn_cls: 0.02065  loss_rpn_loc: 0.02198  time: 0.5747  data_time: 0.0183  lr: 0.01  max_mem: 5385M
[11/16 04:49:45] d2.utils.events INFO:  eta: 0:16:04  iter: 319  total_loss: 0.2315  loss_cls: 0.09563  loss_box_reg: 0.0961  loss_rpn_cls: 0.02019  loss_rpn_loc: 0.021  time: 0.5752  data_time: 0.0195  lr: 0.01  max_mem: 5385M
[11/16 04:49:57] d2.utils.events INFO:  eta: 0:15:53  iter: 339  total_loss: 0.2151  loss_cls: 0.09491  loss_box_reg: 0.08835  loss_rpn_cls: 0.01968  loss_rpn_loc: 0.01694  time: 0.5752  data_time: 0.0178  lr: 0.01  max_mem: 5385M
[11/16 04:50:08] d2.utils.events INFO:  eta: 0:15:42  iter: 359  total_loss: 0.2274  loss_cls: 0.0934  loss_box_reg: 0.09088  loss_rpn_cls: 0.01611  loss_rpn_loc: 0.02216  time: 0.5751  data_time: 0.0196  lr: 0.01  max_mem: 5385M
[11/16 04:50:20] d2.utils.events INFO:  eta: 0:15:30  iter: 379  total_loss: 0.209  loss_cls: 0.08865  loss_box_reg: 0.08538  loss_rpn_cls: 0.0162  loss_rpn_loc: 0.02094  time: 0.5749  data_time: 0.0173  lr: 0.01  max_mem: 5385M
[11/16 04:50:31] d2.utils.events INFO:  eta: 0:15:19  iter: 399  total_loss: 0.2052  loss_cls: 0.08747  loss_box_reg: 0.08222  loss_rpn_cls: 0.01567  loss_rpn_loc: 0.01779  time: 0.5745  data_time: 0.0179  lr: 0.01  max_mem: 5385M
[11/16 04:50:42] d2.utils.events INFO:  eta: 0:15:07  iter: 419  total_loss: 0.2038  loss_cls: 0.08354  loss_box_reg: 0.08173  loss_rpn_cls: 0.01612  loss_rpn_loc: 0.02065  time: 0.5747  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/16 04:50:54] d2.utils.events INFO:  eta: 0:14:56  iter: 439  total_loss: 0.1953  loss_cls: 0.07806  loss_box_reg: 0.07826  loss_rpn_cls: 0.01462  loss_rpn_loc: 0.02136  time: 0.5747  data_time: 0.0211  lr: 0.01  max_mem: 5385M
[11/16 04:51:06] d2.utils.events INFO:  eta: 0:14:44  iter: 459  total_loss: 0.1931  loss_cls: 0.07896  loss_box_reg: 0.07808  loss_rpn_cls: 0.01493  loss_rpn_loc: 0.01804  time: 0.5747  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/16 04:51:17] d2.utils.events INFO:  eta: 0:14:32  iter: 479  total_loss: 0.1818  loss_cls: 0.07461  loss_box_reg: 0.0742  loss_rpn_cls: 0.01337  loss_rpn_loc: 0.01844  time: 0.5744  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/16 04:51:29] d2.utils.events INFO:  eta: 0:14:21  iter: 499  total_loss: 0.1801  loss_cls: 0.07338  loss_box_reg: 0.07358  loss_rpn_cls: 0.01348  loss_rpn_loc: 0.02007  time: 0.5745  data_time: 0.0249  lr: 0.01  max_mem: 5385M
[11/16 04:51:40] d2.utils.events INFO:  eta: 0:14:10  iter: 519  total_loss: 0.1777  loss_cls: 0.07351  loss_box_reg: 0.06797  loss_rpn_cls: 0.01308  loss_rpn_loc: 0.02074  time: 0.5747  data_time: 0.0218  lr: 0.01  max_mem: 5385M
[11/16 04:51:52] d2.utils.events INFO:  eta: 0:13:58  iter: 539  total_loss: 0.1646  loss_cls: 0.06955  loss_box_reg: 0.07002  loss_rpn_cls: 0.01171  loss_rpn_loc: 0.01782  time: 0.5747  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/16 04:52:03] d2.utils.events INFO:  eta: 0:13:47  iter: 559  total_loss: 0.1689  loss_cls: 0.06849  loss_box_reg: 0.06528  loss_rpn_cls: 0.01198  loss_rpn_loc: 0.02111  time: 0.5748  data_time: 0.0178  lr: 0.01  max_mem: 5385M
[11/16 04:52:15] d2.utils.events INFO:  eta: 0:13:35  iter: 579  total_loss: 0.1608  loss_cls: 0.06538  loss_box_reg: 0.06555  loss_rpn_cls: 0.01018  loss_rpn_loc: 0.01811  time: 0.5748  data_time: 0.0188  lr: 0.01  max_mem: 5385M
[11/16 04:52:26] d2.utils.events INFO:  eta: 0:13:24  iter: 599  total_loss: 0.161  loss_cls: 0.06709  loss_box_reg: 0.06414  loss_rpn_cls: 0.01101  loss_rpn_loc: 0.01707  time: 0.5748  data_time: 0.0204  lr: 0.01  max_mem: 5385M
[11/16 04:52:38] d2.utils.events INFO:  eta: 0:13:12  iter: 619  total_loss: 0.1532  loss_cls: 0.06602  loss_box_reg: 0.06029  loss_rpn_cls: 0.01051  loss_rpn_loc: 0.01679  time: 0.5747  data_time: 0.0195  lr: 0.01  max_mem: 5385M
[11/16 04:52:49] d2.utils.events INFO:  eta: 0:13:00  iter: 639  total_loss: 0.1554  loss_cls: 0.06505  loss_box_reg: 0.06095  loss_rpn_cls: 0.009624  loss_rpn_loc: 0.01801  time: 0.5747  data_time: 0.0186  lr: 0.01  max_mem: 5385M
[11/16 04:53:01] d2.utils.events INFO:  eta: 0:12:49  iter: 659  total_loss: 0.1478  loss_cls: 0.06259  loss_box_reg: 0.05911  loss_rpn_cls: 0.01002  loss_rpn_loc: 0.01959  time: 0.5747  data_time: 0.0199  lr: 0.01  max_mem: 5385M
[11/16 04:53:12] d2.utils.events INFO:  eta: 0:12:37  iter: 679  total_loss: 0.1489  loss_cls: 0.06011  loss_box_reg: 0.05566  loss_rpn_cls: 0.01027  loss_rpn_loc: 0.01796  time: 0.5745  data_time: 0.0192  lr: 0.01  max_mem: 5385M
[11/16 04:53:24] d2.utils.events INFO:  eta: 0:12:26  iter: 699  total_loss: 0.1477  loss_cls: 0.06063  loss_box_reg: 0.05465  loss_rpn_cls: 0.009783  loss_rpn_loc: 0.01702  time: 0.5744  data_time: 0.0204  lr: 0.01  max_mem: 5385M
[11/16 04:53:35] d2.utils.events INFO:  eta: 0:12:14  iter: 719  total_loss: 0.1354  loss_cls: 0.0592  loss_box_reg: 0.05482  loss_rpn_cls: 0.00883  loss_rpn_loc: 0.01339  time: 0.5744  data_time: 0.0160  lr: 0.01  max_mem: 5385M
[11/16 04:53:47] d2.utils.events INFO:  eta: 0:12:03  iter: 739  total_loss: 0.1417  loss_cls: 0.06007  loss_box_reg: 0.05281  loss_rpn_cls: 0.008516  loss_rpn_loc: 0.01567  time: 0.5744  data_time: 0.0199  lr: 0.01  max_mem: 5385M
[11/16 04:53:58] d2.utils.events INFO:  eta: 0:11:51  iter: 759  total_loss: 0.1367  loss_cls: 0.05927  loss_box_reg: 0.05373  loss_rpn_cls: 0.008557  loss_rpn_loc: 0.01581  time: 0.5743  data_time: 0.0181  lr: 0.01  max_mem: 5385M
[11/16 04:54:10] d2.utils.events INFO:  eta: 0:11:40  iter: 779  total_loss: 0.1313  loss_cls: 0.05519  loss_box_reg: 0.05036  loss_rpn_cls: 0.007433  loss_rpn_loc: 0.01457  time: 0.5744  data_time: 0.0182  lr: 0.01  max_mem: 5385M
[11/16 04:54:21] d2.utils.events INFO:  eta: 0:11:28  iter: 799  total_loss: 0.1294  loss_cls: 0.05547  loss_box_reg: 0.04797  loss_rpn_cls: 0.008148  loss_rpn_loc: 0.01598  time: 0.5746  data_time: 0.0217  lr: 0.01  max_mem: 5385M
[11/16 04:54:33] d2.utils.events INFO:  eta: 0:11:17  iter: 819  total_loss: 0.1253  loss_cls: 0.05594  loss_box_reg: 0.04894  loss_rpn_cls: 0.008424  loss_rpn_loc: 0.01311  time: 0.5747  data_time: 0.0171  lr: 0.01  max_mem: 5385M
[11/16 04:54:44] d2.utils.events INFO:  eta: 0:11:06  iter: 839  total_loss: 0.1301  loss_cls: 0.05611  loss_box_reg: 0.04735  loss_rpn_cls: 0.007859  loss_rpn_loc: 0.01625  time: 0.5746  data_time: 0.0185  lr: 0.01  max_mem: 5385M
[11/16 04:54:56] d2.utils.events INFO:  eta: 0:10:54  iter: 859  total_loss: 0.1227  loss_cls: 0.05429  loss_box_reg: 0.04745  loss_rpn_cls: 0.00687  loss_rpn_loc: 0.01575  time: 0.5746  data_time: 0.0184  lr: 0.01  max_mem: 5385M
[11/16 04:55:08] d2.utils.events INFO:  eta: 0:10:43  iter: 879  total_loss: 0.1247  loss_cls: 0.05364  loss_box_reg: 0.04645  loss_rpn_cls: 0.007456  loss_rpn_loc: 0.01713  time: 0.5747  data_time: 0.0182  lr: 0.01  max_mem: 5385M
[11/16 04:55:19] d2.utils.events INFO:  eta: 0:10:32  iter: 899  total_loss: 0.1179  loss_cls: 0.05083  loss_box_reg: 0.04494  loss_rpn_cls: 0.007268  loss_rpn_loc: 0.01515  time: 0.5748  data_time: 0.0175  lr: 0.01  max_mem: 5385M
[11/16 04:55:31] d2.utils.events INFO:  eta: 0:10:20  iter: 919  total_loss: 0.1156  loss_cls: 0.05023  loss_box_reg: 0.04394  loss_rpn_cls: 0.007081  loss_rpn_loc: 0.0151  time: 0.5748  data_time: 0.0185  lr: 0.01  max_mem: 5385M
[11/16 04:55:42] d2.utils.events INFO:  eta: 0:10:09  iter: 939  total_loss: 0.1144  loss_cls: 0.04975  loss_box_reg: 0.04326  loss_rpn_cls: 0.006762  loss_rpn_loc: 0.0168  time: 0.5748  data_time: 0.0196  lr: 0.01  max_mem: 5385M
[11/16 04:55:54] d2.utils.events INFO:  eta: 0:09:57  iter: 959  total_loss: 0.1162  loss_cls: 0.05012  loss_box_reg: 0.04296  loss_rpn_cls: 0.006618  loss_rpn_loc: 0.01443  time: 0.5748  data_time: 0.0161  lr: 0.01  max_mem: 5385M
[11/16 04:56:05] d2.utils.events INFO:  eta: 0:09:46  iter: 979  total_loss: 0.1153  loss_cls: 0.04984  loss_box_reg: 0.04102  loss_rpn_cls: 0.006992  loss_rpn_loc: 0.01423  time: 0.5747  data_time: 0.0207  lr: 0.01  max_mem: 5385M
[11/16 04:56:17] d2.utils.events INFO:  eta: 0:09:34  iter: 999  total_loss: 0.1097  loss_cls: 0.04918  loss_box_reg: 0.0405  loss_rpn_cls: 0.006388  loss_rpn_loc: 0.01376  time: 0.5745  data_time: 0.0202  lr: 0.01  max_mem: 5385M
[11/16 04:56:28] d2.utils.events INFO:  eta: 0:09:22  iter: 1019  total_loss: 0.1092  loss_cls: 0.04934  loss_box_reg: 0.03885  loss_rpn_cls: 0.006207  loss_rpn_loc: 0.01368  time: 0.5747  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/16 04:56:40] d2.utils.events INFO:  eta: 0:09:11  iter: 1039  total_loss: 0.1099  loss_cls: 0.0483  loss_box_reg: 0.04056  loss_rpn_cls: 0.006817  loss_rpn_loc: 0.01431  time: 0.5747  data_time: 0.0180  lr: 0.01  max_mem: 5385M
[11/16 04:56:51] d2.utils.events INFO:  eta: 0:09:00  iter: 1059  total_loss: 0.1042  loss_cls: 0.04791  loss_box_reg: 0.03785  loss_rpn_cls: 0.005417  loss_rpn_loc: 0.01263  time: 0.5747  data_time: 0.0183  lr: 0.01  max_mem: 5385M
[11/16 04:57:03] d2.utils.events INFO:  eta: 0:08:48  iter: 1079  total_loss: 0.1055  loss_cls: 0.04682  loss_box_reg: 0.03795  loss_rpn_cls: 0.005338  loss_rpn_loc: 0.01292  time: 0.5746  data_time: 0.0196  lr: 0.01  max_mem: 5385M
[11/16 04:57:14] d2.utils.events INFO:  eta: 0:08:37  iter: 1099  total_loss: 0.1108  loss_cls: 0.04645  loss_box_reg: 0.03741  loss_rpn_cls: 0.005735  loss_rpn_loc: 0.01256  time: 0.5747  data_time: 0.0180  lr: 0.01  max_mem: 5385M
[11/16 04:57:26] d2.utils.events INFO:  eta: 0:08:25  iter: 1119  total_loss: 0.1027  loss_cls: 0.04557  loss_box_reg: 0.03779  loss_rpn_cls: 0.005254  loss_rpn_loc: 0.01337  time: 0.5747  data_time: 0.0225  lr: 0.01  max_mem: 5385M
[11/16 04:57:37] d2.utils.events INFO:  eta: 0:08:14  iter: 1139  total_loss: 0.1061  loss_cls: 0.04555  loss_box_reg: 0.03537  loss_rpn_cls: 0.006313  loss_rpn_loc: 0.01321  time: 0.5747  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/16 04:57:49] d2.utils.events INFO:  eta: 0:08:02  iter: 1159  total_loss: 0.1044  loss_cls: 0.04563  loss_box_reg: 0.03646  loss_rpn_cls: 0.005551  loss_rpn_loc: 0.01454  time: 0.5748  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/16 04:58:01] d2.utils.events INFO:  eta: 0:07:51  iter: 1179  total_loss: 0.09933  loss_cls: 0.04359  loss_box_reg: 0.03572  loss_rpn_cls: 0.005272  loss_rpn_loc: 0.01359  time: 0.5749  data_time: 0.0188  lr: 0.01  max_mem: 5385M
[11/16 04:58:12] d2.utils.events INFO:  eta: 0:07:40  iter: 1199  total_loss: 0.09622  loss_cls: 0.04359  loss_box_reg: 0.03631  loss_rpn_cls: 0.00568  loss_rpn_loc: 0.01112  time: 0.5749  data_time: 0.0169  lr: 0.01  max_mem: 5385M
[11/16 04:58:24] d2.utils.events INFO:  eta: 0:07:28  iter: 1219  total_loss: 0.09685  loss_cls: 0.0438  loss_box_reg: 0.03655  loss_rpn_cls: 0.004793  loss_rpn_loc: 0.01197  time: 0.5749  data_time: 0.0171  lr: 0.01  max_mem: 5385M
[11/16 04:58:35] d2.utils.events INFO:  eta: 0:07:16  iter: 1239  total_loss: 0.09785  loss_cls: 0.04358  loss_box_reg: 0.03365  loss_rpn_cls: 0.005526  loss_rpn_loc: 0.01344  time: 0.5749  data_time: 0.0196  lr: 0.01  max_mem: 5385M
[11/16 04:58:47] d2.utils.events INFO:  eta: 0:07:05  iter: 1259  total_loss: 0.09481  loss_cls: 0.04226  loss_box_reg: 0.0349  loss_rpn_cls: 0.005328  loss_rpn_loc: 0.0141  time: 0.5749  data_time: 0.0175  lr: 0.01  max_mem: 5385M
[11/16 04:58:58] d2.utils.events INFO:  eta: 0:06:53  iter: 1279  total_loss: 0.09308  loss_cls: 0.04387  loss_box_reg: 0.03327  loss_rpn_cls: 0.00453  loss_rpn_loc: 0.01097  time: 0.5749  data_time: 0.0217  lr: 0.01  max_mem: 5385M
[11/16 04:59:10] d2.utils.events INFO:  eta: 0:06:42  iter: 1299  total_loss: 0.09562  loss_cls: 0.04285  loss_box_reg: 0.03352  loss_rpn_cls: 0.005019  loss_rpn_loc: 0.01238  time: 0.5750  data_time: 0.0180  lr: 0.01  max_mem: 5385M
[11/16 04:59:21] d2.utils.events INFO:  eta: 0:06:30  iter: 1319  total_loss: 0.09292  loss_cls: 0.04159  loss_box_reg: 0.03304  loss_rpn_cls: 0.004463  loss_rpn_loc: 0.01309  time: 0.5750  data_time: 0.0194  lr: 0.01  max_mem: 5385M
[11/16 04:59:33] d2.utils.events INFO:  eta: 0:06:19  iter: 1339  total_loss: 0.09343  loss_cls: 0.04205  loss_box_reg: 0.03335  loss_rpn_cls: 0.004649  loss_rpn_loc: 0.01281  time: 0.5750  data_time: 0.0199  lr: 0.01  max_mem: 5385M
[11/16 04:59:44] d2.utils.events INFO:  eta: 0:06:07  iter: 1359  total_loss: 0.09517  loss_cls: 0.04257  loss_box_reg: 0.03225  loss_rpn_cls: 0.005053  loss_rpn_loc: 0.01253  time: 0.5750  data_time: 0.0190  lr: 0.01  max_mem: 5385M
[11/16 04:59:56] d2.utils.events INFO:  eta: 0:05:56  iter: 1379  total_loss: 0.0933  loss_cls: 0.04038  loss_box_reg: 0.03219  loss_rpn_cls: 0.004626  loss_rpn_loc: 0.01348  time: 0.5750  data_time: 0.0189  lr: 0.01  max_mem: 5385M
[11/16 05:00:07] d2.utils.events INFO:  eta: 0:05:44  iter: 1399  total_loss: 0.09584  loss_cls: 0.04138  loss_box_reg: 0.03176  loss_rpn_cls: 0.005045  loss_rpn_loc: 0.01535  time: 0.5750  data_time: 0.0201  lr: 0.01  max_mem: 5385M
[11/16 05:00:19] d2.utils.events INFO:  eta: 0:05:33  iter: 1419  total_loss: 0.09009  loss_cls: 0.03965  loss_box_reg: 0.03111  loss_rpn_cls: 0.004262  loss_rpn_loc: 0.01419  time: 0.5751  data_time: 0.0194  lr: 0.01  max_mem: 5385M
[11/16 05:00:31] d2.utils.events INFO:  eta: 0:05:21  iter: 1439  total_loss: 0.0912  loss_cls: 0.04019  loss_box_reg: 0.03243  loss_rpn_cls: 0.005252  loss_rpn_loc: 0.01594  time: 0.5751  data_time: 0.0174  lr: 0.01  max_mem: 5385M
[11/16 05:00:42] d2.utils.events INFO:  eta: 0:05:10  iter: 1459  total_loss: 0.08758  loss_cls: 0.03878  loss_box_reg: 0.03103  loss_rpn_cls: 0.004676  loss_rpn_loc: 0.01135  time: 0.5751  data_time: 0.0217  lr: 0.01  max_mem: 5385M
[11/16 05:00:54] d2.utils.events INFO:  eta: 0:04:59  iter: 1479  total_loss: 0.08753  loss_cls: 0.03814  loss_box_reg: 0.03105  loss_rpn_cls: 0.004538  loss_rpn_loc: 0.01175  time: 0.5752  data_time: 0.0169  lr: 0.01  max_mem: 5385M
[11/16 05:01:05] d2.utils.events INFO:  eta: 0:04:47  iter: 1499  total_loss: 0.0869  loss_cls: 0.03912  loss_box_reg: 0.0299  loss_rpn_cls: 0.004487  loss_rpn_loc: 0.01055  time: 0.5751  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/16 05:01:17] d2.utils.events INFO:  eta: 0:04:35  iter: 1519  total_loss: 0.08553  loss_cls: 0.03879  loss_box_reg: 0.02909  loss_rpn_cls: 0.004811  loss_rpn_loc: 0.01222  time: 0.5750  data_time: 0.0175  lr: 0.01  max_mem: 5385M
[11/16 05:01:28] d2.utils.events INFO:  eta: 0:04:24  iter: 1539  total_loss: 0.08932  loss_cls: 0.03992  loss_box_reg: 0.02959  loss_rpn_cls: 0.004456  loss_rpn_loc: 0.01382  time: 0.5750  data_time: 0.0185  lr: 0.01  max_mem: 5385M
[11/16 05:01:40] d2.utils.events INFO:  eta: 0:04:13  iter: 1559  total_loss: 0.09007  loss_cls: 0.03858  loss_box_reg: 0.0305  loss_rpn_cls: 0.004376  loss_rpn_loc: 0.01311  time: 0.5752  data_time: 0.0180  lr: 0.01  max_mem: 5385M
[11/16 05:01:52] d2.utils.events INFO:  eta: 0:04:01  iter: 1579  total_loss: 0.08872  loss_cls: 0.04029  loss_box_reg: 0.03064  loss_rpn_cls: 0.004405  loss_rpn_loc: 0.01321  time: 0.5752  data_time: 0.0183  lr: 0.01  max_mem: 5385M
[11/16 05:02:03] d2.utils.events INFO:  eta: 0:03:50  iter: 1599  total_loss: 0.08507  loss_cls: 0.03723  loss_box_reg: 0.02835  loss_rpn_cls: 0.004192  loss_rpn_loc: 0.01498  time: 0.5751  data_time: 0.0191  lr: 0.01  max_mem: 5385M
[11/16 05:02:15] d2.utils.events INFO:  eta: 0:03:38  iter: 1619  total_loss: 0.08322  loss_cls: 0.03593  loss_box_reg: 0.02803  loss_rpn_cls: 0.004665  loss_rpn_loc: 0.01151  time: 0.5752  data_time: 0.0190  lr: 0.001  max_mem: 5385M
[11/16 05:02:26] d2.utils.events INFO:  eta: 0:03:27  iter: 1639  total_loss: 0.08108  loss_cls: 0.03745  loss_box_reg: 0.03002  loss_rpn_cls: 0.004226  loss_rpn_loc: 0.00914  time: 0.5752  data_time: 0.0187  lr: 0.001  max_mem: 5385M
[11/16 05:02:38] d2.utils.events INFO:  eta: 0:03:15  iter: 1659  total_loss: 0.07645  loss_cls: 0.03666  loss_box_reg: 0.02837  loss_rpn_cls: 0.004313  loss_rpn_loc: 0.007026  time: 0.5751  data_time: 0.0209  lr: 0.001  max_mem: 5385M
[11/16 05:02:49] d2.utils.events INFO:  eta: 0:03:04  iter: 1679  total_loss: 0.07494  loss_cls: 0.03676  loss_box_reg: 0.02679  loss_rpn_cls: 0.003906  loss_rpn_loc: 0.00861  time: 0.5752  data_time: 0.0237  lr: 0.001  max_mem: 5385M
[11/16 05:03:01] d2.utils.events INFO:  eta: 0:02:52  iter: 1699  total_loss: 0.07587  loss_cls: 0.03669  loss_box_reg: 0.02819  loss_rpn_cls: 0.00426  loss_rpn_loc: 0.007628  time: 0.5752  data_time: 0.0202  lr: 0.001  max_mem: 5385M
[11/16 05:03:12] d2.utils.events INFO:  eta: 0:02:41  iter: 1719  total_loss: 0.07768  loss_cls: 0.03672  loss_box_reg: 0.02751  loss_rpn_cls: 0.004204  loss_rpn_loc: 0.008481  time: 0.5753  data_time: 0.0210  lr: 0.001  max_mem: 5385M
[11/16 05:03:24] d2.utils.events INFO:  eta: 0:02:29  iter: 1739  total_loss: 0.0771  loss_cls: 0.03806  loss_box_reg: 0.02685  loss_rpn_cls: 0.003992  loss_rpn_loc: 0.006559  time: 0.5752  data_time: 0.0205  lr: 0.001  max_mem: 5386M
[11/16 05:03:35] d2.utils.events INFO:  eta: 0:02:18  iter: 1759  total_loss: 0.07473  loss_cls: 0.03669  loss_box_reg: 0.02764  loss_rpn_cls: 0.004109  loss_rpn_loc: 0.006659  time: 0.5751  data_time: 0.0176  lr: 0.001  max_mem: 5386M
[11/16 05:03:47] d2.utils.events INFO:  eta: 0:02:06  iter: 1779  total_loss: 0.07757  loss_cls: 0.03675  loss_box_reg: 0.02756  loss_rpn_cls: 0.00397  loss_rpn_loc: 0.007311  time: 0.5751  data_time: 0.0178  lr: 0.001  max_mem: 5386M
[11/16 05:03:58] d2.utils.events INFO:  eta: 0:01:55  iter: 1799  total_loss: 0.0808  loss_cls: 0.03761  loss_box_reg: 0.02842  loss_rpn_cls: 0.004034  loss_rpn_loc: 0.006952  time: 0.5751  data_time: 0.0166  lr: 0.001  max_mem: 5386M
[11/16 05:04:10] d2.utils.events INFO:  eta: 0:01:43  iter: 1819  total_loss: 0.07565  loss_cls: 0.03686  loss_box_reg: 0.02701  loss_rpn_cls: 0.003603  loss_rpn_loc: 0.006727  time: 0.5750  data_time: 0.0191  lr: 0.001  max_mem: 5386M
[11/16 05:04:21] d2.utils.events INFO:  eta: 0:01:32  iter: 1839  total_loss: 0.07504  loss_cls: 0.03688  loss_box_reg: 0.02763  loss_rpn_cls: 0.003806  loss_rpn_loc: 0.005801  time: 0.5750  data_time: 0.0184  lr: 0.001  max_mem: 5386M
[11/16 05:04:33] d2.utils.events INFO:  eta: 0:01:20  iter: 1859  total_loss: 0.07588  loss_cls: 0.03702  loss_box_reg: 0.02777  loss_rpn_cls: 0.004342  loss_rpn_loc: 0.007451  time: 0.5750  data_time: 0.0191  lr: 0.001  max_mem: 5386M
[11/16 05:04:44] d2.utils.events INFO:  eta: 0:01:08  iter: 1879  total_loss: 0.07603  loss_cls: 0.03765  loss_box_reg: 0.02753  loss_rpn_cls: 0.004064  loss_rpn_loc: 0.00654  time: 0.5750  data_time: 0.0171  lr: 0.001  max_mem: 5386M
[11/16 05:04:55] d2.utils.events INFO:  eta: 0:00:57  iter: 1899  total_loss: 0.07563  loss_cls: 0.03701  loss_box_reg: 0.02714  loss_rpn_cls: 0.004038  loss_rpn_loc: 0.007088  time: 0.5749  data_time: 0.0199  lr: 0.001  max_mem: 5386M
[11/16 05:05:07] d2.utils.events INFO:  eta: 0:00:45  iter: 1919  total_loss: 0.07938  loss_cls: 0.03657  loss_box_reg: 0.02788  loss_rpn_cls: 0.003606  loss_rpn_loc: 0.007077  time: 0.5750  data_time: 0.0186  lr: 0.001  max_mem: 5386M
[11/16 05:05:19] d2.utils.events INFO:  eta: 0:00:34  iter: 1939  total_loss: 0.07588  loss_cls: 0.03616  loss_box_reg: 0.02788  loss_rpn_cls: 0.003671  loss_rpn_loc: 0.00635  time: 0.5750  data_time: 0.0179  lr: 0.001  max_mem: 5386M
[11/16 05:05:30] d2.utils.events INFO:  eta: 0:00:22  iter: 1959  total_loss: 0.07184  loss_cls: 0.0358  loss_box_reg: 0.02615  loss_rpn_cls: 0.003666  loss_rpn_loc: 0.006348  time: 0.5749  data_time: 0.0183  lr: 0.001  max_mem: 5386M
[11/16 05:05:42] d2.utils.events INFO:  eta: 0:00:11  iter: 1979  total_loss: 0.07686  loss_cls: 0.03629  loss_box_reg: 0.0273  loss_rpn_cls: 0.003245  loss_rpn_loc: 0.006234  time: 0.5749  data_time: 0.0187  lr: 0.001  max_mem: 5386M
[11/16 05:05:53] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/model_final.pth
[11/16 05:05:55] d2.utils.events INFO:  eta: 0:00:00  iter: 1999  total_loss: 0.07479  loss_cls: 0.03656  loss_box_reg: 0.02814  loss_rpn_cls: 0.003996  loss_rpn_loc: 0.007511  time: 0.5749  data_time: 0.0195  lr: 0.001  max_mem: 5386M
[11/16 05:05:55] d2.engine.hooks INFO: Overall training speed: 1998 iterations in 0:19:08 (0.5749 s / it)
[11/16 05:05:55] d2.engine.hooks INFO: Total training time: 0:19:13 (0:00:04 on hooks)
[11/16 05:05:56] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 10538        |  bicycle   | 313          |     car      | 1641         |
|  motorcycle  | 388          |  airplane  | 131          |     bus      | 259          |
|    train     | 212          |    boat    | 458          |     bird     | 453          |
|     cat      | 195          |    dog     | 223          |    horse     | 305          |
|    sheep     | 306          |    cow     | 376          |    bottle    | 939          |
|    chair     | 1594         |   couch    | 236          | potted plant | 429          |
| dining table | 633          |     tv     | 257          |              |              |
|    total     | 19886        |            |              |              |              |[0m
[11/16 05:05:56] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 05:05:56] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/16 05:05:56] d2.data.common INFO: Serialized dataset takes 2.08 MiB
[11/16 05:05:57] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/16 05:05:57] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/16 05:05:58] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 05:05:58] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/16 05:05:58] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/16 05:06:03] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/16 05:06:17] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1301 s / img. ETA=0:02:36
[11/16 05:06:23] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1288 s / img. ETA=0:02:28
[11/16 05:06:29] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1284 s / img. ETA=0:02:21
[11/16 05:06:36] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1278 s / img. ETA=0:02:14
[11/16 05:06:43] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1299 s / img. ETA=0:02:09
[11/16 05:06:49] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1284 s / img. ETA=0:02:02
[11/16 05:06:55] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1276 s / img. ETA=0:01:54
[11/16 05:07:01] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1277 s / img. ETA=0:01:48
[11/16 05:07:08] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1276 s / img. ETA=0:01:42
[11/16 05:07:14] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1273 s / img. ETA=0:01:35
[11/16 05:07:20] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1273 s / img. ETA=0:01:29
[11/16 05:07:26] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1271 s / img. ETA=0:01:22
[11/16 05:07:33] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1270 s / img. ETA=0:01:16
[11/16 05:07:39] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1266 s / img. ETA=0:01:09
[11/16 05:07:45] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1266 s / img. ETA=0:01:03
[11/16 05:07:51] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1265 s / img. ETA=0:00:56
[11/16 05:07:58] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1264 s / img. ETA=0:00:50
[11/16 05:08:04] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1265 s / img. ETA=0:00:44
[11/16 05:08:10] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1263 s / img. ETA=0:00:37
[11/16 05:08:16] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1263 s / img. ETA=0:00:31
[11/16 05:08:23] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1263 s / img. ETA=0:00:25
[11/16 05:08:29] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1263 s / img. ETA=0:00:18
[11/16 05:08:35] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1262 s / img. ETA=0:00:12
[11/16 05:08:41] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1262 s / img. ETA=0:00:06
[11/16 05:08:48] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1261 s / img. ETA=0:00:00
[11/16 05:08:48] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:37 (0.126104 s / img per device, on 4 devices)
[11/16 05:08:48] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:33 (0.123667 s / img per device, on 4 devices)
[11/16 05:08:49] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/16 05:08:49] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/inference/coco_instances_results.json
[11/16 05:08:49] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/16 05:08:57] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 13.256 | 23.839 | 13.003 | 4.705 | 14.244 | 20.491 |
[11/16 05:08:57] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.433  | bicycle    | 6.351  | car          | 18.537 |
| motorcycle   | 12.970 | airplane   | 29.817 | bus          | 45.337 |
| train        | 30.053 | boat       | 6.204  | bird         | 9.002  |
| cat          | 25.622 | dog        | 17.564 | horse        | 25.703 |
| sheep        | 7.641  | cow        | 10.411 | bottle       | 3.466  |
| chair        | 0.778  | couch      | 2.364  | potted plant | 0.405  |
| dining table | 2.448  | tv         | 9.010  |              |        |
[11/16 05:08:57] defrcn.engine.defaults INFO: Evaluation results for coco14_test_novel in csv format:
[11/16 05:08:57] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/16 05:08:57] defrcn.evaluation.testing INFO: copypaste: nAP,nAP50,nAP75,nAPs,nAPm,nAPl,AP
[11/16 05:08:57] defrcn.evaluation.testing INFO: copypaste: 13.2558,23.8391,13.0031,4.7047,14.2442,20.4914,13.2558
[11/16 05:09:08] detectron2 INFO: Rank of current process: 0. World size: 4
[11/16 05:09:08] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_gfsod_r101_novel_3shot_seed4.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4', 'SEED', '38112449'], resume=False, start_iter=-1)
[11/16 05:09:08] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_gfsod_r101_novel_3shot_seed4.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 80
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_all_3shot_seed4", )
  TEST: ('coco14_test_all',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (3840,)
  MAX_ITER: 4800
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/16 05:09:08] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/config.yaml
[11/16 05:09:09] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/16 05:09:09] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/model_final-merge.pth ...
[11/16 05:09:10] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10538        |   bicycle    | 313          |      car      | 1641         |
|  motorcycle   | 388          |   airplane   | 131          |      bus      | 259          |
|     train     | 212          |    truck     | 352          |     boat      | 458          |
| traffic light | 516          | fire hydrant | 83           |   stop sign   | 84           |
| parking meter | 59           |    bench     | 471          |     bird      | 453          |
|      cat      | 195          |     dog      | 223          |     horse     | 305          |
|     sheep     | 306          |     cow      | 376          |   elephant    | 283          |
|     bear      | 53           |    zebra     | 275          |    giraffe    | 170          |
|   backpack    | 384          |   umbrella   | 387          |    handbag    | 483          |
|      tie      | 290          |   suitcase   | 309          |    frisbee    | 109          |
|     skis      | 281          |  snowboard   | 90           |  sports ball  | 233          |
|     kite      | 381          | baseball bat | 123          | baseball gl.. | 139          |
|  skateboard   | 215          |  surfboard   | 266          | tennis racket | 183          |
|    bottle     | 939          |  wine glass  | 363          |      cup      | 891          |
|     fork      | 234          |    knife     | 290          |     spoon     | 253          |
|     bowl      | 617          |    banana    | 359          |     apple     | 158          |
|   sandwich    | 158          |    orange    | 185          |   broccoli    | 330          |
|    carrot     | 341          |   hot dog    | 160          |     pizza     | 223          |
|     donut     | 225          |     cake     | 236          |     chair     | 1594         |
|     couch     | 236          | potted plant | 429          |      bed      | 195          |
| dining table  | 633          |    toilet    | 179          |      tv       | 257          |
|    laptop     | 236          |    mouse     | 95           |    remote     | 241          |
|   keyboard    | 117          |  cell phone  | 291          |   microwave   | 88           |
|     oven      | 142          |   toaster    | 11           |     sink      | 211          |
| refrigerator  | 107          |     book     | 1031         |     clock     | 290          |
|     vase      | 350          |   scissors   | 56           |  teddy bear   | 238          |
|  hair drier   | 11           |  toothbrush  | 77           |               |              |
|     total     | 35094        |              |              |               |              |[0m
[11/16 05:09:10] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 05:09:10] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/16 05:09:10] d2.data.common INFO: Serialized dataset takes 3.00 MiB
[11/16 05:09:11] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/16 05:09:11] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/16 05:09:17] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 3            |   bicycle    | 3            |      car      | 3            |
|  motorcycle   | 3            |   airplane   | 3            |      bus      | 3            |
|     train     | 3            |    truck     | 3            |     boat      | 3            |
| traffic light | 3            | fire hydrant | 3            |   stop sign   | 3            |
| parking meter | 3            |    bench     | 3            |     bird      | 3            |
|      cat      | 3            |     dog      | 3            |     horse     | 3            |
|     sheep     | 3            |     cow      | 3            |   elephant    | 3            |
|     bear      | 3            |    zebra     | 3            |    giraffe    | 3            |
|   backpack    | 3            |   umbrella   | 3            |    handbag    | 3            |
|      tie      | 3            |   suitcase   | 3            |    frisbee    | 3            |
|     skis      | 3            |  snowboard   | 3            |  sports ball  | 3            |
|     kite      | 3            | baseball bat | 3            | baseball gl.. | 3            |
|  skateboard   | 3            |  surfboard   | 3            | tennis racket | 3            |
|    bottle     | 3            |  wine glass  | 3            |      cup      | 3            |
|     fork      | 3            |    knife     | 3            |     spoon     | 3            |
|     bowl      | 3            |    banana    | 3            |     apple     | 3            |
|   sandwich    | 3            |    orange    | 3            |   broccoli    | 3            |
|    carrot     | 3            |   hot dog    | 3            |     pizza     | 3            |
|     donut     | 3            |     cake     | 3            |     chair     | 3            |
|     couch     | 3            | potted plant | 3            |      bed      | 3            |
| dining table  | 3            |    toilet    | 3            |      tv       | 3            |
|    laptop     | 3            |    mouse     | 3            |    remote     | 3            |
|   keyboard    | 3            |  cell phone  | 3            |   microwave   | 3            |
|     oven      | 3            |   toaster    | 3            |     sink      | 3            |
| refrigerator  | 3            |     book     | 3            |     clock     | 3            |
|     vase      | 3            |   scissors   | 3            |  teddy bear   | 3            |
|  hair drier   | 3            |  toothbrush  | 3            |               |              |
|     total     | 240          |              |              |               |              |[0m
[11/16 05:09:17] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 05:09:17] d2.data.common INFO: Serializing 240 elements to byte tensors and concatenating them all ...
[11/16 05:09:17] d2.data.common INFO: Serialized dataset takes 0.06 MiB
[11/16 05:09:34] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/16 05:09:48] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1277 s / img. ETA=0:02:33
[11/16 05:09:55] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1273 s / img. ETA=0:02:26
[11/16 05:10:01] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1265 s / img. ETA=0:02:19
[11/16 05:10:07] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1262 s / img. ETA=0:02:12
[11/16 05:10:14] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1271 s / img. ETA=0:02:07
[11/16 05:10:20] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1265 s / img. ETA=0:02:00
[11/16 05:10:26] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1262 s / img. ETA=0:01:53
[11/16 05:10:33] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1266 s / img. ETA=0:01:47
[11/16 05:10:39] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1267 s / img. ETA=0:01:41
[11/16 05:10:45] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1263 s / img. ETA=0:01:34
[11/16 05:10:51] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1263 s / img. ETA=0:01:28
[11/16 05:10:58] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1263 s / img. ETA=0:01:22
[11/16 05:11:04] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1264 s / img. ETA=0:01:15
[11/16 05:11:10] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1262 s / img. ETA=0:01:09
[11/16 05:11:17] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1262 s / img. ETA=0:01:03
[11/16 05:11:23] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1261 s / img. ETA=0:00:56
[11/16 05:11:29] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1260 s / img. ETA=0:00:50
[11/16 05:11:35] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1261 s / img. ETA=0:00:44
[11/16 05:11:42] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1260 s / img. ETA=0:00:37
[11/16 05:11:48] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1260 s / img. ETA=0:00:31
[11/16 05:11:55] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1264 s / img. ETA=0:00:25
[11/16 05:12:01] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1263 s / img. ETA=0:00:18
[11/16 05:12:07] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1263 s / img. ETA=0:00:12
[11/16 05:12:14] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1263 s / img. ETA=0:00:06
[11/16 05:12:20] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1262 s / img. ETA=0:00:00
[11/16 05:12:20] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:37 (0.126104 s / img per device, on 4 devices)
[11/16 05:12:20] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:33 (0.123674 s / img per device, on 4 devices)
[11/16 05:12:27] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/16 05:12:27] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed4/inference/coco_instances_results.json
[11/16 05:12:27] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/16 05:12:51] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 30.898 | 47.887 | 32.869 | 14.857 | 35.207 | 44.272 |
[11/16 05:12:51] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category      | AP     | category     | AP     | category       | AP     |
|:--------------|:-------|:-------------|:-------|:---------------|:-------|
| person        | 1.451  | bicycle      | 6.392  | car            | 20.781 |
| motorcycle    | 13.131 | airplane     | 28.902 | bus            | 45.276 |
| train         | 30.795 | truck        | 28.279 | boat           | 6.001  |
| traffic light | 24.960 | fire hydrant | 64.879 | stop sign      | 69.606 |
| parking meter | 38.031 | bench        | 18.006 | bird           | 9.400  |
| cat           | 26.478 | dog          | 17.504 | horse          | 26.134 |
| sheep         | 11.785 | cow          | 13.066 | elephant       | 65.123 |
| bear          | 59.052 | zebra        | 59.701 | giraffe        | 66.900 |
| backpack      | 16.317 | umbrella     | 30.937 | handbag        | 14.657 |
| tie           | 32.237 | suitcase     | 27.851 | frisbee        | 55.866 |
| skis          | 22.680 | snowboard    | 33.951 | sports ball    | 40.262 |
| kite          | 37.947 | baseball bat | 25.600 | baseball glove | 30.384 |
| skateboard    | 47.740 | surfboard    | 40.359 | tennis racket  | 48.874 |
| bottle        | 4.593  | wine glass   | 29.351 | cup            | 37.010 |
| fork          | 33.566 | knife        | 16.333 | spoon          | 17.089 |
| bowl          | 36.001 | banana       | 25.214 | apple          | 19.000 |
| sandwich      | 33.068 | orange       | 23.403 | broccoli       | 26.184 |
| carrot        | 24.104 | hot dog      | 30.501 | pizza          | 50.980 |
| donut         | 48.680 | cake         | 39.495 | chair          | 0.853  |
| couch         | 2.720  | potted plant | 0.602  | bed            | 41.442 |
| dining table  | 3.678  | toilet       | 53.991 | tv             | 14.853 |
| laptop        | 55.141 | mouse        | 48.158 | remote         | 28.979 |
| keyboard      | 51.613 | cell phone   | 25.224 | microwave      | 51.168 |
| oven          | 35.358 | toaster      | 29.588 | sink           | 33.847 |
| refrigerator  | 50.325 | book         | 8.412  | clock          | 48.613 |
| vase          | 32.079 | scissors     | 25.695 | teddy bear     | 40.218 |
| hair drier    | 19.300 | toothbrush   | 18.080 |                |        |
[11/16 05:13:08] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 36.457 | 55.306 | 39.172 | 18.153 | 41.807 | 51.661 |
[11/16 05:13:08] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category       | AP     | category      | AP     | category     | AP     |
|:---------------|:-------|:--------------|:-------|:-------------|:-------|
| truck          | 28.279 | traffic light | 24.960 | fire hydrant | 64.879 |
| stop sign      | 69.606 | parking meter | 38.031 | bench        | 18.006 |
| elephant       | 65.123 | bear          | 59.052 | zebra        | 59.701 |
| giraffe        | 66.900 | backpack      | 16.317 | umbrella     | 30.937 |
| handbag        | 14.657 | tie           | 32.237 | suitcase     | 27.851 |
| frisbee        | 55.866 | skis          | 22.680 | snowboard    | 33.951 |
| sports ball    | 40.262 | kite          | 37.947 | baseball bat | 25.600 |
| baseball glove | 30.384 | skateboard    | 47.740 | surfboard    | 40.359 |
| tennis racket  | 48.874 | wine glass    | 29.351 | cup          | 37.010 |
| fork           | 33.566 | knife         | 16.333 | spoon        | 17.089 |
| bowl           | 36.001 | banana        | 25.214 | apple        | 19.000 |
| sandwich       | 33.068 | orange        | 23.403 | broccoli     | 26.184 |
| carrot         | 24.104 | hot dog       | 30.501 | pizza        | 50.980 |
| donut          | 48.680 | cake          | 39.495 | bed          | 41.442 |
| toilet         | 53.991 | laptop        | 55.141 | mouse        | 48.158 |
| remote         | 28.979 | keyboard      | 51.613 | cell phone   | 25.224 |
| microwave      | 51.168 | oven          | 35.358 | toaster      | 29.588 |
| sink           | 33.847 | refrigerator  | 50.325 | book         | 8.412  |
| clock          | 48.613 | vase          | 32.079 | scissors     | 25.695 |
| teddy bear     | 40.218 | hair drier    | 19.300 | toothbrush   | 18.080 |
[11/16 05:13:14] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 14.220 | 25.630 | 13.958 | 5.136 | 15.409 | 22.106 |
[11/16 05:13:14] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.451  | bicycle    | 6.392  | car          | 20.781 |
| motorcycle   | 13.131 | airplane   | 28.902 | bus          | 45.276 |
| train        | 30.795 | boat       | 6.001  | bird         | 9.400  |
| cat          | 26.478 | dog        | 17.504 | horse        | 26.134 |
| sheep        | 11.785 | cow        | 13.066 | bottle       | 4.593  |
| chair        | 0.853  | couch      | 2.720  | potted plant | 0.602  |
| dining table | 3.678  | tv         | 14.853 |              |        |
[11/16 05:13:14] defrcn.engine.defaults INFO: Evaluation results for coco14_test_all in csv format:
[11/16 05:13:14] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/16 05:13:14] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,APs,APm,APl,bAP,bAP50,bAP75,bAPs,bAPm,bAPl,nAP,nAP50,nAP75,nAPs,nAPm,nAPl
[11/16 05:13:14] defrcn.evaluation.testing INFO: copypaste: 30.8975,47.8871,32.8689,14.8573,35.2073,44.2724,36.4568,55.3062,39.1725,18.1525,41.8067,51.6611,14.2198,25.6300,13.9582,5.1363,15.4091,22.1061
