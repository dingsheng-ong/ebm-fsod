[11/17 17:10:56] detectron2 INFO: Rank of current process: 0. World size: 4
[11/17 17:10:56] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_fsod_r101_novel_3shot_seed8.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/17 17:10:56] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_fsod_r101_novel_3shot_seed8.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_novel_3shot_seed8", )
  TEST: ('coco14_test_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/17 17:10:56] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/config.yaml
[11/17 17:10:56] d2.utils.env INFO: Using a generated random seed 57569278
[11/17 17:10:56] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/17 17:10:57] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 60 images left.
[11/17 17:10:57] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 3            |  bicycle   | 3            |     car      | 3            |
|  motorcycle  | 3            |  airplane  | 3            |     bus      | 3            |
|    train     | 3            |    boat    | 3            |     bird     | 3            |
|     cat      | 3            |    dog     | 3            |    horse     | 3            |
|    sheep     | 3            |    cow     | 3            |    bottle    | 3            |
|    chair     | 3            |   couch    | 3            | potted plant | 3            |
| dining table | 3            |     tv     | 3            |              |              |
|    total     | 60           |            |              |              |              |[0m
[11/17 17:10:57] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/17 17:10:57] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/17 17:10:57] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/17 17:10:57] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/17 17:10:57] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth ...
[11/17 17:10:57] d2.engine.train_loop INFO: Starting training from iteration 0
[11/17 17:11:11] d2.utils.events INFO:  eta: 0:17:39  iter: 19  total_loss: 0.7558  loss_cls: 0.4577  loss_box_reg: 0.1175  loss_rpn_cls: 0.1374  loss_rpn_loc: 0.05503  time: 0.5801  data_time: 0.1127  lr: 0.01  max_mem: 5161M
[11/17 17:11:22] d2.utils.events INFO:  eta: 0:17:30  iter: 39  total_loss: 0.6969  loss_cls: 0.4355  loss_box_reg: 0.1255  loss_rpn_cls: 0.08999  loss_rpn_loc: 0.0529  time: 0.5603  data_time: 0.0121  lr: 0.01  max_mem: 5281M
[11/17 17:11:33] d2.utils.events INFO:  eta: 0:17:15  iter: 59  total_loss: 0.4602  loss_cls: 0.2041  loss_box_reg: 0.1275  loss_rpn_cls: 0.07314  loss_rpn_loc: 0.04182  time: 0.5519  data_time: 0.0122  lr: 0.01  max_mem: 5384M
[11/17 17:11:44] d2.utils.events INFO:  eta: 0:17:02  iter: 79  total_loss: 0.4144  loss_cls: 0.1763  loss_box_reg: 0.1244  loss_rpn_cls: 0.06659  loss_rpn_loc: 0.04136  time: 0.5529  data_time: 0.0439  lr: 0.01  max_mem: 5384M
[11/17 17:11:55] d2.utils.events INFO:  eta: 0:16:52  iter: 99  total_loss: 0.3792  loss_cls: 0.1613  loss_box_reg: 0.1239  loss_rpn_cls: 0.05925  loss_rpn_loc: 0.04037  time: 0.5535  data_time: 0.0132  lr: 0.01  max_mem: 5384M
[11/17 17:12:06] d2.utils.events INFO:  eta: 0:16:40  iter: 119  total_loss: 0.3582  loss_cls: 0.1501  loss_box_reg: 0.1186  loss_rpn_cls: 0.05662  loss_rpn_loc: 0.03441  time: 0.5498  data_time: 0.0127  lr: 0.01  max_mem: 5385M
[11/17 17:12:16] d2.utils.events INFO:  eta: 0:16:30  iter: 139  total_loss: 0.3256  loss_cls: 0.1381  loss_box_reg: 0.1135  loss_rpn_cls: 0.04607  loss_rpn_loc: 0.03333  time: 0.5483  data_time: 0.0133  lr: 0.01  max_mem: 5385M
[11/17 17:12:27] d2.utils.events INFO:  eta: 0:16:20  iter: 159  total_loss: 0.322  loss_cls: 0.1342  loss_box_reg: 0.1142  loss_rpn_cls: 0.03854  loss_rpn_loc: 0.03003  time: 0.5468  data_time: 0.0127  lr: 0.01  max_mem: 5385M
[11/17 17:12:38] d2.utils.events INFO:  eta: 0:16:09  iter: 179  total_loss: 0.3174  loss_cls: 0.1296  loss_box_reg: 0.1145  loss_rpn_cls: 0.03756  loss_rpn_loc: 0.03177  time: 0.5456  data_time: 0.0117  lr: 0.01  max_mem: 5385M
[11/17 17:12:49] d2.utils.events INFO:  eta: 0:15:58  iter: 199  total_loss: 0.2923  loss_cls: 0.1172  loss_box_reg: 0.1072  loss_rpn_cls: 0.03821  loss_rpn_loc: 0.02875  time: 0.5446  data_time: 0.0127  lr: 0.01  max_mem: 5385M
[11/17 17:12:59] d2.utils.events INFO:  eta: 0:15:47  iter: 219  total_loss: 0.2785  loss_cls: 0.1174  loss_box_reg: 0.1059  loss_rpn_cls: 0.03193  loss_rpn_loc: 0.03087  time: 0.5430  data_time: 0.0115  lr: 0.01  max_mem: 5385M
[11/17 17:13:10] d2.utils.events INFO:  eta: 0:15:38  iter: 239  total_loss: 0.2859  loss_cls: 0.1135  loss_box_reg: 0.1039  loss_rpn_cls: 0.03357  loss_rpn_loc: 0.02789  time: 0.5429  data_time: 0.0117  lr: 0.01  max_mem: 5385M
[11/17 17:13:21] d2.utils.events INFO:  eta: 0:15:29  iter: 259  total_loss: 0.2681  loss_cls: 0.1062  loss_box_reg: 0.1053  loss_rpn_cls: 0.03037  loss_rpn_loc: 0.02826  time: 0.5426  data_time: 0.0130  lr: 0.01  max_mem: 5385M
[11/17 17:13:32] d2.utils.events INFO:  eta: 0:15:17  iter: 279  total_loss: 0.2533  loss_cls: 0.1043  loss_box_reg: 0.09784  loss_rpn_cls: 0.02858  loss_rpn_loc: 0.02751  time: 0.5433  data_time: 0.0120  lr: 0.01  max_mem: 5385M
[11/17 17:13:43] d2.utils.events INFO:  eta: 0:15:06  iter: 299  total_loss: 0.2521  loss_cls: 0.0965  loss_box_reg: 0.09696  loss_rpn_cls: 0.02788  loss_rpn_loc: 0.0278  time: 0.5427  data_time: 0.0131  lr: 0.01  max_mem: 5385M
[11/17 17:13:53] d2.utils.events INFO:  eta: 0:14:55  iter: 319  total_loss: 0.2494  loss_cls: 0.09941  loss_box_reg: 0.09285  loss_rpn_cls: 0.0253  loss_rpn_loc: 0.03166  time: 0.5423  data_time: 0.0122  lr: 0.01  max_mem: 5385M
[11/17 17:14:04] d2.utils.events INFO:  eta: 0:14:44  iter: 339  total_loss: 0.2419  loss_cls: 0.09288  loss_box_reg: 0.09156  loss_rpn_cls: 0.02376  loss_rpn_loc: 0.02597  time: 0.5412  data_time: 0.0126  lr: 0.01  max_mem: 5385M
[11/17 17:14:14] d2.utils.events INFO:  eta: 0:14:33  iter: 359  total_loss: 0.2292  loss_cls: 0.09138  loss_box_reg: 0.0893  loss_rpn_cls: 0.02116  loss_rpn_loc: 0.02786  time: 0.5406  data_time: 0.0127  lr: 0.01  max_mem: 5385M
[11/17 17:14:25] d2.utils.events INFO:  eta: 0:14:22  iter: 379  total_loss: 0.2208  loss_cls: 0.08626  loss_box_reg: 0.08716  loss_rpn_cls: 0.02207  loss_rpn_loc: 0.02536  time: 0.5400  data_time: 0.0112  lr: 0.01  max_mem: 5385M
[11/17 17:14:36] d2.utils.events INFO:  eta: 0:14:11  iter: 399  total_loss: 0.2254  loss_cls: 0.08637  loss_box_reg: 0.08287  loss_rpn_cls: 0.02182  loss_rpn_loc: 0.02842  time: 0.5397  data_time: 0.0123  lr: 0.01  max_mem: 5385M
[11/17 17:14:46] d2.utils.events INFO:  eta: 0:14:00  iter: 419  total_loss: 0.2126  loss_cls: 0.08412  loss_box_reg: 0.08095  loss_rpn_cls: 0.01946  loss_rpn_loc: 0.02766  time: 0.5394  data_time: 0.0115  lr: 0.01  max_mem: 5385M
[11/17 17:14:57] d2.utils.events INFO:  eta: 0:13:49  iter: 439  total_loss: 0.2161  loss_cls: 0.08484  loss_box_reg: 0.07787  loss_rpn_cls: 0.01977  loss_rpn_loc: 0.0257  time: 0.5391  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:15:08] d2.utils.events INFO:  eta: 0:13:38  iter: 459  total_loss: 0.1956  loss_cls: 0.07741  loss_box_reg: 0.07391  loss_rpn_cls: 0.01619  loss_rpn_loc: 0.02743  time: 0.5387  data_time: 0.0111  lr: 0.01  max_mem: 5385M
[11/17 17:15:18] d2.utils.events INFO:  eta: 0:13:28  iter: 479  total_loss: 0.1936  loss_cls: 0.07775  loss_box_reg: 0.07461  loss_rpn_cls: 0.01781  loss_rpn_loc: 0.02722  time: 0.5386  data_time: 0.0102  lr: 0.01  max_mem: 5385M
[11/17 17:15:29] d2.utils.events INFO:  eta: 0:13:18  iter: 499  total_loss: 0.1905  loss_cls: 0.07553  loss_box_reg: 0.07016  loss_rpn_cls: 0.01631  loss_rpn_loc: 0.02417  time: 0.5383  data_time: 0.0108  lr: 0.01  max_mem: 5385M
[11/17 17:15:40] d2.utils.events INFO:  eta: 0:13:07  iter: 519  total_loss: 0.1832  loss_cls: 0.0745  loss_box_reg: 0.06744  loss_rpn_cls: 0.01561  loss_rpn_loc: 0.02659  time: 0.5380  data_time: 0.0125  lr: 0.01  max_mem: 5385M
[11/17 17:15:50] d2.utils.events INFO:  eta: 0:12:56  iter: 539  total_loss: 0.1904  loss_cls: 0.07404  loss_box_reg: 0.06732  loss_rpn_cls: 0.01741  loss_rpn_loc: 0.02735  time: 0.5378  data_time: 0.0121  lr: 0.01  max_mem: 5385M
[11/17 17:16:01] d2.utils.events INFO:  eta: 0:12:45  iter: 559  total_loss: 0.1755  loss_cls: 0.07159  loss_box_reg: 0.0681  loss_rpn_cls: 0.01527  loss_rpn_loc: 0.02502  time: 0.5377  data_time: 0.0113  lr: 0.01  max_mem: 5385M
[11/17 17:16:12] d2.utils.events INFO:  eta: 0:12:34  iter: 579  total_loss: 0.176  loss_cls: 0.0696  loss_box_reg: 0.06282  loss_rpn_cls: 0.01553  loss_rpn_loc: 0.02453  time: 0.5375  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:16:22] d2.utils.events INFO:  eta: 0:12:24  iter: 599  total_loss: 0.1674  loss_cls: 0.06766  loss_box_reg: 0.06049  loss_rpn_cls: 0.01406  loss_rpn_loc: 0.02479  time: 0.5374  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:16:34] d2.utils.events INFO:  eta: 0:12:13  iter: 619  total_loss: 0.1688  loss_cls: 0.06676  loss_box_reg: 0.06046  loss_rpn_cls: 0.01433  loss_rpn_loc: 0.02466  time: 0.5380  data_time: 0.0120  lr: 0.01  max_mem: 5385M
[11/17 17:16:44] d2.utils.events INFO:  eta: 0:12:03  iter: 639  total_loss: 0.1567  loss_cls: 0.06548  loss_box_reg: 0.05583  loss_rpn_cls: 0.01382  loss_rpn_loc: 0.02321  time: 0.5379  data_time: 0.0110  lr: 0.01  max_mem: 5385M
[11/17 17:16:55] d2.utils.events INFO:  eta: 0:11:52  iter: 659  total_loss: 0.1599  loss_cls: 0.06521  loss_box_reg: 0.05672  loss_rpn_cls: 0.01302  loss_rpn_loc: 0.02448  time: 0.5378  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:17:05] d2.utils.events INFO:  eta: 0:11:41  iter: 679  total_loss: 0.1612  loss_cls: 0.06484  loss_box_reg: 0.05676  loss_rpn_cls: 0.01296  loss_rpn_loc: 0.02211  time: 0.5375  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:17:16] d2.utils.events INFO:  eta: 0:11:30  iter: 699  total_loss: 0.1531  loss_cls: 0.06359  loss_box_reg: 0.05432  loss_rpn_cls: 0.01183  loss_rpn_loc: 0.02368  time: 0.5374  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:17:27] d2.utils.events INFO:  eta: 0:11:20  iter: 719  total_loss: 0.1449  loss_cls: 0.06106  loss_box_reg: 0.05141  loss_rpn_cls: 0.01137  loss_rpn_loc: 0.02083  time: 0.5381  data_time: 0.0111  lr: 0.01  max_mem: 5385M
[11/17 17:17:39] d2.utils.events INFO:  eta: 0:11:09  iter: 739  total_loss: 0.1459  loss_cls: 0.05961  loss_box_reg: 0.05088  loss_rpn_cls: 0.01367  loss_rpn_loc: 0.02307  time: 0.5386  data_time: 0.0424  lr: 0.01  max_mem: 5385M
[11/17 17:17:49] d2.utils.events INFO:  eta: 0:10:58  iter: 759  total_loss: 0.1515  loss_cls: 0.06196  loss_box_reg: 0.05242  loss_rpn_cls: 0.01063  loss_rpn_loc: 0.02553  time: 0.5384  data_time: 0.0113  lr: 0.01  max_mem: 5385M
[11/17 17:18:00] d2.utils.events INFO:  eta: 0:10:47  iter: 779  total_loss: 0.1424  loss_cls: 0.05865  loss_box_reg: 0.0484  loss_rpn_cls: 0.01095  loss_rpn_loc: 0.0259  time: 0.5381  data_time: 0.0109  lr: 0.01  max_mem: 5385M
[11/17 17:18:10] d2.utils.events INFO:  eta: 0:10:37  iter: 799  total_loss: 0.1392  loss_cls: 0.05685  loss_box_reg: 0.05042  loss_rpn_cls: 0.01052  loss_rpn_loc: 0.02476  time: 0.5380  data_time: 0.0107  lr: 0.01  max_mem: 5385M
[11/17 17:18:21] d2.utils.events INFO:  eta: 0:10:26  iter: 819  total_loss: 0.1324  loss_cls: 0.05517  loss_box_reg: 0.04468  loss_rpn_cls: 0.009873  loss_rpn_loc: 0.02119  time: 0.5377  data_time: 0.0111  lr: 0.01  max_mem: 5385M
[11/17 17:18:32] d2.utils.events INFO:  eta: 0:10:15  iter: 839  total_loss: 0.1332  loss_cls: 0.05436  loss_box_reg: 0.04566  loss_rpn_cls: 0.01022  loss_rpn_loc: 0.02232  time: 0.5375  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/17 17:18:42] d2.utils.events INFO:  eta: 0:10:05  iter: 859  total_loss: 0.1329  loss_cls: 0.05334  loss_box_reg: 0.04573  loss_rpn_cls: 0.01005  loss_rpn_loc: 0.02125  time: 0.5375  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/17 17:18:53] d2.utils.events INFO:  eta: 0:09:54  iter: 879  total_loss: 0.1312  loss_cls: 0.05371  loss_box_reg: 0.04479  loss_rpn_cls: 0.008459  loss_rpn_loc: 0.02241  time: 0.5377  data_time: 0.0328  lr: 0.01  max_mem: 5385M
[11/17 17:19:04] d2.utils.events INFO:  eta: 0:09:44  iter: 899  total_loss: 0.1303  loss_cls: 0.05198  loss_box_reg: 0.04332  loss_rpn_cls: 0.01059  loss_rpn_loc: 0.02571  time: 0.5375  data_time: 0.0102  lr: 0.01  max_mem: 5385M
[11/17 17:19:14] d2.utils.events INFO:  eta: 0:09:33  iter: 919  total_loss: 0.1257  loss_cls: 0.04947  loss_box_reg: 0.04201  loss_rpn_cls: 0.009142  loss_rpn_loc: 0.02413  time: 0.5373  data_time: 0.0110  lr: 0.01  max_mem: 5385M
[11/17 17:19:25] d2.utils.events INFO:  eta: 0:09:22  iter: 939  total_loss: 0.1238  loss_cls: 0.05064  loss_box_reg: 0.03954  loss_rpn_cls: 0.009823  loss_rpn_loc: 0.02335  time: 0.5373  data_time: 0.0115  lr: 0.01  max_mem: 5385M
[11/17 17:19:36] d2.utils.events INFO:  eta: 0:09:11  iter: 959  total_loss: 0.1198  loss_cls: 0.04906  loss_box_reg: 0.0404  loss_rpn_cls: 0.008792  loss_rpn_loc: 0.02257  time: 0.5369  data_time: 0.0125  lr: 0.01  max_mem: 5385M
[11/17 17:19:46] d2.utils.events INFO:  eta: 0:09:01  iter: 979  total_loss: 0.1157  loss_cls: 0.04736  loss_box_reg: 0.03877  loss_rpn_cls: 0.008235  loss_rpn_loc: 0.01776  time: 0.5367  data_time: 0.0127  lr: 0.01  max_mem: 5385M
[11/17 17:19:57] d2.utils.events INFO:  eta: 0:08:49  iter: 999  total_loss: 0.1192  loss_cls: 0.04947  loss_box_reg: 0.03943  loss_rpn_cls: 0.009219  loss_rpn_loc: 0.02024  time: 0.5369  data_time: 0.0455  lr: 0.01  max_mem: 5385M
[11/17 17:20:08] d2.utils.events INFO:  eta: 0:08:39  iter: 1019  total_loss: 0.1173  loss_cls: 0.04709  loss_box_reg: 0.03929  loss_rpn_cls: 0.008263  loss_rpn_loc: 0.01846  time: 0.5367  data_time: 0.0109  lr: 0.01  max_mem: 5385M
[11/17 17:20:18] d2.utils.events INFO:  eta: 0:08:28  iter: 1039  total_loss: 0.1198  loss_cls: 0.04771  loss_box_reg: 0.0391  loss_rpn_cls: 0.008236  loss_rpn_loc: 0.02006  time: 0.5365  data_time: 0.0128  lr: 0.01  max_mem: 5385M
[11/17 17:20:29] d2.utils.events INFO:  eta: 0:08:17  iter: 1059  total_loss: 0.1141  loss_cls: 0.04638  loss_box_reg: 0.03702  loss_rpn_cls: 0.008481  loss_rpn_loc: 0.02175  time: 0.5365  data_time: 0.0125  lr: 0.01  max_mem: 5385M
[11/17 17:20:39] d2.utils.events INFO:  eta: 0:08:07  iter: 1079  total_loss: 0.1111  loss_cls: 0.04556  loss_box_reg: 0.03546  loss_rpn_cls: 0.00728  loss_rpn_loc: 0.01938  time: 0.5364  data_time: 0.0118  lr: 0.01  max_mem: 5385M
[11/17 17:20:50] d2.utils.events INFO:  eta: 0:07:56  iter: 1099  total_loss: 0.1088  loss_cls: 0.04594  loss_box_reg: 0.03698  loss_rpn_cls: 0.007163  loss_rpn_loc: 0.01707  time: 0.5362  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:21:01] d2.utils.events INFO:  eta: 0:07:45  iter: 1119  total_loss: 0.1083  loss_cls: 0.0451  loss_box_reg: 0.03671  loss_rpn_cls: 0.007626  loss_rpn_loc: 0.01969  time: 0.5360  data_time: 0.0104  lr: 0.01  max_mem: 5385M
[11/17 17:21:11] d2.utils.events INFO:  eta: 0:07:35  iter: 1139  total_loss: 0.108  loss_cls: 0.04526  loss_box_reg: 0.03458  loss_rpn_cls: 0.00847  loss_rpn_loc: 0.01698  time: 0.5360  data_time: 0.0111  lr: 0.01  max_mem: 5385M
[11/17 17:21:22] d2.utils.events INFO:  eta: 0:07:24  iter: 1159  total_loss: 0.1024  loss_cls: 0.04488  loss_box_reg: 0.03568  loss_rpn_cls: 0.007673  loss_rpn_loc: 0.01788  time: 0.5358  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/17 17:21:32] d2.utils.events INFO:  eta: 0:07:14  iter: 1179  total_loss: 0.1056  loss_cls: 0.04438  loss_box_reg: 0.03584  loss_rpn_cls: 0.006915  loss_rpn_loc: 0.01815  time: 0.5357  data_time: 0.0124  lr: 0.01  max_mem: 5385M
[11/17 17:21:43] d2.utils.events INFO:  eta: 0:07:03  iter: 1199  total_loss: 0.1059  loss_cls: 0.04151  loss_box_reg: 0.03496  loss_rpn_cls: 0.007242  loss_rpn_loc: 0.02099  time: 0.5356  data_time: 0.0109  lr: 0.01  max_mem: 5385M
[11/17 17:21:54] d2.utils.events INFO:  eta: 0:06:52  iter: 1219  total_loss: 0.1075  loss_cls: 0.04259  loss_box_reg: 0.03651  loss_rpn_cls: 0.007599  loss_rpn_loc: 0.02041  time: 0.5355  data_time: 0.0114  lr: 0.01  max_mem: 5385M
[11/17 17:22:04] d2.utils.events INFO:  eta: 0:06:42  iter: 1239  total_loss: 0.1047  loss_cls: 0.0417  loss_box_reg: 0.0333  loss_rpn_cls: 0.007395  loss_rpn_loc: 0.02017  time: 0.5355  data_time: 0.0113  lr: 0.01  max_mem: 5385M
[11/17 17:22:15] d2.utils.events INFO:  eta: 0:06:31  iter: 1259  total_loss: 0.1017  loss_cls: 0.0417  loss_box_reg: 0.03264  loss_rpn_cls: 0.007131  loss_rpn_loc: 0.01789  time: 0.5355  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/17 17:22:26] d2.utils.events INFO:  eta: 0:06:20  iter: 1279  total_loss: 0.1026  loss_cls: 0.042  loss_box_reg: 0.03134  loss_rpn_cls: 0.007207  loss_rpn_loc: 0.02073  time: 0.5355  data_time: 0.0119  lr: 0.01  max_mem: 5385M
[11/17 17:22:36] d2.utils.events INFO:  eta: 0:06:10  iter: 1299  total_loss: 0.09903  loss_cls: 0.04035  loss_box_reg: 0.03277  loss_rpn_cls: 0.007724  loss_rpn_loc: 0.01862  time: 0.5354  data_time: 0.0110  lr: 0.01  max_mem: 5385M
[11/17 17:22:47] d2.utils.events INFO:  eta: 0:05:59  iter: 1319  total_loss: 0.1035  loss_cls: 0.04032  loss_box_reg: 0.03193  loss_rpn_cls: 0.007105  loss_rpn_loc: 0.02173  time: 0.5353  data_time: 0.0106  lr: 0.01  max_mem: 5385M
[11/17 17:22:58] d2.utils.events INFO:  eta: 0:05:49  iter: 1339  total_loss: 0.09617  loss_cls: 0.04008  loss_box_reg: 0.03103  loss_rpn_cls: 0.006262  loss_rpn_loc: 0.01837  time: 0.5357  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/17 17:23:09] d2.utils.events INFO:  eta: 0:05:38  iter: 1359  total_loss: 0.1017  loss_cls: 0.04088  loss_box_reg: 0.03257  loss_rpn_cls: 0.006897  loss_rpn_loc: 0.0194  time: 0.5357  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/17 17:23:19] d2.utils.events INFO:  eta: 0:05:28  iter: 1379  total_loss: 0.09334  loss_cls: 0.04029  loss_box_reg: 0.03042  loss_rpn_cls: 0.006554  loss_rpn_loc: 0.01836  time: 0.5355  data_time: 0.0111  lr: 0.01  max_mem: 5385M
[11/17 17:23:30] d2.utils.events INFO:  eta: 0:05:17  iter: 1399  total_loss: 0.0949  loss_cls: 0.03886  loss_box_reg: 0.03124  loss_rpn_cls: 0.006978  loss_rpn_loc: 0.02083  time: 0.5354  data_time: 0.0112  lr: 0.01  max_mem: 5385M
[11/17 17:23:40] d2.utils.events INFO:  eta: 0:05:07  iter: 1419  total_loss: 0.09583  loss_cls: 0.03832  loss_box_reg: 0.03025  loss_rpn_cls: 0.006351  loss_rpn_loc: 0.01829  time: 0.5353  data_time: 0.0108  lr: 0.01  max_mem: 5385M
[11/17 17:23:51] d2.utils.events INFO:  eta: 0:04:56  iter: 1439  total_loss: 0.1013  loss_cls: 0.03912  loss_box_reg: 0.0309  loss_rpn_cls: 0.006638  loss_rpn_loc: 0.02091  time: 0.5352  data_time: 0.0122  lr: 0.01  max_mem: 5385M
[11/17 17:24:02] d2.utils.events INFO:  eta: 0:04:45  iter: 1459  total_loss: 0.09282  loss_cls: 0.03762  loss_box_reg: 0.02976  loss_rpn_cls: 0.006292  loss_rpn_loc: 0.015  time: 0.5351  data_time: 0.0105  lr: 0.01  max_mem: 5385M
[11/17 17:24:12] d2.utils.events INFO:  eta: 0:04:34  iter: 1479  total_loss: 0.08802  loss_cls: 0.03803  loss_box_reg: 0.03107  loss_rpn_cls: 0.005448  loss_rpn_loc: 0.01653  time: 0.5349  data_time: 0.0112  lr: 0.01  max_mem: 5385M
[11/17 17:24:23] d2.utils.events INFO:  eta: 0:04:24  iter: 1499  total_loss: 0.09511  loss_cls: 0.03821  loss_box_reg: 0.02962  loss_rpn_cls: 0.006331  loss_rpn_loc: 0.02007  time: 0.5352  data_time: 0.0106  lr: 0.01  max_mem: 5385M
[11/17 17:24:34] d2.utils.events INFO:  eta: 0:04:13  iter: 1519  total_loss: 0.09116  loss_cls: 0.03777  loss_box_reg: 0.02967  loss_rpn_cls: 0.00539  loss_rpn_loc: 0.0176  time: 0.5352  data_time: 0.0107  lr: 0.01  max_mem: 5385M
[11/17 17:24:44] d2.utils.events INFO:  eta: 0:04:03  iter: 1539  total_loss: 0.09064  loss_cls: 0.03717  loss_box_reg: 0.0295  loss_rpn_cls: 0.005685  loss_rpn_loc: 0.01639  time: 0.5352  data_time: 0.0128  lr: 0.01  max_mem: 5385M
[11/17 17:24:55] d2.utils.events INFO:  eta: 0:03:52  iter: 1559  total_loss: 0.09277  loss_cls: 0.03583  loss_box_reg: 0.0286  loss_rpn_cls: 0.006127  loss_rpn_loc: 0.02166  time: 0.5351  data_time: 0.0117  lr: 0.01  max_mem: 5385M
[11/17 17:25:06] d2.utils.events INFO:  eta: 0:03:42  iter: 1579  total_loss: 0.09373  loss_cls: 0.03593  loss_box_reg: 0.029  loss_rpn_cls: 0.006842  loss_rpn_loc: 0.02167  time: 0.5351  data_time: 0.0122  lr: 0.01  max_mem: 5385M
[11/17 17:25:16] d2.utils.events INFO:  eta: 0:03:31  iter: 1599  total_loss: 0.09164  loss_cls: 0.03573  loss_box_reg: 0.02716  loss_rpn_cls: 0.006384  loss_rpn_loc: 0.01693  time: 0.5349  data_time: 0.0113  lr: 0.01  max_mem: 5385M
[11/17 17:25:27] d2.utils.events INFO:  eta: 0:03:20  iter: 1619  total_loss: 0.08302  loss_cls: 0.03543  loss_box_reg: 0.02825  loss_rpn_cls: 0.006385  loss_rpn_loc: 0.01245  time: 0.5349  data_time: 0.0107  lr: 0.001  max_mem: 5385M
[11/17 17:25:37] d2.utils.events INFO:  eta: 0:03:10  iter: 1639  total_loss: 0.08515  loss_cls: 0.03564  loss_box_reg: 0.02884  loss_rpn_cls: 0.0066  loss_rpn_loc: 0.01379  time: 0.5347  data_time: 0.0110  lr: 0.001  max_mem: 5385M
[11/17 17:25:48] d2.utils.events INFO:  eta: 0:02:59  iter: 1659  total_loss: 0.08659  loss_cls: 0.03589  loss_box_reg: 0.0274  loss_rpn_cls: 0.006671  loss_rpn_loc: 0.01365  time: 0.5345  data_time: 0.0110  lr: 0.001  max_mem: 5385M
[11/17 17:25:58] d2.utils.events INFO:  eta: 0:02:49  iter: 1679  total_loss: 0.08356  loss_cls: 0.03345  loss_box_reg: 0.02665  loss_rpn_cls: 0.006337  loss_rpn_loc: 0.01458  time: 0.5345  data_time: 0.0113  lr: 0.001  max_mem: 5385M
[11/17 17:26:09] d2.utils.events INFO:  eta: 0:02:38  iter: 1699  total_loss: 0.07843  loss_cls: 0.03547  loss_box_reg: 0.02633  loss_rpn_cls: 0.00586  loss_rpn_loc: 0.01218  time: 0.5344  data_time: 0.0112  lr: 0.001  max_mem: 5385M
[11/17 17:26:19] d2.utils.events INFO:  eta: 0:02:27  iter: 1719  total_loss: 0.08149  loss_cls: 0.03585  loss_box_reg: 0.02541  loss_rpn_cls: 0.00627  loss_rpn_loc: 0.012  time: 0.5343  data_time: 0.0110  lr: 0.001  max_mem: 5385M
[11/17 17:26:30] d2.utils.events INFO:  eta: 0:02:17  iter: 1739  total_loss: 0.0804  loss_cls: 0.035  loss_box_reg: 0.02593  loss_rpn_cls: 0.00636  loss_rpn_loc: 0.0105  time: 0.5342  data_time: 0.0103  lr: 0.001  max_mem: 5385M
[11/17 17:26:41] d2.utils.events INFO:  eta: 0:02:06  iter: 1759  total_loss: 0.08123  loss_cls: 0.03611  loss_box_reg: 0.02814  loss_rpn_cls: 0.00626  loss_rpn_loc: 0.01216  time: 0.5342  data_time: 0.0106  lr: 0.001  max_mem: 5385M
[11/17 17:26:51] d2.utils.events INFO:  eta: 0:01:56  iter: 1779  total_loss: 0.08158  loss_cls: 0.03596  loss_box_reg: 0.02784  loss_rpn_cls: 0.005793  loss_rpn_loc: 0.01023  time: 0.5342  data_time: 0.0114  lr: 0.001  max_mem: 5385M
[11/17 17:27:02] d2.utils.events INFO:  eta: 0:01:45  iter: 1799  total_loss: 0.08276  loss_cls: 0.03505  loss_box_reg: 0.02691  loss_rpn_cls: 0.006394  loss_rpn_loc: 0.01398  time: 0.5341  data_time: 0.0112  lr: 0.001  max_mem: 5385M
[11/17 17:27:12] d2.utils.events INFO:  eta: 0:01:35  iter: 1819  total_loss: 0.07745  loss_cls: 0.03564  loss_box_reg: 0.02725  loss_rpn_cls: 0.005786  loss_rpn_loc: 0.0101  time: 0.5340  data_time: 0.0102  lr: 0.001  max_mem: 5385M
[11/17 17:27:23] d2.utils.events INFO:  eta: 0:01:24  iter: 1839  total_loss: 0.07845  loss_cls: 0.03399  loss_box_reg: 0.027  loss_rpn_cls: 0.006237  loss_rpn_loc: 0.01189  time: 0.5341  data_time: 0.0115  lr: 0.001  max_mem: 5385M
[11/17 17:27:34] d2.utils.events INFO:  eta: 0:01:13  iter: 1859  total_loss: 0.07795  loss_cls: 0.03521  loss_box_reg: 0.02646  loss_rpn_cls: 0.005467  loss_rpn_loc: 0.009673  time: 0.5340  data_time: 0.0104  lr: 0.001  max_mem: 5385M
[11/17 17:27:44] d2.utils.events INFO:  eta: 0:01:03  iter: 1879  total_loss: 0.07871  loss_cls: 0.03522  loss_box_reg: 0.02677  loss_rpn_cls: 0.005646  loss_rpn_loc: 0.009477  time: 0.5340  data_time: 0.0117  lr: 0.001  max_mem: 5385M
[11/17 17:27:55] d2.utils.events INFO:  eta: 0:00:52  iter: 1899  total_loss: 0.08136  loss_cls: 0.0358  loss_box_reg: 0.02701  loss_rpn_cls: 0.005358  loss_rpn_loc: 0.009753  time: 0.5339  data_time: 0.0096  lr: 0.001  max_mem: 5385M
[11/17 17:28:05] d2.utils.events INFO:  eta: 0:00:42  iter: 1919  total_loss: 0.08145  loss_cls: 0.03489  loss_box_reg: 0.02832  loss_rpn_cls: 0.005768  loss_rpn_loc: 0.01036  time: 0.5338  data_time: 0.0101  lr: 0.001  max_mem: 5385M
[11/17 17:28:16] d2.utils.events INFO:  eta: 0:00:31  iter: 1939  total_loss: 0.07831  loss_cls: 0.03446  loss_box_reg: 0.0271  loss_rpn_cls: 0.005765  loss_rpn_loc: 0.009832  time: 0.5337  data_time: 0.0102  lr: 0.001  max_mem: 5385M
[11/17 17:28:27] d2.utils.events INFO:  eta: 0:00:21  iter: 1959  total_loss: 0.08269  loss_cls: 0.03471  loss_box_reg: 0.02687  loss_rpn_cls: 0.00584  loss_rpn_loc: 0.01074  time: 0.5337  data_time: 0.0101  lr: 0.001  max_mem: 5385M
[11/17 17:28:37] d2.utils.events INFO:  eta: 0:00:10  iter: 1979  total_loss: 0.07944  loss_cls: 0.03631  loss_box_reg: 0.02703  loss_rpn_cls: 0.005425  loss_rpn_loc: 0.01003  time: 0.5337  data_time: 0.0120  lr: 0.001  max_mem: 5385M
[11/17 17:28:48] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/model_final.pth
[11/17 17:28:49] d2.utils.events INFO:  eta: 0:00:00  iter: 1999  total_loss: 0.07806  loss_cls: 0.03542  loss_box_reg: 0.02642  loss_rpn_cls: 0.00524  loss_rpn_loc: 0.0104  time: 0.5336  data_time: 0.0104  lr: 0.001  max_mem: 5385M
[11/17 17:28:49] d2.engine.hooks INFO: Overall training speed: 1998 iterations in 0:17:46 (0.5337 s / it)
[11/17 17:28:49] d2.engine.hooks INFO: Total training time: 0:17:48 (0:00:01 on hooks)
[11/17 17:28:50] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 10538        |  bicycle   | 313          |     car      | 1641         |
|  motorcycle  | 388          |  airplane  | 131          |     bus      | 259          |
|    train     | 212          |    boat    | 458          |     bird     | 453          |
|     cat      | 195          |    dog     | 223          |    horse     | 305          |
|    sheep     | 306          |    cow     | 376          |    bottle    | 939          |
|    chair     | 1594         |   couch    | 236          | potted plant | 429          |
| dining table | 633          |     tv     | 257          |              |              |
|    total     | 19886        |            |              |              |              |[0m
[11/17 17:28:50] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/17 17:28:50] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/17 17:28:50] d2.data.common INFO: Serialized dataset takes 2.08 MiB
[11/17 17:28:50] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/17 17:28:50] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/17 17:28:51] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/17 17:28:51] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/17 17:28:51] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/17 17:28:55] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/17 17:29:06] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1149 s / img. ETA=0:02:17
[11/17 17:29:11] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1144 s / img. ETA=0:02:11
[11/17 17:29:17] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1141 s / img. ETA=0:02:05
[11/17 17:29:23] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1143 s / img. ETA=0:02:00
[11/17 17:29:28] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1144 s / img. ETA=0:01:54
[11/17 17:29:34] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1134 s / img. ETA=0:01:47
[11/17 17:29:39] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1131 s / img. ETA=0:01:41
[11/17 17:29:45] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1131 s / img. ETA=0:01:36
[11/17 17:29:51] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1132 s / img. ETA=0:01:30
[11/17 17:29:56] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1129 s / img. ETA=0:01:24
[11/17 17:30:02] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1130 s / img. ETA=0:01:19
[11/17 17:30:08] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1128 s / img. ETA=0:01:13
[11/17 17:30:13] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1127 s / img. ETA=0:01:07
[11/17 17:30:18] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1123 s / img. ETA=0:01:01
[11/17 17:30:24] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1127 s / img. ETA=0:00:56
[11/17 17:30:30] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1126 s / img. ETA=0:00:50
[11/17 17:30:36] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1126 s / img. ETA=0:00:45
[11/17 17:30:41] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1127 s / img. ETA=0:00:39
[11/17 17:30:47] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1126 s / img. ETA=0:00:33
[11/17 17:30:52] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1125 s / img. ETA=0:00:28
[11/17 17:30:58] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1125 s / img. ETA=0:00:22
[11/17 17:31:04] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1126 s / img. ETA=0:00:16
[11/17 17:31:09] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1126 s / img. ETA=0:00:11
[11/17 17:31:15] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1126 s / img. ETA=0:00:05
[11/17 17:31:21] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1125 s / img. ETA=0:00:00
[11/17 17:31:21] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:20 (0.112450 s / img per device, on 4 devices)
[11/17 17:31:21] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:17 (0.110483 s / img per device, on 4 devices)
[11/17 17:31:22] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/17 17:31:22] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/inference/coco_instances_results.json
[11/17 17:31:22] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/17 17:31:29] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 14.170 | 25.695 | 13.691 | 3.947 | 14.447 | 21.798 |
[11/17 17:31:29] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.458  | bicycle    | 4.928  | car          | 9.023  |
| motorcycle   | 14.553 | airplane   | 20.545 | bus          | 45.972 |
| train        | 28.175 | boat       | 0.354  | bird         | 8.035  |
| cat          | 16.991 | dog        | 13.512 | horse        | 15.699 |
| sheep        | 14.546 | cow        | 16.545 | bottle       | 9.991  |
| chair        | 3.803  | couch      | 15.926 | potted plant | 1.345  |
| dining table | 8.220  | tv         | 33.777 |              |        |
[11/17 17:31:29] defrcn.engine.defaults INFO: Evaluation results for coco14_test_novel in csv format:
[11/17 17:31:29] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/17 17:31:29] defrcn.evaluation.testing INFO: copypaste: nAP,nAP50,nAP75,nAPs,nAPm,nAPl,AP
[11/17 17:31:29] defrcn.evaluation.testing INFO: copypaste: 14.1699,25.6955,13.6912,3.9465,14.4473,21.7980,14.1699
[11/17 17:31:40] detectron2 INFO: Rank of current process: 0. World size: 4
[11/17 17:31:40] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_gfsod_r101_novel_3shot_seed8.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8', 'SEED', '57569278'], resume=False, start_iter=-1)
[11/17 17:31:40] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_gfsod_r101_novel_3shot_seed8.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 80
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_all_3shot_seed8", )
  TEST: ('coco14_test_all',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (3840,)
  MAX_ITER: 4800
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/17 17:31:40] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/config.yaml
[11/17 17:31:41] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/17 17:31:41] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/model_final-merge.pth ...
[11/17 17:31:42] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10538        |   bicycle    | 313          |      car      | 1641         |
|  motorcycle   | 388          |   airplane   | 131          |      bus      | 259          |
|     train     | 212          |    truck     | 352          |     boat      | 458          |
| traffic light | 516          | fire hydrant | 83           |   stop sign   | 84           |
| parking meter | 59           |    bench     | 471          |     bird      | 453          |
|      cat      | 195          |     dog      | 223          |     horse     | 305          |
|     sheep     | 306          |     cow      | 376          |   elephant    | 283          |
|     bear      | 53           |    zebra     | 275          |    giraffe    | 170          |
|   backpack    | 384          |   umbrella   | 387          |    handbag    | 483          |
|      tie      | 290          |   suitcase   | 309          |    frisbee    | 109          |
|     skis      | 281          |  snowboard   | 90           |  sports ball  | 233          |
|     kite      | 381          | baseball bat | 123          | baseball gl.. | 139          |
|  skateboard   | 215          |  surfboard   | 266          | tennis racket | 183          |
|    bottle     | 939          |  wine glass  | 363          |      cup      | 891          |
|     fork      | 234          |    knife     | 290          |     spoon     | 253          |
|     bowl      | 617          |    banana    | 359          |     apple     | 158          |
|   sandwich    | 158          |    orange    | 185          |   broccoli    | 330          |
|    carrot     | 341          |   hot dog    | 160          |     pizza     | 223          |
|     donut     | 225          |     cake     | 236          |     chair     | 1594         |
|     couch     | 236          | potted plant | 429          |      bed      | 195          |
| dining table  | 633          |    toilet    | 179          |      tv       | 257          |
|    laptop     | 236          |    mouse     | 95           |    remote     | 241          |
|   keyboard    | 117          |  cell phone  | 291          |   microwave   | 88           |
|     oven      | 142          |   toaster    | 11           |     sink      | 211          |
| refrigerator  | 107          |     book     | 1031         |     clock     | 290          |
|     vase      | 350          |   scissors   | 56           |  teddy bear   | 238          |
|  hair drier   | 11           |  toothbrush  | 77           |               |              |
|     total     | 35094        |              |              |               |              |[0m
[11/17 17:31:42] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/17 17:31:42] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/17 17:31:42] d2.data.common INFO: Serialized dataset takes 3.00 MiB
[11/17 17:31:43] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/17 17:31:43] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/17 17:31:44] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 3            |   bicycle    | 3            |      car      | 3            |
|  motorcycle   | 3            |   airplane   | 3            |      bus      | 3            |
|     train     | 3            |    truck     | 3            |     boat      | 3            |
| traffic light | 3            | fire hydrant | 3            |   stop sign   | 3            |
| parking meter | 3            |    bench     | 3            |     bird      | 3            |
|      cat      | 3            |     dog      | 3            |     horse     | 3            |
|     sheep     | 3            |     cow      | 3            |   elephant    | 3            |
|     bear      | 3            |    zebra     | 3            |    giraffe    | 3            |
|   backpack    | 3            |   umbrella   | 3            |    handbag    | 3            |
|      tie      | 3            |   suitcase   | 3            |    frisbee    | 3            |
|     skis      | 3            |  snowboard   | 3            |  sports ball  | 3            |
|     kite      | 3            | baseball bat | 3            | baseball gl.. | 3            |
|  skateboard   | 3            |  surfboard   | 3            | tennis racket | 3            |
|    bottle     | 3            |  wine glass  | 3            |      cup      | 3            |
|     fork      | 3            |    knife     | 3            |     spoon     | 3            |
|     bowl      | 3            |    banana    | 3            |     apple     | 3            |
|   sandwich    | 3            |    orange    | 3            |   broccoli    | 3            |
|    carrot     | 3            |   hot dog    | 3            |     pizza     | 3            |
|     donut     | 3            |     cake     | 3            |     chair     | 3            |
|     couch     | 3            | potted plant | 3            |      bed      | 3            |
| dining table  | 3            |    toilet    | 3            |      tv       | 3            |
|    laptop     | 3            |    mouse     | 3            |    remote     | 3            |
|   keyboard    | 3            |  cell phone  | 3            |   microwave   | 3            |
|     oven      | 3            |   toaster    | 3            |     sink      | 3            |
| refrigerator  | 3            |     book     | 3            |     clock     | 3            |
|     vase      | 3            |   scissors   | 3            |  teddy bear   | 3            |
|  hair drier   | 3            |  toothbrush  | 3            |               |              |
|     total     | 240          |              |              |               |              |[0m
[11/17 17:31:44] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/17 17:31:44] d2.data.common INFO: Serializing 239 elements to byte tensors and concatenating them all ...
[11/17 17:31:44] d2.data.common INFO: Serialized dataset takes 0.06 MiB
[11/17 17:32:00] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/17 17:32:12] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1165 s / img. ETA=0:02:19
[11/17 17:32:17] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1156 s / img. ETA=0:02:12
[11/17 17:32:23] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1150 s / img. ETA=0:02:06
[11/17 17:32:29] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1149 s / img. ETA=0:02:00
[11/17 17:32:35] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1150 s / img. ETA=0:01:54
[11/17 17:32:40] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1140 s / img. ETA=0:01:48
[11/17 17:32:46] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1137 s / img. ETA=0:01:42
[11/17 17:32:51] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1138 s / img. ETA=0:01:36
[11/17 17:32:57] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1139 s / img. ETA=0:01:31
[11/17 17:33:03] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1135 s / img. ETA=0:01:25
[11/17 17:33:08] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1136 s / img. ETA=0:01:19
[11/17 17:33:14] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1135 s / img. ETA=0:01:13
[11/17 17:33:19] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1133 s / img. ETA=0:01:07
[11/17 17:33:25] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1130 s / img. ETA=0:01:02
[11/17 17:33:31] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1132 s / img. ETA=0:00:56
[11/17 17:33:36] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1132 s / img. ETA=0:00:50
[11/17 17:33:42] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1132 s / img. ETA=0:00:45
[11/17 17:33:48] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1133 s / img. ETA=0:00:39
[11/17 17:33:53] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1132 s / img. ETA=0:00:33
[11/17 17:33:59] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1132 s / img. ETA=0:00:28
[11/17 17:34:05] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1132 s / img. ETA=0:00:22
[11/17 17:34:10] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1133 s / img. ETA=0:00:16
[11/17 17:34:16] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1133 s / img. ETA=0:00:11
[11/17 17:34:22] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1133 s / img. ETA=0:00:05
[11/17 17:34:27] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1132 s / img. ETA=0:00:00
[11/17 17:34:28] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:21 (0.113253 s / img per device, on 4 devices)
[11/17 17:34:28] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:18 (0.111108 s / img per device, on 4 devices)
[11/17 17:34:32] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/17 17:34:32] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed8/inference/coco_instances_results.json
[11/17 17:34:33] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/17 17:34:53] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 31.049 | 48.336 | 32.896 | 14.590 | 35.276 | 43.978 |
[11/17 17:34:53] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category      | AP     | category     | AP     | category       | AP     |
|:--------------|:-------|:-------------|:-------|:---------------|:-------|
| person        | 1.328  | bicycle      | 4.952  | car            | 8.847  |
| motorcycle    | 14.490 | airplane     | 18.452 | bus            | 45.537 |
| train         | 27.572 | truck        | 31.202 | boat           | 0.605  |
| traffic light | 24.447 | fire hydrant | 62.868 | stop sign      | 69.711 |
| parking meter | 36.242 | bench        | 18.169 | bird           | 8.074  |
| cat           | 18.919 | dog          | 13.506 | horse          | 16.177 |
| sheep         | 16.012 | cow          | 16.438 | elephant       | 65.322 |
| bear          | 58.026 | zebra        | 60.494 | giraffe        | 67.982 |
| backpack      | 17.047 | umbrella     | 32.484 | handbag        | 15.647 |
| tie           | 32.507 | suitcase     | 27.946 | frisbee        | 56.347 |
| skis          | 24.528 | snowboard    | 34.482 | sports ball    | 38.297 |
| kite          | 38.788 | baseball bat | 26.567 | baseball glove | 30.504 |
| skateboard    | 46.829 | surfboard    | 39.455 | tennis racket  | 48.875 |
| bottle        | 10.626 | wine glass   | 29.956 | cup            | 35.950 |
| fork          | 34.760 | knife        | 16.275 | spoon          | 16.854 |
| bowl          | 35.720 | banana       | 24.570 | apple          | 20.731 |
| sandwich      | 35.238 | orange       | 23.582 | broccoli       | 24.449 |
| carrot        | 22.832 | hot dog      | 32.324 | pizza          | 50.486 |
| donut         | 49.305 | cake         | 38.581 | chair          | 4.482  |
| couch         | 15.616 | potted plant | 1.434  | bed            | 40.452 |
| dining table  | 8.350  | toilet       | 53.626 | tv             | 34.936 |
| laptop        | 56.897 | mouse        | 48.526 | remote         | 28.474 |
| keyboard      | 50.585 | cell phone   | 25.812 | microwave      | 55.308 |
| oven          | 36.410 | toaster      | 29.978 | sink           | 32.708 |
| refrigerator  | 51.257 | book         | 8.509  | clock          | 47.719 |
| vase          | 32.352 | scissors     | 26.054 | teddy bear     | 39.166 |
| hair drier    | 16.519 | toothbrush   | 20.847 |                |        |
[11/17 17:35:08] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 36.626 | 55.730 | 39.249 | 18.247 | 42.261 | 51.101 |
[11/17 17:35:08] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category       | AP     | category      | AP     | category     | AP     |
|:---------------|:-------|:--------------|:-------|:-------------|:-------|
| truck          | 31.202 | traffic light | 24.447 | fire hydrant | 62.868 |
| stop sign      | 69.711 | parking meter | 36.242 | bench        | 18.169 |
| elephant       | 65.322 | bear          | 58.026 | zebra        | 60.494 |
| giraffe        | 67.982 | backpack      | 17.047 | umbrella     | 32.484 |
| handbag        | 15.647 | tie           | 32.507 | suitcase     | 27.946 |
| frisbee        | 56.347 | skis          | 24.528 | snowboard    | 34.482 |
| sports ball    | 38.297 | kite          | 38.788 | baseball bat | 26.567 |
| baseball glove | 30.504 | skateboard    | 46.829 | surfboard    | 39.455 |
| tennis racket  | 48.875 | wine glass    | 29.956 | cup          | 35.950 |
| fork           | 34.760 | knife         | 16.275 | spoon        | 16.854 |
| bowl           | 35.720 | banana        | 24.570 | apple        | 20.731 |
| sandwich       | 35.238 | orange        | 23.582 | broccoli     | 24.449 |
| carrot         | 22.832 | hot dog       | 32.324 | pizza        | 50.486 |
| donut          | 49.305 | cake          | 38.581 | bed          | 40.452 |
| toilet         | 53.626 | laptop        | 56.897 | mouse        | 48.526 |
| remote         | 28.474 | keyboard      | 50.585 | cell phone   | 25.812 |
| microwave      | 55.308 | oven          | 36.410 | toaster      | 29.978 |
| sink           | 32.708 | refrigerator  | 51.257 | book         | 8.509  |
| clock          | 47.719 | vase          | 32.352 | scissors     | 26.054 |
| teddy bear     | 39.166 | hair drier    | 16.519 | toothbrush   | 20.847 |
[11/17 17:35:13] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 14.318 | 26.153 | 13.836 | 3.803 | 14.322 | 22.609 |
[11/17 17:35:13] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.328  | bicycle    | 4.952  | car          | 8.847  |
| motorcycle   | 14.490 | airplane   | 18.452 | bus          | 45.537 |
| train        | 27.572 | boat       | 0.605  | bird         | 8.074  |
| cat          | 18.919 | dog        | 13.506 | horse        | 16.177 |
| sheep        | 16.012 | cow        | 16.438 | bottle       | 10.626 |
| chair        | 4.482  | couch      | 15.616 | potted plant | 1.434  |
| dining table | 8.350  | tv         | 34.936 |              |        |
[11/17 17:35:13] defrcn.engine.defaults INFO: Evaluation results for coco14_test_all in csv format:
[11/17 17:35:13] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/17 17:35:13] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,APs,APm,APl,bAP,bAP50,bAP75,bAPs,bAPm,bAPl,nAP,nAP50,nAP75,nAPs,nAPm,nAPl
[11/17 17:35:13] defrcn.evaluation.testing INFO: copypaste: 31.0492,48.3358,32.8956,14.5904,35.2761,43.9779,36.6263,55.7300,39.2489,18.2471,42.2609,51.1009,14.3177,26.1533,13.8356,3.8029,14.3217,22.6087
