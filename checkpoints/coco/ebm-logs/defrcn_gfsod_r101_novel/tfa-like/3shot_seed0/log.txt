[11/13 13:26:44] detectron2 INFO: Rank of current process: 0. World size: 4
[11/13 13:26:44] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_fsod_r101_novel_3shot_seed0.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_det_r101_base/model_final-remove.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/13 13:26:44] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_fsod_r101_novel_3shot_seed0.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_novel_3shot_seed0", )
  TEST: ('coco14_test_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/13 13:26:44] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/config.yaml
[11/13 13:26:44] d2.utils.env INFO: Using a generated random seed 46577598
[11/13 13:26:44] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/13 13:26:44] defrcn.dataloader.build INFO: Removed 79 images with no usable annotations. 51 images left.
[11/13 13:26:44] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 3            |  bicycle   | 3            |     car      | 3            |
|  motorcycle  | 3            |  airplane  | 3            |     bus      | 3            |
|    train     | 3            |    boat    | 3            |     bird     | 3            |
|     cat      | 3            |    dog     | 3            |    horse     | 3            |
|    sheep     | 3            |    cow     | 3            |    bottle    | 3            |
|    chair     | 3            |   couch    | 3            | potted plant | 3            |
| dining table | 3            |     tv     | 3            |              |              |
|    total     | 60           |            |              |              |              |[0m
[11/13 13:26:44] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/13 13:26:44] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/13 13:26:44] d2.data.common INFO: Serializing 51 elements to byte tensors and concatenating them all ...
[11/13 13:26:44] d2.data.common INFO: Serialized dataset takes 0.01 MiB
[11/13 13:26:45] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_det_r101_base/model_final-remove.pth ...
[11/13 13:26:45] d2.engine.train_loop INFO: Starting training from iteration 0
[11/13 13:27:00] d2.utils.events INFO:  eta: 0:18:00  iter: 19  total_loss: 0.871  loss_cls: 0.5533  loss_box_reg: 0.1634  loss_rpn_cls: 0.0972  loss_rpn_loc: 0.08112  time: 0.5478  data_time: 0.1008  lr: 0.01  max_mem: 5224M
[11/13 13:27:11] d2.utils.events INFO:  eta: 0:17:55  iter: 39  total_loss: 0.6962  loss_cls: 0.4433  loss_box_reg: 0.1643  loss_rpn_cls: 0.0679  loss_rpn_loc: 0.05487  time: 0.5492  data_time: 0.0150  lr: 0.01  max_mem: 5384M
[11/13 13:27:22] d2.utils.events INFO:  eta: 0:17:39  iter: 59  total_loss: 0.4769  loss_cls: 0.206  loss_box_reg: 0.1647  loss_rpn_cls: 0.04915  loss_rpn_loc: 0.04502  time: 0.5463  data_time: 0.0128  lr: 0.01  max_mem: 5384M
[11/13 13:27:33] d2.utils.events INFO:  eta: 0:17:24  iter: 79  total_loss: 0.4115  loss_cls: 0.1671  loss_box_reg: 0.1576  loss_rpn_cls: 0.04143  loss_rpn_loc: 0.03725  time: 0.5450  data_time: 0.0128  lr: 0.01  max_mem: 5385M
[11/13 13:27:44] d2.utils.events INFO:  eta: 0:17:12  iter: 99  total_loss: 0.4012  loss_cls: 0.1548  loss_box_reg: 0.1556  loss_rpn_cls: 0.03657  loss_rpn_loc: 0.04181  time: 0.5440  data_time: 0.0131  lr: 0.01  max_mem: 5385M
[11/13 13:27:55] d2.utils.events INFO:  eta: 0:17:04  iter: 119  total_loss: 0.3646  loss_cls: 0.1462  loss_box_reg: 0.1497  loss_rpn_cls: 0.03501  loss_rpn_loc: 0.03386  time: 0.5445  data_time: 0.0130  lr: 0.01  max_mem: 5385M
[11/13 13:28:06] d2.utils.events INFO:  eta: 0:16:51  iter: 139  total_loss: 0.3459  loss_cls: 0.1336  loss_box_reg: 0.1409  loss_rpn_cls: 0.0313  loss_rpn_loc: 0.03585  time: 0.5436  data_time: 0.0128  lr: 0.01  max_mem: 5385M
[11/13 13:28:16] d2.utils.events INFO:  eta: 0:16:38  iter: 159  total_loss: 0.3243  loss_cls: 0.1231  loss_box_reg: 0.1412  loss_rpn_cls: 0.02845  loss_rpn_loc: 0.03446  time: 0.5431  data_time: 0.0110  lr: 0.01  max_mem: 5385M
[11/13 13:28:27] d2.utils.events INFO:  eta: 0:16:26  iter: 179  total_loss: 0.3159  loss_cls: 0.1154  loss_box_reg: 0.1372  loss_rpn_cls: 0.028  loss_rpn_loc: 0.03604  time: 0.5430  data_time: 0.0116  lr: 0.01  max_mem: 5385M
[11/13 13:28:38] d2.utils.events INFO:  eta: 0:16:15  iter: 199  total_loss: 0.3008  loss_cls: 0.1122  loss_box_reg: 0.129  loss_rpn_cls: 0.02722  loss_rpn_loc: 0.03466  time: 0.5427  data_time: 0.0131  lr: 0.01  max_mem: 5385M
[11/13 13:28:49] d2.utils.events INFO:  eta: 0:16:04  iter: 219  total_loss: 0.2849  loss_cls: 0.106  loss_box_reg: 0.1272  loss_rpn_cls: 0.02084  loss_rpn_loc: 0.03166  time: 0.5426  data_time: 0.0123  lr: 0.01  max_mem: 5385M
[11/13 13:29:00] d2.utils.events INFO:  eta: 0:15:53  iter: 239  total_loss: 0.2818  loss_cls: 0.101  loss_box_reg: 0.1247  loss_rpn_cls: 0.02118  loss_rpn_loc: 0.03012  time: 0.5424  data_time: 0.0139  lr: 0.01  max_mem: 5385M
[11/13 13:29:11] d2.utils.events INFO:  eta: 0:15:42  iter: 259  total_loss: 0.2732  loss_cls: 0.09557  loss_box_reg: 0.1183  loss_rpn_cls: 0.02229  loss_rpn_loc: 0.03975  time: 0.5424  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:29:21] d2.utils.events INFO:  eta: 0:15:30  iter: 279  total_loss: 0.2621  loss_cls: 0.09308  loss_box_reg: 0.1119  loss_rpn_cls: 0.01817  loss_rpn_loc: 0.0338  time: 0.5421  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/13 13:29:32] d2.utils.events INFO:  eta: 0:15:19  iter: 299  total_loss: 0.2501  loss_cls: 0.08832  loss_box_reg: 0.1072  loss_rpn_cls: 0.01766  loss_rpn_loc: 0.03284  time: 0.5420  data_time: 0.0122  lr: 0.01  max_mem: 5386M
[11/13 13:29:43] d2.utils.events INFO:  eta: 0:15:08  iter: 319  total_loss: 0.2403  loss_cls: 0.08519  loss_box_reg: 0.1045  loss_rpn_cls: 0.01593  loss_rpn_loc: 0.03312  time: 0.5418  data_time: 0.0129  lr: 0.01  max_mem: 5386M
[11/13 13:29:54] d2.utils.events INFO:  eta: 0:14:57  iter: 339  total_loss: 0.2237  loss_cls: 0.08198  loss_box_reg: 0.09377  loss_rpn_cls: 0.01798  loss_rpn_loc: 0.02866  time: 0.5417  data_time: 0.0128  lr: 0.01  max_mem: 5386M
[11/13 13:30:05] d2.utils.events INFO:  eta: 0:14:45  iter: 359  total_loss: 0.2197  loss_cls: 0.07851  loss_box_reg: 0.09455  loss_rpn_cls: 0.01494  loss_rpn_loc: 0.03241  time: 0.5415  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:30:15] d2.utils.events INFO:  eta: 0:14:33  iter: 379  total_loss: 0.2109  loss_cls: 0.07552  loss_box_reg: 0.08991  loss_rpn_cls: 0.01547  loss_rpn_loc: 0.02986  time: 0.5412  data_time: 0.0118  lr: 0.01  max_mem: 5386M
[11/13 13:30:26] d2.utils.events INFO:  eta: 0:14:22  iter: 399  total_loss: 0.2045  loss_cls: 0.07455  loss_box_reg: 0.08319  loss_rpn_cls: 0.01463  loss_rpn_loc: 0.02694  time: 0.5409  data_time: 0.0127  lr: 0.01  max_mem: 5386M
[11/13 13:30:37] d2.utils.events INFO:  eta: 0:14:11  iter: 419  total_loss: 0.1997  loss_cls: 0.07114  loss_box_reg: 0.08401  loss_rpn_cls: 0.01427  loss_rpn_loc: 0.02845  time: 0.5404  data_time: 0.0119  lr: 0.01  max_mem: 5386M
[11/13 13:30:47] d2.utils.events INFO:  eta: 0:14:00  iter: 439  total_loss: 0.1891  loss_cls: 0.06878  loss_box_reg: 0.07746  loss_rpn_cls: 0.01566  loss_rpn_loc: 0.02841  time: 0.5403  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/13 13:30:58] d2.utils.events INFO:  eta: 0:13:48  iter: 459  total_loss: 0.1892  loss_cls: 0.07002  loss_box_reg: 0.07483  loss_rpn_cls: 0.01528  loss_rpn_loc: 0.02779  time: 0.5400  data_time: 0.0135  lr: 0.01  max_mem: 5386M
[11/13 13:31:09] d2.utils.events INFO:  eta: 0:13:37  iter: 479  total_loss: 0.1818  loss_cls: 0.07077  loss_box_reg: 0.07184  loss_rpn_cls: 0.01409  loss_rpn_loc: 0.02772  time: 0.5399  data_time: 0.0127  lr: 0.01  max_mem: 5386M
[11/13 13:31:20] d2.utils.events INFO:  eta: 0:13:26  iter: 499  total_loss: 0.1655  loss_cls: 0.06401  loss_box_reg: 0.0682  loss_rpn_cls: 0.01211  loss_rpn_loc: 0.02507  time: 0.5399  data_time: 0.0139  lr: 0.01  max_mem: 5386M
[11/13 13:31:30] d2.utils.events INFO:  eta: 0:13:15  iter: 519  total_loss: 0.1698  loss_cls: 0.06376  loss_box_reg: 0.06833  loss_rpn_cls: 0.01155  loss_rpn_loc: 0.02631  time: 0.5397  data_time: 0.0138  lr: 0.01  max_mem: 5386M
[11/13 13:31:41] d2.utils.events INFO:  eta: 0:13:05  iter: 539  total_loss: 0.165  loss_cls: 0.06161  loss_box_reg: 0.0657  loss_rpn_cls: 0.01181  loss_rpn_loc: 0.03022  time: 0.5397  data_time: 0.0133  lr: 0.01  max_mem: 5386M
[11/13 13:31:52] d2.utils.events INFO:  eta: 0:12:54  iter: 559  total_loss: 0.1629  loss_cls: 0.0603  loss_box_reg: 0.0617  loss_rpn_cls: 0.01161  loss_rpn_loc: 0.02956  time: 0.5397  data_time: 0.0135  lr: 0.01  max_mem: 5386M
[11/13 13:32:03] d2.utils.events INFO:  eta: 0:12:43  iter: 579  total_loss: 0.1555  loss_cls: 0.05877  loss_box_reg: 0.05891  loss_rpn_cls: 0.0111  loss_rpn_loc: 0.0215  time: 0.5396  data_time: 0.0132  lr: 0.01  max_mem: 5386M
[11/13 13:32:14] d2.utils.events INFO:  eta: 0:12:32  iter: 599  total_loss: 0.1493  loss_cls: 0.05878  loss_box_reg: 0.05848  loss_rpn_cls: 0.01078  loss_rpn_loc: 0.02309  time: 0.5397  data_time: 0.0137  lr: 0.01  max_mem: 5386M
[11/13 13:32:24] d2.utils.events INFO:  eta: 0:12:21  iter: 619  total_loss: 0.1497  loss_cls: 0.05757  loss_box_reg: 0.05612  loss_rpn_cls: 0.01092  loss_rpn_loc: 0.02677  time: 0.5398  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/13 13:32:35] d2.utils.events INFO:  eta: 0:12:11  iter: 639  total_loss: 0.1472  loss_cls: 0.05728  loss_box_reg: 0.05587  loss_rpn_cls: 0.01136  loss_rpn_loc: 0.02378  time: 0.5397  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:32:46] d2.utils.events INFO:  eta: 0:12:00  iter: 659  total_loss: 0.1503  loss_cls: 0.05608  loss_box_reg: 0.05583  loss_rpn_cls: 0.01238  loss_rpn_loc: 0.02451  time: 0.5397  data_time: 0.0134  lr: 0.01  max_mem: 5386M
[11/13 13:32:57] d2.utils.events INFO:  eta: 0:11:49  iter: 679  total_loss: 0.1379  loss_cls: 0.05325  loss_box_reg: 0.05411  loss_rpn_cls: 0.008882  loss_rpn_loc: 0.02251  time: 0.5397  data_time: 0.0146  lr: 0.01  max_mem: 5386M
[11/13 13:33:08] d2.utils.events INFO:  eta: 0:11:39  iter: 699  total_loss: 0.1448  loss_cls: 0.05453  loss_box_reg: 0.05591  loss_rpn_cls: 0.009802  loss_rpn_loc: 0.02441  time: 0.5397  data_time: 0.0122  lr: 0.01  max_mem: 5386M
[11/13 13:33:18] d2.utils.events INFO:  eta: 0:11:28  iter: 719  total_loss: 0.1341  loss_cls: 0.05516  loss_box_reg: 0.05199  loss_rpn_cls: 0.007901  loss_rpn_loc: 0.02415  time: 0.5395  data_time: 0.0115  lr: 0.01  max_mem: 5386M
[11/13 13:33:29] d2.utils.events INFO:  eta: 0:11:17  iter: 739  total_loss: 0.1334  loss_cls: 0.05185  loss_box_reg: 0.04806  loss_rpn_cls: 0.008786  loss_rpn_loc: 0.02327  time: 0.5393  data_time: 0.0111  lr: 0.01  max_mem: 5386M
[11/13 13:33:40] d2.utils.events INFO:  eta: 0:11:06  iter: 759  total_loss: 0.1366  loss_cls: 0.05221  loss_box_reg: 0.04869  loss_rpn_cls: 0.008763  loss_rpn_loc: 0.02139  time: 0.5392  data_time: 0.0114  lr: 0.01  max_mem: 5386M
[11/13 13:33:51] d2.utils.events INFO:  eta: 0:10:55  iter: 779  total_loss: 0.1421  loss_cls: 0.05156  loss_box_reg: 0.04854  loss_rpn_cls: 0.009425  loss_rpn_loc: 0.0286  time: 0.5391  data_time: 0.0110  lr: 0.01  max_mem: 5386M
[11/13 13:34:02] d2.utils.events INFO:  eta: 0:10:45  iter: 799  total_loss: 0.1303  loss_cls: 0.04968  loss_box_reg: 0.04737  loss_rpn_cls: 0.008127  loss_rpn_loc: 0.01993  time: 0.5392  data_time: 0.0107  lr: 0.01  max_mem: 5386M
[11/13 13:34:12] d2.utils.events INFO:  eta: 0:10:34  iter: 819  total_loss: 0.1255  loss_cls: 0.04961  loss_box_reg: 0.04547  loss_rpn_cls: 0.00787  loss_rpn_loc: 0.02155  time: 0.5392  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/13 13:34:23] d2.utils.events INFO:  eta: 0:10:23  iter: 839  total_loss: 0.1297  loss_cls: 0.04946  loss_box_reg: 0.04632  loss_rpn_cls: 0.0089  loss_rpn_loc: 0.02436  time: 0.5393  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/13 13:34:34] d2.utils.events INFO:  eta: 0:10:13  iter: 859  total_loss: 0.12  loss_cls: 0.04854  loss_box_reg: 0.04565  loss_rpn_cls: 0.007777  loss_rpn_loc: 0.02033  time: 0.5392  data_time: 0.0108  lr: 0.01  max_mem: 5386M
[11/13 13:34:45] d2.utils.events INFO:  eta: 0:10:02  iter: 879  total_loss: 0.121  loss_cls: 0.04628  loss_box_reg: 0.04551  loss_rpn_cls: 0.007743  loss_rpn_loc: 0.02161  time: 0.5392  data_time: 0.0114  lr: 0.01  max_mem: 5386M
[11/13 13:34:56] d2.utils.events INFO:  eta: 0:09:51  iter: 899  total_loss: 0.1217  loss_cls: 0.04601  loss_box_reg: 0.04134  loss_rpn_cls: 0.009309  loss_rpn_loc: 0.02488  time: 0.5392  data_time: 0.0113  lr: 0.01  max_mem: 5386M
[11/13 13:35:06] d2.utils.events INFO:  eta: 0:09:40  iter: 919  total_loss: 0.1175  loss_cls: 0.04504  loss_box_reg: 0.04074  loss_rpn_cls: 0.007624  loss_rpn_loc: 0.02214  time: 0.5393  data_time: 0.0110  lr: 0.01  max_mem: 5386M
[11/13 13:35:17] d2.utils.events INFO:  eta: 0:09:30  iter: 939  total_loss: 0.1226  loss_cls: 0.04519  loss_box_reg: 0.04229  loss_rpn_cls: 0.009193  loss_rpn_loc: 0.02718  time: 0.5392  data_time: 0.0128  lr: 0.01  max_mem: 5386M
[11/13 13:35:28] d2.utils.events INFO:  eta: 0:09:19  iter: 959  total_loss: 0.1194  loss_cls: 0.04401  loss_box_reg: 0.04168  loss_rpn_cls: 0.00852  loss_rpn_loc: 0.02546  time: 0.5391  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/13 13:35:39] d2.utils.events INFO:  eta: 0:09:08  iter: 979  total_loss: 0.1195  loss_cls: 0.04382  loss_box_reg: 0.04045  loss_rpn_cls: 0.006919  loss_rpn_loc: 0.02179  time: 0.5392  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/13 13:35:50] d2.utils.events INFO:  eta: 0:08:57  iter: 999  total_loss: 0.1151  loss_cls: 0.04454  loss_box_reg: 0.03807  loss_rpn_cls: 0.00808  loss_rpn_loc: 0.02004  time: 0.5392  data_time: 0.0123  lr: 0.01  max_mem: 5386M
[11/13 13:36:00] d2.utils.events INFO:  eta: 0:08:46  iter: 1019  total_loss: 0.1104  loss_cls: 0.04459  loss_box_reg: 0.03955  loss_rpn_cls: 0.007851  loss_rpn_loc: 0.02225  time: 0.5392  data_time: 0.0117  lr: 0.01  max_mem: 5386M
[11/13 13:36:11] d2.utils.events INFO:  eta: 0:08:35  iter: 1039  total_loss: 0.1111  loss_cls: 0.04205  loss_box_reg: 0.03939  loss_rpn_cls: 0.007487  loss_rpn_loc: 0.02167  time: 0.5391  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/13 13:36:22] d2.utils.events INFO:  eta: 0:08:24  iter: 1059  total_loss: 0.1102  loss_cls: 0.04265  loss_box_reg: 0.03762  loss_rpn_cls: 0.007118  loss_rpn_loc: 0.01883  time: 0.5391  data_time: 0.0119  lr: 0.01  max_mem: 5386M
[11/13 13:36:33] d2.utils.events INFO:  eta: 0:08:14  iter: 1079  total_loss: 0.1068  loss_cls: 0.04234  loss_box_reg: 0.03896  loss_rpn_cls: 0.007433  loss_rpn_loc: 0.0182  time: 0.5391  data_time: 0.0128  lr: 0.01  max_mem: 5386M
[11/13 13:36:43] d2.utils.events INFO:  eta: 0:08:03  iter: 1099  total_loss: 0.1083  loss_cls: 0.04021  loss_box_reg: 0.03646  loss_rpn_cls: 0.007136  loss_rpn_loc: 0.02102  time: 0.5390  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/13 13:36:54] d2.utils.events INFO:  eta: 0:07:52  iter: 1119  total_loss: 0.1068  loss_cls: 0.04061  loss_box_reg: 0.03756  loss_rpn_cls: 0.007027  loss_rpn_loc: 0.01943  time: 0.5390  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/13 13:37:05] d2.utils.events INFO:  eta: 0:07:41  iter: 1139  total_loss: 0.1039  loss_cls: 0.04077  loss_box_reg: 0.03707  loss_rpn_cls: 0.006348  loss_rpn_loc: 0.02131  time: 0.5389  data_time: 0.0105  lr: 0.01  max_mem: 5386M
[11/13 13:37:16] d2.utils.events INFO:  eta: 0:07:31  iter: 1159  total_loss: 0.1009  loss_cls: 0.04056  loss_box_reg: 0.03623  loss_rpn_cls: 0.006574  loss_rpn_loc: 0.01701  time: 0.5390  data_time: 0.0119  lr: 0.01  max_mem: 5386M
[11/13 13:37:26] d2.utils.events INFO:  eta: 0:07:20  iter: 1179  total_loss: 0.1015  loss_cls: 0.04006  loss_box_reg: 0.03779  loss_rpn_cls: 0.006051  loss_rpn_loc: 0.01778  time: 0.5389  data_time: 0.0112  lr: 0.01  max_mem: 5386M
[11/13 13:37:37] d2.utils.events INFO:  eta: 0:07:09  iter: 1199  total_loss: 0.1057  loss_cls: 0.04115  loss_box_reg: 0.03588  loss_rpn_cls: 0.005804  loss_rpn_loc: 0.02032  time: 0.5389  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/13 13:37:48] d2.utils.events INFO:  eta: 0:06:58  iter: 1219  total_loss: 0.1072  loss_cls: 0.0385  loss_box_reg: 0.03663  loss_rpn_cls: 0.006182  loss_rpn_loc: 0.0203  time: 0.5390  data_time: 0.0111  lr: 0.01  max_mem: 5386M
[11/13 13:37:59] d2.utils.events INFO:  eta: 0:06:48  iter: 1239  total_loss: 0.1009  loss_cls: 0.03891  loss_box_reg: 0.03582  loss_rpn_cls: 0.005773  loss_rpn_loc: 0.02071  time: 0.5390  data_time: 0.0122  lr: 0.01  max_mem: 5386M
[11/13 13:38:10] d2.utils.events INFO:  eta: 0:06:37  iter: 1259  total_loss: 0.09968  loss_cls: 0.03807  loss_box_reg: 0.03495  loss_rpn_cls: 0.006016  loss_rpn_loc: 0.01886  time: 0.5389  data_time: 0.0127  lr: 0.01  max_mem: 5386M
[11/13 13:38:20] d2.utils.events INFO:  eta: 0:06:26  iter: 1279  total_loss: 0.09602  loss_cls: 0.03914  loss_box_reg: 0.0344  loss_rpn_cls: 0.005944  loss_rpn_loc: 0.01817  time: 0.5389  data_time: 0.0117  lr: 0.01  max_mem: 5386M
[11/13 13:38:31] d2.utils.events INFO:  eta: 0:06:15  iter: 1299  total_loss: 0.1028  loss_cls: 0.03843  loss_box_reg: 0.03416  loss_rpn_cls: 0.006902  loss_rpn_loc: 0.02357  time: 0.5389  data_time: 0.0121  lr: 0.01  max_mem: 5386M
[11/13 13:38:42] d2.utils.events INFO:  eta: 0:06:04  iter: 1319  total_loss: 0.09709  loss_cls: 0.03797  loss_box_reg: 0.03191  loss_rpn_cls: 0.005288  loss_rpn_loc: 0.01955  time: 0.5389  data_time: 0.0136  lr: 0.01  max_mem: 5386M
[11/13 13:38:53] d2.utils.events INFO:  eta: 0:05:54  iter: 1339  total_loss: 0.09571  loss_cls: 0.03656  loss_box_reg: 0.0319  loss_rpn_cls: 0.006115  loss_rpn_loc: 0.02139  time: 0.5388  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/13 13:39:03] d2.utils.events INFO:  eta: 0:05:43  iter: 1359  total_loss: 0.09005  loss_cls: 0.03615  loss_box_reg: 0.02962  loss_rpn_cls: 0.005805  loss_rpn_loc: 0.01674  time: 0.5387  data_time: 0.0115  lr: 0.01  max_mem: 5386M
[11/13 13:39:14] d2.utils.events INFO:  eta: 0:05:32  iter: 1379  total_loss: 0.09262  loss_cls: 0.03576  loss_box_reg: 0.03261  loss_rpn_cls: 0.006741  loss_rpn_loc: 0.02091  time: 0.5388  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:39:25] d2.utils.events INFO:  eta: 0:05:22  iter: 1399  total_loss: 0.09462  loss_cls: 0.03639  loss_box_reg: 0.03231  loss_rpn_cls: 0.005527  loss_rpn_loc: 0.01665  time: 0.5387  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:39:36] d2.utils.events INFO:  eta: 0:05:11  iter: 1419  total_loss: 0.09204  loss_cls: 0.03607  loss_box_reg: 0.03188  loss_rpn_cls: 0.004778  loss_rpn_loc: 0.01981  time: 0.5387  data_time: 0.0109  lr: 0.01  max_mem: 5386M
[11/13 13:39:46] d2.utils.events INFO:  eta: 0:05:00  iter: 1439  total_loss: 0.09355  loss_cls: 0.03495  loss_box_reg: 0.03236  loss_rpn_cls: 0.006787  loss_rpn_loc: 0.02021  time: 0.5386  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/13 13:39:57] d2.utils.events INFO:  eta: 0:04:50  iter: 1459  total_loss: 0.09505  loss_cls: 0.03629  loss_box_reg: 0.03218  loss_rpn_cls: 0.006014  loss_rpn_loc: 0.01979  time: 0.5387  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/13 13:40:08] d2.utils.events INFO:  eta: 0:04:39  iter: 1479  total_loss: 0.09039  loss_cls: 0.03539  loss_box_reg: 0.03079  loss_rpn_cls: 0.005537  loss_rpn_loc: 0.02179  time: 0.5386  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/13 13:40:19] d2.utils.events INFO:  eta: 0:04:28  iter: 1499  total_loss: 0.08716  loss_cls: 0.03464  loss_box_reg: 0.03075  loss_rpn_cls: 0.006017  loss_rpn_loc: 0.01957  time: 0.5386  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/13 13:40:29] d2.utils.events INFO:  eta: 0:04:17  iter: 1519  total_loss: 0.08823  loss_cls: 0.03473  loss_box_reg: 0.03074  loss_rpn_cls: 0.004667  loss_rpn_loc: 0.01708  time: 0.5386  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:40:40] d2.utils.events INFO:  eta: 0:04:07  iter: 1539  total_loss: 0.08831  loss_cls: 0.03556  loss_box_reg: 0.03154  loss_rpn_cls: 0.005139  loss_rpn_loc: 0.01519  time: 0.5386  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/13 13:40:51] d2.utils.events INFO:  eta: 0:03:56  iter: 1559  total_loss: 0.08968  loss_cls: 0.03402  loss_box_reg: 0.02989  loss_rpn_cls: 0.005658  loss_rpn_loc: 0.01752  time: 0.5385  data_time: 0.0114  lr: 0.01  max_mem: 5386M
[11/13 13:41:02] d2.utils.events INFO:  eta: 0:03:45  iter: 1579  total_loss: 0.08953  loss_cls: 0.03507  loss_box_reg: 0.02981  loss_rpn_cls: 0.00475  loss_rpn_loc: 0.01839  time: 0.5384  data_time: 0.0112  lr: 0.01  max_mem: 5386M
[11/13 13:41:13] d2.utils.events INFO:  eta: 0:03:34  iter: 1599  total_loss: 0.08782  loss_cls: 0.03356  loss_box_reg: 0.02971  loss_rpn_cls: 0.004898  loss_rpn_loc: 0.01875  time: 0.5384  data_time: 0.0114  lr: 0.01  max_mem: 5386M
[11/13 13:41:23] d2.utils.events INFO:  eta: 0:03:23  iter: 1619  total_loss: 0.08439  loss_cls: 0.03382  loss_box_reg: 0.02851  loss_rpn_cls: 0.005645  loss_rpn_loc: 0.01558  time: 0.5384  data_time: 0.0119  lr: 0.001  max_mem: 5386M
[11/13 13:41:34] d2.utils.events INFO:  eta: 0:03:13  iter: 1639  total_loss: 0.0809  loss_cls: 0.03325  loss_box_reg: 0.02833  loss_rpn_cls: 0.004247  loss_rpn_loc: 0.01223  time: 0.5384  data_time: 0.0124  lr: 0.001  max_mem: 5386M
[11/13 13:41:45] d2.utils.events INFO:  eta: 0:03:02  iter: 1659  total_loss: 0.07469  loss_cls: 0.03315  loss_box_reg: 0.02632  loss_rpn_cls: 0.00439  loss_rpn_loc: 0.0101  time: 0.5384  data_time: 0.0119  lr: 0.001  max_mem: 5386M
[11/13 13:41:56] d2.utils.events INFO:  eta: 0:02:51  iter: 1679  total_loss: 0.08023  loss_cls: 0.03445  loss_box_reg: 0.02676  loss_rpn_cls: 0.005331  loss_rpn_loc: 0.01137  time: 0.5384  data_time: 0.0115  lr: 0.001  max_mem: 5386M
[11/13 13:42:06] d2.utils.events INFO:  eta: 0:02:40  iter: 1699  total_loss: 0.07662  loss_cls: 0.03248  loss_box_reg: 0.02764  loss_rpn_cls: 0.004638  loss_rpn_loc: 0.01041  time: 0.5384  data_time: 0.0123  lr: 0.001  max_mem: 5386M
[11/13 13:42:17] d2.utils.events INFO:  eta: 0:02:30  iter: 1719  total_loss: 0.0795  loss_cls: 0.03342  loss_box_reg: 0.02735  loss_rpn_cls: 0.004853  loss_rpn_loc: 0.01182  time: 0.5384  data_time: 0.0108  lr: 0.001  max_mem: 5386M
[11/13 13:42:28] d2.utils.events INFO:  eta: 0:02:19  iter: 1739  total_loss: 0.08051  loss_cls: 0.03388  loss_box_reg: 0.02775  loss_rpn_cls: 0.00542  loss_rpn_loc: 0.01318  time: 0.5385  data_time: 0.0117  lr: 0.001  max_mem: 5386M
[11/13 13:42:39] d2.utils.events INFO:  eta: 0:02:08  iter: 1759  total_loss: 0.07696  loss_cls: 0.03516  loss_box_reg: 0.02771  loss_rpn_cls: 0.003853  loss_rpn_loc: 0.01077  time: 0.5384  data_time: 0.0117  lr: 0.001  max_mem: 5386M
[11/13 13:42:49] d2.utils.events INFO:  eta: 0:01:58  iter: 1779  total_loss: 0.07745  loss_cls: 0.03272  loss_box_reg: 0.02865  loss_rpn_cls: 0.004836  loss_rpn_loc: 0.01159  time: 0.5384  data_time: 0.0122  lr: 0.001  max_mem: 5386M
[11/13 13:43:00] d2.utils.events INFO:  eta: 0:01:47  iter: 1799  total_loss: 0.08362  loss_cls: 0.03397  loss_box_reg: 0.02954  loss_rpn_cls: 0.005011  loss_rpn_loc: 0.012  time: 0.5384  data_time: 0.0120  lr: 0.001  max_mem: 5386M
[11/13 13:43:11] d2.utils.events INFO:  eta: 0:01:36  iter: 1819  total_loss: 0.07711  loss_cls: 0.03435  loss_box_reg: 0.02899  loss_rpn_cls: 0.005091  loss_rpn_loc: 0.01102  time: 0.5384  data_time: 0.0117  lr: 0.001  max_mem: 5386M
[11/13 13:43:22] d2.utils.events INFO:  eta: 0:01:25  iter: 1839  total_loss: 0.07507  loss_cls: 0.03361  loss_box_reg: 0.02813  loss_rpn_cls: 0.004627  loss_rpn_loc: 0.01051  time: 0.5383  data_time: 0.0113  lr: 0.001  max_mem: 5386M
[11/13 13:43:32] d2.utils.events INFO:  eta: 0:01:15  iter: 1859  total_loss: 0.08171  loss_cls: 0.03401  loss_box_reg: 0.02809  loss_rpn_cls: 0.004036  loss_rpn_loc: 0.01148  time: 0.5383  data_time: 0.0111  lr: 0.001  max_mem: 5386M
[11/13 13:43:43] d2.utils.events INFO:  eta: 0:01:04  iter: 1879  total_loss: 0.07887  loss_cls: 0.03466  loss_box_reg: 0.02788  loss_rpn_cls: 0.004303  loss_rpn_loc: 0.009814  time: 0.5383  data_time: 0.0117  lr: 0.001  max_mem: 5386M
[11/13 13:43:54] d2.utils.events INFO:  eta: 0:00:53  iter: 1899  total_loss: 0.07738  loss_cls: 0.03388  loss_box_reg: 0.02751  loss_rpn_cls: 0.004454  loss_rpn_loc: 0.009666  time: 0.5383  data_time: 0.0121  lr: 0.001  max_mem: 5386M
[11/13 13:44:05] d2.utils.events INFO:  eta: 0:00:42  iter: 1919  total_loss: 0.08005  loss_cls: 0.03348  loss_box_reg: 0.02911  loss_rpn_cls: 0.004897  loss_rpn_loc: 0.01085  time: 0.5383  data_time: 0.0130  lr: 0.001  max_mem: 5386M
[11/13 13:44:15] d2.utils.events INFO:  eta: 0:00:32  iter: 1939  total_loss: 0.0781  loss_cls: 0.03542  loss_box_reg: 0.02809  loss_rpn_cls: 0.004313  loss_rpn_loc: 0.009861  time: 0.5382  data_time: 0.0113  lr: 0.001  max_mem: 5386M
[11/13 13:44:26] d2.utils.events INFO:  eta: 0:00:21  iter: 1959  total_loss: 0.07954  loss_cls: 0.03396  loss_box_reg: 0.02856  loss_rpn_cls: 0.004736  loss_rpn_loc: 0.0117  time: 0.5382  data_time: 0.0118  lr: 0.001  max_mem: 5386M
[11/13 13:44:37] d2.utils.events INFO:  eta: 0:00:10  iter: 1979  total_loss: 0.07927  loss_cls: 0.03512  loss_box_reg: 0.02861  loss_rpn_cls: 0.004794  loss_rpn_loc: 0.01012  time: 0.5381  data_time: 0.0109  lr: 0.001  max_mem: 5386M
[11/13 13:44:47] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/model_final.pth
[11/13 13:44:48] d2.utils.events INFO:  eta: 0:00:00  iter: 1999  total_loss: 0.07713  loss_cls: 0.03278  loss_box_reg: 0.02756  loss_rpn_cls: 0.005  loss_rpn_loc: 0.01191  time: 0.5381  data_time: 0.0124  lr: 0.001  max_mem: 5386M
[11/13 13:44:48] d2.engine.hooks INFO: Overall training speed: 1998 iterations in 0:17:55 (0.5381 s / it)
[11/13 13:44:48] d2.engine.hooks INFO: Total training time: 0:17:58 (0:00:02 on hooks)
[11/13 13:44:49] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 10538        |  bicycle   | 313          |     car      | 1641         |
|  motorcycle  | 388          |  airplane  | 131          |     bus      | 259          |
|    train     | 212          |    boat    | 458          |     bird     | 453          |
|     cat      | 195          |    dog     | 223          |    horse     | 305          |
|    sheep     | 306          |    cow     | 376          |    bottle    | 939          |
|    chair     | 1594         |   couch    | 236          | potted plant | 429          |
| dining table | 633          |     tv     | 257          |              |              |
|    total     | 19886        |            |              |              |              |[0m
[11/13 13:44:49] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/13 13:44:49] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/13 13:44:49] d2.data.common INFO: Serialized dataset takes 2.08 MiB
[11/13 13:44:50] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/13 13:44:50] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/13 13:44:52] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/13 13:44:52] d2.data.common INFO: Serializing 130 elements to byte tensors and concatenating them all ...
[11/13 13:44:52] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/13 13:44:59] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/13 13:45:10] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1208 s / img. ETA=0:02:24
[11/13 13:45:16] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1205 s / img. ETA=0:02:18
[11/13 13:45:22] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1200 s / img. ETA=0:02:11
[11/13 13:45:28] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1200 s / img. ETA=0:02:05
[11/13 13:45:34] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1202 s / img. ETA=0:02:00
[11/13 13:45:40] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1195 s / img. ETA=0:01:53
[11/13 13:45:46] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1191 s / img. ETA=0:01:47
[11/13 13:45:52] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1192 s / img. ETA=0:01:41
[11/13 13:45:58] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1194 s / img. ETA=0:01:35
[11/13 13:46:04] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1190 s / img. ETA=0:01:29
[11/13 13:46:10] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1192 s / img. ETA=0:01:23
[11/13 13:46:16] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1191 s / img. ETA=0:01:17
[11/13 13:46:22] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1191 s / img. ETA=0:01:11
[11/13 13:46:27] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1187 s / img. ETA=0:01:05
[11/13 13:46:34] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1188 s / img. ETA=0:00:59
[11/13 13:46:39] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1187 s / img. ETA=0:00:53
[11/13 13:46:45] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1188 s / img. ETA=0:00:47
[11/13 13:46:51] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1189 s / img. ETA=0:00:41
[11/13 13:46:57] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1188 s / img. ETA=0:00:35
[11/13 13:47:03] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1189 s / img. ETA=0:00:29
[11/13 13:47:09] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1189 s / img. ETA=0:00:23
[11/13 13:47:15] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1189 s / img. ETA=0:00:17
[11/13 13:47:21] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1189 s / img. ETA=0:00:11
[11/13 13:47:27] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1190 s / img. ETA=0:00:05
[11/13 13:47:33] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1189 s / img. ETA=0:00:00
[11/13 13:47:33] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:28 (0.118876 s / img per device, on 4 devices)
[11/13 13:47:33] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:25 (0.116789 s / img per device, on 4 devices)
[11/13 13:47:34] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/13 13:47:34] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/inference/coco_instances_results.json
[11/13 13:47:34] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/13 13:47:46] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 14.455 | 26.170 | 14.074 | 5.793 | 13.280 | 22.864 |
[11/13 13:47:46] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 6.105  | bicycle    | 3.069  | car          | 4.638  |
| motorcycle   | 18.525 | airplane   | 38.205 | bus          | 46.641 |
| train        | 23.369 | boat       | 4.546  | bird         | 5.613  |
| cat          | 13.950 | dog        | 14.510 | horse        | 24.081 |
| sheep        | 2.617  | cow        | 13.665 | bottle       | 9.946  |
| chair        | 4.003  | couch      | 17.416 | potted plant | 2.113  |
| dining table | 3.231  | tv         | 32.860 |              |        |
[11/13 13:47:46] defrcn.engine.defaults INFO: Evaluation results for coco14_test_novel in csv format:
[11/13 13:47:46] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/13 13:47:46] defrcn.evaluation.testing INFO: copypaste: nAP,nAP50,nAP75,nAPs,nAPm,nAPl,AP
[11/13 13:47:46] defrcn.evaluation.testing INFO: copypaste: 14.4551,26.1696,14.0740,5.7929,13.2801,22.8636,14.4551
[11/13 13:47:59] detectron2 INFO: Rank of current process: 0. World size: 4
[11/13 13:47:59] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_gfsod_r101_novel_3shot_seed0.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0', 'SEED', '46577598'], resume=False, start_iter=-1)
[11/13 13:47:59] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_gfsod_r101_novel_3shot_seed0.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 80
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_all_3shot_seed0", )
  TEST: ('coco14_test_all',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (3840,)
  MAX_ITER: 4800
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/13 13:47:59] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/config.yaml
[11/13 13:48:00] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/13 13:48:00] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/model_final-merge.pth ...
[11/13 13:48:01] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10538        |   bicycle    | 313          |      car      | 1641         |
|  motorcycle   | 388          |   airplane   | 131          |      bus      | 259          |
|     train     | 212          |    truck     | 352          |     boat      | 458          |
| traffic light | 516          | fire hydrant | 83           |   stop sign   | 84           |
| parking meter | 59           |    bench     | 471          |     bird      | 453          |
|      cat      | 195          |     dog      | 223          |     horse     | 305          |
|     sheep     | 306          |     cow      | 376          |   elephant    | 283          |
|     bear      | 53           |    zebra     | 275          |    giraffe    | 170          |
|   backpack    | 384          |   umbrella   | 387          |    handbag    | 483          |
|      tie      | 290          |   suitcase   | 309          |    frisbee    | 109          |
|     skis      | 281          |  snowboard   | 90           |  sports ball  | 233          |
|     kite      | 381          | baseball bat | 123          | baseball gl.. | 139          |
|  skateboard   | 215          |  surfboard   | 266          | tennis racket | 183          |
|    bottle     | 939          |  wine glass  | 363          |      cup      | 891          |
|     fork      | 234          |    knife     | 290          |     spoon     | 253          |
|     bowl      | 617          |    banana    | 359          |     apple     | 158          |
|   sandwich    | 158          |    orange    | 185          |   broccoli    | 330          |
|    carrot     | 341          |   hot dog    | 160          |     pizza     | 223          |
|     donut     | 225          |     cake     | 236          |     chair     | 1594         |
|     couch     | 236          | potted plant | 429          |      bed      | 195          |
| dining table  | 633          |    toilet    | 179          |      tv       | 257          |
|    laptop     | 236          |    mouse     | 95           |    remote     | 241          |
|   keyboard    | 117          |  cell phone  | 291          |   microwave   | 88           |
|     oven      | 142          |   toaster    | 11           |     sink      | 211          |
| refrigerator  | 107          |     book     | 1031         |     clock     | 290          |
|     vase      | 350          |   scissors   | 56           |  teddy bear   | 238          |
|  hair drier   | 11           |  toothbrush  | 77           |               |              |
|     total     | 35094        |              |              |               |              |[0m
[11/13 13:48:01] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/13 13:48:01] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/13 13:48:01] d2.data.common INFO: Serialized dataset takes 3.00 MiB
[11/13 13:48:02] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/13 13:48:02] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/13 13:48:04] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 3            |   bicycle    | 3            |      car      | 3            |
|  motorcycle   | 3            |   airplane   | 3            |      bus      | 3            |
|     train     | 3            |    truck     | 3            |     boat      | 3            |
| traffic light | 3            | fire hydrant | 3            |   stop sign   | 3            |
| parking meter | 3            |    bench     | 3            |     bird      | 3            |
|      cat      | 3            |     dog      | 3            |     horse     | 3            |
|     sheep     | 3            |     cow      | 3            |   elephant    | 3            |
|     bear      | 3            |    zebra     | 3            |    giraffe    | 3            |
|   backpack    | 3            |   umbrella   | 3            |    handbag    | 3            |
|      tie      | 3            |   suitcase   | 3            |    frisbee    | 3            |
|     skis      | 3            |  snowboard   | 3            |  sports ball  | 3            |
|     kite      | 3            | baseball bat | 3            | baseball gl.. | 3            |
|  skateboard   | 3            |  surfboard   | 3            | tennis racket | 3            |
|    bottle     | 3            |  wine glass  | 3            |      cup      | 3            |
|     fork      | 3            |    knife     | 3            |     spoon     | 3            |
|     bowl      | 3            |    banana    | 3            |     apple     | 3            |
|   sandwich    | 3            |    orange    | 3            |   broccoli    | 3            |
|    carrot     | 3            |   hot dog    | 3            |     pizza     | 3            |
|     donut     | 3            |     cake     | 3            |     chair     | 3            |
|     couch     | 3            | potted plant | 3            |      bed      | 3            |
| dining table  | 3            |    toilet    | 3            |      tv       | 3            |
|    laptop     | 3            |    mouse     | 3            |    remote     | 3            |
|   keyboard    | 3            |  cell phone  | 3            |   microwave   | 3            |
|     oven      | 3            |   toaster    | 3            |     sink      | 3            |
| refrigerator  | 3            |     book     | 3            |     clock     | 3            |
|     vase      | 3            |   scissors   | 3            |  teddy bear   | 3            |
|  hair drier   | 3            |  toothbrush  | 3            |               |              |
|     total     | 240          |              |              |               |              |[0m
[11/13 13:48:04] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/13 13:48:04] d2.data.common INFO: Serializing 402 elements to byte tensors and concatenating them all ...
[11/13 13:48:04] d2.data.common INFO: Serialized dataset takes 0.08 MiB
[11/13 13:48:28] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/13 13:48:39] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1192 s / img. ETA=0:02:23
[11/13 13:48:45] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1199 s / img. ETA=0:02:17
[11/13 13:48:51] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1192 s / img. ETA=0:02:11
[11/13 13:48:56] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1189 s / img. ETA=0:02:04
[11/13 13:49:02] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1191 s / img. ETA=0:01:59
[11/13 13:49:08] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1183 s / img. ETA=0:01:52
[11/13 13:49:14] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1180 s / img. ETA=0:01:46
[11/13 13:49:20] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1181 s / img. ETA=0:01:40
[11/13 13:49:26] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1181 s / img. ETA=0:01:34
[11/13 13:49:32] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1178 s / img. ETA=0:01:28
[11/13 13:49:38] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1179 s / img. ETA=0:01:22
[11/13 13:49:43] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1179 s / img. ETA=0:01:16
[11/13 13:49:49] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1179 s / img. ETA=0:01:10
[11/13 13:49:55] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1175 s / img. ETA=0:01:04
[11/13 13:50:01] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1177 s / img. ETA=0:00:58
[11/13 13:50:07] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1179 s / img. ETA=0:00:53
[11/13 13:50:13] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1180 s / img. ETA=0:00:47
[11/13 13:50:19] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1180 s / img. ETA=0:00:41
[11/13 13:50:25] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1179 s / img. ETA=0:00:35
[11/13 13:50:31] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1179 s / img. ETA=0:00:29
[11/13 13:50:36] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1178 s / img. ETA=0:00:23
[11/13 13:50:42] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1178 s / img. ETA=0:00:17
[11/13 13:50:48] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1179 s / img. ETA=0:00:11
[11/13 13:50:54] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1178 s / img. ETA=0:00:05
[11/13 13:51:00] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1177 s / img. ETA=0:00:00
[11/13 13:51:00] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:26 (0.117269 s / img per device, on 4 devices)
[11/13 13:51:00] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:23 (0.115393 s / img per device, on 4 devices)
[11/13 13:51:04] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/13 13:51:04] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed0/inference/coco_instances_results.json
[11/13 13:51:04] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/13 13:51:27] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 30.317 | 47.688 | 32.049 | 14.709 | 34.143 | 43.461 |
[11/13 13:51:27] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category      | AP     | category     | AP     | category       | AP     |
|:--------------|:-------|:-------------|:-------|:---------------|:-------|
| person        | 6.138  | bicycle      | 2.925  | car            | 4.319  |
| motorcycle    | 18.888 | airplane     | 38.173 | bus            | 46.758 |
| train         | 23.502 | truck        | 29.683 | boat           | 5.731  |
| traffic light | 23.850 | fire hydrant | 62.814 | stop sign      | 69.118 |
| parking meter | 36.266 | bench        | 17.085 | bird           | 6.585  |
| cat           | 14.727 | dog          | 14.291 | horse          | 24.391 |
| sheep         | 3.964  | cow          | 16.188 | elephant       | 62.900 |
| bear          | 53.438 | zebra        | 59.040 | giraffe        | 67.138 |
| backpack      | 14.826 | umbrella     | 29.946 | handbag        | 12.857 |
| tie           | 29.980 | suitcase     | 26.716 | frisbee        | 56.581 |
| skis          | 21.355 | snowboard    | 31.809 | sports ball    | 38.785 |
| kite          | 36.607 | baseball bat | 26.344 | baseball glove | 24.768 |
| skateboard    | 41.222 | surfboard    | 37.972 | tennis racket  | 46.750 |
| bottle        | 11.811 | wine glass   | 29.487 | cup            | 36.451 |
| fork          | 34.067 | knife        | 14.563 | spoon          | 16.060 |
| bowl          | 36.310 | banana       | 23.758 | apple          | 19.777 |
| sandwich      | 34.897 | orange       | 23.197 | broccoli       | 23.602 |
| carrot        | 23.333 | hot dog      | 30.902 | pizza          | 50.188 |
| donut         | 49.429 | cake         | 38.004 | chair          | 4.233  |
| couch         | 18.475 | potted plant | 2.319  | bed            | 39.347 |
| dining table  | 3.614  | toilet       | 52.979 | tv             | 35.957 |
| laptop        | 54.864 | mouse        | 47.337 | remote         | 27.485 |
| keyboard      | 51.122 | cell phone   | 24.006 | microwave      | 50.677 |
| oven          | 35.824 | toaster      | 29.633 | sink           | 32.563 |
| refrigerator  | 51.026 | book         | 8.606  | clock          | 46.766 |
| vase          | 30.600 | scissors     | 24.064 | teddy bear     | 37.112 |
| hair drier    | 16.556 | toothbrush   | 19.892 |                |        |
[11/13 13:51:42] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 35.372 | 54.408 | 37.828 | 17.802 | 40.724 | 49.885 |
[11/13 13:51:42] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category       | AP     | category      | AP     | category     | AP     |
|:---------------|:-------|:--------------|:-------|:-------------|:-------|
| truck          | 29.683 | traffic light | 23.850 | fire hydrant | 62.814 |
| stop sign      | 69.118 | parking meter | 36.266 | bench        | 17.085 |
| elephant       | 62.900 | bear          | 53.438 | zebra        | 59.040 |
| giraffe        | 67.138 | backpack      | 14.826 | umbrella     | 29.946 |
| handbag        | 12.857 | tie           | 29.980 | suitcase     | 26.716 |
| frisbee        | 56.581 | skis          | 21.355 | snowboard    | 31.809 |
| sports ball    | 38.785 | kite          | 36.607 | baseball bat | 26.344 |
| baseball glove | 24.768 | skateboard    | 41.222 | surfboard    | 37.972 |
| tennis racket  | 46.750 | wine glass    | 29.487 | cup          | 36.451 |
| fork           | 34.067 | knife         | 14.563 | spoon        | 16.060 |
| bowl           | 36.310 | banana        | 23.758 | apple        | 19.777 |
| sandwich       | 34.897 | orange        | 23.197 | broccoli     | 23.602 |
| carrot         | 23.333 | hot dog       | 30.902 | pizza        | 50.188 |
| donut          | 49.429 | cake          | 38.004 | bed          | 39.347 |
| toilet         | 52.979 | laptop        | 54.864 | mouse        | 47.337 |
| remote         | 27.485 | keyboard      | 51.122 | cell phone   | 24.006 |
| microwave      | 50.677 | oven          | 35.824 | toaster      | 29.633 |
| sink           | 32.563 | refrigerator  | 51.026 | book         | 8.606  |
| clock          | 46.766 | vase          | 30.600 | scissors     | 24.064 |
| teddy bear     | 37.112 | hair drier    | 16.556 | toothbrush   | 19.892 |
[11/13 13:51:51] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 15.149 | 27.528 | 14.714 | 5.584 | 14.399 | 24.191 |
[11/13 13:51:51] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 6.138  | bicycle    | 2.925  | car          | 4.319  |
| motorcycle   | 18.888 | airplane   | 38.173 | bus          | 46.758 |
| train        | 23.502 | boat       | 5.731  | bird         | 6.585  |
| cat          | 14.727 | dog        | 14.291 | horse        | 24.391 |
| sheep        | 3.964  | cow        | 16.188 | bottle       | 11.811 |
| chair        | 4.233  | couch      | 18.475 | potted plant | 2.319  |
| dining table | 3.614  | tv         | 35.957 |              |        |
[11/13 13:51:51] defrcn.engine.defaults INFO: Evaluation results for coco14_test_all in csv format:
[11/13 13:51:51] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/13 13:51:51] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,APs,APm,APl,bAP,bAP50,bAP75,bAPs,bAPm,bAPl,nAP,nAP50,nAP75,nAPs,nAPm,nAPl
[11/13 13:51:51] defrcn.evaluation.testing INFO: copypaste: 30.3165,47.6879,32.0492,14.7086,34.1426,43.4613,35.3722,54.4077,37.8276,17.8016,40.7239,49.8847,15.1495,27.5285,14.7139,5.5843,14.3990,24.1911
