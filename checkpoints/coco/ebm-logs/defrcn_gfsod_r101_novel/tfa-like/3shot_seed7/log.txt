[11/16 13:52:51] detectron2 INFO: Rank of current process: 0. World size: 4
[11/16 13:52:51] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_fsod_r101_novel_3shot_seed7.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/16 13:52:51] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_fsod_r101_novel_3shot_seed7.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_novel_3shot_seed7", )
  TEST: ('coco14_test_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/16 13:52:51] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/config.yaml
[11/16 13:52:51] d2.utils.env INFO: Using a generated random seed 53320773
[11/16 13:52:51] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/16 13:52:52] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 60 images left.
[11/16 13:52:52] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 3            |  bicycle   | 3            |     car      | 3            |
|  motorcycle  | 3            |  airplane  | 3            |     bus      | 3            |
|    train     | 3            |    boat    | 3            |     bird     | 3            |
|     cat      | 3            |    dog     | 3            |    horse     | 3            |
|    sheep     | 3            |    cow     | 3            |    bottle    | 3            |
|    chair     | 3            |   couch    | 3            | potted plant | 3            |
| dining table | 3            |     tv     | 3            |              |              |
|    total     | 60           |            |              |              |              |[0m
[11/16 13:52:52] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/16 13:52:52] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/16 13:52:52] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/16 13:52:52] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/16 13:52:52] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth ...
[11/16 13:52:52] d2.engine.train_loop INFO: Starting training from iteration 0
[11/16 13:53:07] d2.utils.events INFO:  eta: 0:19:03  iter: 19  total_loss: 0.7687  loss_cls: 0.489  loss_box_reg: 0.1279  loss_rpn_cls: 0.09595  loss_rpn_loc: 0.06213  time: 0.5753  data_time: 0.1519  lr: 0.01  max_mem: 5382M
[11/16 13:53:19] d2.utils.events INFO:  eta: 0:18:52  iter: 39  total_loss: 0.7159  loss_cls: 0.4675  loss_box_reg: 0.1318  loss_rpn_cls: 0.07038  loss_rpn_loc: 0.04518  time: 0.5783  data_time: 0.0131  lr: 0.01  max_mem: 5385M
[11/16 13:53:30] d2.utils.events INFO:  eta: 0:18:45  iter: 59  total_loss: 0.4218  loss_cls: 0.2029  loss_box_reg: 0.1279  loss_rpn_cls: 0.0592  loss_rpn_loc: 0.04055  time: 0.5794  data_time: 0.0126  lr: 0.01  max_mem: 5385M
[11/16 13:53:42] d2.utils.events INFO:  eta: 0:18:34  iter: 79  total_loss: 0.3787  loss_cls: 0.1749  loss_box_reg: 0.1172  loss_rpn_cls: 0.04636  loss_rpn_loc: 0.03591  time: 0.5815  data_time: 0.0125  lr: 0.01  max_mem: 5385M
[11/16 13:53:54] d2.utils.events INFO:  eta: 0:18:30  iter: 99  total_loss: 0.3609  loss_cls: 0.1583  loss_box_reg: 0.1217  loss_rpn_cls: 0.04058  loss_rpn_loc: 0.03814  time: 0.5859  data_time: 0.0139  lr: 0.01  max_mem: 5385M
[11/16 13:54:06] d2.utils.events INFO:  eta: 0:18:24  iter: 119  total_loss: 0.3441  loss_cls: 0.1472  loss_box_reg: 0.117  loss_rpn_cls: 0.03734  loss_rpn_loc: 0.0332  time: 0.5905  data_time: 0.0121  lr: 0.01  max_mem: 5385M
[11/16 13:54:19] d2.utils.events INFO:  eta: 0:18:17  iter: 139  total_loss: 0.3245  loss_cls: 0.1381  loss_box_reg: 0.1204  loss_rpn_cls: 0.03451  loss_rpn_loc: 0.03163  time: 0.5940  data_time: 0.0121  lr: 0.01  max_mem: 5386M
[11/16 13:54:31] d2.utils.events INFO:  eta: 0:18:11  iter: 159  total_loss: 0.3092  loss_cls: 0.1302  loss_box_reg: 0.1086  loss_rpn_cls: 0.02951  loss_rpn_loc: 0.03144  time: 0.5973  data_time: 0.0120  lr: 0.01  max_mem: 5386M
[11/16 13:54:43] d2.utils.events INFO:  eta: 0:18:01  iter: 179  total_loss: 0.2933  loss_cls: 0.123  loss_box_reg: 0.1109  loss_rpn_cls: 0.02963  loss_rpn_loc: 0.02574  time: 0.5982  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 13:54:55] d2.utils.events INFO:  eta: 0:17:51  iter: 199  total_loss: 0.2869  loss_cls: 0.1196  loss_box_reg: 0.1111  loss_rpn_cls: 0.02598  loss_rpn_loc: 0.0278  time: 0.5993  data_time: 0.0122  lr: 0.01  max_mem: 5386M
[11/16 13:55:07] d2.utils.events INFO:  eta: 0:17:42  iter: 219  total_loss: 0.2731  loss_cls: 0.1159  loss_box_reg: 0.1028  loss_rpn_cls: 0.02483  loss_rpn_loc: 0.02981  time: 0.5997  data_time: 0.0142  lr: 0.01  max_mem: 5386M
[11/16 13:55:20] d2.utils.events INFO:  eta: 0:17:34  iter: 239  total_loss: 0.2675  loss_cls: 0.1077  loss_box_reg: 0.1035  loss_rpn_cls: 0.02329  loss_rpn_loc: 0.03236  time: 0.6015  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/16 13:55:32] d2.utils.events INFO:  eta: 0:17:22  iter: 259  total_loss: 0.253  loss_cls: 0.1027  loss_box_reg: 0.1014  loss_rpn_cls: 0.02243  loss_rpn_loc: 0.02748  time: 0.6012  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/16 13:55:44] d2.utils.events INFO:  eta: 0:17:11  iter: 279  total_loss: 0.2434  loss_cls: 0.1045  loss_box_reg: 0.09584  loss_rpn_cls: 0.01916  loss_rpn_loc: 0.02499  time: 0.6014  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 13:55:56] d2.utils.events INFO:  eta: 0:17:00  iter: 299  total_loss: 0.2293  loss_cls: 0.09478  loss_box_reg: 0.09121  loss_rpn_cls: 0.0198  loss_rpn_loc: 0.02673  time: 0.6026  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 13:56:09] d2.utils.events INFO:  eta: 0:16:49  iter: 319  total_loss: 0.2339  loss_cls: 0.09495  loss_box_reg: 0.09419  loss_rpn_cls: 0.01837  loss_rpn_loc: 0.02915  time: 0.6031  data_time: 0.0135  lr: 0.01  max_mem: 5386M
[11/16 13:56:21] d2.utils.events INFO:  eta: 0:16:39  iter: 339  total_loss: 0.227  loss_cls: 0.08966  loss_box_reg: 0.08786  loss_rpn_cls: 0.01815  loss_rpn_loc: 0.02568  time: 0.6051  data_time: 0.0142  lr: 0.01  max_mem: 5386M
[11/16 13:56:34] d2.utils.events INFO:  eta: 0:16:27  iter: 359  total_loss: 0.2148  loss_cls: 0.08776  loss_box_reg: 0.08438  loss_rpn_cls: 0.01593  loss_rpn_loc: 0.02428  time: 0.6052  data_time: 0.0123  lr: 0.01  max_mem: 5386M
[11/16 13:56:46] d2.utils.events INFO:  eta: 0:16:16  iter: 379  total_loss: 0.2106  loss_cls: 0.08235  loss_box_reg: 0.0826  loss_rpn_cls: 0.01584  loss_rpn_loc: 0.02619  time: 0.6059  data_time: 0.0122  lr: 0.01  max_mem: 5386M
[11/16 13:56:58] d2.utils.events INFO:  eta: 0:16:05  iter: 399  total_loss: 0.2045  loss_cls: 0.08493  loss_box_reg: 0.07988  loss_rpn_cls: 0.01472  loss_rpn_loc: 0.02502  time: 0.6070  data_time: 0.0128  lr: 0.01  max_mem: 5386M
[11/16 13:57:11] d2.utils.events INFO:  eta: 0:15:54  iter: 419  total_loss: 0.196  loss_cls: 0.08095  loss_box_reg: 0.07487  loss_rpn_cls: 0.01476  loss_rpn_loc: 0.02605  time: 0.6078  data_time: 0.0127  lr: 0.01  max_mem: 5386M
[11/16 13:57:23] d2.utils.events INFO:  eta: 0:15:45  iter: 439  total_loss: 0.1926  loss_cls: 0.07923  loss_box_reg: 0.07392  loss_rpn_cls: 0.01368  loss_rpn_loc: 0.02437  time: 0.6082  data_time: 0.0140  lr: 0.01  max_mem: 5386M
[11/16 13:57:36] d2.utils.events INFO:  eta: 0:15:33  iter: 459  total_loss: 0.1939  loss_cls: 0.07496  loss_box_reg: 0.07145  loss_rpn_cls: 0.01501  loss_rpn_loc: 0.02682  time: 0.6085  data_time: 0.0140  lr: 0.01  max_mem: 5386M
[11/16 13:57:48] d2.utils.events INFO:  eta: 0:15:20  iter: 479  total_loss: 0.1793  loss_cls: 0.07403  loss_box_reg: 0.06663  loss_rpn_cls: 0.0141  loss_rpn_loc: 0.02421  time: 0.6082  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 13:58:00] d2.utils.events INFO:  eta: 0:15:08  iter: 499  total_loss: 0.1753  loss_cls: 0.07573  loss_box_reg: 0.0683  loss_rpn_cls: 0.01254  loss_rpn_loc: 0.01977  time: 0.6084  data_time: 0.0126  lr: 0.01  max_mem: 5386M
[11/16 13:58:12] d2.utils.events INFO:  eta: 0:14:56  iter: 519  total_loss: 0.1746  loss_cls: 0.07223  loss_box_reg: 0.06254  loss_rpn_cls: 0.01302  loss_rpn_loc: 0.02338  time: 0.6085  data_time: 0.0132  lr: 0.01  max_mem: 5386M
[11/16 13:58:24] d2.utils.events INFO:  eta: 0:14:45  iter: 539  total_loss: 0.1667  loss_cls: 0.06976  loss_box_reg: 0.06127  loss_rpn_cls: 0.01265  loss_rpn_loc: 0.0227  time: 0.6085  data_time: 0.0144  lr: 0.01  max_mem: 5386M
[11/16 13:58:37] d2.utils.events INFO:  eta: 0:14:33  iter: 559  total_loss: 0.1627  loss_cls: 0.07062  loss_box_reg: 0.06049  loss_rpn_cls: 0.01211  loss_rpn_loc: 0.0226  time: 0.6087  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/16 13:58:50] d2.utils.events INFO:  eta: 0:14:22  iter: 579  total_loss: 0.1616  loss_cls: 0.06599  loss_box_reg: 0.05604  loss_rpn_cls: 0.01243  loss_rpn_loc: 0.02416  time: 0.6099  data_time: 0.0124  lr: 0.01  max_mem: 5386M
[11/16 13:59:02] d2.utils.events INFO:  eta: 0:14:09  iter: 599  total_loss: 0.1509  loss_cls: 0.06661  loss_box_reg: 0.05531  loss_rpn_cls: 0.01033  loss_rpn_loc: 0.01637  time: 0.6096  data_time: 0.0126  lr: 0.01  max_mem: 5386M
[11/16 13:59:14] d2.utils.events INFO:  eta: 0:13:57  iter: 619  total_loss: 0.1479  loss_cls: 0.06389  loss_box_reg: 0.05252  loss_rpn_cls: 0.01023  loss_rpn_loc: 0.02221  time: 0.6101  data_time: 0.0132  lr: 0.01  max_mem: 5386M
[11/16 13:59:26] d2.utils.events INFO:  eta: 0:13:46  iter: 639  total_loss: 0.1477  loss_cls: 0.06369  loss_box_reg: 0.05089  loss_rpn_cls: 0.01096  loss_rpn_loc: 0.02288  time: 0.6100  data_time: 0.0128  lr: 0.01  max_mem: 5386M
[11/16 13:59:38] d2.utils.events INFO:  eta: 0:13:33  iter: 659  total_loss: 0.1474  loss_cls: 0.06315  loss_box_reg: 0.05087  loss_rpn_cls: 0.01033  loss_rpn_loc: 0.02097  time: 0.6098  data_time: 0.0128  lr: 0.01  max_mem: 5386M
[11/16 13:59:51] d2.utils.events INFO:  eta: 0:13:21  iter: 679  total_loss: 0.1446  loss_cls: 0.06283  loss_box_reg: 0.0476  loss_rpn_cls: 0.0105  loss_rpn_loc: 0.02002  time: 0.6097  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/16 14:00:03] d2.utils.events INFO:  eta: 0:13:09  iter: 699  total_loss: 0.1402  loss_cls: 0.06142  loss_box_reg: 0.04724  loss_rpn_cls: 0.01019  loss_rpn_loc: 0.02192  time: 0.6097  data_time: 0.0127  lr: 0.01  max_mem: 5386M
[11/16 14:00:15] d2.utils.events INFO:  eta: 0:12:57  iter: 719  total_loss: 0.1398  loss_cls: 0.06099  loss_box_reg: 0.04658  loss_rpn_cls: 0.009259  loss_rpn_loc: 0.02243  time: 0.6097  data_time: 0.0126  lr: 0.01  max_mem: 5386M
[11/16 14:00:27] d2.utils.events INFO:  eta: 0:12:45  iter: 739  total_loss: 0.1281  loss_cls: 0.05831  loss_box_reg: 0.04358  loss_rpn_cls: 0.009343  loss_rpn_loc: 0.02014  time: 0.6100  data_time: 0.0136  lr: 0.01  max_mem: 5386M
[11/16 14:00:40] d2.utils.events INFO:  eta: 0:12:33  iter: 759  total_loss: 0.126  loss_cls: 0.05731  loss_box_reg: 0.04289  loss_rpn_cls: 0.008285  loss_rpn_loc: 0.01607  time: 0.6099  data_time: 0.0119  lr: 0.01  max_mem: 5386M
[11/16 14:00:52] d2.utils.events INFO:  eta: 0:12:21  iter: 779  total_loss: 0.1271  loss_cls: 0.05751  loss_box_reg: 0.04145  loss_rpn_cls: 0.008077  loss_rpn_loc: 0.0167  time: 0.6097  data_time: 0.0118  lr: 0.01  max_mem: 5386M
[11/16 14:01:04] d2.utils.events INFO:  eta: 0:12:08  iter: 799  total_loss: 0.1292  loss_cls: 0.05742  loss_box_reg: 0.04158  loss_rpn_cls: 0.008615  loss_rpn_loc: 0.02026  time: 0.6100  data_time: 0.0119  lr: 0.01  max_mem: 5386M
[11/16 14:01:16] d2.utils.events INFO:  eta: 0:11:57  iter: 819  total_loss: 0.123  loss_cls: 0.05512  loss_box_reg: 0.04019  loss_rpn_cls: 0.008515  loss_rpn_loc: 0.02238  time: 0.6101  data_time: 0.0121  lr: 0.01  max_mem: 5386M
[11/16 14:01:29] d2.utils.events INFO:  eta: 0:11:44  iter: 839  total_loss: 0.1209  loss_cls: 0.05374  loss_box_reg: 0.03913  loss_rpn_cls: 0.008361  loss_rpn_loc: 0.01902  time: 0.6102  data_time: 0.0126  lr: 0.01  max_mem: 5386M
[11/16 14:01:41] d2.utils.events INFO:  eta: 0:11:32  iter: 859  total_loss: 0.1153  loss_cls: 0.05224  loss_box_reg: 0.03644  loss_rpn_cls: 0.007679  loss_rpn_loc: 0.01671  time: 0.6102  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/16 14:01:53] d2.utils.events INFO:  eta: 0:11:20  iter: 879  total_loss: 0.1201  loss_cls: 0.05348  loss_box_reg: 0.03711  loss_rpn_cls: 0.00837  loss_rpn_loc: 0.01966  time: 0.6100  data_time: 0.0115  lr: 0.01  max_mem: 5386M
[11/16 14:02:05] d2.utils.events INFO:  eta: 0:11:08  iter: 899  total_loss: 0.1149  loss_cls: 0.0529  loss_box_reg: 0.03611  loss_rpn_cls: 0.007941  loss_rpn_loc: 0.01865  time: 0.6100  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/16 14:02:18] d2.utils.events INFO:  eta: 0:10:56  iter: 919  total_loss: 0.1207  loss_cls: 0.05322  loss_box_reg: 0.03657  loss_rpn_cls: 0.00747  loss_rpn_loc: 0.0217  time: 0.6101  data_time: 0.0115  lr: 0.01  max_mem: 5386M
[11/16 14:02:30] d2.utils.events INFO:  eta: 0:10:44  iter: 939  total_loss: 0.1114  loss_cls: 0.04939  loss_box_reg: 0.03594  loss_rpn_cls: 0.007763  loss_rpn_loc: 0.01808  time: 0.6101  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 14:02:42] d2.utils.events INFO:  eta: 0:10:32  iter: 959  total_loss: 0.1142  loss_cls: 0.05124  loss_box_reg: 0.0371  loss_rpn_cls: 0.007674  loss_rpn_loc: 0.01883  time: 0.6101  data_time: 0.0118  lr: 0.01  max_mem: 5386M
[11/16 14:02:54] d2.utils.events INFO:  eta: 0:10:20  iter: 979  total_loss: 0.1059  loss_cls: 0.04846  loss_box_reg: 0.03289  loss_rpn_cls: 0.006384  loss_rpn_loc: 0.01666  time: 0.6100  data_time: 0.0117  lr: 0.01  max_mem: 5386M
[11/16 14:03:06] d2.utils.events INFO:  eta: 0:10:07  iter: 999  total_loss: 0.1077  loss_cls: 0.04764  loss_box_reg: 0.03388  loss_rpn_cls: 0.007143  loss_rpn_loc: 0.02147  time: 0.6100  data_time: 0.0120  lr: 0.01  max_mem: 5386M
[11/16 14:03:18] d2.utils.events INFO:  eta: 0:09:56  iter: 1019  total_loss: 0.1065  loss_cls: 0.04814  loss_box_reg: 0.03207  loss_rpn_cls: 0.00686  loss_rpn_loc: 0.01797  time: 0.6097  data_time: 0.0121  lr: 0.01  max_mem: 5386M
[11/16 14:03:31] d2.utils.events INFO:  eta: 0:09:44  iter: 1039  total_loss: 0.1028  loss_cls: 0.04712  loss_box_reg: 0.03172  loss_rpn_cls: 0.007241  loss_rpn_loc: 0.01712  time: 0.6099  data_time: 0.0132  lr: 0.01  max_mem: 5386M
[11/16 14:03:43] d2.utils.events INFO:  eta: 0:09:33  iter: 1059  total_loss: 0.1018  loss_cls: 0.04578  loss_box_reg: 0.03205  loss_rpn_cls: 0.00669  loss_rpn_loc: 0.01504  time: 0.6100  data_time: 0.0134  lr: 0.01  max_mem: 5386M
[11/16 14:03:55] d2.utils.events INFO:  eta: 0:09:21  iter: 1079  total_loss: 0.1045  loss_cls: 0.04619  loss_box_reg: 0.03244  loss_rpn_cls: 0.006807  loss_rpn_loc: 0.01732  time: 0.6102  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 14:04:08] d2.utils.events INFO:  eta: 0:09:09  iter: 1099  total_loss: 0.1022  loss_cls: 0.04554  loss_box_reg: 0.03228  loss_rpn_cls: 0.005929  loss_rpn_loc: 0.02133  time: 0.6103  data_time: 0.0116  lr: 0.01  max_mem: 5386M
[11/16 14:04:20] d2.utils.events INFO:  eta: 0:08:57  iter: 1119  total_loss: 0.09812  loss_cls: 0.0437  loss_box_reg: 0.03058  loss_rpn_cls: 0.006493  loss_rpn_loc: 0.01972  time: 0.6103  data_time: 0.0117  lr: 0.01  max_mem: 5386M
[11/16 14:04:32] d2.utils.events INFO:  eta: 0:08:45  iter: 1139  total_loss: 0.09629  loss_cls: 0.04415  loss_box_reg: 0.02993  loss_rpn_cls: 0.006694  loss_rpn_loc: 0.01756  time: 0.6103  data_time: 0.0126  lr: 0.01  max_mem: 5386M
[11/16 14:04:44] d2.utils.events INFO:  eta: 0:08:33  iter: 1159  total_loss: 0.1011  loss_cls: 0.045  loss_box_reg: 0.02953  loss_rpn_cls: 0.006795  loss_rpn_loc: 0.01721  time: 0.6104  data_time: 0.0127  lr: 0.01  max_mem: 5386M
[11/16 14:04:57] d2.utils.events INFO:  eta: 0:08:20  iter: 1179  total_loss: 0.09576  loss_cls: 0.04215  loss_box_reg: 0.02941  loss_rpn_cls: 0.005972  loss_rpn_loc: 0.01946  time: 0.6102  data_time: 0.0123  lr: 0.01  max_mem: 5386M
[11/16 14:05:09] d2.utils.events INFO:  eta: 0:08:08  iter: 1199  total_loss: 0.09571  loss_cls: 0.04332  loss_box_reg: 0.03099  loss_rpn_cls: 0.006738  loss_rpn_loc: 0.01594  time: 0.6103  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 14:05:21] d2.utils.events INFO:  eta: 0:07:56  iter: 1219  total_loss: 0.09688  loss_cls: 0.04187  loss_box_reg: 0.02828  loss_rpn_cls: 0.006261  loss_rpn_loc: 0.01778  time: 0.6102  data_time: 0.0141  lr: 0.01  max_mem: 5386M
[11/16 14:05:33] d2.utils.events INFO:  eta: 0:07:44  iter: 1239  total_loss: 0.09747  loss_cls: 0.0423  loss_box_reg: 0.02903  loss_rpn_cls: 0.006255  loss_rpn_loc: 0.0159  time: 0.6102  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 14:05:45] d2.utils.events INFO:  eta: 0:07:32  iter: 1259  total_loss: 0.09393  loss_cls: 0.04244  loss_box_reg: 0.0292  loss_rpn_cls: 0.006516  loss_rpn_loc: 0.01676  time: 0.6102  data_time: 0.0130  lr: 0.01  max_mem: 5386M
[11/16 14:05:58] d2.utils.events INFO:  eta: 0:07:20  iter: 1279  total_loss: 0.09264  loss_cls: 0.04124  loss_box_reg: 0.02712  loss_rpn_cls: 0.005558  loss_rpn_loc: 0.01369  time: 0.6101  data_time: 0.0136  lr: 0.01  max_mem: 5386M
[11/16 14:06:10] d2.utils.events INFO:  eta: 0:07:07  iter: 1299  total_loss: 0.09426  loss_cls: 0.042  loss_box_reg: 0.02821  loss_rpn_cls: 0.005284  loss_rpn_loc: 0.01323  time: 0.6101  data_time: 0.0118  lr: 0.01  max_mem: 5386M
[11/16 14:06:22] d2.utils.events INFO:  eta: 0:06:55  iter: 1319  total_loss: 0.09256  loss_cls: 0.0421  loss_box_reg: 0.02746  loss_rpn_cls: 0.005267  loss_rpn_loc: 0.01595  time: 0.6105  data_time: 0.0146  lr: 0.01  max_mem: 5386M
[11/16 14:06:35] d2.utils.events INFO:  eta: 0:06:43  iter: 1339  total_loss: 0.08933  loss_cls: 0.04036  loss_box_reg: 0.02651  loss_rpn_cls: 0.005663  loss_rpn_loc: 0.01549  time: 0.6104  data_time: 0.0118  lr: 0.01  max_mem: 5386M
[11/16 14:06:47] d2.utils.events INFO:  eta: 0:06:31  iter: 1359  total_loss: 0.09095  loss_cls: 0.03984  loss_box_reg: 0.02719  loss_rpn_cls: 0.00527  loss_rpn_loc: 0.01704  time: 0.6104  data_time: 0.0135  lr: 0.01  max_mem: 5386M
[11/16 14:06:59] d2.utils.events INFO:  eta: 0:06:19  iter: 1379  total_loss: 0.08958  loss_cls: 0.03929  loss_box_reg: 0.02628  loss_rpn_cls: 0.005115  loss_rpn_loc: 0.01366  time: 0.6104  data_time: 0.0121  lr: 0.01  max_mem: 5386M
[11/16 14:07:11] d2.utils.events INFO:  eta: 0:06:06  iter: 1399  total_loss: 0.08772  loss_cls: 0.03935  loss_box_reg: 0.02651  loss_rpn_cls: 0.005202  loss_rpn_loc: 0.01809  time: 0.6104  data_time: 0.0126  lr: 0.01  max_mem: 5386M
[11/16 14:07:23] d2.utils.events INFO:  eta: 0:05:54  iter: 1419  total_loss: 0.08892  loss_cls: 0.03869  loss_box_reg: 0.02539  loss_rpn_cls: 0.005702  loss_rpn_loc: 0.01628  time: 0.6103  data_time: 0.0123  lr: 0.01  max_mem: 5386M
[11/16 14:07:36] d2.utils.events INFO:  eta: 0:05:42  iter: 1439  total_loss: 0.08854  loss_cls: 0.03953  loss_box_reg: 0.02634  loss_rpn_cls: 0.00545  loss_rpn_loc: 0.01779  time: 0.6104  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/16 14:07:48] d2.utils.events INFO:  eta: 0:05:29  iter: 1459  total_loss: 0.08555  loss_cls: 0.03898  loss_box_reg: 0.02582  loss_rpn_cls: 0.0049  loss_rpn_loc: 0.01399  time: 0.6103  data_time: 0.0145  lr: 0.01  max_mem: 5386M
[11/16 14:08:00] d2.utils.events INFO:  eta: 0:05:17  iter: 1479  total_loss: 0.08936  loss_cls: 0.03713  loss_box_reg: 0.02606  loss_rpn_cls: 0.006176  loss_rpn_loc: 0.01778  time: 0.6104  data_time: 0.0123  lr: 0.01  max_mem: 5386M
[11/16 14:08:12] d2.utils.events INFO:  eta: 0:05:05  iter: 1499  total_loss: 0.08251  loss_cls: 0.03768  loss_box_reg: 0.02513  loss_rpn_cls: 0.005328  loss_rpn_loc: 0.01566  time: 0.6104  data_time: 0.0122  lr: 0.01  max_mem: 5386M
[11/16 14:08:25] d2.utils.events INFO:  eta: 0:04:53  iter: 1519  total_loss: 0.08345  loss_cls: 0.03659  loss_box_reg: 0.02393  loss_rpn_cls: 0.005743  loss_rpn_loc: 0.01647  time: 0.6104  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/16 14:08:37] d2.utils.events INFO:  eta: 0:04:40  iter: 1539  total_loss: 0.08339  loss_cls: 0.03715  loss_box_reg: 0.02565  loss_rpn_cls: 0.005162  loss_rpn_loc: 0.01617  time: 0.6103  data_time: 0.0119  lr: 0.01  max_mem: 5386M
[11/16 14:08:49] d2.utils.events INFO:  eta: 0:04:28  iter: 1559  total_loss: 0.08464  loss_cls: 0.03703  loss_box_reg: 0.02519  loss_rpn_cls: 0.004306  loss_rpn_loc: 0.01622  time: 0.6103  data_time: 0.0118  lr: 0.01  max_mem: 5386M
[11/16 14:09:01] d2.utils.events INFO:  eta: 0:04:16  iter: 1579  total_loss: 0.08344  loss_cls: 0.03643  loss_box_reg: 0.02406  loss_rpn_cls: 0.00512  loss_rpn_loc: 0.01575  time: 0.6103  data_time: 0.0125  lr: 0.01  max_mem: 5386M
[11/16 14:09:13] d2.utils.events INFO:  eta: 0:04:04  iter: 1599  total_loss: 0.08064  loss_cls: 0.03705  loss_box_reg: 0.02516  loss_rpn_cls: 0.004572  loss_rpn_loc: 0.01638  time: 0.6102  data_time: 0.0131  lr: 0.01  max_mem: 5386M
[11/16 14:09:25] d2.utils.events INFO:  eta: 0:03:52  iter: 1619  total_loss: 0.08184  loss_cls: 0.03703  loss_box_reg: 0.02317  loss_rpn_cls: 0.005255  loss_rpn_loc: 0.01222  time: 0.6102  data_time: 0.0128  lr: 0.001  max_mem: 5386M
[11/16 14:09:38] d2.utils.events INFO:  eta: 0:03:39  iter: 1639  total_loss: 0.07598  loss_cls: 0.03526  loss_box_reg: 0.02328  loss_rpn_cls: 0.004874  loss_rpn_loc: 0.01257  time: 0.6102  data_time: 0.0117  lr: 0.001  max_mem: 5386M
[11/16 14:09:50] d2.utils.events INFO:  eta: 0:03:27  iter: 1659  total_loss: 0.07523  loss_cls: 0.03518  loss_box_reg: 0.0233  loss_rpn_cls: 0.004847  loss_rpn_loc: 0.01168  time: 0.6101  data_time: 0.0121  lr: 0.001  max_mem: 5386M
[11/16 14:10:02] d2.utils.events INFO:  eta: 0:03:15  iter: 1679  total_loss: 0.07489  loss_cls: 0.03616  loss_box_reg: 0.0232  loss_rpn_cls: 0.005105  loss_rpn_loc: 0.01066  time: 0.6100  data_time: 0.0125  lr: 0.001  max_mem: 5386M
[11/16 14:10:14] d2.utils.events INFO:  eta: 0:03:03  iter: 1699  total_loss: 0.07868  loss_cls: 0.03708  loss_box_reg: 0.023  loss_rpn_cls: 0.005313  loss_rpn_loc: 0.01058  time: 0.6100  data_time: 0.0119  lr: 0.001  max_mem: 5386M
[11/16 14:10:26] d2.utils.events INFO:  eta: 0:02:50  iter: 1719  total_loss: 0.07508  loss_cls: 0.03569  loss_box_reg: 0.02384  loss_rpn_cls: 0.004073  loss_rpn_loc: 0.009196  time: 0.6099  data_time: 0.0128  lr: 0.001  max_mem: 5386M
[11/16 14:10:38] d2.utils.events INFO:  eta: 0:02:38  iter: 1739  total_loss: 0.07635  loss_cls: 0.03638  loss_box_reg: 0.02281  loss_rpn_cls: 0.005058  loss_rpn_loc: 0.0121  time: 0.6100  data_time: 0.0121  lr: 0.001  max_mem: 5386M
[11/16 14:10:51] d2.utils.events INFO:  eta: 0:02:26  iter: 1759  total_loss: 0.07553  loss_cls: 0.03651  loss_box_reg: 0.02447  loss_rpn_cls: 0.004303  loss_rpn_loc: 0.00836  time: 0.6100  data_time: 0.0116  lr: 0.001  max_mem: 5386M
[11/16 14:11:03] d2.utils.events INFO:  eta: 0:02:14  iter: 1779  total_loss: 0.07316  loss_cls: 0.03658  loss_box_reg: 0.02346  loss_rpn_cls: 0.004661  loss_rpn_loc: 0.009066  time: 0.6099  data_time: 0.0126  lr: 0.001  max_mem: 5386M
[11/16 14:11:16] d2.utils.events INFO:  eta: 0:02:02  iter: 1799  total_loss: 0.07657  loss_cls: 0.03642  loss_box_reg: 0.02518  loss_rpn_cls: 0.004477  loss_rpn_loc: 0.01115  time: 0.6098  data_time: 0.0130  lr: 0.001  max_mem: 5386M
[11/16 14:11:28] d2.utils.events INFO:  eta: 0:01:49  iter: 1819  total_loss: 0.07632  loss_cls: 0.0363  loss_box_reg: 0.02329  loss_rpn_cls: 0.00475  loss_rpn_loc: 0.01092  time: 0.6099  data_time: 0.0127  lr: 0.001  max_mem: 5386M
[11/16 14:11:40] d2.utils.events INFO:  eta: 0:01:37  iter: 1839  total_loss: 0.07513  loss_cls: 0.0367  loss_box_reg: 0.02448  loss_rpn_cls: 0.004726  loss_rpn_loc: 0.01013  time: 0.6099  data_time: 0.0125  lr: 0.001  max_mem: 5386M
[11/16 14:11:53] d2.utils.events INFO:  eta: 0:01:25  iter: 1859  total_loss: 0.07479  loss_cls: 0.03486  loss_box_reg: 0.02313  loss_rpn_cls: 0.004624  loss_rpn_loc: 0.01129  time: 0.6100  data_time: 0.0119  lr: 0.001  max_mem: 5386M
[11/16 14:12:05] d2.utils.events INFO:  eta: 0:01:13  iter: 1879  total_loss: 0.07399  loss_cls: 0.03638  loss_box_reg: 0.02275  loss_rpn_cls: 0.004118  loss_rpn_loc: 0.01059  time: 0.6100  data_time: 0.0131  lr: 0.001  max_mem: 5386M
[11/16 14:12:17] d2.utils.events INFO:  eta: 0:01:00  iter: 1899  total_loss: 0.07657  loss_cls: 0.03527  loss_box_reg: 0.02311  loss_rpn_cls: 0.004194  loss_rpn_loc: 0.01  time: 0.6102  data_time: 0.0121  lr: 0.001  max_mem: 5386M
[11/16 14:12:30] d2.utils.events INFO:  eta: 0:00:48  iter: 1919  total_loss: 0.07812  loss_cls: 0.03661  loss_box_reg: 0.0232  loss_rpn_cls: 0.005067  loss_rpn_loc: 0.01197  time: 0.6102  data_time: 0.0118  lr: 0.001  max_mem: 5386M
[11/16 14:12:42] d2.utils.events INFO:  eta: 0:00:36  iter: 1939  total_loss: 0.07812  loss_cls: 0.03604  loss_box_reg: 0.02366  loss_rpn_cls: 0.0038  loss_rpn_loc: 0.009515  time: 0.6101  data_time: 0.0117  lr: 0.001  max_mem: 5386M
[11/16 14:12:54] d2.utils.events INFO:  eta: 0:00:24  iter: 1959  total_loss: 0.07623  loss_cls: 0.0361  loss_box_reg: 0.02419  loss_rpn_cls: 0.004527  loss_rpn_loc: 0.009659  time: 0.6100  data_time: 0.0124  lr: 0.001  max_mem: 5386M
[11/16 14:13:06] d2.utils.events INFO:  eta: 0:00:12  iter: 1979  total_loss: 0.07754  loss_cls: 0.03506  loss_box_reg: 0.02286  loss_rpn_cls: 0.005027  loss_rpn_loc: 0.01187  time: 0.6100  data_time: 0.0131  lr: 0.001  max_mem: 5386M
[11/16 14:13:18] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/model_final.pth
[11/16 14:13:20] d2.utils.events INFO:  eta: 0:00:00  iter: 1999  total_loss: 0.07414  loss_cls: 0.03599  loss_box_reg: 0.02384  loss_rpn_cls: 0.004763  loss_rpn_loc: 0.008806  time: 0.6099  data_time: 0.0136  lr: 0.001  max_mem: 5386M
[11/16 14:13:20] d2.engine.hooks INFO: Overall training speed: 1998 iterations in 0:20:18 (0.6100 s / it)
[11/16 14:13:20] d2.engine.hooks INFO: Total training time: 0:20:23 (0:00:04 on hooks)
[11/16 14:13:21] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 10538        |  bicycle   | 313          |     car      | 1641         |
|  motorcycle  | 388          |  airplane  | 131          |     bus      | 259          |
|    train     | 212          |    boat    | 458          |     bird     | 453          |
|     cat      | 195          |    dog     | 223          |    horse     | 305          |
|    sheep     | 306          |    cow     | 376          |    bottle    | 939          |
|    chair     | 1594         |   couch    | 236          | potted plant | 429          |
| dining table | 633          |     tv     | 257          |              |              |
|    total     | 19886        |            |              |              |              |[0m
[11/16 14:13:21] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 14:13:21] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/16 14:13:21] d2.data.common INFO: Serialized dataset takes 2.08 MiB
[11/16 14:13:22] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/16 14:13:22] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/16 14:13:23] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 14:13:23] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/16 14:13:23] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/16 14:13:27] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/16 14:13:40] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1230 s / img. ETA=0:02:27
[11/16 14:13:46] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1222 s / img. ETA=0:02:20
[11/16 14:13:52] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1223 s / img. ETA=0:02:14
[11/16 14:13:59] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1223 s / img. ETA=0:02:08
[11/16 14:14:05] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1227 s / img. ETA=0:02:02
[11/16 14:14:11] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1219 s / img. ETA=0:01:55
[11/16 14:14:17] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1218 s / img. ETA=0:01:49
[11/16 14:14:23] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1219 s / img. ETA=0:01:43
[11/16 14:14:29] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1219 s / img. ETA=0:01:37
[11/16 14:14:35] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1216 s / img. ETA=0:01:31
[11/16 14:14:41] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1216 s / img. ETA=0:01:25
[11/16 14:14:47] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1215 s / img. ETA=0:01:18
[11/16 14:14:53] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1216 s / img. ETA=0:01:12
[11/16 14:14:59] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1213 s / img. ETA=0:01:06
[11/16 14:15:05] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1215 s / img. ETA=0:01:00
[11/16 14:15:11] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1216 s / img. ETA=0:00:54
[11/16 14:15:17] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1216 s / img. ETA=0:00:48
[11/16 14:15:24] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1217 s / img. ETA=0:00:42
[11/16 14:15:30] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1215 s / img. ETA=0:00:36
[11/16 14:15:36] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1215 s / img. ETA=0:00:30
[11/16 14:15:42] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1215 s / img. ETA=0:00:24
[11/16 14:15:48] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1215 s / img. ETA=0:00:18
[11/16 14:15:54] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1215 s / img. ETA=0:00:12
[11/16 14:16:00] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1215 s / img. ETA=0:00:06
[11/16 14:16:06] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1214 s / img. ETA=0:00:00
[11/16 14:16:06] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:31 (0.121285 s / img per device, on 4 devices)
[11/16 14:16:06] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:28 (0.119321 s / img per device, on 4 devices)
[11/16 14:16:07] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/16 14:16:07] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/inference/coco_instances_results.json
[11/16 14:16:07] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/16 14:16:15] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 12.206 | 22.276 | 11.948 | 5.424 | 12.321 | 20.498 |
[11/16 14:16:15] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.862  | bicycle    | 3.476  | car          | 6.269  |
| motorcycle   | 12.206 | airplane   | 31.493 | bus          | 14.758 |
| train        | 21.324 | boat       | 4.785  | bird         | 11.203 |
| cat          | 10.549 | dog        | 10.261 | horse        | 24.538 |
| sheep        | 8.938  | cow        | 14.099 | bottle       | 11.779 |
| chair        | 1.674  | couch      | 19.961 | potted plant | 1.438  |
| dining table | 2.497  | tv         | 31.007 |              |        |
[11/16 14:16:15] defrcn.engine.defaults INFO: Evaluation results for coco14_test_novel in csv format:
[11/16 14:16:15] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/16 14:16:15] defrcn.evaluation.testing INFO: copypaste: nAP,nAP50,nAP75,nAPs,nAPm,nAPl,AP
[11/16 14:16:15] defrcn.evaluation.testing INFO: copypaste: 12.2059,22.2762,11.9476,5.4237,12.3214,20.4981,12.2059
[11/16 14:16:25] detectron2 INFO: Rank of current process: 0. World size: 4
[11/16 14:16:25] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_gfsod_r101_novel_3shot_seed7.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7', 'SEED', '53320773'], resume=False, start_iter=-1)
[11/16 14:16:25] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_gfsod_r101_novel_3shot_seed7.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 80
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_all_3shot_seed7", )
  TEST: ('coco14_test_all',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (3840,)
  MAX_ITER: 4800
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/16 14:16:26] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/config.yaml
[11/16 14:16:26] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/16 14:16:26] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/model_final-merge.pth ...
[11/16 14:16:28] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10538        |   bicycle    | 313          |      car      | 1641         |
|  motorcycle   | 388          |   airplane   | 131          |      bus      | 259          |
|     train     | 212          |    truck     | 352          |     boat      | 458          |
| traffic light | 516          | fire hydrant | 83           |   stop sign   | 84           |
| parking meter | 59           |    bench     | 471          |     bird      | 453          |
|      cat      | 195          |     dog      | 223          |     horse     | 305          |
|     sheep     | 306          |     cow      | 376          |   elephant    | 283          |
|     bear      | 53           |    zebra     | 275          |    giraffe    | 170          |
|   backpack    | 384          |   umbrella   | 387          |    handbag    | 483          |
|      tie      | 290          |   suitcase   | 309          |    frisbee    | 109          |
|     skis      | 281          |  snowboard   | 90           |  sports ball  | 233          |
|     kite      | 381          | baseball bat | 123          | baseball gl.. | 139          |
|  skateboard   | 215          |  surfboard   | 266          | tennis racket | 183          |
|    bottle     | 939          |  wine glass  | 363          |      cup      | 891          |
|     fork      | 234          |    knife     | 290          |     spoon     | 253          |
|     bowl      | 617          |    banana    | 359          |     apple     | 158          |
|   sandwich    | 158          |    orange    | 185          |   broccoli    | 330          |
|    carrot     | 341          |   hot dog    | 160          |     pizza     | 223          |
|     donut     | 225          |     cake     | 236          |     chair     | 1594         |
|     couch     | 236          | potted plant | 429          |      bed      | 195          |
| dining table  | 633          |    toilet    | 179          |      tv       | 257          |
|    laptop     | 236          |    mouse     | 95           |    remote     | 241          |
|   keyboard    | 117          |  cell phone  | 291          |   microwave   | 88           |
|     oven      | 142          |   toaster    | 11           |     sink      | 211          |
| refrigerator  | 107          |     book     | 1031         |     clock     | 290          |
|     vase      | 350          |   scissors   | 56           |  teddy bear   | 238          |
|  hair drier   | 11           |  toothbrush  | 77           |               |              |
|     total     | 35094        |              |              |               |              |[0m
[11/16 14:16:28] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 14:16:28] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/16 14:16:28] d2.data.common INFO: Serialized dataset takes 3.00 MiB
[11/16 14:16:28] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/16 14:16:28] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/16 14:16:33] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 3            |   bicycle    | 3            |      car      | 3            |
|  motorcycle   | 3            |   airplane   | 3            |      bus      | 3            |
|     train     | 3            |    truck     | 3            |     boat      | 3            |
| traffic light | 3            | fire hydrant | 3            |   stop sign   | 3            |
| parking meter | 3            |    bench     | 3            |     bird      | 3            |
|      cat      | 3            |     dog      | 3            |     horse     | 3            |
|     sheep     | 3            |     cow      | 3            |   elephant    | 3            |
|     bear      | 3            |    zebra     | 3            |    giraffe    | 3            |
|   backpack    | 3            |   umbrella   | 3            |    handbag    | 3            |
|      tie      | 3            |   suitcase   | 3            |    frisbee    | 3            |
|     skis      | 3            |  snowboard   | 3            |  sports ball  | 3            |
|     kite      | 3            | baseball bat | 3            | baseball gl.. | 3            |
|  skateboard   | 3            |  surfboard   | 3            | tennis racket | 3            |
|    bottle     | 3            |  wine glass  | 3            |      cup      | 3            |
|     fork      | 3            |    knife     | 3            |     spoon     | 3            |
|     bowl      | 3            |    banana    | 3            |     apple     | 3            |
|   sandwich    | 3            |    orange    | 3            |   broccoli    | 3            |
|    carrot     | 3            |   hot dog    | 3            |     pizza     | 3            |
|     donut     | 3            |     cake     | 3            |     chair     | 3            |
|     couch     | 3            | potted plant | 3            |      bed      | 3            |
| dining table  | 3            |    toilet    | 3            |      tv       | 3            |
|    laptop     | 3            |    mouse     | 3            |    remote     | 3            |
|   keyboard    | 3            |  cell phone  | 3            |   microwave   | 3            |
|     oven      | 3            |   toaster    | 3            |     sink      | 3            |
| refrigerator  | 3            |     book     | 3            |     clock     | 3            |
|     vase      | 3            |   scissors   | 3            |  teddy bear   | 3            |
|  hair drier   | 3            |  toothbrush  | 3            |               |              |
|     total     | 240          |              |              |               |              |[0m
[11/16 14:16:33] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 14:16:33] d2.data.common INFO: Serializing 240 elements to byte tensors and concatenating them all ...
[11/16 14:16:33] d2.data.common INFO: Serialized dataset takes 0.06 MiB
[11/16 14:16:50] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/16 14:17:03] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1228 s / img. ETA=0:02:27
[11/16 14:17:09] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1220 s / img. ETA=0:02:20
[11/16 14:17:16] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1236 s / img. ETA=0:02:15
[11/16 14:17:22] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1231 s / img. ETA=0:02:09
[11/16 14:17:28] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1233 s / img. ETA=0:02:03
[11/16 14:17:34] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1223 s / img. ETA=0:01:56
[11/16 14:17:40] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1221 s / img. ETA=0:01:49
[11/16 14:17:46] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1221 s / img. ETA=0:01:43
[11/16 14:17:52] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1221 s / img. ETA=0:01:37
[11/16 14:17:58] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1218 s / img. ETA=0:01:31
[11/16 14:18:04] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1219 s / img. ETA=0:01:25
[11/16 14:18:10] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1218 s / img. ETA=0:01:19
[11/16 14:18:16] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1217 s / img. ETA=0:01:13
[11/16 14:18:22] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1215 s / img. ETA=0:01:06
[11/16 14:18:28] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1216 s / img. ETA=0:01:00
[11/16 14:18:34] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1217 s / img. ETA=0:00:54
[11/16 14:18:40] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1217 s / img. ETA=0:00:48
[11/16 14:18:47] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1218 s / img. ETA=0:00:42
[11/16 14:18:53] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1218 s / img. ETA=0:00:36
[11/16 14:18:59] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1218 s / img. ETA=0:00:30
[11/16 14:19:05] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1218 s / img. ETA=0:00:24
[11/16 14:19:11] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1218 s / img. ETA=0:00:18
[11/16 14:19:17] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1218 s / img. ETA=0:00:12
[11/16 14:19:23] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1217 s / img. ETA=0:00:06
[11/16 14:19:29] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1216 s / img. ETA=0:00:00
[11/16 14:19:29] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:31 (0.121285 s / img per device, on 4 devices)
[11/16 14:19:29] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:28 (0.119403 s / img per device, on 4 devices)
[11/16 14:19:34] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/16 14:19:35] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed7/inference/coco_instances_results.json
[11/16 14:19:35] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/16 14:19:57] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 30.712 | 47.794 | 32.685 | 14.425 | 34.603 | 44.850 |
[11/16 14:19:57] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category      | AP     | category     | AP     | category       | AP     |
|:--------------|:-------|:-------------|:-------|:---------------|:-------|
| person        | 1.965  | bicycle      | 3.506  | car            | 6.028  |
| motorcycle    | 12.560 | airplane     | 30.694 | bus            | 28.362 |
| train         | 21.062 | truck        | 30.834 | boat           | 6.739  |
| traffic light | 24.452 | fire hydrant | 64.940 | stop sign      | 69.616 |
| parking meter | 36.785 | bench        | 17.921 | bird           | 11.004 |
| cat           | 10.632 | dog          | 12.645 | horse          | 24.845 |
| sheep         | 11.771 | cow          | 16.530 | elephant       | 65.497 |
| bear          | 60.117 | zebra        | 58.788 | giraffe        | 68.231 |
| backpack      | 17.634 | umbrella     | 29.913 | handbag        | 14.794 |
| tie           | 32.240 | suitcase     | 29.497 | frisbee        | 55.477 |
| skis          | 21.630 | snowboard    | 30.783 | sports ball    | 38.244 |
| kite          | 38.056 | baseball bat | 25.582 | baseball glove | 29.427 |
| skateboard    | 45.632 | surfboard    | 38.700 | tennis racket  | 48.337 |
| bottle        | 11.750 | wine glass   | 29.569 | cup            | 36.424 |
| fork          | 34.155 | knife        | 16.062 | spoon          | 15.131 |
| bowl          | 35.505 | banana       | 24.715 | apple          | 20.288 |
| sandwich      | 34.087 | orange       | 22.893 | broccoli       | 25.058 |
| carrot        | 22.773 | hot dog      | 32.485 | pizza          | 49.796 |
| donut         | 50.195 | cake         | 39.406 | chair          | 1.752  |
| couch         | 19.833 | potted plant | 1.530  | bed            | 41.511 |
| dining table  | 2.826  | toilet       | 55.028 | tv             | 35.922 |
| laptop        | 56.316 | mouse        | 47.111 | remote         | 28.845 |
| keyboard      | 52.629 | cell phone   | 24.908 | microwave      | 53.591 |
| oven          | 36.453 | toaster      | 29.335 | sink           | 32.953 |
| refrigerator  | 54.371 | book         | 8.172  | clock          | 46.775 |
| vase          | 32.864 | scissors     | 24.619 | teddy bear     | 38.989 |
| hair drier    | 17.313 | toothbrush   | 21.588 |                |        |
[11/16 14:20:13] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 36.417 | 55.569 | 39.091 | 17.607 | 41.659 | 52.253 |
[11/16 14:20:13] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category       | AP     | category      | AP     | category     | AP     |
|:---------------|:-------|:--------------|:-------|:-------------|:-------|
| truck          | 30.834 | traffic light | 24.452 | fire hydrant | 64.940 |
| stop sign      | 69.616 | parking meter | 36.785 | bench        | 17.921 |
| elephant       | 65.497 | bear          | 60.117 | zebra        | 58.788 |
| giraffe        | 68.231 | backpack      | 17.634 | umbrella     | 29.913 |
| handbag        | 14.794 | tie           | 32.240 | suitcase     | 29.497 |
| frisbee        | 55.477 | skis          | 21.630 | snowboard    | 30.783 |
| sports ball    | 38.244 | kite          | 38.056 | baseball bat | 25.582 |
| baseball glove | 29.427 | skateboard    | 45.632 | surfboard    | 38.700 |
| tennis racket  | 48.337 | wine glass    | 29.569 | cup          | 36.424 |
| fork           | 34.155 | knife         | 16.062 | spoon        | 15.131 |
| bowl           | 35.505 | banana        | 24.715 | apple        | 20.288 |
| sandwich       | 34.087 | orange        | 22.893 | broccoli     | 25.058 |
| carrot         | 22.773 | hot dog       | 32.485 | pizza        | 49.796 |
| donut          | 50.195 | cake          | 39.406 | bed          | 41.511 |
| toilet         | 55.028 | laptop        | 56.316 | mouse        | 47.111 |
| remote         | 28.845 | keyboard      | 52.629 | cell phone   | 24.908 |
| microwave      | 53.591 | oven          | 36.453 | toaster      | 29.335 |
| sink           | 32.953 | refrigerator  | 54.371 | book         | 8.172  |
| clock          | 46.775 | vase          | 32.864 | scissors     | 24.619 |
| teddy bear     | 38.989 | hair drier    | 17.313 | toothbrush   | 21.588 |
[11/16 14:20:19] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 13.598 | 24.470 | 13.469 | 5.038 | 13.435 | 22.641 |
[11/16 14:20:19] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 1.965  | bicycle    | 3.506  | car          | 6.028  |
| motorcycle   | 12.560 | airplane   | 30.694 | bus          | 28.362 |
| train        | 21.062 | boat       | 6.739  | bird         | 11.004 |
| cat          | 10.632 | dog        | 12.645 | horse        | 24.845 |
| sheep        | 11.771 | cow        | 16.530 | bottle       | 11.750 |
| chair        | 1.752  | couch      | 19.833 | potted plant | 1.530  |
| dining table | 2.826  | tv         | 35.922 |              |        |
[11/16 14:20:19] defrcn.engine.defaults INFO: Evaluation results for coco14_test_all in csv format:
[11/16 14:20:19] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/16 14:20:19] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,APs,APm,APl,bAP,bAP50,bAP75,bAPs,bAPm,bAPl,nAP,nAP50,nAP75,nAPs,nAPm,nAPl
[11/16 14:20:19] defrcn.evaluation.testing INFO: copypaste: 30.7124,47.7942,32.6852,14.4251,34.6028,44.8503,36.4173,55.5691,39.0907,17.6073,41.6587,52.2534,13.5977,24.4696,13.4687,5.0378,13.4349,22.6411
