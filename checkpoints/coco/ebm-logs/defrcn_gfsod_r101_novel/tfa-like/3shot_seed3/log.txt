[11/16 01:47:24] detectron2 INFO: Rank of current process: 0. World size: 4
[11/16 01:47:24] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_fsod_r101_novel_3shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=False, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth'], resume=False, start_iter=-1)
[11/16 01:47:24] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_fsod_r101_novel_3shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 20
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_novel_3shot_seed3", )
  TEST: ('coco14_test_novel',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (1600,)
  MAX_ITER: 2000
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/16 01:47:24] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/config.yaml
[11/16 01:47:24] d2.utils.env INFO: Using a generated random seed 26180421
[11/16 01:47:24] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/16 01:47:25] defrcn.dataloader.build INFO: Removed 0 images with no usable annotations. 60 images left.
[11/16 01:47:25] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 3            |  bicycle   | 3            |     car      | 3            |
|  motorcycle  | 3            |  airplane  | 3            |     bus      | 3            |
|    train     | 3            |    boat    | 3            |     bird     | 3            |
|     cat      | 3            |    dog     | 3            |    horse     | 3            |
|    sheep     | 3            |    cow     | 3            |    bottle    | 3            |
|    chair     | 3            |   couch    | 3            | potted plant | 3            |
| dining table | 3            |     tv     | 3            |              |              |
|    total     | 60           |            |              |              |              |[0m
[11/16 01:47:25] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style='choice'), RandomFlip()]
[11/16 01:47:25] defrcn.dataloader.build INFO: Using training sampler TrainingSampler
[11/16 01:47:25] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/16 01:47:25] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/16 01:47:25] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_det_r101_base/model_final-init.pth ...
[11/16 01:47:25] d2.engine.train_loop INFO: Starting training from iteration 0
[11/16 01:47:40] d2.utils.events INFO:  eta: 0:18:55  iter: 19  total_loss: 0.728  loss_cls: 0.4681  loss_box_reg: 0.124  loss_rpn_cls: 0.1026  loss_rpn_loc: 0.05848  time: 0.5729  data_time: 0.1682  lr: 0.01  max_mem: 5291M
[11/16 01:47:52] d2.utils.events INFO:  eta: 0:18:45  iter: 39  total_loss: 0.7037  loss_cls: 0.4642  loss_box_reg: 0.1339  loss_rpn_cls: 0.06726  loss_rpn_loc: 0.04493  time: 0.5747  data_time: 0.0171  lr: 0.01  max_mem: 5386M
[11/16 01:48:03] d2.utils.events INFO:  eta: 0:18:39  iter: 59  total_loss: 0.4452  loss_cls: 0.2074  loss_box_reg: 0.1279  loss_rpn_cls: 0.05476  loss_rpn_loc: 0.03953  time: 0.5770  data_time: 0.0155  lr: 0.01  max_mem: 5386M
[11/16 01:48:15] d2.utils.events INFO:  eta: 0:18:27  iter: 79  total_loss: 0.3838  loss_cls: 0.1771  loss_box_reg: 0.126  loss_rpn_cls: 0.04768  loss_rpn_loc: 0.03638  time: 0.5782  data_time: 0.0153  lr: 0.01  max_mem: 5386M
[11/16 01:48:27] d2.utils.events INFO:  eta: 0:18:19  iter: 99  total_loss: 0.3829  loss_cls: 0.1655  loss_box_reg: 0.1307  loss_rpn_cls: 0.04819  loss_rpn_loc: 0.03321  time: 0.5789  data_time: 0.0197  lr: 0.01  max_mem: 5386M
[11/16 01:48:38] d2.utils.events INFO:  eta: 0:18:08  iter: 119  total_loss: 0.3556  loss_cls: 0.1511  loss_box_reg: 0.1255  loss_rpn_cls: 0.04029  loss_rpn_loc: 0.03653  time: 0.5788  data_time: 0.0166  lr: 0.01  max_mem: 5386M
[11/16 01:48:50] d2.utils.events INFO:  eta: 0:17:56  iter: 139  total_loss: 0.3406  loss_cls: 0.141  loss_box_reg: 0.1214  loss_rpn_cls: 0.03531  loss_rpn_loc: 0.02986  time: 0.5789  data_time: 0.0194  lr: 0.01  max_mem: 5386M
[11/16 01:49:01] d2.utils.events INFO:  eta: 0:17:48  iter: 159  total_loss: 0.3141  loss_cls: 0.1369  loss_box_reg: 0.1221  loss_rpn_cls: 0.03254  loss_rpn_loc: 0.02908  time: 0.5798  data_time: 0.0172  lr: 0.01  max_mem: 5386M
[11/16 01:49:13] d2.utils.events INFO:  eta: 0:17:36  iter: 179  total_loss: 0.312  loss_cls: 0.131  loss_box_reg: 0.1206  loss_rpn_cls: 0.02904  loss_rpn_loc: 0.02724  time: 0.5802  data_time: 0.0183  lr: 0.01  max_mem: 5386M
[11/16 01:49:25] d2.utils.events INFO:  eta: 0:17:25  iter: 199  total_loss: 0.2949  loss_cls: 0.1254  loss_box_reg: 0.1221  loss_rpn_cls: 0.02715  loss_rpn_loc: 0.02815  time: 0.5802  data_time: 0.0170  lr: 0.01  max_mem: 5386M
[11/16 01:49:37] d2.utils.events INFO:  eta: 0:17:15  iter: 219  total_loss: 0.2857  loss_cls: 0.1184  loss_box_reg: 0.1124  loss_rpn_cls: 0.02584  loss_rpn_loc: 0.02864  time: 0.5825  data_time: 0.0190  lr: 0.01  max_mem: 5386M
[11/16 01:49:49] d2.utils.events INFO:  eta: 0:17:04  iter: 239  total_loss: 0.2783  loss_cls: 0.1149  loss_box_reg: 0.1152  loss_rpn_cls: 0.02153  loss_rpn_loc: 0.02832  time: 0.5828  data_time: 0.0169  lr: 0.01  max_mem: 5386M
[11/16 01:50:00] d2.utils.events INFO:  eta: 0:16:52  iter: 259  total_loss: 0.2692  loss_cls: 0.1096  loss_box_reg: 0.1071  loss_rpn_cls: 0.02145  loss_rpn_loc: 0.02942  time: 0.5824  data_time: 0.0180  lr: 0.01  max_mem: 5386M
[11/16 01:50:12] d2.utils.events INFO:  eta: 0:16:41  iter: 279  total_loss: 0.2639  loss_cls: 0.1046  loss_box_reg: 0.1073  loss_rpn_cls: 0.02061  loss_rpn_loc: 0.0292  time: 0.5824  data_time: 0.0183  lr: 0.01  max_mem: 5386M
[11/16 01:50:24] d2.utils.events INFO:  eta: 0:16:28  iter: 299  total_loss: 0.2611  loss_cls: 0.1036  loss_box_reg: 0.1083  loss_rpn_cls: 0.02041  loss_rpn_loc: 0.02666  time: 0.5823  data_time: 0.0176  lr: 0.01  max_mem: 5386M
[11/16 01:50:35] d2.utils.events INFO:  eta: 0:16:18  iter: 319  total_loss: 0.249  loss_cls: 0.09654  loss_box_reg: 0.1014  loss_rpn_cls: 0.01946  loss_rpn_loc: 0.02762  time: 0.5825  data_time: 0.0198  lr: 0.01  max_mem: 5386M
[11/16 01:50:47] d2.utils.events INFO:  eta: 0:16:07  iter: 339  total_loss: 0.2408  loss_cls: 0.09492  loss_box_reg: 0.09891  loss_rpn_cls: 0.01799  loss_rpn_loc: 0.02381  time: 0.5829  data_time: 0.0182  lr: 0.01  max_mem: 5386M
[11/16 01:50:59] d2.utils.events INFO:  eta: 0:15:56  iter: 359  total_loss: 0.2311  loss_cls: 0.09094  loss_box_reg: 0.09691  loss_rpn_cls: 0.01519  loss_rpn_loc: 0.02713  time: 0.5829  data_time: 0.0175  lr: 0.01  max_mem: 5386M
[11/16 01:51:10] d2.utils.events INFO:  eta: 0:15:44  iter: 379  total_loss: 0.22  loss_cls: 0.09058  loss_box_reg: 0.09091  loss_rpn_cls: 0.01598  loss_rpn_loc: 0.02619  time: 0.5828  data_time: 0.0187  lr: 0.01  max_mem: 5386M
[11/16 01:51:22] d2.utils.events INFO:  eta: 0:15:32  iter: 399  total_loss: 0.2155  loss_cls: 0.08685  loss_box_reg: 0.09074  loss_rpn_cls: 0.01594  loss_rpn_loc: 0.02367  time: 0.5826  data_time: 0.0217  lr: 0.01  max_mem: 5386M
[11/16 01:51:34] d2.utils.events INFO:  eta: 0:15:20  iter: 419  total_loss: 0.2109  loss_cls: 0.08421  loss_box_reg: 0.08419  loss_rpn_cls: 0.01623  loss_rpn_loc: 0.02275  time: 0.5825  data_time: 0.0151  lr: 0.01  max_mem: 5386M
[11/16 01:51:45] d2.utils.events INFO:  eta: 0:15:09  iter: 439  total_loss: 0.2003  loss_cls: 0.0829  loss_box_reg: 0.08461  loss_rpn_cls: 0.01421  loss_rpn_loc: 0.02296  time: 0.5825  data_time: 0.0180  lr: 0.01  max_mem: 5386M
[11/16 01:51:57] d2.utils.events INFO:  eta: 0:14:57  iter: 459  total_loss: 0.1903  loss_cls: 0.08013  loss_box_reg: 0.07685  loss_rpn_cls: 0.01335  loss_rpn_loc: 0.02263  time: 0.5824  data_time: 0.0171  lr: 0.01  max_mem: 5386M
[11/16 01:52:09] d2.utils.events INFO:  eta: 0:14:45  iter: 479  total_loss: 0.1902  loss_cls: 0.07653  loss_box_reg: 0.07822  loss_rpn_cls: 0.01241  loss_rpn_loc: 0.02035  time: 0.5826  data_time: 0.0165  lr: 0.01  max_mem: 5386M
[11/16 01:52:20] d2.utils.events INFO:  eta: 0:14:34  iter: 499  total_loss: 0.1836  loss_cls: 0.07647  loss_box_reg: 0.07402  loss_rpn_cls: 0.01214  loss_rpn_loc: 0.02351  time: 0.5827  data_time: 0.0173  lr: 0.01  max_mem: 5386M
[11/16 01:52:32] d2.utils.events INFO:  eta: 0:14:22  iter: 519  total_loss: 0.1834  loss_cls: 0.07325  loss_box_reg: 0.06762  loss_rpn_cls: 0.0123  loss_rpn_loc: 0.02463  time: 0.5828  data_time: 0.0192  lr: 0.01  max_mem: 5386M
[11/16 01:52:44] d2.utils.events INFO:  eta: 0:14:10  iter: 539  total_loss: 0.1814  loss_cls: 0.07263  loss_box_reg: 0.06887  loss_rpn_cls: 0.01253  loss_rpn_loc: 0.02117  time: 0.5827  data_time: 0.0198  lr: 0.01  max_mem: 5386M
[11/16 01:52:55] d2.utils.events INFO:  eta: 0:13:59  iter: 559  total_loss: 0.1731  loss_cls: 0.07112  loss_box_reg: 0.06685  loss_rpn_cls: 0.0107  loss_rpn_loc: 0.01983  time: 0.5827  data_time: 0.0174  lr: 0.01  max_mem: 5386M
[11/16 01:53:07] d2.utils.events INFO:  eta: 0:13:47  iter: 579  total_loss: 0.162  loss_cls: 0.06879  loss_box_reg: 0.06172  loss_rpn_cls: 0.01074  loss_rpn_loc: 0.02067  time: 0.5827  data_time: 0.0164  lr: 0.01  max_mem: 5386M
[11/16 01:53:19] d2.utils.events INFO:  eta: 0:13:35  iter: 599  total_loss: 0.1674  loss_cls: 0.06798  loss_box_reg: 0.0605  loss_rpn_cls: 0.01096  loss_rpn_loc: 0.02327  time: 0.5827  data_time: 0.0185  lr: 0.01  max_mem: 5386M
[11/16 01:53:31] d2.utils.events INFO:  eta: 0:13:24  iter: 619  total_loss: 0.1647  loss_cls: 0.0677  loss_box_reg: 0.05977  loss_rpn_cls: 0.009741  loss_rpn_loc: 0.02422  time: 0.5829  data_time: 0.0168  lr: 0.01  max_mem: 5386M
[11/16 01:53:42] d2.utils.events INFO:  eta: 0:13:12  iter: 639  total_loss: 0.1589  loss_cls: 0.06842  loss_box_reg: 0.05643  loss_rpn_cls: 0.009805  loss_rpn_loc: 0.02439  time: 0.5829  data_time: 0.0222  lr: 0.01  max_mem: 5386M
[11/16 01:53:54] d2.utils.events INFO:  eta: 0:13:00  iter: 659  total_loss: 0.1539  loss_cls: 0.06482  loss_box_reg: 0.05616  loss_rpn_cls: 0.01072  loss_rpn_loc: 0.02637  time: 0.5828  data_time: 0.0161  lr: 0.01  max_mem: 5386M
[11/16 01:54:06] d2.utils.events INFO:  eta: 0:12:49  iter: 679  total_loss: 0.146  loss_cls: 0.06325  loss_box_reg: 0.05149  loss_rpn_cls: 0.009773  loss_rpn_loc: 0.02314  time: 0.5829  data_time: 0.0211  lr: 0.01  max_mem: 5386M
[11/16 01:54:17] d2.utils.events INFO:  eta: 0:12:37  iter: 699  total_loss: 0.1428  loss_cls: 0.06136  loss_box_reg: 0.05144  loss_rpn_cls: 0.009213  loss_rpn_loc: 0.02015  time: 0.5827  data_time: 0.0191  lr: 0.01  max_mem: 5386M
[11/16 01:54:29] d2.utils.events INFO:  eta: 0:12:25  iter: 719  total_loss: 0.1427  loss_cls: 0.06077  loss_box_reg: 0.04823  loss_rpn_cls: 0.0093  loss_rpn_loc: 0.0231  time: 0.5826  data_time: 0.0189  lr: 0.01  max_mem: 5386M
[11/16 01:54:40] d2.utils.events INFO:  eta: 0:12:14  iter: 739  total_loss: 0.1378  loss_cls: 0.05969  loss_box_reg: 0.04863  loss_rpn_cls: 0.008372  loss_rpn_loc: 0.01971  time: 0.5826  data_time: 0.0178  lr: 0.01  max_mem: 5386M
[11/16 01:54:52] d2.utils.events INFO:  eta: 0:12:02  iter: 759  total_loss: 0.1327  loss_cls: 0.05687  loss_box_reg: 0.04756  loss_rpn_cls: 0.008651  loss_rpn_loc: 0.02196  time: 0.5826  data_time: 0.0184  lr: 0.01  max_mem: 5386M
[11/16 01:55:04] d2.utils.events INFO:  eta: 0:11:50  iter: 779  total_loss: 0.1362  loss_cls: 0.05758  loss_box_reg: 0.04573  loss_rpn_cls: 0.008884  loss_rpn_loc: 0.02221  time: 0.5825  data_time: 0.0166  lr: 0.01  max_mem: 5386M
[11/16 01:55:15] d2.utils.events INFO:  eta: 0:11:38  iter: 799  total_loss: 0.1305  loss_cls: 0.05735  loss_box_reg: 0.04398  loss_rpn_cls: 0.008146  loss_rpn_loc: 0.01934  time: 0.5823  data_time: 0.0154  lr: 0.01  max_mem: 5386M
[11/16 01:55:27] d2.utils.events INFO:  eta: 0:11:26  iter: 819  total_loss: 0.1285  loss_cls: 0.05651  loss_box_reg: 0.04469  loss_rpn_cls: 0.008041  loss_rpn_loc: 0.0211  time: 0.5821  data_time: 0.0158  lr: 0.01  max_mem: 5386M
[11/16 01:55:38] d2.utils.events INFO:  eta: 0:11:14  iter: 839  total_loss: 0.1311  loss_cls: 0.05587  loss_box_reg: 0.04376  loss_rpn_cls: 0.008181  loss_rpn_loc: 0.02294  time: 0.5820  data_time: 0.0174  lr: 0.01  max_mem: 5386M
[11/16 01:55:50] d2.utils.events INFO:  eta: 0:11:03  iter: 859  total_loss: 0.1285  loss_cls: 0.05463  loss_box_reg: 0.04193  loss_rpn_cls: 0.007127  loss_rpn_loc: 0.02578  time: 0.5822  data_time: 0.0187  lr: 0.01  max_mem: 5386M
[11/16 01:56:02] d2.utils.events INFO:  eta: 0:10:51  iter: 879  total_loss: 0.1219  loss_cls: 0.05171  loss_box_reg: 0.03935  loss_rpn_cls: 0.008062  loss_rpn_loc: 0.02333  time: 0.5822  data_time: 0.0183  lr: 0.01  max_mem: 5386M
[11/16 01:56:13] d2.utils.events INFO:  eta: 0:10:40  iter: 899  total_loss: 0.1158  loss_cls: 0.05351  loss_box_reg: 0.04031  loss_rpn_cls: 0.007911  loss_rpn_loc: 0.01797  time: 0.5822  data_time: 0.0165  lr: 0.01  max_mem: 5386M
[11/16 01:56:25] d2.utils.events INFO:  eta: 0:10:28  iter: 919  total_loss: 0.1133  loss_cls: 0.05176  loss_box_reg: 0.03754  loss_rpn_cls: 0.007825  loss_rpn_loc: 0.01621  time: 0.5822  data_time: 0.0161  lr: 0.01  max_mem: 5386M
[11/16 01:56:37] d2.utils.events INFO:  eta: 0:10:16  iter: 939  total_loss: 0.1145  loss_cls: 0.05058  loss_box_reg: 0.03893  loss_rpn_cls: 0.0069  loss_rpn_loc: 0.01887  time: 0.5822  data_time: 0.0220  lr: 0.01  max_mem: 5386M
[11/16 01:56:49] d2.utils.events INFO:  eta: 0:10:05  iter: 959  total_loss: 0.1091  loss_cls: 0.04946  loss_box_reg: 0.03691  loss_rpn_cls: 0.006906  loss_rpn_loc: 0.01807  time: 0.5820  data_time: 0.0155  lr: 0.01  max_mem: 5386M
[11/16 01:57:00] d2.utils.events INFO:  eta: 0:09:53  iter: 979  total_loss: 0.1137  loss_cls: 0.04986  loss_box_reg: 0.03843  loss_rpn_cls: 0.006403  loss_rpn_loc: 0.01705  time: 0.5820  data_time: 0.0183  lr: 0.01  max_mem: 5386M
[11/16 01:57:12] d2.utils.events INFO:  eta: 0:09:42  iter: 999  total_loss: 0.1094  loss_cls: 0.04993  loss_box_reg: 0.03643  loss_rpn_cls: 0.007291  loss_rpn_loc: 0.01942  time: 0.5820  data_time: 0.0180  lr: 0.01  max_mem: 5386M
[11/16 01:57:23] d2.utils.events INFO:  eta: 0:09:30  iter: 1019  total_loss: 0.107  loss_cls: 0.04873  loss_box_reg: 0.03548  loss_rpn_cls: 0.006197  loss_rpn_loc: 0.01969  time: 0.5819  data_time: 0.0157  lr: 0.01  max_mem: 5386M
[11/16 01:57:35] d2.utils.events INFO:  eta: 0:09:19  iter: 1039  total_loss: 0.1074  loss_cls: 0.04976  loss_box_reg: 0.03563  loss_rpn_cls: 0.006663  loss_rpn_loc: 0.02133  time: 0.5818  data_time: 0.0173  lr: 0.01  max_mem: 5386M
[11/16 01:57:47] d2.utils.events INFO:  eta: 0:09:07  iter: 1059  total_loss: 0.1104  loss_cls: 0.04814  loss_box_reg: 0.03579  loss_rpn_cls: 0.00686  loss_rpn_loc: 0.02144  time: 0.5818  data_time: 0.0173  lr: 0.01  max_mem: 5386M
[11/16 01:57:58] d2.utils.events INFO:  eta: 0:08:55  iter: 1079  total_loss: 0.1019  loss_cls: 0.04586  loss_box_reg: 0.03532  loss_rpn_cls: 0.005791  loss_rpn_loc: 0.01808  time: 0.5817  data_time: 0.0175  lr: 0.01  max_mem: 5386M
[11/16 01:58:10] d2.utils.events INFO:  eta: 0:08:43  iter: 1099  total_loss: 0.1062  loss_cls: 0.04737  loss_box_reg: 0.03424  loss_rpn_cls: 0.006506  loss_rpn_loc: 0.01852  time: 0.5816  data_time: 0.0189  lr: 0.01  max_mem: 5386M
[11/16 01:58:21] d2.utils.events INFO:  eta: 0:08:31  iter: 1119  total_loss: 0.1021  loss_cls: 0.04568  loss_box_reg: 0.03429  loss_rpn_cls: 0.0058  loss_rpn_loc: 0.01807  time: 0.5816  data_time: 0.0178  lr: 0.01  max_mem: 5386M
[11/16 01:58:33] d2.utils.events INFO:  eta: 0:08:20  iter: 1139  total_loss: 0.1031  loss_cls: 0.04587  loss_box_reg: 0.0331  loss_rpn_cls: 0.006035  loss_rpn_loc: 0.01642  time: 0.5816  data_time: 0.0173  lr: 0.01  max_mem: 5386M
[11/16 01:58:45] d2.utils.events INFO:  eta: 0:08:08  iter: 1159  total_loss: 0.1038  loss_cls: 0.04543  loss_box_reg: 0.03307  loss_rpn_cls: 0.005236  loss_rpn_loc: 0.01751  time: 0.5815  data_time: 0.0187  lr: 0.01  max_mem: 5386M
[11/16 01:58:56] d2.utils.events INFO:  eta: 0:07:56  iter: 1179  total_loss: 0.09729  loss_cls: 0.04473  loss_box_reg: 0.03294  loss_rpn_cls: 0.005307  loss_rpn_loc: 0.01604  time: 0.5814  data_time: 0.0165  lr: 0.01  max_mem: 5386M
[11/16 01:59:08] d2.utils.events INFO:  eta: 0:07:45  iter: 1199  total_loss: 0.09891  loss_cls: 0.04274  loss_box_reg: 0.032  loss_rpn_cls: 0.005187  loss_rpn_loc: 0.01777  time: 0.5812  data_time: 0.0178  lr: 0.01  max_mem: 5386M
[11/16 01:59:20] d2.utils.events INFO:  eta: 0:07:33  iter: 1219  total_loss: 0.09623  loss_cls: 0.04234  loss_box_reg: 0.03048  loss_rpn_cls: 0.005715  loss_rpn_loc: 0.01997  time: 0.5811  data_time: 0.0154  lr: 0.01  max_mem: 5386M
[11/16 01:59:33] d2.utils.events INFO:  eta: 0:07:21  iter: 1239  total_loss: 0.1019  loss_cls: 0.04304  loss_box_reg: 0.03162  loss_rpn_cls: 0.005757  loss_rpn_loc: 0.01941  time: 0.5809  data_time: 0.0159  lr: 0.01  max_mem: 5386M
[11/16 01:59:44] d2.utils.events INFO:  eta: 0:07:10  iter: 1259  total_loss: 0.09977  loss_cls: 0.04373  loss_box_reg: 0.03086  loss_rpn_cls: 0.005758  loss_rpn_loc: 0.0168  time: 0.5810  data_time: 0.0198  lr: 0.01  max_mem: 5386M
[11/16 01:59:56] d2.utils.events INFO:  eta: 0:06:58  iter: 1279  total_loss: 0.09404  loss_cls: 0.04203  loss_box_reg: 0.03044  loss_rpn_cls: 0.005223  loss_rpn_loc: 0.01792  time: 0.5810  data_time: 0.0138  lr: 0.01  max_mem: 5386M
[11/16 02:00:08] d2.utils.events INFO:  eta: 0:06:46  iter: 1299  total_loss: 0.09599  loss_cls: 0.04336  loss_box_reg: 0.03156  loss_rpn_cls: 0.005228  loss_rpn_loc: 0.01722  time: 0.5810  data_time: 0.0168  lr: 0.01  max_mem: 5386M
[11/16 02:00:19] d2.utils.events INFO:  eta: 0:06:34  iter: 1319  total_loss: 0.09558  loss_cls: 0.04152  loss_box_reg: 0.03051  loss_rpn_cls: 0.00546  loss_rpn_loc: 0.01842  time: 0.5811  data_time: 0.0180  lr: 0.01  max_mem: 5386M
[11/16 02:00:31] d2.utils.events INFO:  eta: 0:06:23  iter: 1339  total_loss: 0.09079  loss_cls: 0.03926  loss_box_reg: 0.0285  loss_rpn_cls: 0.004949  loss_rpn_loc: 0.01553  time: 0.5811  data_time: 0.0162  lr: 0.01  max_mem: 5386M
[11/16 02:00:43] d2.utils.events INFO:  eta: 0:06:11  iter: 1359  total_loss: 0.09168  loss_cls: 0.04173  loss_box_reg: 0.0299  loss_rpn_cls: 0.005183  loss_rpn_loc: 0.01527  time: 0.5811  data_time: 0.0192  lr: 0.01  max_mem: 5386M
[11/16 02:00:54] d2.utils.events INFO:  eta: 0:05:59  iter: 1379  total_loss: 0.09434  loss_cls: 0.04122  loss_box_reg: 0.03024  loss_rpn_cls: 0.005387  loss_rpn_loc: 0.01392  time: 0.5810  data_time: 0.0160  lr: 0.01  max_mem: 5386M
[11/16 02:01:06] d2.utils.events INFO:  eta: 0:05:48  iter: 1399  total_loss: 0.08664  loss_cls: 0.03983  loss_box_reg: 0.02782  loss_rpn_cls: 0.005168  loss_rpn_loc: 0.0141  time: 0.5810  data_time: 0.0180  lr: 0.01  max_mem: 5386M
[11/16 02:01:17] d2.utils.events INFO:  eta: 0:05:36  iter: 1419  total_loss: 0.09103  loss_cls: 0.04105  loss_box_reg: 0.02997  loss_rpn_cls: 0.004545  loss_rpn_loc: 0.01605  time: 0.5810  data_time: 0.0162  lr: 0.01  max_mem: 5386M
[11/16 02:01:29] d2.utils.events INFO:  eta: 0:05:25  iter: 1439  total_loss: 0.09016  loss_cls: 0.03973  loss_box_reg: 0.02887  loss_rpn_cls: 0.004894  loss_rpn_loc: 0.01521  time: 0.5809  data_time: 0.0198  lr: 0.01  max_mem: 5386M
[11/16 02:01:41] d2.utils.events INFO:  eta: 0:05:13  iter: 1459  total_loss: 0.09042  loss_cls: 0.04099  loss_box_reg: 0.02739  loss_rpn_cls: 0.004646  loss_rpn_loc: 0.01702  time: 0.5809  data_time: 0.0178  lr: 0.01  max_mem: 5386M
[11/16 02:01:52] d2.utils.events INFO:  eta: 0:05:01  iter: 1479  total_loss: 0.08745  loss_cls: 0.03854  loss_box_reg: 0.02614  loss_rpn_cls: 0.004984  loss_rpn_loc: 0.0162  time: 0.5809  data_time: 0.0180  lr: 0.01  max_mem: 5386M
[11/16 02:02:04] d2.utils.events INFO:  eta: 0:04:50  iter: 1499  total_loss: 0.0868  loss_cls: 0.03838  loss_box_reg: 0.02632  loss_rpn_cls: 0.004841  loss_rpn_loc: 0.01435  time: 0.5809  data_time: 0.0176  lr: 0.01  max_mem: 5386M
[11/16 02:02:16] d2.utils.events INFO:  eta: 0:04:38  iter: 1519  total_loss: 0.08561  loss_cls: 0.03752  loss_box_reg: 0.02559  loss_rpn_cls: 0.004607  loss_rpn_loc: 0.01464  time: 0.5809  data_time: 0.0154  lr: 0.01  max_mem: 5386M
[11/16 02:02:27] d2.utils.events INFO:  eta: 0:04:27  iter: 1539  total_loss: 0.08229  loss_cls: 0.03752  loss_box_reg: 0.02749  loss_rpn_cls: 0.004606  loss_rpn_loc: 0.01385  time: 0.5809  data_time: 0.0178  lr: 0.01  max_mem: 5386M
[11/16 02:02:39] d2.utils.events INFO:  eta: 0:04:15  iter: 1559  total_loss: 0.08575  loss_cls: 0.03691  loss_box_reg: 0.0263  loss_rpn_cls: 0.004799  loss_rpn_loc: 0.0174  time: 0.5809  data_time: 0.0156  lr: 0.01  max_mem: 5386M
[11/16 02:02:51] d2.utils.events INFO:  eta: 0:04:03  iter: 1579  total_loss: 0.0848  loss_cls: 0.03854  loss_box_reg: 0.02568  loss_rpn_cls: 0.004368  loss_rpn_loc: 0.01586  time: 0.5808  data_time: 0.0170  lr: 0.01  max_mem: 5386M
[11/16 02:03:02] d2.utils.events INFO:  eta: 0:03:52  iter: 1599  total_loss: 0.08428  loss_cls: 0.03757  loss_box_reg: 0.02652  loss_rpn_cls: 0.005014  loss_rpn_loc: 0.0157  time: 0.5808  data_time: 0.0172  lr: 0.01  max_mem: 5386M
[11/16 02:03:14] d2.utils.events INFO:  eta: 0:03:40  iter: 1619  total_loss: 0.08174  loss_cls: 0.03754  loss_box_reg: 0.02587  loss_rpn_cls: 0.004445  loss_rpn_loc: 0.01296  time: 0.5808  data_time: 0.0164  lr: 0.001  max_mem: 5386M
[11/16 02:03:25] d2.utils.events INFO:  eta: 0:03:28  iter: 1639  total_loss: 0.07771  loss_cls: 0.03587  loss_box_reg: 0.02478  loss_rpn_cls: 0.004742  loss_rpn_loc: 0.009672  time: 0.5808  data_time: 0.0153  lr: 0.001  max_mem: 5386M
[11/16 02:03:37] d2.utils.events INFO:  eta: 0:03:17  iter: 1659  total_loss: 0.07622  loss_cls: 0.0372  loss_box_reg: 0.02519  loss_rpn_cls: 0.004057  loss_rpn_loc: 0.01043  time: 0.5808  data_time: 0.0187  lr: 0.001  max_mem: 5386M
[11/16 02:03:49] d2.utils.events INFO:  eta: 0:03:05  iter: 1679  total_loss: 0.0741  loss_cls: 0.03582  loss_box_reg: 0.02487  loss_rpn_cls: 0.004228  loss_rpn_loc: 0.008568  time: 0.5807  data_time: 0.0171  lr: 0.001  max_mem: 5386M
[11/16 02:04:00] d2.utils.events INFO:  eta: 0:02:53  iter: 1699  total_loss: 0.07718  loss_cls: 0.03623  loss_box_reg: 0.02463  loss_rpn_cls: 0.004297  loss_rpn_loc: 0.009362  time: 0.5806  data_time: 0.0191  lr: 0.001  max_mem: 5386M
[11/16 02:04:12] d2.utils.events INFO:  eta: 0:02:42  iter: 1719  total_loss: 0.07621  loss_cls: 0.03651  loss_box_reg: 0.02483  loss_rpn_cls: 0.00424  loss_rpn_loc: 0.008573  time: 0.5806  data_time: 0.0161  lr: 0.001  max_mem: 5386M
[11/16 02:04:23] d2.utils.events INFO:  eta: 0:02:30  iter: 1739  total_loss: 0.07473  loss_cls: 0.03783  loss_box_reg: 0.02393  loss_rpn_cls: 0.004455  loss_rpn_loc: 0.01004  time: 0.5806  data_time: 0.0176  lr: 0.001  max_mem: 5386M
[11/16 02:04:35] d2.utils.events INFO:  eta: 0:02:19  iter: 1759  total_loss: 0.07549  loss_cls: 0.03638  loss_box_reg: 0.02529  loss_rpn_cls: 0.004367  loss_rpn_loc: 0.01  time: 0.5806  data_time: 0.0161  lr: 0.001  max_mem: 5386M
[11/16 02:04:47] d2.utils.events INFO:  eta: 0:02:07  iter: 1779  total_loss: 0.077  loss_cls: 0.03751  loss_box_reg: 0.02496  loss_rpn_cls: 0.004086  loss_rpn_loc: 0.009064  time: 0.5806  data_time: 0.0180  lr: 0.001  max_mem: 5386M
[11/16 02:04:58] d2.utils.events INFO:  eta: 0:01:56  iter: 1799  total_loss: 0.07665  loss_cls: 0.0367  loss_box_reg: 0.02481  loss_rpn_cls: 0.004316  loss_rpn_loc: 0.01038  time: 0.5806  data_time: 0.0169  lr: 0.001  max_mem: 5386M
[11/16 02:05:10] d2.utils.events INFO:  eta: 0:01:44  iter: 1819  total_loss: 0.07386  loss_cls: 0.03732  loss_box_reg: 0.02458  loss_rpn_cls: 0.004477  loss_rpn_loc: 0.009667  time: 0.5807  data_time: 0.0184  lr: 0.001  max_mem: 5386M
[11/16 02:05:22] d2.utils.events INFO:  eta: 0:01:32  iter: 1839  total_loss: 0.0738  loss_cls: 0.03644  loss_box_reg: 0.02416  loss_rpn_cls: 0.003843  loss_rpn_loc: 0.00902  time: 0.5807  data_time: 0.0162  lr: 0.001  max_mem: 5386M
[11/16 02:05:33] d2.utils.events INFO:  eta: 0:01:21  iter: 1859  total_loss: 0.07395  loss_cls: 0.03687  loss_box_reg: 0.02526  loss_rpn_cls: 0.004192  loss_rpn_loc: 0.008073  time: 0.5807  data_time: 0.0181  lr: 0.001  max_mem: 5386M
[11/16 02:05:45] d2.utils.events INFO:  eta: 0:01:09  iter: 1879  total_loss: 0.07535  loss_cls: 0.036  loss_box_reg: 0.02506  loss_rpn_cls: 0.004086  loss_rpn_loc: 0.008889  time: 0.5807  data_time: 0.0175  lr: 0.001  max_mem: 5386M
[11/16 02:05:56] d2.utils.events INFO:  eta: 0:00:58  iter: 1899  total_loss: 0.07617  loss_cls: 0.03683  loss_box_reg: 0.02553  loss_rpn_cls: 0.004166  loss_rpn_loc: 0.00897  time: 0.5807  data_time: 0.0164  lr: 0.001  max_mem: 5386M
[11/16 02:06:08] d2.utils.events INFO:  eta: 0:00:46  iter: 1919  total_loss: 0.07373  loss_cls: 0.03639  loss_box_reg: 0.02371  loss_rpn_cls: 0.003994  loss_rpn_loc: 0.008432  time: 0.5807  data_time: 0.0170  lr: 0.001  max_mem: 5386M
[11/16 02:06:20] d2.utils.events INFO:  eta: 0:00:34  iter: 1939  total_loss: 0.07657  loss_cls: 0.03766  loss_box_reg: 0.02544  loss_rpn_cls: 0.004429  loss_rpn_loc: 0.008911  time: 0.5806  data_time: 0.0193  lr: 0.001  max_mem: 5386M
[11/16 02:06:31] d2.utils.events INFO:  eta: 0:00:23  iter: 1959  total_loss: 0.0727  loss_cls: 0.03565  loss_box_reg: 0.02467  loss_rpn_cls: 0.004013  loss_rpn_loc: 0.007897  time: 0.5805  data_time: 0.0170  lr: 0.001  max_mem: 5386M
[11/16 02:06:43] d2.utils.events INFO:  eta: 0:00:11  iter: 1979  total_loss: 0.07207  loss_cls: 0.03737  loss_box_reg: 0.02382  loss_rpn_cls: 0.004061  loss_rpn_loc: 0.008609  time: 0.5805  data_time: 0.0167  lr: 0.001  max_mem: 5386M
[11/16 02:06:54] fvcore.common.checkpoint INFO: Saving checkpoint to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/model_final.pth
[11/16 02:06:56] d2.utils.events INFO:  eta: 0:00:00  iter: 1999  total_loss: 0.07498  loss_cls: 0.03669  loss_box_reg: 0.02513  loss_rpn_cls: 0.004215  loss_rpn_loc: 0.009341  time: 0.5804  data_time: 0.0156  lr: 0.001  max_mem: 5386M
[11/16 02:06:56] d2.engine.hooks INFO: Overall training speed: 1998 iterations in 0:19:19 (0.5804 s / it)
[11/16 02:06:56] d2.engine.hooks INFO: Total training time: 0:19:26 (0:00:06 on hooks)
[11/16 02:06:57] defrcn.dataloader.build INFO: Distribution of instances among all 20 categories:
[36m|   category   | #instances   |  category  | #instances   |   category   | #instances   |
|:------------:|:-------------|:----------:|:-------------|:------------:|:-------------|
|    person    | 10538        |  bicycle   | 313          |     car      | 1641         |
|  motorcycle  | 388          |  airplane  | 131          |     bus      | 259          |
|    train     | 212          |    boat    | 458          |     bird     | 453          |
|     cat      | 195          |    dog     | 223          |    horse     | 305          |
|    sheep     | 306          |    cow     | 376          |    bottle    | 939          |
|    chair     | 1594         |   couch    | 236          | potted plant | 429          |
| dining table | 633          |     tv     | 257          |              |              |
|    total     | 19886        |            |              |              |              |[0m
[11/16 02:06:57] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 02:06:57] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/16 02:06:57] d2.data.common INFO: Serialized dataset takes 2.08 MiB
[11/16 02:06:58] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/16 02:06:58] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/16 02:06:59] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 02:06:59] d2.data.common INFO: Serializing 60 elements to byte tensors and concatenating them all ...
[11/16 02:06:59] d2.data.common INFO: Serialized dataset takes 0.02 MiB
[11/16 02:07:03] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/16 02:07:18] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1289 s / img. ETA=0:02:34
[11/16 02:07:24] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1286 s / img. ETA=0:02:27
[11/16 02:07:31] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1314 s / img. ETA=0:02:24
[11/16 02:07:37] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1311 s / img. ETA=0:02:17
[11/16 02:07:44] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1310 s / img. ETA=0:02:11
[11/16 02:07:50] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1302 s / img. ETA=0:02:03
[11/16 02:07:57] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1296 s / img. ETA=0:01:56
[11/16 02:08:03] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1294 s / img. ETA=0:01:50
[11/16 02:08:09] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1291 s / img. ETA=0:01:43
[11/16 02:08:16] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1287 s / img. ETA=0:01:36
[11/16 02:08:22] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1286 s / img. ETA=0:01:30
[11/16 02:08:28] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1287 s / img. ETA=0:01:23
[11/16 02:08:35] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1286 s / img. ETA=0:01:17
[11/16 02:08:41] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1284 s / img. ETA=0:01:10
[11/16 02:08:48] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1285 s / img. ETA=0:01:04
[11/16 02:08:54] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1284 s / img. ETA=0:00:57
[11/16 02:09:00] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1285 s / img. ETA=0:00:51
[11/16 02:09:07] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1284 s / img. ETA=0:00:44
[11/16 02:09:13] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1284 s / img. ETA=0:00:38
[11/16 02:09:20] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1285 s / img. ETA=0:00:32
[11/16 02:09:26] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1284 s / img. ETA=0:00:25
[11/16 02:09:32] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1283 s / img. ETA=0:00:19
[11/16 02:09:39] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1283 s / img. ETA=0:00:12
[11/16 02:09:45] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1283 s / img. ETA=0:00:06
[11/16 02:09:52] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1283 s / img. ETA=0:00:00
[11/16 02:09:52] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:40 (0.128514 s / img per device, on 4 devices)
[11/16 02:09:52] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:36 (0.125931 s / img per device, on 4 devices)
[11/16 02:09:53] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/16 02:09:53] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/inference/coco_instances_results.json
[11/16 02:09:53] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/16 02:10:01] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 12.571 | 22.269 | 12.916 | 5.139 | 12.673 | 19.573 |
[11/16 02:10:01] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 0.544  | bicycle    | 3.316  | car          | 17.024 |
| motorcycle   | 14.002 | airplane   | 28.177 | bus          | 43.490 |
| train        | 31.538 | boat       | 5.120  | bird         | 1.233  |
| cat          | 14.971 | dog        | 3.415  | horse        | 13.624 |
| sheep        | 5.521  | cow        | 7.365  | bottle       | 6.342  |
| chair        | 4.005  | couch      | 11.594 | potted plant | 1.906  |
| dining table | 6.860  | tv         | 31.378 |              |        |
[11/16 02:10:01] defrcn.engine.defaults INFO: Evaluation results for coco14_test_novel in csv format:
[11/16 02:10:01] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/16 02:10:01] defrcn.evaluation.testing INFO: copypaste: nAP,nAP50,nAP75,nAPs,nAPm,nAPl,AP
[11/16 02:10:01] defrcn.evaluation.testing INFO: copypaste: 12.5713,22.2691,12.9158,5.1388,12.6734,19.5728,12.5713
[11/16 02:10:12] detectron2 INFO: Rank of current process: 0. World size: 4
[11/16 02:10:12] detectron2 INFO: Command line arguments: Namespace(config_file='configs/coco/defrcn_gfsod_r101_novel_3shot_seed3.yaml', dist_url='tcp://127.0.0.1:55719', end_iter=-1, eval_all=False, eval_during_train=False, eval_iter=-1, eval_only=True, machine_rank=0, num_gpus=4, num_machines=1, opts=['MODEL.WEIGHTS', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/model_final-merge.pth', 'MODEL.ROI_HEADS.OUTPUT_LAYER', 'CustomFastRCNNOutputLayers', 'TEST.PCB_MODELPATH', '.pretrain_weights/resnet101-5d3b4d8f.pth', 'OUTPUT_DIR', 'checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3', 'SEED', '26180421'], resume=False, start_iter=-1)
[11/16 02:10:12] detectron2 INFO: Contents of args.config_file=configs/coco/defrcn_gfsod_r101_novel_3shot_seed3.yaml:
_BASE_: "../Base-RCNN.yaml"
MODEL:
  WEIGHTS: "/Path/to/Base/Pretrain/Weight"
  MASK_ON: False
  BACKBONE:
    FREEZE: False
  RESNETS:
    DEPTH: 101
  RPN:
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.0
    FREEZE: False
  ROI_HEADS:
    NUM_CLASSES: 80
    FREEZE_FEAT: True
    CLS_DROPOUT: True
    ENABLE_DECOUPLE: True
    BACKWARD_SCALE: 0.01
DATASETS:
  TRAIN: ("coco14_trainval_all_3shot_seed3", )
  TEST: ('coco14_test_all',)
SOLVER:
  IMS_PER_BATCH: 16
  BASE_LR: 0.01
  STEPS: (3840,)
  MAX_ITER: 4800
  CHECKPOINT_PERIOD: 100000
  WARMUP_ITERS: 0
TEST:
  PCB_ENABLE: True
  PCB_MODELPATH: "/Path/to/ImageNet/Pre-Train/Weight"
OUTPUT_DIR: "/Path/to/Output/Dir"
[11/16 02:10:12] detectron2 INFO: Full config saved to /home/dso/DeFRCN/checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/config.yaml
[11/16 02:10:13] d2.modeling.backbone.resnet WARNING: ResNet.make_stage(first_stride=) is deprecated!  Use 'stride_per_block' or 'stride' instead.
[11/16 02:10:13] fvcore.common.checkpoint INFO: [Checkpointer] Loading from checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/model_final-merge.pth ...
[11/16 02:10:14] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 10538        |   bicycle    | 313          |      car      | 1641         |
|  motorcycle   | 388          |   airplane   | 131          |      bus      | 259          |
|     train     | 212          |    truck     | 352          |     boat      | 458          |
| traffic light | 516          | fire hydrant | 83           |   stop sign   | 84           |
| parking meter | 59           |    bench     | 471          |     bird      | 453          |
|      cat      | 195          |     dog      | 223          |     horse     | 305          |
|     sheep     | 306          |     cow      | 376          |   elephant    | 283          |
|     bear      | 53           |    zebra     | 275          |    giraffe    | 170          |
|   backpack    | 384          |   umbrella   | 387          |    handbag    | 483          |
|      tie      | 290          |   suitcase   | 309          |    frisbee    | 109          |
|     skis      | 281          |  snowboard   | 90           |  sports ball  | 233          |
|     kite      | 381          | baseball bat | 123          | baseball gl.. | 139          |
|  skateboard   | 215          |  surfboard   | 266          | tennis racket | 183          |
|    bottle     | 939          |  wine glass  | 363          |      cup      | 891          |
|     fork      | 234          |    knife     | 290          |     spoon     | 253          |
|     bowl      | 617          |    banana    | 359          |     apple     | 158          |
|   sandwich    | 158          |    orange    | 185          |   broccoli    | 330          |
|    carrot     | 341          |   hot dog    | 160          |     pizza     | 223          |
|     donut     | 225          |     cake     | 236          |     chair     | 1594         |
|     couch     | 236          | potted plant | 429          |      bed      | 195          |
| dining table  | 633          |    toilet    | 179          |      tv       | 257          |
|    laptop     | 236          |    mouse     | 95           |    remote     | 241          |
|   keyboard    | 117          |  cell phone  | 291          |   microwave   | 88           |
|     oven      | 142          |   toaster    | 11           |     sink      | 211          |
| refrigerator  | 107          |     book     | 1031         |     clock     | 290          |
|     vase      | 350          |   scissors   | 56           |  teddy bear   | 238          |
|  hair drier   | 11           |  toothbrush  | 77           |               |              |
|     total     | 35094        |              |              |               |              |[0m
[11/16 02:10:14] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 02:10:14] d2.data.common INFO: Serializing 5000 elements to byte tensors and concatenating them all ...
[11/16 02:10:14] d2.data.common INFO: Serialized dataset takes 3.00 MiB
[11/16 02:10:15] defrcn.evaluation.evaluator INFO: Start initializing PCB module, please wait a seconds...
[11/16 02:10:15] defrcn.evaluation.calibration_layer INFO: Loading ImageNet Pre-train Model from .pretrain_weights/resnet101-5d3b4d8f.pth
[11/16 02:10:21] defrcn.dataloader.build INFO: Distribution of instances among all 80 categories:
[36m|   category    | #instances   |   category   | #instances   |   category    | #instances   |
|:-------------:|:-------------|:------------:|:-------------|:-------------:|:-------------|
|    person     | 3            |   bicycle    | 3            |      car      | 3            |
|  motorcycle   | 3            |   airplane   | 3            |      bus      | 3            |
|     train     | 3            |    truck     | 3            |     boat      | 3            |
| traffic light | 3            | fire hydrant | 3            |   stop sign   | 3            |
| parking meter | 3            |    bench     | 3            |     bird      | 3            |
|      cat      | 3            |     dog      | 3            |     horse     | 3            |
|     sheep     | 3            |     cow      | 3            |   elephant    | 3            |
|     bear      | 3            |    zebra     | 3            |    giraffe    | 3            |
|   backpack    | 3            |   umbrella   | 3            |    handbag    | 3            |
|      tie      | 3            |   suitcase   | 3            |    frisbee    | 3            |
|     skis      | 3            |  snowboard   | 3            |  sports ball  | 3            |
|     kite      | 3            | baseball bat | 3            | baseball gl.. | 3            |
|  skateboard   | 3            |  surfboard   | 3            | tennis racket | 3            |
|    bottle     | 3            |  wine glass  | 3            |      cup      | 3            |
|     fork      | 3            |    knife     | 3            |     spoon     | 3            |
|     bowl      | 3            |    banana    | 3            |     apple     | 3            |
|   sandwich    | 3            |    orange    | 3            |   broccoli    | 3            |
|    carrot     | 3            |   hot dog    | 3            |     pizza     | 3            |
|     donut     | 3            |     cake     | 3            |     chair     | 3            |
|     couch     | 3            | potted plant | 3            |      bed      | 3            |
| dining table  | 3            |    toilet    | 3            |      tv       | 3            |
|    laptop     | 3            |    mouse     | 3            |    remote     | 3            |
|   keyboard    | 3            |  cell phone  | 3            |   microwave   | 3            |
|     oven      | 3            |   toaster    | 3            |     sink      | 3            |
| refrigerator  | 3            |     book     | 3            |     clock     | 3            |
|     vase      | 3            |   scissors   | 3            |  teddy bear   | 3            |
|  hair drier   | 3            |  toothbrush  | 3            |               |              |
|     total     | 240          |              |              |               |              |[0m
[11/16 02:10:21] defrcn.dataloader.dataset_mapper INFO: [DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style='choice')]
[11/16 02:10:21] d2.data.common INFO: Serializing 240 elements to byte tensors and concatenating them all ...
[11/16 02:10:21] d2.data.common INFO: Serialized dataset takes 0.06 MiB
[11/16 02:10:38] defrcn.evaluation.evaluator INFO: Start inference on 1250 images
[11/16 02:10:53] defrcn.evaluation.evaluator INFO: Inference done 50/1250. 0.1290 s / img. ETA=0:02:34
[11/16 02:10:59] defrcn.evaluation.evaluator INFO: Inference done 100/1250. 0.1294 s / img. ETA=0:02:28
[11/16 02:11:06] defrcn.evaluation.evaluator INFO: Inference done 150/1250. 0.1294 s / img. ETA=0:02:22
[11/16 02:11:12] defrcn.evaluation.evaluator INFO: Inference done 200/1250. 0.1287 s / img. ETA=0:02:15
[11/16 02:11:18] defrcn.evaluation.evaluator INFO: Inference done 250/1250. 0.1290 s / img. ETA=0:02:09
[11/16 02:11:25] defrcn.evaluation.evaluator INFO: Inference done 300/1250. 0.1286 s / img. ETA=0:02:02
[11/16 02:11:31] defrcn.evaluation.evaluator INFO: Inference done 350/1250. 0.1285 s / img. ETA=0:01:55
[11/16 02:11:38] defrcn.evaluation.evaluator INFO: Inference done 400/1250. 0.1286 s / img. ETA=0:01:49
[11/16 02:11:44] defrcn.evaluation.evaluator INFO: Inference done 450/1250. 0.1285 s / img. ETA=0:01:42
[11/16 02:11:50] defrcn.evaluation.evaluator INFO: Inference done 500/1250. 0.1284 s / img. ETA=0:01:36
[11/16 02:11:57] defrcn.evaluation.evaluator INFO: Inference done 550/1250. 0.1286 s / img. ETA=0:01:30
[11/16 02:12:03] defrcn.evaluation.evaluator INFO: Inference done 600/1250. 0.1287 s / img. ETA=0:01:23
[11/16 02:12:10] defrcn.evaluation.evaluator INFO: Inference done 650/1250. 0.1287 s / img. ETA=0:01:17
[11/16 02:12:16] defrcn.evaluation.evaluator INFO: Inference done 700/1250. 0.1285 s / img. ETA=0:01:10
[11/16 02:12:23] defrcn.evaluation.evaluator INFO: Inference done 750/1250. 0.1287 s / img. ETA=0:01:04
[11/16 02:12:29] defrcn.evaluation.evaluator INFO: Inference done 800/1250. 0.1287 s / img. ETA=0:00:57
[11/16 02:12:36] defrcn.evaluation.evaluator INFO: Inference done 850/1250. 0.1290 s / img. ETA=0:00:51
[11/16 02:12:42] defrcn.evaluation.evaluator INFO: Inference done 900/1250. 0.1292 s / img. ETA=0:00:45
[11/16 02:12:49] defrcn.evaluation.evaluator INFO: Inference done 950/1250. 0.1293 s / img. ETA=0:00:38
[11/16 02:12:55] defrcn.evaluation.evaluator INFO: Inference done 1000/1250. 0.1292 s / img. ETA=0:00:32
[11/16 02:13:02] defrcn.evaluation.evaluator INFO: Inference done 1050/1250. 0.1293 s / img. ETA=0:00:25
[11/16 02:13:08] defrcn.evaluation.evaluator INFO: Inference done 1100/1250. 0.1292 s / img. ETA=0:00:19
[11/16 02:13:15] defrcn.evaluation.evaluator INFO: Inference done 1150/1250. 0.1293 s / img. ETA=0:00:12
[11/16 02:13:21] defrcn.evaluation.evaluator INFO: Inference done 1200/1250. 0.1293 s / img. ETA=0:00:06
[11/16 02:13:28] defrcn.evaluation.evaluator INFO: Inference done 1250/1250. 0.1293 s / img. ETA=0:00:00
[11/16 02:13:28] defrcn.evaluation.evaluator INFO: Total inference time: 0:02:41 (0.129317 s / img per device, on 4 devices)
[11/16 02:13:28] defrcn.evaluation.evaluator INFO: Total inference pure compute time: 0:02:37 (0.126583 s / img per device, on 4 devices)
[11/16 02:13:30] defrcn.evaluation.coco_evaluation INFO: Preparing results for COCO format ...
[11/16 02:13:30] defrcn.evaluation.coco_evaluation INFO: Saving results to checkpoints/coco/ebm/defrcn_gfsod_r101_novel/tfa-like/3shot_seed3/inference/coco_instances_results.json
[11/16 02:13:30] defrcn.evaluation.coco_evaluation INFO: Evaluating predictions ...
[11/16 02:13:55] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 30.616 | 47.438 | 32.794 | 14.474 | 35.040 | 44.793 |
[11/16 02:13:55] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category      | AP     | category     | AP     | category       | AP     |
|:--------------|:-------|:-------------|:-------|:---------------|:-------|
| person        | 0.564  | bicycle      | 3.648  | car            | 17.357 |
| motorcycle    | 14.018 | airplane     | 26.676 | bus            | 43.979 |
| train         | 30.965 | truck        | 29.506 | boat           | 6.230  |
| traffic light | 24.425 | fire hydrant | 64.390 | stop sign      | 68.780 |
| parking meter | 38.326 | bench        | 17.402 | bird           | 1.809  |
| cat           | 17.916 | dog          | 3.534  | horse          | 14.478 |
| sheep         | 5.846  | cow          | 9.276  | elephant       | 64.307 |
| bear          | 59.761 | zebra        | 58.375 | giraffe        | 67.928 |
| backpack      | 16.989 | umbrella     | 30.303 | handbag        | 15.502 |
| tie           | 33.069 | suitcase     | 28.406 | frisbee        | 56.857 |
| skis          | 21.930 | snowboard    | 32.172 | sports ball    | 38.199 |
| kite          | 38.656 | baseball bat | 26.841 | baseball glove | 27.944 |
| skateboard    | 45.756 | surfboard    | 38.793 | tennis racket  | 48.134 |
| bottle        | 9.047  | wine glass   | 28.744 | cup            | 37.125 |
| fork          | 34.147 | knife        | 16.240 | spoon          | 16.905 |
| bowl          | 35.746 | banana       | 24.432 | apple          | 17.688 |
| sandwich      | 34.005 | orange       | 23.948 | broccoli       | 24.564 |
| carrot        | 22.119 | hot dog      | 32.639 | pizza          | 51.485 |
| donut         | 47.625 | cake         | 39.860 | chair          | 4.070  |
| couch         | 15.331 | potted plant | 2.664  | bed            | 37.906 |
| dining table  | 6.945  | toilet       | 54.311 | tv             | 32.910 |
| laptop        | 55.740 | mouse        | 46.758 | remote         | 29.361 |
| keyboard      | 50.706 | cell phone   | 25.818 | microwave      | 52.331 |
| oven          | 36.200 | toaster      | 32.689 | sink           | 33.672 |
| refrigerator  | 55.513 | book         | 8.770  | clock          | 46.293 |
| vase          | 33.177 | scissors     | 24.473 | teddy bear     | 39.424 |
| hair drier    | 18.353 | toothbrush   | 20.487 |                |        |
[11/16 02:14:13] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs   |  APm   |  APl   |
|:------:|:------:|:------:|:------:|:------:|:------:|
| 36.367 | 55.260 | 39.199 | 17.760 | 42.061 | 52.679 |
[11/16 02:14:13] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category       | AP     | category      | AP     | category     | AP     |
|:---------------|:-------|:--------------|:-------|:-------------|:-------|
| truck          | 29.506 | traffic light | 24.425 | fire hydrant | 64.390 |
| stop sign      | 68.780 | parking meter | 38.326 | bench        | 17.402 |
| elephant       | 64.307 | bear          | 59.761 | zebra        | 58.375 |
| giraffe        | 67.928 | backpack      | 16.989 | umbrella     | 30.303 |
| handbag        | 15.502 | tie           | 33.069 | suitcase     | 28.406 |
| frisbee        | 56.857 | skis          | 21.930 | snowboard    | 32.172 |
| sports ball    | 38.199 | kite          | 38.656 | baseball bat | 26.841 |
| baseball glove | 27.944 | skateboard    | 45.756 | surfboard    | 38.793 |
| tennis racket  | 48.134 | wine glass    | 28.744 | cup          | 37.125 |
| fork           | 34.147 | knife         | 16.240 | spoon        | 16.905 |
| bowl           | 35.746 | banana        | 24.432 | apple        | 17.688 |
| sandwich       | 34.005 | orange        | 23.948 | broccoli     | 24.564 |
| carrot         | 22.119 | hot dog       | 32.639 | pizza        | 51.485 |
| donut          | 47.625 | cake          | 39.860 | bed          | 37.906 |
| toilet         | 54.311 | laptop        | 55.740 | mouse        | 46.758 |
| remote         | 29.361 | keyboard      | 50.706 | cell phone   | 25.818 |
| microwave      | 52.331 | oven          | 36.200 | toaster      | 32.689 |
| sink           | 33.672 | refrigerator  | 55.513 | book         | 8.770  |
| clock          | 46.293 | vase          | 33.177 | scissors     | 24.473 |
| teddy bear     | 39.424 | hair drier    | 18.353 | toothbrush   | 20.487 |
[11/16 02:14:19] defrcn.evaluation.coco_evaluation INFO: Evaluation results for bbox: 
|   AP   |  AP50  |  AP75  |  APs  |  APm   |  APl   |
|:------:|:------:|:------:|:-----:|:------:|:------:|
| 13.363 | 23.972 | 13.577 | 4.781 | 13.975 | 21.136 |
[11/16 02:14:19] defrcn.evaluation.coco_evaluation INFO: Per-category bbox AP: 
| category     | AP     | category   | AP     | category     | AP     |
|:-------------|:-------|:-----------|:-------|:-------------|:-------|
| person       | 0.564  | bicycle    | 3.648  | car          | 17.357 |
| motorcycle   | 14.018 | airplane   | 26.676 | bus          | 43.979 |
| train        | 30.965 | boat       | 6.230  | bird         | 1.809  |
| cat          | 17.916 | dog        | 3.534  | horse        | 14.478 |
| sheep        | 5.846  | cow        | 9.276  | bottle       | 9.047  |
| chair        | 4.070  | couch      | 15.331 | potted plant | 2.664  |
| dining table | 6.945  | tv         | 32.910 |              |        |
[11/16 02:14:19] defrcn.engine.defaults INFO: Evaluation results for coco14_test_all in csv format:
[11/16 02:14:19] defrcn.evaluation.testing INFO: copypaste: Task: bbox
[11/16 02:14:19] defrcn.evaluation.testing INFO: copypaste: AP,AP50,AP75,APs,APm,APl,bAP,bAP50,bAP75,bAPs,bAPm,bAPl,nAP,nAP50,nAP75,nAPs,nAPm,nAPl
[11/16 02:14:19] defrcn.evaluation.testing INFO: copypaste: 30.6158,47.4383,32.7938,14.4742,35.0398,44.7934,36.3668,55.2602,39.1992,17.7602,42.0613,52.6792,13.3630,23.9724,13.5775,4.7806,13.9751,21.1361
